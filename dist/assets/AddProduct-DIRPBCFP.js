import{j as e}from"./query-vendor-BLxHmmGk.js";import{r as p,u as ue}from"./react-vendor-BeR0k5Z3.js";import{l as ge,o as H,P as W,t as K,x as U,a1 as he,a5 as _e,y as X,F as k,_ as xe,B as z,C as ye,G as je,H as ve,D as fe}from"./index-DGlTgSKx.js";import{I as i}from"./input-CEHl5GoJ.js";import{L as a}from"./label-ClRcubO_.js";import{T as be}from"./textarea-DU5hu0UG.js";import{c as Y,R as Ne,I as we}from"./index-XJCymQHf.js";import{u as Fe}from"./index-BC78nHQ6.js";import{u as Ce}from"./index-DjQc2W_p.js";import{aM as ke,u as P,J as Pe,aa as Re,X as M,ac as q,q as O}from"./ui-vendor-CN4tOqpp.js";import{u as Se}from"./useVendorPermissions-3FIyIdzZ.js";import{S as Ie,a as Ge,b as Ee,c as Ae,d as V}from"./select-CQfvDDtS.js";import{K as Ve,s as F,n as Q,c as Te,a as We,b as Le,d as Me,e as qe,f as Oe,g as Ue}from"./jewelryCalculations-CdGLIbP_.js";import{P as $e}from"./PlanLimitWarning-D2tC9SoR.js";import{u as Ke}from"./useRewardsSystem-5YgyYoFa.js";import{j as Be}from"./validations-Dq2g6qv0.js";import{A as Je,a as ze}from"./alert-B0m9J_BT.js";import"./supabase-vendor-VSDMYZ1k.js";import"./index-BdQq_4o_.js";import"./index-aqCwQlp3.js";import"./index-ibl8YJur.js";var B="Radio",[He,Z]=H(B),[Xe,Ye]=He(B),D=p.forwardRef((r,t)=>{const{__scopeRadio:c,name:y,checked:h=!1,required:x,disabled:u,value:f="on",onCheck:l,form:C,...b}=r,[j,s]=p.useState(null),o=K(t,_=>s(_)),g=p.useRef(!1),v=j?C||!!j.closest("form"):!0;return e.jsxs(Xe,{scope:c,checked:h,disabled:u,children:[e.jsx(W.button,{type:"button",role:"radio","aria-checked":h,"data-state":te(h),"data-disabled":u?"":void 0,disabled:u,value:f,...b,ref:o,onClick:U(r.onClick,_=>{h||l==null||l(),v&&(g.current=_.isPropagationStopped(),g.current||_.stopPropagation())})}),v&&e.jsx(re,{control:j,bubbles:!g.current,name:y,value:f,checked:h,required:x,disabled:u,form:C,style:{transform:"translateX(-100%)"}})]})});D.displayName=B;var ee="RadioIndicator",se=p.forwardRef((r,t)=>{const{__scopeRadio:c,forceMount:y,...h}=r,x=Ye(ee,c);return e.jsx(he,{present:y||x.checked,children:e.jsx(W.span,{"data-state":te(x.checked),"data-disabled":x.disabled?"":void 0,...h,ref:t})})});se.displayName=ee;var Qe="RadioBubbleInput",re=p.forwardRef(({__scopeRadio:r,control:t,checked:c,bubbles:y=!0,...h},x)=>{const u=p.useRef(null),f=K(u,x),l=Ce(c),C=_e(t);return p.useEffect(()=>{const b=u.current;if(!b)return;const j=window.HTMLInputElement.prototype,o=Object.getOwnPropertyDescriptor(j,"checked").set;if(l!==c&&o){const g=new Event("click",{bubbles:y});o.call(b,c),b.dispatchEvent(g)}},[l,c,y]),e.jsx(W.input,{type:"radio","aria-hidden":!0,defaultChecked:c,...h,tabIndex:-1,ref:f,style:{...h.style,...C,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});re.displayName=Qe;function te(r){return r?"checked":"unchecked"}var Ze=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],L="RadioGroup",[De]=H(L,[Y,Z]),ae=Y(),ie=Z(),[es,ss]=De(L),oe=p.forwardRef((r,t)=>{const{__scopeRadioGroup:c,name:y,defaultValue:h,value:x,required:u=!1,disabled:f=!1,orientation:l,dir:C,loop:b=!0,onValueChange:j,...s}=r,o=ae(c),g=Fe(C),[v,_]=ge({prop:x,defaultProp:h??null,onChange:j,caller:L});return e.jsx(es,{scope:c,name:y,required:u,disabled:f,value:v,onValueChange:_,children:e.jsx(Ne,{asChild:!0,...o,orientation:l,dir:g,loop:b,children:e.jsx(W.div,{role:"radiogroup","aria-required":u,"aria-orientation":l,"data-disabled":f?"":void 0,dir:g,...s,ref:t})})})});oe.displayName=L;var le="RadioGroupItem",ne=p.forwardRef((r,t)=>{const{__scopeRadioGroup:c,disabled:y,...h}=r,x=ss(le,c),u=x.disabled||y,f=ae(c),l=ie(c),C=p.useRef(null),b=K(t,C),j=x.value===h.value,s=p.useRef(!1);return p.useEffect(()=>{const o=v=>{Ze.includes(v.key)&&(s.current=!0)},g=()=>s.current=!1;return document.addEventListener("keydown",o),document.addEventListener("keyup",g),()=>{document.removeEventListener("keydown",o),document.removeEventListener("keyup",g)}},[]),e.jsx(we,{asChild:!0,...f,focusable:!u,active:j,children:e.jsx(D,{disabled:u,required:x.required,checked:j,...l,...h,name:x.name,ref:b,onCheck:()=>x.onValueChange(h.value),onKeyDown:U(o=>{o.key==="Enter"&&o.preventDefault()}),onFocus:U(h.onFocus,()=>{var o;s.current&&((o=C.current)==null||o.click())})})})});ne.displayName=le;var rs="RadioGroupIndicator",ce=p.forwardRef((r,t)=>{const{__scopeRadioGroup:c,...y}=r,h=ie(c);return e.jsx(se,{...h,...y,ref:t})});ce.displayName=rs;var de=oe,me=ne,ts=ce;const pe=p.forwardRef(({className:r,...t},c)=>e.jsx(de,{className:X("grid gap-2",r),...t,ref:c}));pe.displayName=de.displayName;const $=p.forwardRef(({className:r,...t},c)=>e.jsx(me,{ref:c,className:X("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),...t,children:e.jsx(ts,{className:"flex items-center justify-center",children:e.jsx(ke,{className:"h-2.5 w-2.5 fill-current text-current"})})}));$.displayName=me.displayName;const as=Ve.map(r=>r.value),is=({formData:r,handleChange:t,setFormData:c})=>{var j,s;const[y,h]=p.useState(0),[x,u]=p.useState(!1),f=as.includes((j=r.purity_fraction_used)==null?void 0:j.toString());p.useEffect(()=>{(async()=>{const{data:{user:g}}=await k.auth.getUser();if(!g)return;const{data:v}=await k.from("vendor_profiles").select("making_charges_per_gram").eq("user_id",g.id).maybeSingle();if(v!=null&&v.making_charges_per_gram){const _=Number(v.making_charges_per_gram);isNaN(_)||h(_)}})()},[]);const l=p.useMemo(()=>{const o=F(r.d_wt_1),g=F(r.d_wt_2),v=F(r.d_rate_1),_=F(r.pointer_diamond),R=F(r.weight_grams),S=F(r.carat_weight),n=F(r.gemstone_rate),d=F(r.gold_per_gram_price),m=F(r.certification_cost),N=Q(r.purity_fraction_used),w=Te(o,g),G=We(o,v,g,_),I=Le(R,w,S),E=Me(R,y),A=S*n,J=qe(I,N,d),T=Oe(G,E,J,m,A);return{totalDiamondWeight:w>0?w.toFixed(2):"",dValue:G>0?G.toFixed(2):"",netWeight:I>0?I.toFixed(3):"",makingCharges:E>0?E.toFixed(2):"",gemstoneCost:A>0?A.toFixed(2):"",goldValue:J,totalPrice:T>0?T.toFixed(2):"",costPrice:T>0?(T*.85).toFixed(2):""}},[r.d_wt_1,r.d_wt_2,r.d_rate_1,r.pointer_diamond,r.weight_grams,r.carat_weight,r.gemstone_rate,r.gold_per_gram_price,r.certification_cost,r.purity_fraction_used,y]);p.useEffect(()=>{const o={};l.totalDiamondWeight&&l.totalDiamondWeight!==r.diamond_weight&&(o.diamond_weight=l.totalDiamondWeight),l.dValue&&l.dValue!==r.d_value&&(o.d_value=l.dValue),l.netWeight&&l.netWeight!==r.net_weight&&(o.net_weight=l.netWeight),l.makingCharges&&l.makingCharges!==r.mkg&&(o.mkg=l.makingCharges),l.gemstoneCost&&l.gemstoneCost!==r.gemstone_cost&&(o.gemstone_cost=l.gemstoneCost),l.totalPrice&&l.totalPrice!==r.retail_price&&(o.retail_price=l.totalPrice,o.cost_price=l.costPrice),Object.keys(o).length>0&&c(g=>({...g,...o}))},[l,r,c]);const C=p.useCallback(o=>{o==="custom"?(u(!0),c(g=>({...g,purity_fraction_used:""}))):(u(!1),c(g=>({...g,purity_fraction_used:o})))},[c]),b=p.useCallback(()=>{u(!1),c(o=>({...o,purity_fraction_used:"18"}))},[c]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"}),"Jewellery Details",e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"metal_type",children:"Metal Type"}),e.jsx(i,{id:"metal_type",name:"metal_type",value:r.metal_type||"",onChange:t,placeholder:"18K Gold"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"gemstone",children:"Gemstone"}),e.jsx(i,{id:"gemstone",name:"gemstone",value:r.gemstone||"",onChange:t,placeholder:"GH VS (Color Clarity)"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"weight_grams",children:"Gross Weight (g)"}),e.jsx(i,{id:"weight_grams",name:"weight_grams",type:"number",step:"0.001",value:r.weight_grams||"",onChange:t,placeholder:"4.37"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"carat_weight",children:"Gemstone Weight (ct)"}),e.jsx(i,{id:"carat_weight",name:"carat_weight",type:"number",step:"0.01",value:r.carat_weight||"",onChange:t,placeholder:"0.50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"net_weight",children:"Net Weight (g)"}),e.jsx(i,{id:"net_weight",name:"net_weight",type:"number",step:"0.001",value:r.net_weight||"",onChange:t,placeholder:"4.252",className:"bg-muted/30",readOnly:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"d_wt_1",children:"D.WT 1 (ct)"}),e.jsx(i,{id:"d_wt_1",name:"d_wt_1",type:"number",step:"0.01",value:r.d_wt_1||"",onChange:t,placeholder:"0.23"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"d_wt_2",children:"D.WT 2 (ct)"}),e.jsx(i,{id:"d_wt_2",name:"d_wt_2",type:"number",step:"0.01",value:r.d_wt_2||"",onChange:t,placeholder:"0.36"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"diamond_weight",children:"Total D.WT (ct)"}),e.jsx(i,{id:"diamond_weight",name:"diamond_weight",type:"number",step:"0.01",value:r.diamond_weight||"",className:"bg-muted/30",readOnly:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"D.WT 1 + D.WT 2"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"d_rate_1",children:"D Rate 1 (â‚¹/ct)"}),e.jsx(i,{id:"d_rate_1",name:"d_rate_1",type:"number",step:"0.01",value:r.d_rate_1||"",onChange:t,placeholder:"15000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"pointer_diamond",children:"Pointer Diamond (â‚¹/ct)"}),e.jsx(i,{id:"pointer_diamond",name:"pointer_diamond",type:"number",step:"0.01",value:r.pointer_diamond||"",onChange:t,placeholder:"12000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"d_value",children:"D Value (â‚¹)"}),e.jsx(i,{id:"d_value",name:"d_value",type:"number",step:"0.01",value:r.d_value||"",className:"bg-muted/30",readOnly:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"purity_fraction_used",children:"Purity (Karat)"}),x||!f&&r.purity_fraction_used?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{id:"purity_fraction_used",name:"purity_fraction_used",type:"number",step:"0.01",value:r.purity_fraction_used||"",onChange:t,placeholder:"18 or 75 or 0.75",className:"flex-1"}),e.jsx("button",{type:"button",onClick:b,className:"px-3 py-2 text-xs bg-muted hover:bg-muted/80 rounded-md transition-colors",children:"Reset"})]}):e.jsxs(Ie,{value:((s=r.purity_fraction_used)==null?void 0:s.toString())||"18",onValueChange:C,children:[e.jsx(Ge,{className:"bg-background",children:e.jsx(Ee,{placeholder:"Select purity"})}),e.jsxs(Ae,{className:"bg-background z-50",children:[e.jsx(V,{value:"14",children:"14K (58.3%)"}),e.jsx(V,{value:"18",children:"18K (75%)"}),e.jsx(V,{value:"22",children:"22K (91.7%)"}),e.jsx(V,{value:"24",children:"24K (100%)"}),e.jsx(V,{value:"custom",children:"Custom..."})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Ue(r.purity_fraction_used),"% gold purity"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"gold_per_gram_price",children:"Gold Rate (â‚¹/g)"}),e.jsx(i,{id:"gold_per_gram_price",name:"gold_per_gram_price",type:"number",step:"0.01",value:r.gold_per_gram_price||"",onChange:t,placeholder:"7500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"mkg",children:"Making Charges (â‚¹)"}),e.jsx(i,{id:"mkg",name:"mkg",type:"number",step:"0.01",value:r.mkg||"",className:"bg-muted/30",readOnly:!0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Gross Ã— â‚¹",y,"/g"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"retail_price",children:"Total Price (â‚¹)"}),e.jsx(i,{id:"retail_price",name:"retail_price",type:"number",step:"0.01",value:r.retail_price||"",className:"bg-muted/30 font-semibold",readOnly:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"gemstone_rate",children:"Gemstone Rate (â‚¹/ct)"}),e.jsx(i,{id:"gemstone_rate",name:"gemstone_rate",type:"number",step:"0.01",value:r.gemstone_rate||"",onChange:t,placeholder:"5000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"gemstone_cost",children:"Gemstone Cost (â‚¹)"}),e.jsx(i,{id:"gemstone_cost",name:"gemstone_cost",type:"number",step:"0.01",value:r.gemstone_cost||"",className:"bg-muted/30",readOnly:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Weight Ã— Rate"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"certification_cost",children:"Certification (â‚¹)"}),e.jsx(i,{id:"certification_cost",name:"certification_cost",type:"number",step:"0.01",value:r.certification_cost||"",onChange:t,placeholder:"0"})]})]}),e.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg border border-border",children:[e.jsx("p",{className:"text-sm font-medium mb-3",children:"Price Breakdown"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Diamond Value:"}),e.jsxs("span",{className:"font-medium",children:["â‚¹",F(r.d_value).toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Making Charges:"}),e.jsxs("span",{className:"font-medium",children:["â‚¹",F(r.mkg).toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Gold Value:"}),e.jsxs("span",{className:"font-medium",children:["â‚¹",l.goldValue.toLocaleString("en-IN",{maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Certification:"}),e.jsxs("span",{className:"font-medium",children:["â‚¹",F(r.certification_cost).toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Gemstone Cost:"}),e.jsxs("span",{className:"font-medium",children:["â‚¹",F(r.gemstone_cost).toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"border-t pt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"Total Price:"}),e.jsxs("span",{className:"font-bold text-primary",children:["â‚¹",F(r.retail_price).toLocaleString("en-IN")]})]})]})]})]})},os=({formData:r,handleChange:t})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"}),"Gemstone Details",e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"gemstone_name",children:"Gemstone Name"}),e.jsx(i,{id:"gemstone_name",name:"gemstone_name",value:r.gemstone_name,onChange:t,placeholder:"Ruby, Sapphire, Emerald..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"gemstone_type",children:"Gemstone Type"}),e.jsx(i,{id:"gemstone_type",name:"gemstone_type",value:r.gemstone_type,onChange:t,placeholder:"Natural, Synthetic..."})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"color",children:"Color"}),e.jsx(i,{id:"color",name:"color",value:r.color,onChange:t,placeholder:"Red, Blue, Green..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"clarity",children:"Clarity"}),e.jsx(i,{id:"clarity",name:"clarity",value:r.clarity,onChange:t,placeholder:"VVS, VS, SI..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"cut",children:"Cut"}),e.jsx(i,{id:"cut",name:"cut",value:r.cut,onChange:t,placeholder:"Excellent, Good..."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"carat_weight",children:"Carat Weight"}),e.jsx(i,{id:"carat_weight",name:"carat_weight",type:"number",step:"0.01",value:r.carat_weight,onChange:t,placeholder:"5.50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"per_carat_price",children:"Per Carat Price (â‚¹)"}),e.jsx(i,{id:"per_carat_price",name:"per_carat_price",type:"number",step:"0.01",value:r.per_carat_price,onChange:t,placeholder:"10000"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"color_shade_amount",children:"Color Shade Amount"}),e.jsx(i,{id:"color_shade_amount",name:"color_shade_amount",value:r.color_shade_amount,onChange:t,placeholder:"Vivid, Medium..."})]})]}),ls=({formData:r,handleChange:t})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"}),"Diamond Details",e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"shape",children:"Shape"}),e.jsx(i,{id:"shape",name:"shape",value:r.shape,onChange:t,placeholder:"Round, Princess, Oval..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"carat",children:"Carat"}),e.jsx(i,{id:"carat",name:"carat",type:"number",step:"0.01",value:r.carat,onChange:t,placeholder:"1.50"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"color",children:"Color"}),e.jsx(i,{id:"color",name:"color",value:r.color,onChange:t,placeholder:"D, E, F, G, H..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"clarity",children:"Clarity"}),e.jsx(i,{id:"clarity",name:"clarity",value:r.clarity,onChange:t,placeholder:"IF, VVS1, VVS2, VS1..."})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"cut",children:"Cut"}),e.jsx(i,{id:"cut",name:"cut",value:r.cut,onChange:t,placeholder:"Excellent, Very Good..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"polish",children:"Polish"}),e.jsx(i,{id:"polish",name:"polish",value:r.polish,onChange:t,placeholder:"Excellent, Very Good..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"symmetry",children:"Symmetry"}),e.jsx(i,{id:"symmetry",name:"symmetry",value:r.symmetry,onChange:t,placeholder:"Excellent, Very Good..."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"fluorescence",children:"Fluorescence"}),e.jsx(i,{id:"fluorescence",name:"fluorescence",value:r.fluorescence,onChange:t,placeholder:"None, Faint, Medium..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"measurement",children:"Measurement"}),e.jsx(i,{id:"measurement",name:"measurement",value:r.measurement,onChange:t,placeholder:"6.50 x 6.55 x 4.05 mm"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"lab",children:"Lab"}),e.jsx(i,{id:"lab",name:"lab",value:r.lab,onChange:t,placeholder:"GIA, IGI, AGS..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"certification",children:"Certification #"}),e.jsx(i,{id:"certification",name:"certification",value:r.certification,onChange:t,placeholder:"Certificate number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"ratio",children:"Ratio"}),e.jsx(i,{id:"ratio",name:"ratio",value:r.ratio,onChange:t,placeholder:"1.00 - 1.05"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"per_carat_price",children:"Per Carat Price (â‚¹)"}),e.jsx(i,{id:"per_carat_price",name:"per_carat_price",type:"number",step:"0.01",value:r.per_carat_price,onChange:t,placeholder:"500000"})]})]}),Rs=()=>{const r=ue(),{permissions:t,loading:c}=Se(),{awardPoints:y}=Ke(),[h,x]=p.useState(!1),[u,f]=p.useState({}),[l,C]=p.useState(["Jewellery"]),[b,j]=p.useState([]),[s,o]=p.useState({name:"",description:"",sku:"",category:"",product_type:"Jewellery",metal_type:"",gemstone:"",gemstone_name:"",gemstone_type:"",gemstone_rate:"",color:"",diamond_color:"",clarity:"",cut:"",polish:"",symmetry:"",fluorescence:"",shape:"",measurement:"",certification:"",ratio:"",lab:"",weight_grams:"",net_weight:"",diamond_weight:"",d_wt_1:"",d_wt_2:"",purity_fraction_used:"18",d_rate_1:"",pointer_diamond:"",d_value:"",mkg:"",carat:"",carat_weight:"",per_carat_price:"",gold_per_gram_price:"",certification_cost:"",gemstone_cost:"",cost_price:"",retail_price:"",total_usd:"",stock_quantity:"0",color_shade_amount:"",image_url:"",image_url_2:"",image_url_3:"",delivery_type:"immediate",dispatches_in_days:""});p.useEffect(()=>{g()},[]);const g=async()=>{try{const{data:{user:n}}=await k.auth.getUser();if(!n)return;const{data:d,error:m}=await k.from("user_approval_status").select("approved_categories").eq("user_id",n.id).single();if(m)throw m;const N=(d==null?void 0:d.approved_categories)||["Jewellery"];C(N),o(w=>({...w,product_type:N[0]}))}catch(n){console.error("Failed to fetch approved categories:",n)}};p.useEffect(()=>{!c&&!t.can_add_products&&(P.error("You don't have permission to add products"),r("/"))},[t,c,r]);const v=async n=>{if(n.preventDefault(),j([]),s.product_type==="Jewellery")try{Be.parse({name:s.name,description:s.description||void 0,sku:s.sku||void 0,category:s.category||void 0,metal_type:s.metal_type,gemstone:s.gemstone||void 0,weight_grams:s.weight_grams?parseFloat(s.weight_grams):void 0,net_weight:s.net_weight?parseFloat(s.net_weight):void 0,gold_per_gram_price:s.gold_per_gram_price?parseFloat(s.gold_per_gram_price):void 0,purity_fraction_used:s.purity_fraction_used?parseFloat(s.purity_fraction_used):void 0,d_wt_1:s.d_wt_1?parseFloat(s.d_wt_1):null,d_wt_2:s.d_wt_2?parseFloat(s.d_wt_2):null,diamond_weight:s.diamond_weight?parseFloat(s.diamond_weight):null,d_rate_1:s.d_rate_1?parseFloat(s.d_rate_1):null,pointer_diamond:s.pointer_diamond?parseFloat(s.pointer_diamond):null,d_value:s.d_value?parseFloat(s.d_value):null,mkg:s.mkg?parseFloat(s.mkg):void 0,carat_weight:s.carat_weight?parseFloat(s.carat_weight):null,gemstone_rate:s.gemstone_rate?parseFloat(s.gemstone_rate):null,certification_cost:s.certification_cost?parseFloat(s.certification_cost):null,gemstone_cost:s.gemstone_cost?parseFloat(s.gemstone_cost):null,cost_price:s.cost_price?parseFloat(s.cost_price):void 0,retail_price:s.retail_price?parseFloat(s.retail_price):void 0,stock_quantity:parseInt(s.stock_quantity),delivery_type:s.delivery_type,image_url:s.image_url||null,image_url_2:s.image_url_2||null,image_url_3:s.image_url_3||null})}catch(d){if(d.errors){const m=d.errors.map(N=>`${N.path.join(" â†’ ")}: ${N.message}`);j(m),P.error("Please fix the validation errors below"),window.scrollTo({top:0,behavior:"smooth"});return}}x(!0);try{const{data:{user:d}}=await k.auth.getUser();if(!d)throw new Error("Not authenticated");const{error:m}=await k.from("products").insert([{user_id:d.id,name:s.name,description:s.description||null,sku:s.sku||null,category:s.category||null,product_type:s.product_type,metal_type:s.metal_type||null,gemstone:s.gemstone||null,gemstone_name:s.gemstone_name||null,gemstone_type:s.gemstone_type||null,color:s.color||null,diamond_color:s.diamond_color||null,clarity:s.clarity||null,cut:s.cut||null,polish:s.polish||null,symmetry:s.symmetry||null,fluorescence:s.fluorescence||null,shape:s.shape||null,measurement:s.measurement||null,certification:s.certification||null,ratio:s.ratio||null,lab:s.lab||null,weight_grams:s.weight_grams?parseFloat(s.weight_grams):null,net_weight:s.net_weight?parseFloat(s.net_weight):null,diamond_weight:s.diamond_weight?parseFloat(s.diamond_weight):null,d_wt_1:s.d_wt_1?parseFloat(s.d_wt_1):null,d_wt_2:s.d_wt_2?parseFloat(s.d_wt_2):null,purity_fraction_used:s.purity_fraction_used?Q(s.purity_fraction_used):null,d_rate_1:s.d_rate_1?parseFloat(s.d_rate_1):null,pointer_diamond:s.pointer_diamond?parseFloat(s.pointer_diamond):null,d_value:s.d_value?parseFloat(s.d_value):null,mkg:s.mkg?parseFloat(s.mkg):null,carat:s.carat?parseFloat(s.carat):null,carat_weight:s.carat_weight?parseFloat(s.carat_weight):null,per_carat_price:s.per_carat_price?parseFloat(s.per_carat_price):null,gold_per_gram_price:s.gold_per_gram_price?parseFloat(s.gold_per_gram_price):null,certification_cost:s.certification_cost?parseFloat(s.certification_cost):null,gemstone_cost:s.gemstone_cost?parseFloat(s.gemstone_cost):null,cost_price:parseFloat(s.cost_price),retail_price:parseFloat(s.retail_price),total_usd:s.total_usd?parseFloat(s.total_usd):null,stock_quantity:parseInt(s.stock_quantity),color_shade_amount:s.color_shade_amount||null,image_url:s.image_url||null,image_url_2:s.image_url_2||null,image_url_3:s.image_url_3||null,delivery_type:s.delivery_type,dispatches_in_days:s.dispatches_in_days?parseInt(s.dispatches_in_days):null}]);if(m)throw m;try{await y("product_added",{product_name:s.name})}catch(N){console.error("Failed to award points:",N)}P.success("Product added successfully!"),r("/")}catch(d){P.error(d.message||"Failed to add product")}finally{x(!1)}},_=n=>{o({...s,[n.target.name]:n.target.value})},R=async(n,d)=>{if(n){if(!n.type.startsWith("image/")){P.error("Please upload an image file");return}if(n.size>5*1024*1024){P.error("Image size should be less than 5MB");return}f(m=>({...m,[d]:!0}));try{const{data:{user:m}}=await k.auth.getUser();if(!m)throw new Error("Not authenticated");const N=n.name.split(".").pop(),w=`${m.id}/${Date.now()}-${Math.random().toString(36).substring(7)}.${N}`,{data:G,error:I}=await k.storage.from("product-images").upload(w,n,{cacheControl:"3600",upsert:!1});if(I)throw I;const{data:{publicUrl:E}}=k.storage.from("product-images").getPublicUrl(G.path);o(A=>({...A,[d]:E})),P.success("Image uploaded successfully!")}catch(m){console.error("Upload error:",m),P.error(m.message||"Failed to upload image")}finally{f(m=>({...m,[d]:!1}))}}},S=n=>{o(d=>({...d,[n]:""}))};return c?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."}):e.jsx(xe,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-muted/20 py-8",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[e.jsxs(z,{variant:"ghost",onClick:()=>r("/"),className:"mb-6",children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Back to Catalog"]}),e.jsxs(ye,{className:"shadow-xl",children:[e.jsxs(je,{className:"border-b border-border/50",children:[e.jsx(ve,{className:"text-3xl font-serif bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"Add New Product"}),e.jsx("p",{className:"text-muted-foreground text-sm mt-2",children:"Select a category and fill in the product details"})]}),e.jsxs(fe,{className:"pt-6",children:[b.length>0&&e.jsxs(Je,{variant:"destructive",className:"mb-6",children:[e.jsx(Re,{className:"h-4 w-4"}),e.jsxs(ze,{children:[e.jsx("div",{className:"font-semibold mb-2",children:"Please fix the following errors:"}),e.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm",children:b.map((n,d)=>e.jsx("li",{children:n},d))})]})]}),e.jsx("div",{className:"mb-6",children:e.jsx($e,{})}),l.length>1&&e.jsxs("div",{className:"mb-8 pb-6 border-b border-border/30",children:[e.jsx(a,{className:"text-base font-semibold mb-4 block",children:"Select Product Category *"}),e.jsx("div",{className:"flex gap-3 flex-wrap",children:l.map(n=>{const d=s.product_type===n,m=n.toLowerCase().replace(/\s+/g,"-"),N={jewellery:{gradient:"from-category-jewellery/20 to-category-jewellery/5",border:"border-category-jewellery/40",text:"text-category-jewellery",glow:"shadow-[0_0_20px_hsl(var(--category-jewellery)/0.3)]",icon:"ðŸ’"},gemstones:{gradient:"from-category-gemstone/20 to-category-gemstone/5",border:"border-category-gemstone/40",text:"text-category-gemstone",glow:"shadow-[0_0_20px_hsl(var(--category-gemstone)/0.3)]",icon:"ðŸ’Ž"},"loose-gemstones":{gradient:"from-category-gemstone/20 to-category-gemstone/5",border:"border-category-gemstone/40",text:"text-category-gemstone",glow:"shadow-[0_0_20px_hsl(var(--category-gemstone)/0.3)]",icon:"ðŸ’Ž"},"loose-diamonds":{gradient:"from-category-diamond/20 to-category-diamond/5",border:"border-category-diamond/40",text:"text-category-diamond",glow:"shadow-[0_0_20px_hsl(var(--category-diamond)/0.3)]",icon:"âœ¨"}},w=N[m]||N.jewellery;return e.jsxs("button",{type:"button",onClick:()=>o({...s,product_type:n}),className:`
                            group relative overflow-hidden px-6 py-3 rounded-xl
                            font-serif text-base font-semibold transition-all duration-300 ease-out
                            ${d?`bg-gradient-to-br ${w.gradient} border-2 ${w.border} ${w.glow} scale-105`:"bg-card/50 border-2 border-border/30 hover:border-border/60 hover:scale-102"}
                          `,children:[e.jsx("div",{className:`
                            absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent
                            -translate-x-full group-hover:translate-x-full transition-transform duration-1000 ease-out
                          `}),e.jsxs("span",{className:`
                            relative flex items-center gap-2
                            ${d?w.text:"text-muted-foreground group-hover:text-foreground"}
                            transition-colors duration-300
                          `,children:[e.jsx("span",{className:"text-xl",children:w.icon}),e.jsx("span",{className:"tracking-wide",children:n})]}),d&&e.jsx("div",{className:`
                              absolute bottom-0 left-1/2 -translate-x-1/2 h-1 w-3/4 rounded-full
                              bg-gradient-to-r ${w.gradient} animate-pulse
                            `})]},n)})})]}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"}),"Basic Information",e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"name",children:"Product Name *"}),e.jsx(i,{id:"name",name:"name",value:s.name,onChange:_,required:!0,placeholder:"Gold Diamond Ring"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"description",children:"Description"}),e.jsx(be,{id:"description",name:"description",value:s.description,onChange:_,placeholder:"Beautiful 18k gold ring with diamond...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"sku",children:"SKU"}),e.jsx(i,{id:"sku",name:"sku",value:s.sku,onChange:_,placeholder:"DPS19"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"category",children:"Sub-Category"}),e.jsx(i,{id:"category",name:"category",value:s.category,onChange:_,placeholder:"DIAMOND PANDENT SET"})]})]})]}),s.product_type==="Jewellery"&&e.jsx(is,{formData:s,handleChange:_,setFormData:o}),(s.product_type==="Gemstones"||s.product_type==="Loose Gemstones")&&e.jsx(os,{formData:s,handleChange:_}),s.product_type==="Loose Diamonds"&&e.jsx(ls,{formData:s,handleChange:_}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"}),"Pricing & Stock",e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"cost_price",children:"Cost Price (â‚¹) *"}),e.jsx(i,{id:"cost_price",name:"cost_price",type:"number",step:"0.01",value:s.cost_price,onChange:_,required:!0,placeholder:"75000.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"retail_price",children:"Retail Price (â‚¹) *"}),e.jsx(i,{id:"retail_price",name:"retail_price",type:"number",step:"0.01",value:s.retail_price,onChange:_,required:!0,placeholder:"95000.00"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"stock_quantity",children:"Stock Quantity"}),e.jsx(i,{id:"stock_quantity",name:"stock_quantity",type:"number",value:s.stock_quantity,onChange:_,placeholder:"1"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"}),"Product Images",e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Primary Image *"}),s.image_url?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s.image_url,alt:"Primary product",className:"w-full h-64 object-cover rounded-lg border-2 border-border"}),e.jsx("button",{type:"button",onClick:()=>S("image_url"),className:"absolute top-2 right-2 bg-destructive text-destructive-foreground p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(M,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",id:"image_upload",accept:"image/*",className:"hidden",onChange:n=>{var m;const d=(m=n.target.files)==null?void 0:m[0];d&&R(d,"image_url")},disabled:u.image_url}),e.jsx("label",{htmlFor:"image_upload",className:`
                            flex flex-col items-center justify-center w-full h-64 
                            border-2 border-dashed rounded-lg cursor-pointer
                            bg-muted/50 hover:bg-muted transition-colors
                            ${u.image_url?"opacity-50 cursor-wait":"border-border hover:border-primary"}
                          `,children:u.image_url?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(q,{className:"h-10 w-10 text-primary animate-spin"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Uploading..."})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(O,{className:"h-10 w-10 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Click to upload primary image"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"PNG, JPG up to 5MB"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Image 2"}),s.image_url_2?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s.image_url_2,alt:"Product image 2",className:"w-full h-48 object-cover rounded-lg border-2 border-border"}),e.jsx("button",{type:"button",onClick:()=>S("image_url_2"),className:"absolute top-2 right-2 bg-destructive text-destructive-foreground p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(M,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",id:"image_upload_2",accept:"image/*",className:"hidden",onChange:n=>{var m;const d=(m=n.target.files)==null?void 0:m[0];d&&R(d,"image_url_2")},disabled:u.image_url_2}),e.jsx("label",{htmlFor:"image_upload_2",className:`
                              flex flex-col items-center justify-center w-full h-48 
                              border-2 border-dashed rounded-lg cursor-pointer
                              bg-muted/50 hover:bg-muted transition-colors
                              ${u.image_url_2?"opacity-50 cursor-wait":"border-border hover:border-primary"}
                            `,children:u.image_url_2?e.jsx(q,{className:"h-8 w-8 text-primary animate-spin"}):e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx(O,{className:"h-8 w-8 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Upload image"})]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Image 3"}),s.image_url_3?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s.image_url_3,alt:"Product image 3",className:"w-full h-48 object-cover rounded-lg border-2 border-border"}),e.jsx("button",{type:"button",onClick:()=>S("image_url_3"),className:"absolute top-2 right-2 bg-destructive text-destructive-foreground p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(M,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",id:"image_upload_3",accept:"image/*",className:"hidden",onChange:n=>{var m;const d=(m=n.target.files)==null?void 0:m[0];d&&R(d,"image_url_3")},disabled:u.image_url_3}),e.jsx("label",{htmlFor:"image_upload_3",className:`
                              flex flex-col items-center justify-center w-full h-48 
                              border-2 border-dashed rounded-lg cursor-pointer
                              bg-muted/50 hover:bg-muted transition-colors
                              ${u.image_url_3?"opacity-50 cursor-wait":"border-border hover:border-primary"}
                            `,children:u.image_url_3?e.jsx(q,{className:"h-8 w-8 text-primary animate-spin"}):e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx(O,{className:"h-8 w-8 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Upload image"})]})})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"}),"Delivery",e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(a,{children:"Delivery Type"}),e.jsxs(pe,{value:s.delivery_type,onValueChange:n=>o({...s,delivery_type:n}),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{value:"immediate delivery",id:"immediate"}),e.jsx(a,{htmlFor:"immediate",children:"Immediate Delivery"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{value:"dispatches in",id:"scheduled"}),e.jsx(a,{htmlFor:"scheduled",children:"Scheduled Delivery"})]})]})]}),s.delivery_type==="dispatches in"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"dispatches_in_days",children:"Dispatch in (days)"}),e.jsx(i,{id:"dispatches_in_days",name:"dispatches_in_days",type:"number",value:s.dispatches_in_days,onChange:_,placeholder:"3"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(z,{type:"submit",className:"w-full h-12 text-lg shadow-lg hover:shadow-xl transition-all duration-300",disabled:h,children:h?"Adding Product...":"Add Product"})})]})]})]})]})})})};export{Rs as default};
//# sourceMappingURL=AddProduct-DIRPBCFP.js.map
