{"version":3,"file":"AdminNewsletter-JTMLzQ-T.js","sources":["../../src/pages/AdminNewsletter.tsx"],"sourcesContent":["import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { AdminLayout } from \"@/components/AdminLayout\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { toast } from \"sonner\";\r\nimport { Trash2, Mail, MailOpen } from \"lucide-react\";\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from \"@/components/ui/table\";\r\nimport { AdminLoadingSkeleton } from \"@/components/admin/AdminLoadingSkeleton\";\r\nimport { AdminEmptyState } from \"@/components/admin/AdminEmptyState\";\r\n\r\ninterface Subscriber {\r\n  id: string;\r\n  email: string;\r\n  is_active: boolean;\r\n  subscribed_at: string;\r\n}\r\n\r\nexport default function AdminNewsletter() {\r\n  const queryClient = useQueryClient();\r\n\r\n  const { data: subscribers, isLoading } = useQuery({\r\n    queryKey: [\"admin-newsletter\"],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from(\"newsletter_subscribers\")\r\n        .select(\"*\")\r\n        .order(\"subscribed_at\", { ascending: false });\r\n      if (error) throw error;\r\n      return data as Subscriber[];\r\n    },\r\n  });\r\n\r\n  const toggleActiveMutation = useMutation({\r\n    mutationFn: async ({ id, is_active }: { id: string; is_active: boolean }) => {\r\n      const { error } = await supabase\r\n        .from(\"newsletter_subscribers\")\r\n        .update({ is_active })\r\n        .eq(\"id\", id);\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: [\"admin-newsletter\"] });\r\n      toast.success(\"Subscriber status updated\");\r\n    },\r\n    onError: () => toast.error(\"Failed to update subscriber\"),\r\n  });\r\n\r\n  const deleteMutation = useMutation({\r\n    mutationFn: async (id: string) => {\r\n      const { error } = await supabase\r\n        .from(\"newsletter_subscribers\")\r\n        .delete()\r\n        .eq(\"id\", id);\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: [\"admin-newsletter\"] });\r\n      toast.success(\"Subscriber deleted\");\r\n    },\r\n    onError: () => toast.error(\"Failed to delete subscriber\"),\r\n  });\r\n\r\n  const activeCount = subscribers?.filter((s) => s.is_active).length || 0;\r\n  const totalCount = subscribers?.length || 0;\r\n\r\n  return (\r\n    <AdminLayout>\r\n      <div className=\"p-6 space-y-6 animate-fade-in\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold bg-gradient-to-r from-primary to-primary/60 bg-clip-text text-transparent\">\r\n            Newsletter Subscribers\r\n          </h1>\r\n          <p className=\"text-muted-foreground mt-1\">Manage your email newsletter subscribers</p>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          <Card className=\"bg-gradient-card border-border/50 shadow-md\">\r\n            <CardHeader className=\"pb-3\">\r\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">\r\n                Total Subscribers\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-3xl font-bold\">{totalCount}</div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card className=\"bg-gradient-success border-border/50 shadow-md\">\r\n            <CardHeader className=\"pb-3\">\r\n              <CardTitle className=\"text-sm font-medium text-success-foreground\">\r\n                Active Subscribers\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-3xl font-bold text-success\">{activeCount}</div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card className=\"bg-gradient-card border-border/50 shadow-md\">\r\n            <CardHeader className=\"pb-3\">\r\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">\r\n                Inactive Subscribers\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-3xl font-bold\">{totalCount - activeCount}</div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        {isLoading ? (\r\n          <AdminLoadingSkeleton />\r\n        ) : !subscribers || subscribers.length === 0 ? (\r\n          <AdminEmptyState\r\n            icon={MailOpen}\r\n            title=\"No subscribers yet\"\r\n            description=\"Email subscribers will appear here when visitors sign up for your newsletter\"\r\n          />\r\n        ) : (\r\n          <Card className=\"bg-gradient-card border-border/50 shadow-md\">\r\n            <CardContent className=\"p-0\">\r\n              <div className=\"overflow-x-auto\">\r\n                <Table>\r\n                  <TableHeader>\r\n                    <TableRow className=\"border-border/50 hover:bg-transparent\">\r\n                      <TableHead className=\"font-semibold\">Email</TableHead>\r\n                      <TableHead className=\"font-semibold\">Status</TableHead>\r\n                      <TableHead className=\"font-semibold\">Subscribed</TableHead>\r\n                      <TableHead className=\"text-right font-semibold\">Actions</TableHead>\r\n                    </TableRow>\r\n                  </TableHeader>\r\n                  <TableBody>\r\n                    {subscribers.map((subscriber) => (\r\n                      <TableRow\r\n                        key={subscriber.id}\r\n                        className=\"border-border/50 hover:bg-muted/30 transition-colors\"\r\n                      >\r\n                        <TableCell className=\"font-medium\">\r\n                          {subscriber.email}\r\n                        </TableCell>\r\n                        <TableCell>\r\n                          {subscriber.is_active ? (\r\n                            <Badge className=\"bg-success text-success-foreground\">Active</Badge>\r\n                          ) : (\r\n                            <Badge variant=\"outline\">Inactive</Badge>\r\n                          )}\r\n                        </TableCell>\r\n                        <TableCell className=\"text-muted-foreground\">\r\n                          {new Date(subscriber.subscribed_at).toLocaleDateString()}\r\n                        </TableCell>\r\n                        <TableCell className=\"text-right\">\r\n                          <div className=\"flex justify-end gap-2\">\r\n                            <Button\r\n                              size=\"sm\"\r\n                              variant=\"outline\"\r\n                              onClick={() =>\r\n                                toggleActiveMutation.mutate({\r\n                                  id: subscriber.id,\r\n                                  is_active: !subscriber.is_active,\r\n                                })\r\n                              }\r\n                              className=\"hover:bg-primary/10 hover:border-primary transition-colors\"\r\n                            >\r\n                              <Mail className=\"h-4 w-4\" />\r\n                            </Button>\r\n                            <Button\r\n                              size=\"sm\"\r\n                              variant=\"destructive\"\r\n                              onClick={() => deleteMutation.mutate(subscriber.id)}\r\n                            >\r\n                              <Trash2 className=\"h-4 w-4\" />\r\n                            </Button>\r\n                          </div>\r\n                        </TableCell>\r\n                      </TableRow>\r\n                    ))}\r\n                  </TableBody>\r\n                </Table>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        )}\r\n      </div>\r\n    </AdminLayout>\r\n  );\r\n}\r\n"],"names":["AdminNewsletter","queryClient","useQueryClient","subscribers","isLoading","useQuery","data","error","supabase","toggleActiveMutation","useMutation","id","is_active","toast","deleteMutation","activeCount","totalCount","jsx","AdminLayout","jsxs","Card","CardHeader","CardTitle","CardContent","AdminLoadingSkeleton","AdminEmptyState","MailOpen","Table","TableHeader","TableRow","TableHead","TableBody","subscriber","TableCell","Badge","Button","Mail","Trash2"],"mappings":"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"}