import{j as e}from"./query-vendor-CIvqgC9B.js";import{r as n,h as qe}from"./react-vendor-BCzWReGx.js";import{B as j,l as q,k as F,A as De,C as Ie,t as Te,o as Fe}from"./index-DBHw7ps1.js";import{B as $e}from"./badge-HmGNQ04n.js";import{D as $,a as P,b as O,c as R,d as L,e as U,f as ge}from"./dialog-acGhLkoK.js";import{I as v}from"./input-CpEp8mrX.js";import{L as h}from"./label-Di_dI0OZ.js";import{T as A}from"./textarea-Bx7WjwE9.js";import{H as Pe,u as b,ag as fe,p as Oe,o as ce,N as Re,ah as Le,aa as Ee,i as Ue,Y as Ae,K as Be,ai as je,C as Me,E as G,V as Ve,aj as We,Z as ze,a2 as Ye}from"./ui-vendor-B3Ur81tx.js";import{p as Ge,c as He,a as Je}from"./validations-Dq2g6qv0.js";import{C as Qe}from"./CatalogFilters-CR-GjX2q.js";import{z as I}from"./index-ibl8YJur.js";import{S as Ke,a as Ze}from"./ShareStats-Bdz68xmz.js";import{W as Xe}from"./WhatsAppButton-B0ESRJlY.js";import{W as es}from"./WishlistButton-BDS7o-3u.js";import{A as be,a as ye}from"./alert-D-6GOIHR.js";import{O as ss}from"./OptimizedImage-CZRxPWyo.js";import{S as me,a as de,b as ue,c as he,d as pe}from"./select-B1aOqld7.js";import"./supabase-vendor-DJknrin8.js";import"./index-BswhvY0M.js";import"./index-vsC2Ycwh.js";import"./useKeyboardHeight-BG0IWOn_.js";import"./index-BdQq_4o_.js";import"./index-lgWsV-kP.js";import"./index-D6hZrTqZ.js";const as=({productId:x,productName:l,shareLinkId:y})=>{const[f,N]=n.useState(!1),[a,d]=n.useState(!1),[c,u]=n.useState({name:"",email:"",phone:"",notes:""}),m=async t=>{t.preventDefault();const o=Ge.safeParse(c);if(!o.success){const w=o.error.issues[0];b.error(w.message);return}d(!0);try{const{error:w}=await q.from("product_interests").insert({product_id:x,share_link_id:y,customer_name:o.data.name,customer_email:o.data.email,customer_phone:o.data.phone||null,notes:o.data.notes||null});if(w)throw w;b.success("Interest recorded! The seller will contact you soon.",{description:"We've notified the seller about your interest.",duration:5e3}),N(!1),u({name:"",email:"",phone:"",notes:""})}catch(w){w.code==="23505"?b.error("You've already shown interest in this item"):b.error("Failed to record interest. Please try again.")}finally{d(!1)}};return e.jsxs($,{open:f,onOpenChange:N,children:[e.jsx(P,{asChild:!0,children:e.jsxs(j,{variant:"default",className:"flex-1 bg-gradient-to-r from-pink-500 to-rose-500 hover:from-pink-600 hover:to-rose-600 shadow-md",children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"I'm Interested"]})}),e.jsx(O,{className:"sm:max-w-md",children:e.jsxs("form",{onSubmit:m,children:[e.jsxs(R,{children:[e.jsx(L,{className:"text-xl",children:"Express Your Interest"}),e.jsxs(U,{className:"text-base",children:["Interested in ",e.jsx("span",{className:"font-semibold text-foreground",children:l}),"? Share your details and the seller will contact you soon."]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"name",className:"text-sm font-medium",children:"Name *"}),e.jsx(v,{id:"name",value:c.name,onChange:t=>u({...c,name:t.target.value}),placeholder:"Your full name",className:"h-11",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"email",className:"text-sm font-medium",children:"Email *"}),e.jsx(v,{id:"email",type:"email",value:c.email,onChange:t=>u({...c,email:t.target.value}),placeholder:"your@email.com",className:"h-11",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"phone",className:"text-sm font-medium",children:"Phone (Optional)"}),e.jsx(v,{id:"phone",type:"tel",value:c.phone,onChange:t=>u({...c,phone:t.target.value}),placeholder:"+1 (555) 000-0000",className:"h-11"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"notes",className:"text-sm font-medium",children:"Additional Notes (Optional)"}),e.jsx(A,{id:"notes",value:c.notes,onChange:t=>u({...c,notes:t.target.value}),placeholder:"Any specific requirements or questions...",rows:3,className:"resize-none"})]})]}),e.jsxs(ge,{className:"gap-2 sm:gap-0",children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>N(!1),disabled:a,children:"Cancel"}),e.jsx(j,{type:"submit",disabled:a,className:"bg-gradient-to-r from-pink-500 to-rose-500 hover:from-pink-600 hover:to-rose-600",children:a?"Submitting...":"Submit Interest"})]})]})})]})},rs=({shareLinkId:x})=>{const[l,y]=n.useState(!1),[f,N]=n.useState(!1),[a,d]=n.useState({name:"",email:"",phone:"",message:""}),c=async u=>{u.preventDefault();const m=He.safeParse(a);if(!m.success){const t=m.error.issues[0];b.error(t.message);return}N(!0);try{const{error:t}=await q.from("catalog_inquiries").insert({share_link_id:x,customer_name:m.data.name,customer_email:m.data.email,customer_phone:m.data.phone||null,message:m.data.message});if(t)throw t;b.success("Your message has been sent! The owner will contact you soon."),y(!1),d({name:"",email:"",phone:"",message:""})}catch{b.error("Failed to send message. Please try again.")}finally{N(!1)}};return e.jsxs($,{open:l,onOpenChange:y,children:[e.jsx(P,{asChild:!0,children:e.jsxs(j,{className:"w-full",children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Contact Owner"]})}),e.jsx(O,{className:"sm:max-w-md",children:e.jsxs("form",{onSubmit:c,children:[e.jsxs(R,{children:[e.jsx(L,{children:"Contact Catalog Owner"}),e.jsx(U,{children:"Send a message to the catalog owner and they'll get back to you soon."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"contact-name",children:"Name *"}),e.jsx(v,{id:"contact-name",value:a.name,onChange:u=>d({...a,name:u.target.value}),placeholder:"Your full name",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"contact-email",children:"Email *"}),e.jsx(v,{id:"contact-email",type:"email",value:a.email,onChange:u=>d({...a,email:u.target.value}),placeholder:"your@email.com",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"contact-phone",children:"Phone (Optional)"}),e.jsx(v,{id:"contact-phone",type:"tel",value:a.phone,onChange:u=>d({...a,phone:u.target.value}),placeholder:"+1 (555) 000-0000"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"contact-message",children:"Message *"}),e.jsx(A,{id:"contact-message",value:a.message,onChange:u=>d({...a,message:u.target.value}),placeholder:"Tell us what you're looking for or any questions you have...",rows:4,required:!0})]})]}),e.jsxs(ge,{children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>y(!1),disabled:f,children:"Cancel"}),e.jsx(j,{type:"submit",disabled:f,children:f?"Sending...":"Send Message"})]})]})})]})},ts=I.object({customer_name:I.string().min(2,"Name must be at least 2 characters"),customer_email:I.string().email("Invalid email address"),customer_phone:I.string().optional(),quantity:I.number().min(1,"Quantity must be at least 1"),message:I.string().optional()}),is=({productId:x,productName:l,shareLinkId:y})=>{const[f,N]=n.useState(!1),[a,d]=n.useState({customer_name:"",customer_email:"",customer_phone:"",quantity:1,message:""}),[c,u]=n.useState(!1),m=async t=>{t.preventDefault(),u(!0);try{const o=ts.parse({...a,customer_phone:a.customer_phone||void 0,message:a.message||void 0}),{data:w,error:i}=await q.from("purchase_inquiries").insert([{product_id:x,share_link_id:y,customer_name:o.customer_name,customer_email:o.customer_email,customer_phone:o.customer_phone,quantity:o.quantity,message:o.message}]).select();if(i)throw i;if(w&&w[0])try{await q.functions.invoke("notify-purchase-inquiry",{body:{inquiry_id:w[0].id}})}catch(_){console.error("Failed to send notification email:",_)}b.success("Purchase inquiry submitted successfully!",{description:"The vendor will contact you soon."}),N(!1),d({customer_name:"",customer_email:"",customer_phone:"",quantity:1,message:""})}catch(o){o instanceof I.ZodError?b.error(o.errors[0].message):(console.error("Error submitting purchase inquiry:",o),b.error("Failed to submit inquiry. Please try again."))}finally{u(!1)}};return e.jsxs($,{open:f,onOpenChange:N,children:[e.jsx(P,{asChild:!0,children:e.jsxs(j,{className:"w-full",size:"sm",children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),"Buy Now"]})}),e.jsxs(O,{className:"sm:max-w-md",children:[e.jsx(R,{children:e.jsxs(L,{children:["Purchase Inquiry - ",l]})}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"name",children:"Name *"}),e.jsx(v,{id:"name",value:a.customer_name,onChange:t=>d({...a,customer_name:t.target.value}),placeholder:"Your full name",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"email",children:"Email *"}),e.jsx(v,{id:"email",type:"email",value:a.customer_email,onChange:t=>d({...a,customer_email:t.target.value}),placeholder:"your.email@example.com",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"phone",children:"Phone"}),e.jsx(v,{id:"phone",type:"tel",value:a.customer_phone,onChange:t=>d({...a,customer_phone:t.target.value}),placeholder:"+1 (555) 000-0000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"quantity",children:"Quantity *"}),e.jsx(v,{id:"quantity",type:"number",min:"1",value:a.quantity,onChange:t=>d({...a,quantity:parseInt(t.target.value)||1}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"message",children:"Additional Message"}),e.jsx(A,{id:"message",value:a.message,onChange:t=>d({...a,message:t.target.value}),placeholder:"Any special requests or questions?",rows:3})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>N(!1),className:"flex-1",children:"Cancel"}),e.jsx(j,{type:"submit",disabled:c,className:"flex-1",children:c?"Submitting...":"Submit Inquiry"})]})]})]})]})},ns=({productName:x,productSku:l,price:y,imageUrl:f,catalogUrl:N,businessName:a})=>{const[d,c]=n.useState(!1),[u,m]=n.useState(!1),t=`Check out this beautiful jewelry piece${a?` from ${a}`:""}!

${x}${l?`
SKU: ${l}`:""}
Price: â‚¹${y.toLocaleString("en-IN")}`,o=N,w=[{name:"WhatsApp",icon:fe,color:"bg-green-500 hover:bg-green-600",textColor:"text-green-700 dark:text-green-400",bgColor:"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950/40 dark:to-emerald-950/30",borderColor:"border-green-200 dark:border-green-800",action:()=>{window.open(`https://wa.me/?text=${encodeURIComponent(`${t}

${o}`)}`,"_blank")}},{name:"SMS",icon:Re,color:"bg-amber-500 hover:bg-amber-600",textColor:"text-amber-700 dark:text-amber-400",bgColor:"bg-amber-50 dark:bg-amber-950/30",borderColor:"border-amber-200 dark:border-amber-800",action:()=>{window.open(`sms:?body=${encodeURIComponent(`${t}

${o}`)}`,"_blank")}},{name:"Facebook",icon:Le,color:"bg-blue-600 hover:bg-blue-700",textColor:"text-blue-700 dark:text-blue-400",bgColor:"bg-blue-50 dark:bg-blue-950/30",borderColor:"border-blue-200 dark:border-blue-800",action:()=>{window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(o)}&quote=${encodeURIComponent(t)}`,"_blank")}},{name:"Twitter",icon:Ee,color:"bg-sky-500 hover:bg-sky-600",textColor:"text-sky-700 dark:text-sky-400",bgColor:"bg-sky-50 dark:bg-sky-950/30",borderColor:"border-sky-200 dark:border-sky-800",action:()=>{window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(t)}&url=${encodeURIComponent(o)}`,"_blank")}},{name:"Email",icon:Ue,color:"bg-purple-500 hover:bg-purple-600",textColor:"text-purple-700 dark:text-purple-400",bgColor:"bg-purple-50 dark:bg-purple-950/30",borderColor:"border-purple-200 dark:border-purple-800",action:()=>{window.location.href=`mailto:?subject=${encodeURIComponent(`${x} - Jewelry`)}&body=${encodeURIComponent(`${t}

${o}`)}`}}],i=async()=>{try{await navigator.clipboard.writeText(`${t}

${o}`),c(!0),b.success("Product details copied!"),setTimeout(()=>c(!1),2e3)}catch{b.error("Failed to copy")}};return e.jsxs($,{open:u,onOpenChange:m,children:[e.jsx(P,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-primary/10 hover:text-primary",children:e.jsx(ce,{className:"h-4 w-4"})})}),e.jsxs(O,{className:"sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs(R,{children:[e.jsxs(L,{className:"flex items-center gap-2 text-xl",children:[e.jsx(F.div,{animate:{rotate:[0,15,-15,0]},transition:{duration:.5,repeat:2},children:e.jsx(ce,{className:"h-6 w-6 text-primary"})}),"Share This Product"]}),e.jsx(U,{className:"text-sm",children:"Share this beautiful piece with friends and family"})]}),e.jsxs("div",{className:"space-y-5 mt-2",children:[e.jsx("div",{className:"bg-gradient-to-br from-muted/50 to-background rounded-xl p-4 border border-border",children:e.jsxs("div",{className:"flex gap-4 items-start",children:[f&&e.jsx("div",{className:"flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden bg-muted",children:e.jsx("img",{src:f,alt:x,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-sm text-foreground truncate mb-1",children:x}),l&&e.jsxs("p",{className:"text-xs text-muted-foreground mb-1",children:["SKU: ",l]}),e.jsxs("p",{className:"text-lg font-bold text-primary",children:["â‚¹",y.toLocaleString("en-IN")]})]})]})}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:w.map((_,z)=>{const Y=_.icon;return e.jsx(F.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:z*.1},children:e.jsxs(j,{onClick:_.action,variant:"outline",className:`w-full h-auto flex-col gap-2 py-4 ${_.bgColor} ${_.borderColor||"border-2"} hover:scale-105 transition-transform`,children:[e.jsx("div",{className:`p-2 rounded-full ${_.color} text-white`,children:e.jsx(Y,{className:"h-5 w-5"})}),e.jsx("span",{className:`text-sm font-medium ${_.textColor}`,children:_.name})]})},_.name)})}),e.jsxs(F.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"pt-4 border-t border-border space-y-3",children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-3",children:"Or copy product details"}),e.jsx("div",{className:"flex gap-2",children:e.jsx(j,{onClick:i,variant:"outline",className:`w-full gap-2 transition-all ${d?"bg-green-50 dark:bg-green-950/30 border-green-500":""}`,children:d?e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-green-600",children:"Copied!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"h-4 w-4"}),"Copy Details & Link"]})})})]}),e.jsx(F.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"bg-gradient-to-r from-primary/10 to-primary/5 border border-primary/20 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["ðŸ’Ž ",e.jsx("span",{className:"font-medium",children:"Tip:"})," Share on WhatsApp to send directly to someone special!"]})})]})]})]})},os=({expiresAt:x})=>{const[l,y]=n.useState(null),[f,N]=n.useState(!1);if(n.useEffect(()=>{const c=()=>{try{const m=new Date(x).getTime(),t=new Date().getTime(),o=m-t;return o>0?{days:Math.floor(o/864e5),hours:Math.floor(o/36e5%24),minutes:Math.floor(o/1e3/60%60),seconds:Math.floor(o/1e3%60)}:(N(!0),null)}catch(m){return console.error("Error parsing expiration date:",m),null}};y(c());const u=setInterval(()=>{y(c())},1e3);return()=>clearInterval(u)},[x]),!l&&f)return e.jsxs(be,{variant:"destructive",className:"border-red-500/50 inline-flex",children:[e.jsx(je,{className:"h-4 w-4"}),e.jsx(ye,{children:"This catalog has expired"})]});if(!l)return null;const a=l.days===0&&l.hours<6,d=l.days>0;return e.jsxs(F.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:`inline-flex items-center gap-3 px-4 py-3 rounded-xl border-2 ${a?"bg-gradient-to-r from-red-500/10 to-orange-500/10 border-red-500/30":"bg-gradient-to-r from-primary/10 to-primary/5 border-primary/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:`h-4 w-4 ${a?"text-red-600 dark:text-red-400":"text-primary"}`}),e.jsx("span",{className:`text-sm font-semibold ${a?"text-red-700 dark:text-red-400":"text-foreground"}`,children:a?"âš¡ Expiring Soon:":"Available for:"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(De,{mode:"wait",children:[d&&e.jsx(W,{value:l.days,label:"d",isUrgent:a},"days"),e.jsx(W,{value:l.hours,label:"h",isUrgent:a},"hours"),e.jsx(W,{value:l.minutes,label:"m",isUrgent:a},"minutes"),a&&e.jsx(W,{value:l.seconds,label:"s",isUrgent:a,animate:!0},"seconds")]})})]})},W=({value:x,label:l,isUrgent:y,animate:f})=>e.jsxs(F.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1,...f&&{scale:[1,1.1,1]}},exit:{scale:.8,opacity:0},transition:{duration:f?1:.2,repeat:f?1/0:0},className:`flex items-center gap-1 px-2 py-1 rounded-lg ${y?"bg-red-500/20 text-red-700 dark:text-red-300":"bg-primary/20 text-primary"}`,children:[e.jsx("span",{className:"text-base font-bold tabular-nums min-w-[1.5ch]",children:String(x).padStart(2,"0")}),e.jsx("span",{className:"text-xs font-medium opacity-80",children:l})]}),xe={category:"",metalType:"",minPrice:"",maxPrice:"",diamondColor:"",diamondClarity:"",searchQuery:"",deliveryType:"",minDiamondWeight:"",maxDiamondWeight:"",minNetWeight:"",maxNetWeight:"",gemstoneType:"",color:"",clarity:"",cut:"",minCarat:"",maxCarat:"",diamondType:"",shape:"",polish:"",symmetry:"",fluorescence:"",lab:""},$s=()=>{const{token:x}=qe(),[l,y]=n.useState([]),[f,N]=n.useState(!0),[a,d]=n.useState(null),[c,u]=n.useState(null),[m,t]=n.useState(null),[o,w]=n.useState(83),[i,_]=n.useState(null),[z,Y]=n.useState(!0),[g,H]=n.useState(xe),[B,J]=n.useState(60),[ve,Q]=n.useState(!1),[K,Z]=n.useState(!1),[Ne,X]=n.useState(!1),[ee,se]=n.useState(!1),[S,k]=n.useState({customer_name:"",customer_email:"",customer_phone:"",metal_type:"",gemstone_preference:"",design_description:"",budget_range:""}),[C,E]=n.useState({customer_name:"",customer_email:"",customer_phone:"",message:""});n.useEffect(()=>{if(!x)return;(async()=>{var ie,ne,oe;const r=decodeURIComponent(x),T=sessionStorage.getItem("usd_rate"),M=sessionStorage.getItem("usd_rate_time"),re=T&&M&&Date.now()-parseInt(M)<36e5,[te,V]=await Promise.allSettled([q.functions.invoke("get-shared-catalog",{body:{shareToken:r}}),re?Promise.resolve(null):fetch("https://api.exchangerate-api.com/v4/latest/USD").then(p=>p.json())]);if(V.status==="fulfilled"&&((ne=(ie=V.value)==null?void 0:ie.rates)!=null&&ne.INR)?(w(V.value.rates.INR),sessionStorage.setItem("usd_rate",V.value.rates.INR.toString()),sessionStorage.setItem("usd_rate_time",Date.now().toString())):re&&T&&w(parseFloat(T)),te.status==="fulfilled"){const{data:p,error:le}=te.value;le?d(le.message||"Failed to load catalog"):p!=null&&p.error?d(p.error):(y((p==null?void 0:p.products)||[]),u((p==null?void 0:p.shareLinkId)||null),t((p==null?void 0:p.shareLink)||null),_((p==null?void 0:p.vendorProfile)||null),Y(((oe=p==null?void 0:p.shareLink)==null?void 0:oe.show_vendor_details)??!0))}else d("Failed to load catalog");N(!1)})()},[x]),n.useEffect(()=>{J(60)},[g]);const we=async s=>{s.preventDefault();const r=Je.safeParse(S);if(!r.success){b.error(r.error.issues[0].message);return}Z(!0);const{error:T}=await q.from("custom_orders").insert({customer_name:r.data.customer_name,customer_email:r.data.customer_email,customer_phone:r.data.customer_phone||null,metal_type:r.data.metal_type||null,gemstone_preference:r.data.gemstone_preference||null,design_description:r.data.design_description,budget_range:r.data.budget_range||null,share_link_id:c});if(Z(!1),T){b.error("Failed to submit your request. Please try again.");return}b.success("Your custom order request has been submitted!"),Q(!1),k({customer_name:"",customer_email:"",customer_phone:"",metal_type:"",gemstone_preference:"",design_description:"",budget_range:""})},_e=async s=>{if(s.preventDefault(),!C.customer_name||!C.customer_email||!C.message){b.error("Please fill in all required fields");return}se(!0);const{error:r}=await q.from("video_requests").insert({customer_name:C.customer_name,customer_email:C.customer_email,customer_phone:C.customer_phone||null,requested_products:C.message,share_link_id:c});if(se(!1),r){b.error("Failed to submit your video request. Please try again.");return}b.success("Your video request has been submitted!"),X(!1),E({customer_name:"",customer_email:"",customer_phone:"",message:""})},D=n.useMemo(()=>l.filter(s=>{if(g.searchQuery){const r=g.searchQuery.toLowerCase();if(![s.name,s.description,s.sku].filter(Boolean).some(M=>M.toLowerCase().includes(r)))return!1}return!(g.category&&s.category!==g.category||g.metalType&&s.metal_type!==g.metalType||g.minPrice&&s.retail_price<parseFloat(g.minPrice)||g.maxPrice&&s.retail_price>parseFloat(g.maxPrice)||g.diamondColor&&s.diamond_color!==g.diamondColor||g.diamondClarity&&s.clarity!==g.diamondClarity||g.deliveryType&&s.delivery_type!==g.deliveryType)}),[l,g]);if(f)return e.jsx("div",{className:"min-h-screen bg-background p-4",children:e.jsxs("div",{className:"container mx-auto",children:[e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsx("div",{className:"h-12 w-48 bg-muted animate-pulse rounded-lg"}),e.jsx("div",{className:"h-6 w-64 bg-muted animate-pulse rounded"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-8 w-24 bg-muted animate-pulse rounded-full"}),e.jsx("div",{className:"h-8 w-24 bg-muted animate-pulse rounded-full"})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[...Array(8)].map((s,r)=>e.jsxs("div",{className:"rounded-lg border bg-card overflow-hidden",children:[e.jsx("div",{className:"aspect-square bg-muted animate-pulse"}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("div",{className:"h-4 w-3/4 bg-muted animate-pulse rounded"}),e.jsx("div",{className:"h-5 w-1/2 bg-muted animate-pulse rounded"})]})]},r))})]})});if(a)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs(be,{variant:"destructive",className:"max-w-md",children:[e.jsx(je,{className:"h-4 w-4"}),e.jsx(ye,{children:a})]})});const Ce=m&&new Date(m.expires_at).getTime()-Date.now()<24*60*60*1e3&&new Date(m.expires_at).getTime()>Date.now(),Se=m&&new Date(m.expires_at).getTime()<=Date.now(),ae=typeof window<"u"?`${window.location.origin}/shared/${encodeURIComponent(x||"")}`:"",ke=s=>{c&&q.functions.invoke("track-product-view",{body:{shareLinkId:c,productId:s}}).catch(r=>console.error("Failed to track view:",r))};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background via-muted/5 to-background relative",children:[e.jsx("div",{className:"fixed inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-primary/5 via-transparent to-transparent pointer-events-none"}),e.jsx("header",{className:"border-b border-border/50 bg-gradient-to-b from-card via-card/95 to-card/90 backdrop-blur-xl shadow-2xl relative z-10",children:e.jsxs("div",{className:"container mx-auto px-3 sm:px-4 lg:px-6 py-3 sm:py-4 md:py-6",children:[m&&!Se&&e.jsxs("div",{className:"mb-4 sm:mb-5 flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3 justify-between pb-3 sm:pb-5 border-b border-border/30 bg-gradient-to-r from-primary/5 via-accent/5 to-primary/5 -mx-3 sm:-mx-4 lg:-mx-6 px-3 sm:px-4 lg:px-6 py-3 sm:py-4 rounded-xl",children:[e.jsx(Ke,{viewCount:m.view_count,isExpiringSoon:Ce,showTrending:!0}),e.jsx(os,{expiresAt:m.expires_at})]}),z&&i&&e.jsx("div",{className:"mb-4 sm:mb-5 pb-3 sm:pb-5 border-b border-border/30",children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/20 to-accent/20 blur-xl rounded-full"}),e.jsx(G,{className:"relative h-6 w-6 sm:h-10 sm:w-10 text-primary flex-shrink-0"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-lg sm:text-2xl md:text-3xl font-serif font-bold text-foreground leading-tight mb-2",children:i.business_name||"Jewelry Catalog"}),i.address_line1&&e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground mb-2",children:[i.address_line1,i.city&&`, ${i.city}, ${i.state} ${i.pincode}`]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.email&&e.jsxs("a",{href:`mailto:${i.email}`,className:"text-xs text-primary hover:underline",children:["âœ‰ï¸ ",i.email]}),i.phone&&e.jsxs("a",{href:`tel:${i.phone}`,className:"text-xs px-3 py-1.5 bg-primary/10 border border-primary/30 rounded-full",children:["ðŸ“ž ",i.phone]}),i.whatsapp_number&&e.jsx("a",{href:`https://wa.me/${i.whatsapp_number.replace(/\D/g,"")}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs px-3 py-1.5 bg-emerald-500/20 border border-emerald-500/40 rounded-full text-emerald-600 dark:text-emerald-400",children:"ðŸ’¬ WhatsApp"})]})]})]})}),e.jsx("div",{className:"mb-3",children:e.jsx(Qe,{filters:g,onFilterChange:H,productType:"Jewellery",categories:[...new Set(l.map(s=>s.category).filter(Boolean))],metalTypes:[...new Set(l.map(s=>s.metal_type).filter(Boolean))],diamondColors:[...new Set(l.map(s=>s.diamond_color).filter(Boolean))],diamondClarities:[...new Set(l.map(s=>s.clarity).filter(Boolean))],deliveryTypes:[...new Set(l.map(s=>s.delivery_type).filter(Boolean))],gemstoneTypes:[],colors:[],clarities:[],cuts:[],shapes:[],polishes:[],symmetries:[],fluorescences:[],labs:[]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2 sm:gap-4 pt-3 border-t border-border/30",children:[e.jsx("div",{className:"bg-gradient-to-r from-primary/10 to-accent/10 border border-primary/30 px-4 py-2 rounded-xl",children:e.jsxs("span",{className:"text-xs font-bold",children:["1 USD = ",e.jsxs("span",{className:"text-primary text-lg",children:["â‚¹",o.toFixed(2)]})]})}),c&&e.jsxs("div",{className:"flex gap-1.5 sm:gap-2",children:[e.jsx(Ze,{url:ae,title:(i==null?void 0:i.business_name)||"Jewelry Catalog",description:"Check out this amazing jewelry collection!",className:"flex-1 sm:flex-none"}),e.jsxs($,{open:Ne,onOpenChange:X,children:[e.jsx(P,{asChild:!0,children:e.jsxs(j,{variant:"outline",size:"sm",className:"flex-1 sm:flex-none min-h-[44px] text-xs",children:[e.jsx(Ve,{className:"h-4 w-4 mr-1.5"}),"Video"]})}),e.jsxs(O,{className:"w-[95vw] max-w-lg",children:[e.jsxs(R,{children:[e.jsx(L,{children:"Request Product Video"}),e.jsx(U,{className:"text-sm",children:"Request a video of specific products"})]}),e.jsxs("form",{onSubmit:_e,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Your Name *"}),e.jsx(v,{value:C.customer_name,onChange:s=>E(r=>({...r,customer_name:s.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Email *"}),e.jsx(v,{type:"email",value:C.customer_email,onChange:s=>E(r=>({...r,customer_email:s.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Phone (Optional)"}),e.jsx(v,{type:"tel",value:C.customer_phone,onChange:s=>E(r=>({...r,customer_phone:s.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"What would you like to see? *"}),e.jsx(A,{value:C.message,onChange:s=>E(r=>({...r,message:s.target.value})),rows:4,required:!0})]}),e.jsx(j,{type:"submit",className:"w-full",disabled:ee,children:ee?"Submitting...":"Submit Request"})]})]})]}),e.jsxs($,{open:ve,onOpenChange:Q,children:[e.jsx(P,{asChild:!0,children:e.jsxs(j,{size:"sm",className:"flex-1 sm:flex-none min-h-[44px] text-xs",children:[e.jsx(We,{className:"h-4 w-4 mr-1.5"}),"Custom"]})}),e.jsxs(O,{className:"w-[95vw] max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(R,{children:[e.jsx(L,{children:"Build Your Custom Jewelry"}),e.jsx(U,{className:"text-sm",children:"Tell us about your dream piece"})]}),e.jsxs("form",{onSubmit:we,className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Your Name *"}),e.jsx(v,{value:S.customer_name,onChange:s=>k(r=>({...r,customer_name:s.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Email *"}),e.jsx(v,{type:"email",value:S.customer_email,onChange:s=>k(r=>({...r,customer_email:s.target.value})),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Phone (Optional)"}),e.jsx(v,{type:"tel",value:S.customer_phone,onChange:s=>k(r=>({...r,customer_phone:s.target.value}))})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Preferred Metal"}),e.jsxs(me,{value:S.metal_type,onValueChange:s=>k(r=>({...r,metal_type:s})),children:[e.jsx(de,{children:e.jsx(ue,{placeholder:"Select metal"})}),e.jsx(he,{children:["Gold","White Gold","Rose Gold","Platinum","Silver"].map(s=>e.jsx(pe,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Gemstone"}),e.jsx(v,{value:S.gemstone_preference,onChange:s=>k(r=>({...r,gemstone_preference:s.target.value})),placeholder:"Diamond, Sapphire..."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Budget Range"}),e.jsxs(me,{value:S.budget_range,onValueChange:s=>k(r=>({...r,budget_range:s})),children:[e.jsx(de,{children:e.jsx(ue,{placeholder:"Select budget"})}),e.jsx(he,{children:["Under â‚¹50,000","â‚¹50,000 - â‚¹1,00,000","â‚¹1,00,000 - â‚¹2,50,000","â‚¹2,50,000 - â‚¹5,00,000","Above â‚¹5,00,000"].map(s=>e.jsx(pe,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Design Description *"}),e.jsx(A,{value:S.design_description,onChange:s=>k(r=>({...r,design_description:s.target.value})),rows:4,required:!0,placeholder:"Describe your ideal piece..."})]}),e.jsx(j,{type:"submit",className:"w-full",disabled:K,children:K?"Submitting...":"Submit Custom Order"})]})]})]}),e.jsx(rs,{shareLinkId:c})]})]})]})}),e.jsx("main",{className:"container mx-auto px-3 sm:px-4 lg:px-6 py-6 sm:py-8 md:py-12 relative z-10",children:D.length===0&&l.length>0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(G,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No products match your filters"}),e.jsx(j,{variant:"outline",onClick:()=>H(xe),children:"Clear All Filters"})]}):D.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(G,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4 opacity-50"}),e.jsx("h2",{className:"text-xl font-serif font-bold mb-2",children:"No Products Available"}),e.jsx("p",{className:"text-muted-foreground",children:"This catalog is currently empty"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 sm:gap-4 lg:gap-6",children:D.slice(0,B).map(s=>e.jsxs(Ie,{className:"group overflow-hidden hover:shadow-2xl hover:shadow-primary/10 transition-all duration-500 border-border/50 hover:border-primary/40 bg-gradient-to-b from-card to-card/95 cursor-pointer hover:-translate-y-1",onClick:()=>ke(s.id),children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 via-transparent to-accent/5 opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"}),s.image_url&&e.jsxs("div",{className:"aspect-square overflow-hidden bg-muted/30 relative",children:[e.jsx(ss,{src:s.image_url,alt:s.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700",width:400,height:400}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity z-10",children:[e.jsx("div",{className:"bg-background/90 backdrop-blur-sm rounded-full shadow-lg",children:e.jsx(es,{productId:s.id,shareLinkId:c})}),e.jsx("div",{className:"bg-background/90 backdrop-blur-sm rounded-full shadow-lg",children:e.jsx(ns,{productName:s.name,productSku:s.sku,price:s.displayed_price,imageUrl:s.image_url,catalogUrl:ae,businessName:i==null?void 0:i.business_name})})]})]}),e.jsxs(Te,{className:"pb-2 p-3 sm:p-4",children:[e.jsx("h3",{className:"font-serif text-sm sm:text-base font-bold text-foreground group-hover:text-primary line-clamp-2 transition-colors",children:s.name}),s.sku&&e.jsxs("p",{className:"text-[10px] text-muted-foreground font-mono mt-1",children:["SKU: ",s.sku]})]}),e.jsxs(Fe,{className:"pb-3 p-3 sm:p-4 pt-0",children:[s.description&&e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mb-2 line-clamp-2",children:s.description}),e.jsxs("div",{className:"space-y-0.5 text-[10px] sm:text-xs",children:[s.category&&e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Category:"})," ",e.jsx("span",{className:"font-medium",children:s.category})]}),s.metal_type&&e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Metal:"})," ",e.jsx("span",{className:"font-medium",children:s.metal_type})]}),s.weight_grams&&e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Weight:"})," ",e.jsxs("span",{className:"font-medium",children:[s.weight_grams,"g"]})]})]}),s.delivery_type&&e.jsx("div",{className:"mt-2",children:e.jsx($e,{variant:s.delivery_type==="immediate"?"default":"secondary",className:"text-[9px]",children:s.delivery_type==="immediate"?e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"h-2.5 w-2.5 mr-0.5"}),"Ready"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ye,{className:"h-2.5 w-2.5 mr-0.5"}),s.dispatches_in_days||7,"d"]})})}),e.jsx("div",{className:"mt-3 pt-2 border-t border-border/30",children:e.jsxs("div",{className:"flex items-baseline gap-1.5",children:[e.jsxs("span",{className:"text-sm sm:text-lg font-bold text-primary",children:["â‚¹",(s.displayed_price||s.retail_price||0).toLocaleString("en-IN")]}),e.jsxs("span",{className:"text-[9px] sm:text-xs text-muted-foreground",children:["($",((s.displayed_price||s.retail_price||0)/o).toFixed(0),")"]})]})}),e.jsxs("div",{className:"mt-3 flex gap-1.5",onClick:r=>r.stopPropagation(),children:[e.jsx(as,{productId:s.id,productName:s.name,shareLinkId:c||""}),e.jsx(is,{productId:s.id,productName:s.name,shareLinkId:c||""})]})]})]},s.id))}),D.length>B&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs(j,{variant:"outline",size:"lg",onClick:()=>J(s=>s+60),children:["Load More (",D.length-B," remaining)"]})}),e.jsxs("div",{className:"mt-6 text-center text-sm text-muted-foreground",children:["Showing ",Math.min(B,D.length)," of ",D.length," products"]})]})}),(i==null?void 0:i.whatsapp_number)&&e.jsx(Xe,{whatsappNumber:i.whatsapp_number,message:"Hi! I'm interested in your jewelry catalog.",businessName:i==null?void 0:i.business_name})]})};export{$s as default};
//# sourceMappingURL=SharedCatalog-DU0tCx-3.js.map
