{"version":3,"file":"InvoiceGenerator-MC0IBb3W.js","sources":["../../src/pages/InvoiceGenerator.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { toast } from \"sonner\";\r\nimport { FileText, Calendar, Plus, History, Download, Sparkles } from \"lucide-react\";\r\nimport { generateInvoicePDF } from \"@/utils/invoiceGenerator\";\r\nimport { BackToHomeButton } from \"@/components/BackToHomeButton\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\r\nimport { Calendar as CalendarPicker } from \"@/components/ui/calendar\";\r\nimport { format } from \"date-fns\";\r\n\r\nconst InvoiceGenerator = () => {\r\n  const navigate = useNavigate();\r\n  const [searchParams] = useSearchParams();\r\n  const [user, setUser] = useState<any>(null);\r\n  const [vendorProfile, setVendorProfile] = useState<any>(null);\r\n  const [estimates, setEstimates] = useState<any[]>([]);\r\n  const [showEstimateDialog, setShowEstimateDialog] = useState(false);\r\n  \r\n  // Invoice fields\r\n  const [invoicePrefix, setInvoicePrefix] = useState(\"INV\");\r\n  const [invoiceNumber, setInvoiceNumber] = useState(\"\");\r\n  const [invoiceDate, setInvoiceDate] = useState<Date>(new Date());\r\n  const [paymentTerms, setPaymentTerms] = useState(\"Net 30\");\r\n  const [paymentDueDate, setPaymentDueDate] = useState<Date>();\r\n  const [invoiceNotes, setInvoiceNotes] = useState(\"\");\r\n  const [invoiceTemplate, setInvoiceTemplate] = useState<'detailed' | 'summary' | 'minimal' | 'traditional' | 'modern' | 'luxury'>('detailed');\r\n  const [estimateName, setEstimateName] = useState(\"\");\r\n  \r\n  // Customer details\r\n  const [customerName, setCustomerName] = useState(\"\");\r\n  const [customerPhone, setCustomerPhone] = useState(\"\");\r\n  const [customerEmail, setCustomerEmail] = useState(\"\");\r\n  const [customerAddress, setCustomerAddress] = useState(\"\");\r\n  \r\n  // Cost breakdown\r\n  const [netWeight, setNetWeight] = useState(0);\r\n  const [grossWeight, setGrossWeight] = useState(0);\r\n  const [purityFraction, setPurityFraction] = useState(0.76);\r\n  const [goldRate24k, setGoldRate24k] = useState(0);\r\n  const [makingCharges, setMakingCharges] = useState(0);\r\n  const [cadDesignCharges, setCadDesignCharges] = useState(0);\r\n  const [cammingCharges, setCammingCharges] = useState(0);\r\n  const [certificationCost, setCertificationCost] = useState(0);\r\n  const [diamondCost, setDiamondCost] = useState(0);\r\n  const [gemstoneCost, setGemstoneCost] = useState(0);\r\n  const [goldCost, setGoldCost] = useState(0);\r\n  const [totalCost, setTotalCost] = useState(0);\r\n  const [profitMargin, setProfitMargin] = useState(0);\r\n  const [finalSellingPrice, setFinalSellingPrice] = useState(0);\r\n\r\n  useEffect(() => {\r\n    checkAuth();\r\n  }, []);\r\n\r\n  const checkAuth = async () => {\r\n    const { data: { user } } = await supabase.auth.getUser();\r\n    if (!user) {\r\n      toast.error(\"Please sign in to generate invoices\");\r\n      navigate(\"/auth\");\r\n      return;\r\n    }\r\n    setUser(user);\r\n    await fetchVendorProfile();\r\n    await fetchEstimates();\r\n    \r\n    // Check if we should auto-load an estimate\r\n    const estimateId = searchParams.get('estimate');\r\n    if (estimateId) {\r\n      await loadEstimateById(estimateId);\r\n    }\r\n  };\r\n\r\n  const fetchVendorProfile = async () => {\r\n    const { data: { user } } = await supabase.auth.getUser();\r\n    if (!user) return;\r\n\r\n    const { data, error } = await supabase\r\n      .from('vendor_profiles')\r\n      .select('*')\r\n      .eq('user_id', user.id)\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error('Error fetching vendor profile:', error);\r\n    } else {\r\n      setVendorProfile(data);\r\n    }\r\n  };\r\n\r\n  const fetchEstimates = async () => {\r\n    const { data: { user } } = await supabase.auth.getUser();\r\n    if (!user) return;\r\n\r\n    const { data, error } = await supabase\r\n      .from('manufacturing_cost_estimates')\r\n      .select('*')\r\n      .eq('user_id', user.id)\r\n      .order('created_at', { ascending: false });\r\n\r\n    if (error) {\r\n      console.error('Error fetching estimates:', error);\r\n    } else {\r\n      setEstimates(data || []);\r\n    }\r\n  };\r\n\r\n  const generateNextInvoiceNumber = async () => {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) return;\r\n\r\n      const { data, error } = await supabase\r\n        .from(\"manufacturing_cost_estimates\")\r\n        .select(\"invoice_number\")\r\n        .eq(\"user_id\", user.id)\r\n        .not(\"invoice_number\", \"is\", null)\r\n        .order(\"created_at\", { ascending: false })\r\n        .limit(1);\r\n\r\n      if (error) throw error;\r\n\r\n      const currentYear = new Date().getFullYear();\r\n      let nextNumber = 1;\r\n\r\n      if (data && data.length > 0) {\r\n        const lastInvoice = data[0].invoice_number;\r\n        const match = lastInvoice.match(/(\\d+)$/);\r\n        if (match) {\r\n          nextNumber = parseInt(match[1]) + 1;\r\n        }\r\n      }\r\n\r\n      const newInvoiceNumber = `${invoicePrefix}-${currentYear}-${String(nextNumber).padStart(3, '0')}`;\r\n      setInvoiceNumber(newInvoiceNumber);\r\n      return newInvoiceNumber;\r\n    } catch (error) {\r\n      console.error(\"Error generating invoice number:\", error);\r\n      return `${invoicePrefix}-${new Date().getFullYear()}-001`;\r\n    }\r\n  };\r\n\r\n  const loadEstimateById = async (estimateId: string) => {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('manufacturing_cost_estimates')\r\n        .select('*')\r\n        .eq('id', estimateId)\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      if (data) {\r\n        loadFromEstimate(data);\r\n        await generateNextInvoiceNumber();\r\n        toast.success(\"Estimate loaded and ready to convert to invoice\");\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading estimate:', error);\r\n      toast.error('Failed to load estimate');\r\n    }\r\n  };\r\n\r\n  const loadFromEstimate = (estimate: any) => {\r\n    setEstimateName(estimate.estimate_name);\r\n    setCustomerName(estimate.customer_name || \"\");\r\n    setCustomerPhone(estimate.customer_phone || \"\");\r\n    setCustomerEmail(estimate.customer_email || \"\");\r\n    setCustomerAddress(estimate.customer_address || \"\");\r\n    setNetWeight(estimate.net_weight || 0);\r\n    setGrossWeight(estimate.details?.gross_weight || estimate.net_weight || 0);\r\n    setPurityFraction(estimate.purity_fraction || 0.76);\r\n    setGoldRate24k(estimate.gold_rate_24k || 0);\r\n    setMakingCharges(estimate.making_charges || 0);\r\n    setCadDesignCharges(estimate.cad_design_charges || 0);\r\n    setCammingCharges(estimate.camming_charges || 0);\r\n    setCertificationCost(estimate.certification_cost || 0);\r\n    setDiamondCost(estimate.diamond_cost || 0);\r\n    setGemstoneCost(estimate.gemstone_cost || 0);\r\n    setGoldCost(estimate.gold_cost || 0);\r\n    setTotalCost(estimate.total_cost || 0);\r\n    setProfitMargin(estimate.profit_margin_percentage || 0);\r\n    setFinalSellingPrice(estimate.final_selling_price || 0);\r\n    \r\n    if (estimate.invoice_number) {\r\n      setInvoiceNumber(estimate.invoice_number);\r\n    }\r\n    \r\n    setShowEstimateDialog(false);\r\n  };\r\n\r\n  const loadJewelryTemplate = () => {\r\n    if (!vendorProfile) {\r\n      toast.error(\"Please complete your vendor profile first\");\r\n      return;\r\n    }\r\n\r\n    // Auto-populate from vendor profile\r\n    setGoldRate24k(vendorProfile.gold_rate_24k_per_gram || 0);\r\n    setMakingCharges(vendorProfile.making_charges_per_gram || 0);\r\n    \r\n    // Generate next invoice number automatically\r\n    generateNextInvoiceNumber();\r\n    \r\n    toast.success(\"Jewelry template loaded with your profile data\");\r\n  };\r\n\r\n  const loadSampleData = async () => {\r\n    setEstimateName(\"Diamond Engagement Ring Order\");\r\n    setCustomerName(\"Priya Sharma\");\r\n    setCustomerPhone(\"+91 98765 43210\");\r\n    setCustomerEmail(\"priya.sharma@example.com\");\r\n    setCustomerAddress(\"123 MG Road, Bangalore, Karnataka 560001, India\");\r\n    \r\n    setNetWeight(8.5);\r\n    setGrossWeight(10.2);\r\n    setPurityFraction(0.76);\r\n    setGoldRate24k(6500);\r\n    setMakingCharges(15300);\r\n    setCadDesignCharges(5000);\r\n    setCammingCharges(2000);\r\n    setCertificationCost(3000);\r\n    setDiamondCost(125000);\r\n    setGemstoneCost(8000);\r\n    \r\n    const goldCostCalc = 8.5 * 0.76 * 6500;\r\n    setGoldCost(goldCostCalc);\r\n    \r\n    const totalCostCalc = goldCostCalc + 15300 + 5000 + 2000 + 3000 + 125000 + 8000;\r\n    setTotalCost(totalCostCalc);\r\n    \r\n    setProfitMargin(20);\r\n    const sellingPriceCalc = totalCostCalc * 1.2;\r\n    setFinalSellingPrice(sellingPriceCalc);\r\n    \r\n    setInvoiceNotes(\"Payment accepted via bank transfer or UPI. 50% advance required before production. Remaining 50% due upon completion.\");\r\n    setPaymentTerms(\"Net 30\");\r\n    \r\n    const dueDate = new Date();\r\n    dueDate.setDate(dueDate.getDate() + 30);\r\n    setPaymentDueDate(dueDate);\r\n    \r\n    await generateNextInvoiceNumber();\r\n    \r\n    toast.success(\"Sample data loaded successfully!\");\r\n  };\r\n\r\n  const handleGenerateInvoice = async () => {\r\n    if (!estimateName) {\r\n      toast.error(\"Please enter an estimate/order name\");\r\n      return;\r\n    }\r\n\r\n    if (!customerName) {\r\n      toast.error(\"Please enter customer name\");\r\n      return;\r\n    }\r\n\r\n    let finalInvoiceNumber = invoiceNumber;\r\n    if (!finalInvoiceNumber) {\r\n      finalInvoiceNumber = await generateNextInvoiceNumber() || \"\";\r\n    }\r\n\r\n    const addressParts = [\r\n      vendorProfile?.address_line1,\r\n      vendorProfile?.address_line2,\r\n      vendorProfile?.city,\r\n      vendorProfile?.state,\r\n      vendorProfile?.pincode,\r\n      vendorProfile?.country,\r\n    ].filter(Boolean);\r\n    const vendorAddress = addressParts.length > 0 ? addressParts.join(', ') : undefined;\r\n\r\n    generateInvoicePDF({\r\n      invoiceNumber: finalInvoiceNumber,\r\n      invoiceDate: invoiceDate.toISOString(),\r\n      paymentDueDate: paymentDueDate?.toISOString(),\r\n      paymentTerms,\r\n      estimateName,\r\n      status: \"draft\",\r\n      customerName,\r\n      customerPhone,\r\n      customerEmail,\r\n      customerAddress,\r\n      netWeight,\r\n      grossWeight,\r\n      purityFraction,\r\n      goldRate24k,\r\n      makingCharges,\r\n      cadDesignCharges,\r\n      cammingCharges,\r\n      certificationCost,\r\n      diamondCost,\r\n      gemstoneCost,\r\n      goldCost,\r\n      totalCost,\r\n      profitMargin,\r\n      finalSellingPrice,\r\n      invoiceNotes,\r\n      template: invoiceTemplate,\r\n      vendorBranding: vendorProfile ? {\r\n        name: vendorProfile.business_name,\r\n        logo: vendorProfile.logo_url,\r\n        primaryColor: vendorProfile.primary_brand_color,\r\n        secondaryColor: vendorProfile.secondary_brand_color,\r\n        tagline: vendorProfile.brand_tagline,\r\n        email: vendorProfile.email,\r\n        phone: vendorProfile.phone,\r\n        address: vendorAddress,\r\n      } : undefined,\r\n    });\r\n\r\n    // Save to database or update existing estimate\r\n    try {\r\n      const estimateId = searchParams.get('estimate');\r\n      \r\n      if (estimateId) {\r\n        // Update existing estimate to mark it as having an invoice generated\r\n        const { error } = await supabase\r\n          .from('manufacturing_cost_estimates')\r\n          .update({\r\n            invoice_number: finalInvoiceNumber,\r\n            invoice_date: invoiceDate.toISOString(),\r\n            payment_terms: paymentTerms,\r\n            payment_due_date: paymentDueDate?.toISOString(),\r\n            invoice_notes: invoiceNotes,\r\n            is_invoice_generated: true,\r\n            invoice_status: \"pending\",\r\n          })\r\n          .eq('id', estimateId);\r\n\r\n        if (error) throw error;\r\n      } else {\r\n        // Create new invoice record\r\n        const { error } = await supabase\r\n          .from('manufacturing_cost_estimates')\r\n          .insert({\r\n            user_id: user.id,\r\n            estimate_name: estimateName,\r\n            invoice_number: finalInvoiceNumber,\r\n            invoice_date: invoiceDate.toISOString(),\r\n            payment_terms: paymentTerms,\r\n            payment_due_date: paymentDueDate?.toISOString(),\r\n            invoice_notes: invoiceNotes,\r\n            is_invoice_generated: true,\r\n            invoice_status: \"pending\",\r\n            customer_name: customerName,\r\n            customer_phone: customerPhone,\r\n            customer_email: customerEmail,\r\n            customer_address: customerAddress,\r\n            net_weight: netWeight,\r\n            purity_fraction: purityFraction,\r\n            gold_rate_24k: goldRate24k,\r\n            making_charges: makingCharges,\r\n            cad_design_charges: cadDesignCharges,\r\n            camming_charges: cammingCharges,\r\n            certification_cost: certificationCost,\r\n            diamond_cost: diamondCost,\r\n            gemstone_cost: gemstoneCost,\r\n            gold_cost: goldCost,\r\n            total_cost: totalCost,\r\n            profit_margin_percentage: profitMargin,\r\n            final_selling_price: finalSellingPrice,\r\n            status: 'draft',\r\n          });\r\n\r\n        if (error) throw error;\r\n      }\r\n      \r\n      toast.success(\"Invoice generated and saved successfully\");\r\n    } catch (error: any) {\r\n      console.error(\"Error saving invoice:\", error);\r\n      toast.error(\"Invoice generated but failed to save to database\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-background via-background to-muted/20 p-4 md:p-8\">\r\n      <div className=\"max-w-5xl mx-auto space-y-6\">\r\n        <BackToHomeButton />\r\n\r\n        <div className=\"text-center space-y-4\">\r\n          <div className=\"flex items-center justify-center gap-3\">\r\n            <FileText className=\"h-10 w-10 text-primary\" />\r\n            <h1 className=\"text-4xl md:text-5xl font-bold bg-gradient-to-r from-primary via-accent to-primary bg-clip-text text-transparent\">\r\n              Invoice Generator\r\n            </h1>\r\n          </div>\r\n          <p className=\"text-muted-foreground text-lg max-w-2xl mx-auto\">\r\n            Create professional invoices with your branding\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"flex flex-wrap gap-3 justify-center\">\r\n          <Button onClick={loadJewelryTemplate} variant=\"default\" className=\"bg-gradient-to-r from-primary to-accent\">\r\n            <Sparkles className=\"mr-2 h-4 w-4\" />\r\n            Use Jewelry Template\r\n          </Button>\r\n          <Button onClick={loadSampleData} variant=\"outline\">\r\n            <Download className=\"mr-2 h-4 w-4\" />\r\n            Load Sample Data\r\n          </Button>\r\n          <Button onClick={() => setShowEstimateDialog(true)} variant=\"outline\">\r\n            <Plus className=\"mr-2 h-4 w-4\" />\r\n            Load from Estimate\r\n          </Button>\r\n          <Button onClick={generateNextInvoiceNumber} variant=\"outline\">\r\n            <FileText className=\"mr-2 h-4 w-4\" />\r\n            Auto-Generate Invoice #\r\n          </Button>\r\n          <Button onClick={() => navigate(\"/invoice-history\")} variant=\"outline\">\r\n            <History className=\"mr-2 h-4 w-4\" />\r\n            View History\r\n          </Button>\r\n          <Button onClick={() => navigate(\"/invoice-templates\")} variant=\"outline\">\r\n            <FileText className=\"mr-2 h-4 w-4\" />\r\n            Manage Templates\r\n          </Button>\r\n        </div>\r\n\r\n        <div className=\"grid gap-6 md:grid-cols-2\">\r\n          {/* Invoice Details */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Invoice Details</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div>\r\n                  <Label>Invoice Prefix</Label>\r\n                  <Input\r\n                    value={invoicePrefix}\r\n                    onChange={(e) => setInvoicePrefix(e.target.value.toUpperCase())}\r\n                    placeholder=\"INV\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label>Invoice Number</Label>\r\n                  <Input\r\n                    value={invoiceNumber}\r\n                    onChange={(e) => setInvoiceNumber(e.target.value)}\r\n                    placeholder=\"Auto-generated\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <Label>Order/Estimate Name *</Label>\r\n                <Input\r\n                  value={estimateName}\r\n                  onChange={(e) => setEstimateName(e.target.value)}\r\n                  placeholder=\"e.g., Diamond Ring Order\"\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <Label>Invoice Date</Label>\r\n                <Popover>\r\n                  <PopoverTrigger asChild>\r\n                    <Button variant=\"outline\" className=\"w-full justify-start\">\r\n                      <Calendar className=\"mr-2 h-4 w-4\" />\r\n                      {format(invoiceDate, \"PPP\")}\r\n                    </Button>\r\n                  </PopoverTrigger>\r\n                  <PopoverContent className=\"w-auto p-0\">\r\n                    <CalendarPicker\r\n                      mode=\"single\"\r\n                      selected={invoiceDate}\r\n                      onSelect={(date) => date && setInvoiceDate(date)}\r\n                    />\r\n                  </PopoverContent>\r\n                </Popover>\r\n              </div>\r\n\r\n              <div>\r\n                <Label>Payment Terms</Label>\r\n                <Select value={paymentTerms} onValueChange={setPaymentTerms}>\r\n                  <SelectTrigger>\r\n                    <SelectValue />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"Due on Receipt\">Due on Receipt</SelectItem>\r\n                    <SelectItem value=\"Net 15\">Net 15</SelectItem>\r\n                    <SelectItem value=\"Net 30\">Net 30</SelectItem>\r\n                    <SelectItem value=\"Net 45\">Net 45</SelectItem>\r\n                    <SelectItem value=\"Net 60\">Net 60</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              <div>\r\n                <Label>Payment Due Date</Label>\r\n                <Popover>\r\n                  <PopoverTrigger asChild>\r\n                    <Button variant=\"outline\" className=\"w-full justify-start\">\r\n                      <Calendar className=\"mr-2 h-4 w-4\" />\r\n                      {paymentDueDate ? format(paymentDueDate, \"PPP\") : \"Select date\"}\r\n                    </Button>\r\n                  </PopoverTrigger>\r\n                  <PopoverContent className=\"w-auto p-0\">\r\n                    <CalendarPicker\r\n                      mode=\"single\"\r\n                      selected={paymentDueDate}\r\n                      onSelect={setPaymentDueDate}\r\n                    />\r\n                  </PopoverContent>\r\n                </Popover>\r\n              </div>\r\n\r\n              <div>\r\n                <Label>Invoice Template</Label>\r\n                <Select value={invoiceTemplate} onValueChange={(value: any) => setInvoiceTemplate(value)}>\r\n                  <SelectTrigger>\r\n                    <SelectValue />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"detailed\">Detailed - Comprehensive Breakdown</SelectItem>\r\n                    <SelectItem value=\"summary\">Summary - Quick Overview</SelectItem>\r\n                    <SelectItem value=\"minimal\">Minimal - Essential Only</SelectItem>\r\n                    <SelectItem value=\"traditional\">Traditional - Classic Serif Style</SelectItem>\r\n                    <SelectItem value=\"modern\">Modern - Clean Minimalist</SelectItem>\r\n                    <SelectItem value=\"luxury\">Luxury - Premium Elegant</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              <div>\r\n                <Label>Invoice Notes</Label>\r\n                <Textarea\r\n                  value={invoiceNotes}\r\n                  onChange={(e) => setInvoiceNotes(e.target.value)}\r\n                  placeholder=\"Payment instructions...\"\r\n                  rows={3}\r\n                />\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Customer Details */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Customer Information</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <div>\r\n                <Label>Customer Name *</Label>\r\n                <Input\r\n                  value={customerName}\r\n                  onChange={(e) => setCustomerName(e.target.value)}\r\n                  placeholder=\"Full name\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <Label>Phone Number</Label>\r\n                <Input\r\n                  value={customerPhone}\r\n                  onChange={(e) => setCustomerPhone(e.target.value)}\r\n                  placeholder=\"+1234567890\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <Label>Email</Label>\r\n                <Input\r\n                  type=\"email\"\r\n                  value={customerEmail}\r\n                  onChange={(e) => setCustomerEmail(e.target.value)}\r\n                  placeholder=\"customer@example.com\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <Label>Address</Label>\r\n                <Textarea\r\n                  value={customerAddress}\r\n                  onChange={(e) => setCustomerAddress(e.target.value)}\r\n                  placeholder=\"Complete address\"\r\n                  rows={3}\r\n                />\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Cost Breakdown */}\r\n          <Card className=\"md:col-span-2\">\r\n            <CardHeader>\r\n              <CardTitle>Cost Breakdown</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\r\n                <div>\r\n                  <Label>Gold Cost (₹)</Label>\r\n                  <Input\r\n                    type=\"number\"\r\n                    value={goldCost}\r\n                    onChange={(e) => setGoldCost(Number(e.target.value))}\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label>Making Charges (₹)</Label>\r\n                  <Input\r\n                    type=\"number\"\r\n                    value={makingCharges}\r\n                    onChange={(e) => setMakingCharges(Number(e.target.value))}\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label>Diamond Cost (₹)</Label>\r\n                  <Input\r\n                    type=\"number\"\r\n                    value={diamondCost}\r\n                    onChange={(e) => setDiamondCost(Number(e.target.value))}\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label>Gemstone Cost (₹)</Label>\r\n                  <Input\r\n                    type=\"number\"\r\n                    value={gemstoneCost}\r\n                    onChange={(e) => setGemstoneCost(Number(e.target.value))}\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label>CAD Design (₹)</Label>\r\n                  <Input\r\n                    type=\"number\"\r\n                    value={cadDesignCharges}\r\n                    onChange={(e) => setCadDesignCharges(Number(e.target.value))}\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label>Certification (₹)</Label>\r\n                  <Input\r\n                    type=\"number\"\r\n                    value={certificationCost}\r\n                    onChange={(e) => setCertificationCost(Number(e.target.value))}\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label>Total Amount (₹)</Label>\r\n                  <Input\r\n                    type=\"number\"\r\n                    value={finalSellingPrice}\r\n                    onChange={(e) => setFinalSellingPrice(Number(e.target.value))}\r\n                    className=\"font-bold\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        <div className=\"flex justify-center gap-4\">\r\n          <Button onClick={handleGenerateInvoice} size=\"lg\">\r\n            <Download className=\"mr-2 h-5 w-5\" />\r\n            Generate Invoice PDF\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Load Estimate Dialog */}\r\n        <Dialog open={showEstimateDialog} onOpenChange={setShowEstimateDialog}>\r\n          <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-y-auto\">\r\n            <DialogHeader>\r\n              <DialogTitle>Load from Saved Estimate</DialogTitle>\r\n              <DialogDescription>\r\n                Select an estimate to pre-fill invoice details\r\n              </DialogDescription>\r\n            </DialogHeader>\r\n            <div className=\"space-y-2\">\r\n              {estimates.length === 0 ? (\r\n                <p className=\"text-center text-muted-foreground py-8\">\r\n                  No saved estimates found\r\n                </p>\r\n              ) : (\r\n                estimates.map((estimate) => (\r\n                  <Card\r\n                    key={estimate.id}\r\n                    className=\"cursor-pointer hover:border-primary transition-colors\"\r\n                    onClick={() => loadFromEstimate(estimate)}\r\n                  >\r\n                    <CardContent className=\"p-4\">\r\n                      <div className=\"flex justify-between items-start\">\r\n                        <div>\r\n                          <h3 className=\"font-semibold\">{estimate.estimate_name}</h3>\r\n                          <p className=\"text-sm text-muted-foreground\">\r\n                            {estimate.customer_name || \"No customer\"}\r\n                          </p>\r\n                          <p className=\"text-sm font-semibold text-primary mt-1\">\r\n                            ₹{estimate.final_selling_price?.toFixed(2)}\r\n                          </p>\r\n                        </div>\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                          {new Date(estimate.created_at).toLocaleDateString()}\r\n                        </p>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                ))\r\n              )}\r\n            </div>\r\n          </DialogContent>\r\n        </Dialog>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InvoiceGenerator;\r\n"],"names":["InvoiceGenerator","navigate","useNavigate","searchParams","useSearchParams","user","setUser","useState","vendorProfile","setVendorProfile","estimates","setEstimates","showEstimateDialog","setShowEstimateDialog","invoicePrefix","setInvoicePrefix","invoiceNumber","setInvoiceNumber","invoiceDate","setInvoiceDate","paymentTerms","setPaymentTerms","paymentDueDate","setPaymentDueDate","invoiceNotes","setInvoiceNotes","invoiceTemplate","setInvoiceTemplate","estimateName","setEstimateName","customerName","setCustomerName","customerPhone","setCustomerPhone","customerEmail","setCustomerEmail","customerAddress","setCustomerAddress","netWeight","setNetWeight","grossWeight","setGrossWeight","purityFraction","setPurityFraction","goldRate24k","setGoldRate24k","makingCharges","setMakingCharges","cadDesignCharges","setCadDesignCharges","cammingCharges","setCammingCharges","certificationCost","setCertificationCost","diamondCost","setDiamondCost","gemstoneCost","setGemstoneCost","goldCost","setGoldCost","totalCost","setTotalCost","profitMargin","setProfitMargin","finalSellingPrice","setFinalSellingPrice","useEffect","checkAuth","supabase","toast","fetchVendorProfile","fetchEstimates","estimateId","loadEstimateById","data","error","generateNextInvoiceNumber","currentYear","nextNumber","match","newInvoiceNumber","loadFromEstimate","estimate","_a","loadJewelryTemplate","loadSampleData","goldCostCalc","totalCostCalc","sellingPriceCalc","dueDate","handleGenerateInvoice","finalInvoiceNumber","addressParts","vendorAddress","generateInvoicePDF","jsxs","jsx","BackToHomeButton","FileText","Button","Sparkles","Download","Plus","History","Card","CardHeader","CardTitle","CardContent","Label","Input","e","Popover","PopoverTrigger","Calendar","format","PopoverContent","CalendarPicker","date","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","value","Textarea","Dialog","DialogContent","DialogHeader","DialogTitle","DialogDescription"],"mappings":"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"}