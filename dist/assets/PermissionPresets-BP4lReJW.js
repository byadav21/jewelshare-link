import{j as e}from"./query-vendor-BLxHmmGk.js";import{u as F,r as l}from"./react-vendor-BeR0k5Z3.js";import{F as u,al as I,aj as L,B as n,C as M,G as A,H as E,I as O,D as V}from"./index-DGlTgSKx.js";import{D as H,b as q,c as z,d as B,e as R,f as U}from"./dialog-CRWggOUB.js";import{I as o}from"./input-CEHl5GoJ.js";import{L as i}from"./label-ClRcubO_.js";import{T as G}from"./textarea-DU5hu0UG.js";import{S as J}from"./switch-CO0K2nGH.js";import{T as K,a as X,b,c as x,d as Y,e as p}from"./table-BDYxPG4d.js";import{u as c,J as Q,ak as w,aX as W,aK as Z,ay as $}from"./ui-vendor-CN4tOqpp.js";import"./supabase-vendor-VSDMYZ1k.js";import"./index-CVwUD2ep.js";import"./index-aqCwQlp3.js";import"./index-DjQc2W_p.js";function xe(){const C=F(),[v,y]=l.useState([]),[T,k]=l.useState(!0),[D,d]=l.useState(!1),[_,f]=l.useState(null),[a,t]=l.useState({name:"",description:"",can_add_products:!0,can_view_catalog:!0,can_edit_products:!0,can_delete_products:!0,can_share_catalog:!0,can_view_share_links:!0,can_manage_share_links:!0,can_view_interests:!0,can_add_vendor_details:!0,can_edit_profile:!0,can_view_custom_orders:!0,can_manage_custom_orders:!1,can_import_data:!0,can_manage_team:!1,can_view_sessions:!0,can_manage_sessions:!0,max_products:100,max_share_links:1,max_team_members:0,max_product_images:3,max_active_sessions:1});l.useEffect(()=>{h()},[]);const h=async()=>{try{const{data:s,error:r}=await u.from("permission_templates").select("*").order("created_at",{ascending:!1});if(r)throw r;y(s||[])}catch(s){c.error("Failed to load templates"),console.error(s)}finally{k(!1)}},g=s=>{s?(f(s),t({name:s.name,description:s.description||"",...s.template_config})):(f(null),t({name:"",description:"",can_add_products:!0,can_view_catalog:!0,can_edit_products:!0,can_delete_products:!0,can_share_catalog:!0,can_view_share_links:!0,can_manage_share_links:!0,can_view_interests:!0,can_add_vendor_details:!0,can_edit_profile:!0,can_view_custom_orders:!0,can_manage_custom_orders:!1,can_import_data:!0,can_manage_team:!1,can_view_sessions:!0,can_manage_sessions:!0,max_products:100,max_share_links:1,max_team_members:0,max_product_images:3,max_active_sessions:1})),d(!0)},P=async()=>{if(!a.name.trim()){c.error("Template name is required");return}try{const{name:s,description:r,...j}=a,N={name:s.trim(),description:r.trim()||null,template_config:j};if(_){const{error:m}=await u.from("permission_templates").update(N).eq("id",_.id);if(m)throw m;c.success("Template updated successfully")}else{const{error:m}=await u.from("permission_templates").insert([N]);if(m)throw m;c.success("Template created successfully")}d(!1),h()}catch(s){c.error(s.message||"Failed to save template"),console.error(s)}},S=async s=>{if(confirm("Are you sure you want to delete this template?"))try{const{error:r}=await u.from("permission_templates").delete().eq("id",s);if(r)throw r;c.success("Template deleted successfully"),h()}catch(r){c.error("Failed to delete template"),console.error(r)}};return T?e.jsx(I,{}):e.jsx(L,{children:e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"border-b border-border bg-card/50 backdrop-blur-sm sticky top-0 z-10",children:e.jsx("div",{className:"container mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>C("/super-admin"),children:e.jsx(Q,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Permission Presets"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Create and manage reusable permission templates"})]})]}),e.jsxs(n,{onClick:()=>g(),children:[e.jsx(w,{className:"mr-2 h-4 w-4"}),"Create Template"]})]})})}),e.jsx("main",{className:"container mx-auto px-6 py-8",children:e.jsxs(M,{children:[e.jsxs(A,{children:[e.jsx(E,{children:"Permission Templates"}),e.jsx(O,{children:"Saved templates can be applied to vendors in Plan Management"})]}),e.jsx(V,{children:v.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(W,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No permission templates yet"}),e.jsxs(n,{variant:"outline",className:"mt-4",onClick:()=>g(),children:[e.jsx(w,{className:"mr-2 h-4 w-4"}),"Create Your First Template"]})]}):e.jsxs(K,{children:[e.jsx(X,{children:e.jsxs(b,{children:[e.jsx(x,{children:"Template Name"}),e.jsx(x,{children:"Description"}),e.jsx(x,{children:"Limits"}),e.jsx(x,{className:"text-right",children:"Actions"})]})}),e.jsx(Y,{children:v.map(s=>e.jsxs(b,{children:[e.jsx(p,{className:"font-medium",children:s.name}),e.jsx(p,{className:"text-muted-foreground",children:s.description||"No description"}),e.jsx(p,{children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{children:["Products: ",s.template_config.max_products||"Unlimited"]}),e.jsxs("div",{children:["Share Links: ",s.template_config.max_share_links||"Unlimited"]}),e.jsxs("div",{children:["Team: ",s.template_config.max_team_members||"0"]})]})}),e.jsx(p,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>g(s),children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>S(s.id),children:e.jsx($,{className:"h-4 w-4"})})]})})]},s.id))})]})})]})}),e.jsx(H,{open:D,onOpenChange:d,children:e.jsxs(q,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(z,{children:[e.jsx(B,{children:_?"Edit Permission Template":"Create Permission Template"}),e.jsx(R,{children:"Define a reusable set of permissions and limits"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"name",children:"Template Name *"}),e.jsx(o,{id:"name",value:a.name,onChange:s=>t({...a,name:s.target.value}),placeholder:"e.g., Premium Vendor"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"description",children:"Description"}),e.jsx(G,{id:"description",value:a.description,onChange:s=>t({...a,description:s.target.value}),placeholder:"Describe this template...",rows:3})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Resource Limits"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"max_products",children:"Max Products"}),e.jsx(o,{id:"max_products",type:"number",value:a.max_products||"",onChange:s=>t({...a,max_products:parseInt(s.target.value)||null})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"max_share_links",children:"Max Share Links"}),e.jsx(o,{id:"max_share_links",type:"number",value:a.max_share_links||"",onChange:s=>t({...a,max_share_links:parseInt(s.target.value)||null})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"max_team_members",children:"Max Team Members"}),e.jsx(o,{id:"max_team_members",type:"number",value:a.max_team_members||"",onChange:s=>t({...a,max_team_members:parseInt(s.target.value)||null})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"max_product_images",children:"Max Product Images"}),e.jsx(o,{id:"max_product_images",type:"number",value:a.max_product_images||"",onChange:s=>t({...a,max_product_images:parseInt(s.target.value)||null})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"max_active_sessions",children:"Max Active Sessions"}),e.jsx(o,{id:"max_active_sessions",type:"number",value:a.max_active_sessions,onChange:s=>t({...a,max_active_sessions:parseInt(s.target.value)||1})})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Permissions"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries({can_add_products:"Add Products",can_view_catalog:"View Catalog",can_edit_products:"Edit Products",can_delete_products:"Delete Products",can_share_catalog:"Share Catalog",can_view_share_links:"View Share Links",can_manage_share_links:"Manage Share Links",can_view_interests:"View Interests",can_add_vendor_details:"Add Vendor Details",can_edit_profile:"Edit Profile",can_view_custom_orders:"View Custom Orders",can_manage_custom_orders:"Manage Custom Orders",can_import_data:"Import Data",can_manage_team:"Manage Team",can_view_sessions:"View Sessions",can_manage_sessions:"Manage Sessions"}).map(([s,r])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{htmlFor:s,children:r}),e.jsx(J,{id:s,checked:a[s],onCheckedChange:j=>t({...a,[s]:j})})]},s))})]})]}),e.jsxs(U,{children:[e.jsx(n,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(n,{onClick:P,children:_?"Update Template":"Create Template"})]})]})})]})})}export{xe as default};
//# sourceMappingURL=PermissionPresets-BP4lReJW.js.map
