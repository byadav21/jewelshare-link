import{j as e}from"./query-vendor-BLxHmmGk.js";import{r as o}from"./react-vendor-BeR0k5Z3.js";import{h as S,C as j,g as v,B as U,s as b}from"./index-CX6yiz0b.js";import{L as M}from"./label-DbIM3Eg1.js";import{X as G,aa as I}from"./ui-vendor-DjQqXt9S.js";const E=({bucket:a,onUploadComplete:n,currentImage:w})=>{const[c,d]=o.useState(!1),[m,p]=o.useState(w||null),r=o.useRef(null),{toast:t}=S(),y=async l=>{var f;const s=(f=l.target.files)==null?void 0:f[0];if(!s)return;const u=a==="brand-logos"?["image/jpeg","image/png","image/svg+xml","image/webp"]:["image/jpeg","image/png","image/webp","image/gif"];if(!u.includes(s.type)){t({title:"Invalid File Type",description:`Please upload ${u.join(", ")}`,variant:"destructive"});return}const g=a==="brand-logos"?2*1024*1024:5*1024*1024;if(s.size>g){t({title:"File Too Large",description:`Maximum file size is ${g/1024/1024}MB`,variant:"destructive"});return}try{d(!0);const i=s.name.split(".").pop(),P=`${`${Date.now()}-${Math.random().toString(36).substring(7)}.${i}`}`,{data:C,error:h}=await b.storage.from(a).upload(P,s,{cacheControl:"3600",upsert:!1});if(h)throw h;const{data:{publicUrl:x}}=b.storage.from(a).getPublicUrl(C.path);p(x),n(x),t({title:"Upload Successful",description:"Image has been uploaded successfully."})}catch(i){console.error("Upload error:",i),t({title:"Upload Failed",description:"Something went wrong. Please try again.",variant:"destructive"})}finally{d(!1),r.current&&(r.current.value="")}},N=()=>{p(null),n("")};return e.jsxs("div",{className:"space-y-4",children:[e.jsx(M,{children:"Image Upload"}),e.jsx("input",{ref:r,type:"file",accept:"image/*",onChange:y,className:"hidden"}),m?e.jsx(j,{className:"relative overflow-hidden",children:e.jsx(v,{className:"p-4",children:e.jsxs("div",{className:"relative aspect-video w-full overflow-hidden rounded-lg bg-muted",children:[e.jsx("img",{src:m,alt:"Preview",className:"h-full w-full object-cover"}),e.jsx(U,{variant:"destructive",size:"icon",className:"absolute right-2 top-2",onClick:N,children:e.jsx(G,{className:"h-4 w-4"})})]})})}):e.jsx(j,{className:"cursor-pointer border-2 border-dashed transition-colors hover:border-category-jewellery",onClick:()=>{var l;return(l=r.current)==null?void 0:l.click()},children:e.jsxs(v,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"mb-4 rounded-full bg-category-jewellery/10 p-4",children:c?e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-category-jewellery border-t-transparent"}):e.jsx(I,{className:"h-8 w-8 text-category-jewellery"})}),e.jsx("p",{className:"mb-2 text-sm font-medium",children:c?"Uploading...":"Click to upload image"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a==="brand-logos"?"PNG, JPG, SVG or WebP (max 2MB)":"PNG, JPG, WebP or GIF (max 5MB)"})]})})]})};export{E as M};
//# sourceMappingURL=MediaUpload-D_Yhy2BU.js.map
