{"version":3,"file":"invoiceGenerator-BHCm5yW4.js","sources":["../../src/utils/invoiceGenerator.ts"],"sourcesContent":["import jsPDF from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\n\r\nexport interface VendorBranding {\r\n  name?: string;\r\n  logo?: string;\r\n  primaryColor?: string;\r\n  secondaryColor?: string;\r\n  tagline?: string;\r\n  email?: string;\r\n  phone?: string;\r\n  address?: string;\r\n}\r\n\r\nexport type MetalType = 'gold' | 'platinum' | 'silver';\r\n\r\nexport interface LineItem {\r\n  id: string;\r\n  item_name: string;\r\n  description: string;\r\n  image_url: string;\r\n  certificate_image_url?: string;\r\n  metal_type?: MetalType;\r\n  metal_rate?: number;\r\n  diamond_weight: number;\r\n  diamond_per_carat_price: number;\r\n  diamond_color: string;\r\n  diamond_clarity: string;\r\n  diamond_cut: string;\r\n  diamond_certification: string;\r\n  diamond_shape?: string;\r\n  diamond_fluorescence?: string;\r\n  diamond_measurements?: string;\r\n  gemstone_weight: number;\r\n  gemstone_type: string;\r\n  gemstone_color: string;\r\n  gemstone_clarity: string;\r\n  gemstone_origin?: string;\r\n  gemstone_treatment?: string;\r\n  gemstone_shape?: string;\r\n  gemstone_per_carat_price?: number;\r\n  net_weight: number;\r\n  gross_weight: number;\r\n  purity_fraction: number;\r\n  diamond_cost: number;\r\n  gemstone_cost: number;\r\n  metal_cost?: number;\r\n  gold_cost: number;\r\n  making_charges: number;\r\n  certification_cost: number;\r\n  cad_design_charges: number;\r\n  camming_charges: number;\r\n  subtotal: number;\r\n  weight_mode?: 'gross' | 'net';\r\n}\r\n\r\nexport interface InvoiceData {\r\n  invoiceNumber: string;\r\n  invoiceDate: string;\r\n  paymentDueDate?: string;\r\n  paymentTerms?: string;\r\n  estimateName: string;\r\n  status: string;\r\n  invoiceType?: 'tax' | 'export' | 'proforma';\r\n  customerName?: string;\r\n  customerPhone?: string;\r\n  customerEmail?: string;\r\n  customerAddress?: string;\r\n  customerGSTIN?: string;\r\n  vendorGSTIN?: string;\r\n  netWeight: number;\r\n  grossWeight?: number;\r\n  purityFraction: number;\r\n  goldRate24k: number;\r\n  makingCharges: number;\r\n  cadDesignCharges: number;\r\n  cammingCharges: number;\r\n  certificationCost: number;\r\n  diamondCost: number;\r\n  gemstoneCost: number;\r\n  goldCost: number;\r\n  totalCost: number;\r\n  profitMargin: number;\r\n  finalSellingPrice: number;\r\n  gstMode?: 'sgst_cgst' | 'igst';\r\n  sgstPercentage?: number;\r\n  cgstPercentage?: number;\r\n  igstPercentage?: number;\r\n  sgstAmount?: number;\r\n  cgstAmount?: number;\r\n  igstAmount?: number;\r\n  shippingCharges?: number;\r\n  shippingZone?: string;\r\n  exchangeRate?: number;\r\n  grandTotal?: number;\r\n  notes?: string;\r\n  invoiceNotes?: string;\r\n  details?: any;\r\n  vendorBranding?: VendorBranding;\r\n  template?: 'detailed' | 'summary' | 'minimal' | 'traditional' | 'modern' | 'luxury' | 'loose_diamond' | 'gemstone';\r\n  lineItems?: LineItem[];\r\n  estimateCategory?: 'jewelry' | 'loose_diamond' | 'gemstone';\r\n}\r\n\r\ntype InvoiceTemplate = 'detailed' | 'summary' | 'minimal' | 'traditional' | 'modern' | 'luxury' | 'loose_diamond' | 'gemstone';\r\n\r\n// Helper function to get invoice type label\r\nconst getInvoiceTypeLabel = (type?: 'tax' | 'export' | 'proforma'): string => {\r\n  switch (type) {\r\n    case 'export': return 'EXPORT INVOICE';\r\n    case 'proforma': return 'PROFORMA INVOICE';\r\n    default: return 'TAX INVOICE';\r\n  }\r\n};\r\n\r\n// Helper function for consistent currency formatting (PDF-safe)\r\nconst formatCurrency = (amount: number) => {\r\n  const formatted = amount.toLocaleString('en-IN', {\r\n    minimumFractionDigits: 2,\r\n    maximumFractionDigits: 2\r\n  });\r\n  return `Rs. ${formatted}`;\r\n};\r\n\r\n// Helper function to load image as base64 with CORS handling\r\nconst loadImageAsBase64 = async (url: string): Promise<string | null> => {\r\n  return new Promise((resolve) => {\r\n    const img = new Image();\r\n    img.crossOrigin = 'anonymous';\r\n    \r\n    img.onload = () => {\r\n      try {\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = img.width;\r\n        canvas.height = img.height;\r\n        const ctx = canvas.getContext('2d');\r\n        \r\n        if (!ctx) {\r\n          resolve(null);\r\n          return;\r\n        }\r\n        \r\n        ctx.drawImage(img, 0, 0);\r\n        const dataURL = canvas.toDataURL('image/jpeg', 0.95);\r\n        resolve(dataURL);\r\n      } catch (error) {\r\n        console.error('Error converting image to base64:', error);\r\n        resolve(null);\r\n      }\r\n    };\r\n    \r\n    img.onerror = () => {\r\n      console.error('Failed to load image:', url);\r\n      resolve(null);\r\n    };\r\n    \r\n    // Add timestamp to prevent caching issues\r\n    const separator = url.includes('?') ? '&' : '?';\r\n    img.src = `${url}${separator}_t=${Date.now()}`;\r\n    \r\n    // Timeout after 3 seconds\r\n    setTimeout(() => resolve(null), 3000);\r\n  });\r\n};\r\n\r\nexport const generateInvoicePDF = async (data: InvoiceData) => {\r\n  const template = data.template || 'detailed';\r\n  \r\n  // Auto-select loose diamond template if category is loose_diamond\r\n  if (data.estimateCategory === 'loose_diamond' || template === 'loose_diamond') {\r\n    return await generateLooseDiamondInvoice(data);\r\n  }\r\n  \r\n  // Auto-select gemstone template if category is gemstone\r\n  if (data.estimateCategory === 'gemstone' || template === 'gemstone') {\r\n    return await generateGemstoneInvoice(data);\r\n  }\r\n  \r\n  switch (template) {\r\n    case 'summary':\r\n      return await generateSummaryInvoice(data);\r\n    case 'minimal':\r\n      return await generateMinimalInvoice(data);\r\n    case 'traditional':\r\n      return await generateTraditionalInvoice(data);\r\n    case 'modern':\r\n      return await generateModernInvoice(data);\r\n    case 'luxury':\r\n      return await generateLuxuryInvoice(data);\r\n    default:\r\n      return await generateDetailedInvoice(data);\r\n  }\r\n};\r\n\r\nconst generateDetailedInvoice = async (data: InvoiceData) => {\r\n  const doc = new jsPDF();\r\n  const pageWidth = doc.internal.pageSize.getWidth();\r\n  const pageHeight = doc.internal.pageSize.getHeight();\r\n  \r\n  // Parse brand colors or use elegant defaults\r\n  const primaryColor = data.vendorBranding?.primaryColor || '#1e40af';\r\n  const secondaryColor = data.vendorBranding?.secondaryColor || '#6366f1';\r\n  const accentColor = '#f59e0b';\r\n  \r\n  // Convert hex to RGB\r\n  const hexToRgb = (hex: string) => {\r\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n    return result ? {\r\n      r: parseInt(result[1], 16),\r\n      g: parseInt(result[2], 16),\r\n      b: parseInt(result[3], 16)\r\n    } : { r: 30, g: 64, b: 175 };\r\n  };\r\n  \r\n  const primaryRgb = hexToRgb(primaryColor);\r\n  const secondaryRgb = hexToRgb(secondaryColor);\r\n  const accentRgb = hexToRgb(accentColor);\r\n  \r\n  // Modern gradient header with enhanced design\r\n  doc.setFillColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.rect(0, 0, pageWidth, 50, 'F');\r\n  \r\n  // Subtle accent stripe\r\n  doc.setFillColor(accentRgb.r, accentRgb.g, accentRgb.b);\r\n  doc.rect(0, 48, pageWidth, 2, 'F');\r\n  \r\n  // Logo section with professional styling and actual logo embedding\r\n  if (data.vendorBranding?.logo) {\r\n    // Create logo container with shadow effect\r\n    doc.setFillColor(255, 255, 255);\r\n    doc.roundedRect(16, 10, 30, 30, 3, 3, 'F');\r\n    \r\n    // Logo shadow/border\r\n    doc.setDrawColor(230, 230, 235);\r\n    doc.setLineWidth(0.5);\r\n    doc.roundedRect(16, 10, 30, 30, 3, 3, 'S');\r\n    \r\n    try {\r\n      // Load and embed the actual logo\r\n      const logoBase64 = await loadImageAsBase64(data.vendorBranding.logo);\r\n      \r\n      if (logoBase64) {\r\n        // Add the logo image to PDF with proper sizing and centering\r\n        doc.addImage(logoBase64, 'JPEG', 18, 12, 26, 26, undefined, 'FAST');\r\n      } else {\r\n        // Fallback to placeholder text if image loading fails\r\n        doc.setFontSize(7);\r\n        doc.setTextColor(150, 150, 150);\r\n        doc.text('LOGO', 31, 26.5, { align: 'center' });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error processing logo:', error);\r\n      // Fallback: show placeholder\r\n      doc.setFontSize(7);\r\n      doc.setTextColor(150, 150, 150);\r\n      doc.text('LOGO', 31, 26.5, { align: 'center' });\r\n    }\r\n  }\r\n  \r\n  // Business name with enhanced typography\r\n  const nameStartX = data.vendorBranding?.logo ? 52 : pageWidth / 2;\r\n  const nameAlign = data.vendorBranding?.logo ? 'left' : 'center';\r\n  \r\n  doc.setFontSize(22);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(255, 255, 255);\r\n  \r\n  if (data.vendorBranding?.name) {\r\n    doc.text(data.vendorBranding.name.toUpperCase(), nameStartX, 22, { align: nameAlign });\r\n    \r\n    // Tagline with subtle styling\r\n    if (data.vendorBranding?.tagline) {\r\n      doc.setFontSize(9);\r\n      doc.setFont('helvetica', 'italic');\r\n      doc.setTextColor(240, 240, 245);\r\n      doc.text(data.vendorBranding.tagline, nameStartX, 28, { align: nameAlign });\r\n    }\r\n    \r\n    // INVOICE label with type\r\n    const invoiceLabel = getInvoiceTypeLabel(data.invoiceType);\r\n    doc.setFontSize(14);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(255, 255, 255);\r\n    doc.text(invoiceLabel, nameStartX, 36, { align: nameAlign });\r\n  } else {\r\n    const invoiceLabel = getInvoiceTypeLabel(data.invoiceType);\r\n    doc.setFontSize(26);\r\n    doc.text(invoiceLabel, pageWidth / 2, 28, { align: 'center' });\r\n  }\r\n  \r\n  // Reset text color\r\n  doc.setTextColor(50, 50, 50);\r\n  \r\n  // Vendor contact info in professional card format (right side)\r\n  let headerY = 58;\r\n  if (data.vendorBranding?.email || data.vendorBranding?.phone || data.vendorBranding?.address || data.vendorGSTIN) {\r\n    // Contact info card background\r\n    doc.setFillColor(248, 250, 252);\r\n    doc.roundedRect(pageWidth - 80, headerY, 66, 32, 2, 2, 'F');\r\n    doc.setDrawColor(220, 225, 230);\r\n    doc.setLineWidth(0.5);\r\n    doc.roundedRect(pageWidth - 80, headerY, 66, 32, 2, 2, 'S');\r\n    \r\n    doc.setFontSize(8);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(80, 80, 90);\r\n    \r\n    let contactY = headerY + 6;\r\n    if (data.vendorGSTIN) {\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.text(`GSTIN:`, pageWidth - 76, contactY);\r\n      doc.setFont('helvetica', 'normal');\r\n      doc.text(data.vendorGSTIN, pageWidth - 76, contactY + 3.5);\r\n      contactY += 8;\r\n    }\r\n    if (data.vendorBranding.phone) {\r\n      doc.text(`Tel: ${data.vendorBranding.phone}`, pageWidth - 76, contactY);\r\n      contactY += 4.5;\r\n    }\r\n    if (data.vendorBranding.email) {\r\n      const email = data.vendorBranding.email.length > 25 ? \r\n        data.vendorBranding.email.substring(0, 22) + '...' : \r\n        data.vendorBranding.email;\r\n      doc.text(`Email: ${email}`, pageWidth - 76, contactY);\r\n      contactY += 4.5;\r\n    }\r\n    if (data.vendorBranding.address && contactY < headerY + 28) {\r\n      const splitAddress = doc.splitTextToSize(data.vendorBranding.address, 60);\r\n      doc.text(splitAddress.slice(0, 2), pageWidth - 76, contactY);\r\n    }\r\n  }\r\n  \r\n  doc.setTextColor(40, 40, 50);\r\n  \r\n  // Invoice Details in professional card format (left side)\r\n  let invoiceInfoY = 58;\r\n  \r\n  // Invoice info card background\r\n  doc.setFillColor(255, 253, 245);\r\n  doc.roundedRect(14, invoiceInfoY, 90, 32, 2, 2, 'F');\r\n  \r\n  // Accent border on left\r\n  doc.setFillColor(accentRgb.r, accentRgb.g, accentRgb.b);\r\n  doc.rect(14, invoiceInfoY, 2, 32, 'F');\r\n  \r\n  // Border\r\n  doc.setDrawColor(accentRgb.r, accentRgb.g, accentRgb.b);\r\n  doc.setLineWidth(0.5);\r\n  doc.roundedRect(14, invoiceInfoY, 90, 32, 2, 2, 'S');\r\n  \r\n  let infoY = invoiceInfoY + 7;\r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.text('INVOICE NUMBER', 20, infoY);\r\n  doc.setFontSize(12);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(40, 40, 50);\r\n  doc.text(data.invoiceNumber, 20, infoY + 5);\r\n  \r\n  infoY += 12;\r\n  doc.setFontSize(8);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(100, 100, 110);\r\n  doc.text('Date:', 20, infoY);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.text(new Date(data.invoiceDate).toLocaleDateString('en-IN', {\r\n    day: '2-digit',\r\n    month: 'short',\r\n    year: 'numeric'\r\n  }), 35, infoY);\r\n  \r\n  if (data.paymentDueDate) {\r\n    infoY += 4.5;\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text('Due:', 20, infoY);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(220, 38, 38);\r\n    doc.text(new Date(data.paymentDueDate).toLocaleDateString('en-IN', {\r\n      day: '2-digit',\r\n      month: 'short',\r\n      year: 'numeric'\r\n    }), 35, infoY);\r\n    doc.setTextColor(100, 100, 110);\r\n  }\r\n  \r\n  if (data.paymentTerms) {\r\n    infoY += 4.5;\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text('Terms:', 20, infoY);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.text(data.paymentTerms, 35, infoY);\r\n  }\r\n  \r\n  // Payment status badge\r\n  if (data.status) {\r\n    const statusColors: Record<string, { bg: [number, number, number]; text: [number, number, number] }> = {\r\n      paid: { bg: [220, 252, 231], text: [22, 163, 74] },\r\n      partial: { bg: [254, 249, 195], text: [202, 138, 4] },\r\n      pending: { bg: [254, 226, 226], text: [220, 38, 38] },\r\n    };\r\n    const statusLabels: Record<string, string> = {\r\n      paid: 'PAID',\r\n      partial: 'PARTIAL',\r\n      pending: 'UNPAID',\r\n    };\r\n    const statusConfig = statusColors[data.status] || statusColors.pending;\r\n    const statusLabel = statusLabels[data.status] || 'UNPAID';\r\n    \r\n    doc.setFillColor(...statusConfig.bg);\r\n    doc.roundedRect(pageWidth - 50, 55, 36, 10, 2, 2, 'F');\r\n    doc.setFontSize(8);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(...statusConfig.text);\r\n    doc.text(statusLabel, pageWidth - 32, 61.5, { align: 'center' });\r\n    doc.setTextColor(40, 40, 50);\r\n  }\r\n  \r\n  // Customer Details Section with enhanced design\r\n  let customerSectionY = 98;\r\n  if (data.customerName) {\r\n    // Customer card with gradient background\r\n    doc.setFillColor(250, 252, 255);\r\n    doc.roundedRect(14, customerSectionY, pageWidth - 28, 42, 2, 2, 'F');\r\n    \r\n    // Decorative top border\r\n    doc.setFillColor(secondaryRgb.r, secondaryRgb.g, secondaryRgb.b);\r\n    doc.roundedRect(14, customerSectionY, pageWidth - 28, 3, 2, 2, 'F');\r\n    \r\n    // Border\r\n    doc.setDrawColor(220, 225, 235);\r\n    doc.setLineWidth(0.5);\r\n    doc.roundedRect(14, customerSectionY, pageWidth - 28, 42, 2, 2, 'S');\r\n    \r\n    doc.setFontSize(10);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(secondaryRgb.r, secondaryRgb.g, secondaryRgb.b);\r\n    doc.text('BILL TO', 20, customerSectionY + 10);\r\n    doc.setTextColor(40, 40, 50);\r\n    \r\n    doc.setFontSize(11);\r\n    doc.setFont('helvetica', 'bold');\r\n    let yPos = customerSectionY + 17;\r\n    doc.text(data.customerName, 20, yPos);\r\n    \r\n    doc.setFontSize(9);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(80, 80, 90);\r\n    \r\n    // Two column layout for customer details\r\n    let leftColY = yPos + 6;\r\n    let rightColY = yPos + 6;\r\n    const midPoint = pageWidth / 2;\r\n    \r\n    if (data.customerGSTIN) {\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.text('GSTIN:', 20, leftColY);\r\n      doc.setFont('helvetica', 'normal');\r\n      doc.text(data.customerGSTIN, 38, leftColY);\r\n      leftColY += 5;\r\n    }\r\n    if (data.customerPhone) {\r\n      doc.text(`Tel: ${data.customerPhone}`, 20, leftColY);\r\n      leftColY += 5;\r\n    }\r\n    if (data.customerEmail) {\r\n      const emailLines = doc.splitTextToSize(`Email: ${data.customerEmail}`, midPoint - 25);\r\n      doc.text(emailLines, 20, leftColY);\r\n      leftColY += (emailLines.length * 4);\r\n    }\r\n    if (data.customerAddress) {\r\n      const addressLines = doc.splitTextToSize(data.customerAddress, pageWidth - 50);\r\n      doc.text(addressLines, 20, leftColY);\r\n    }\r\n    customerSectionY += 47;\r\n  }\r\n  \r\n  // Line Items Section (if provided)\r\n  let currentY = customerSectionY + 5;\r\n  \r\n  if (data.lineItems && data.lineItems.length > 0) {\r\n    // Check if we need a new page\r\n    if (currentY > doc.internal.pageSize.getHeight() - 100) {\r\n      doc.addPage();\r\n      currentY = 20;\r\n    }\r\n    \r\n    doc.setFontSize(12);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n    doc.text('INVOICE LINE ITEMS', 14, currentY);\r\n    doc.setTextColor(0, 0, 0);\r\n    currentY += 5;\r\n    \r\n    // Render each line item\r\n    data.lineItems.forEach((item, index) => {\r\n      // Check if we need a new page\r\n      if (currentY > doc.internal.pageSize.getHeight() - 50) {\r\n        doc.addPage();\r\n        currentY = 20;\r\n      }\r\n      \r\n      // Item header with image\r\n      const itemStartY = currentY;\r\n      \r\n      if (item.image_url) {\r\n        try {\r\n          doc.setFillColor(245, 245, 250);\r\n          doc.rect(14, currentY, 30, 30, 'F');\r\n          doc.setFontSize(7);\r\n          doc.setTextColor(150, 150, 150);\r\n          doc.text('[Image]', 29, currentY + 17, { align: 'center' });\r\n        } catch (error) {\r\n          console.error('Error adding item image:', error);\r\n        }\r\n      }\r\n      \r\n      // Item details\r\n      const detailsX = item.image_url ? 48 : 18;\r\n      doc.setFontSize(11);\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.setTextColor(0, 0, 0);\r\n      doc.text(`${index + 1}. ${item.item_name}`, detailsX, currentY + 5);\r\n      \r\n      if (item.description) {\r\n        doc.setFontSize(9);\r\n        doc.setFont('helvetica', 'normal');\r\n        doc.setTextColor(100, 100, 100);\r\n        const descLines = doc.splitTextToSize(item.description, pageWidth - detailsX - 20);\r\n        doc.text(descLines, detailsX, currentY + 11);\r\n      }\r\n      \r\n      currentY = Math.max(currentY + 35, itemStartY + (item.image_url ? 35 : 25));\r\n      \r\n      // Item specifications table\r\n      const itemSpecs: any[] = [\r\n        ['Gross Weight', `${item.gross_weight} g`],\r\n        ['Net Weight', `${item.net_weight} g`],\r\n      ];\r\n      \r\n      // Add diamond details if present\r\n      if (item.diamond_weight > 0) {\r\n        itemSpecs.push(['Diamond Weight', `${item.diamond_weight} ct`]);\r\n        if (item.diamond_color) {\r\n          itemSpecs.push(['Diamond Color', item.diamond_color]);\r\n        }\r\n        if (item.diamond_clarity) {\r\n          itemSpecs.push(['Diamond Clarity', item.diamond_clarity]);\r\n        }\r\n        if (item.diamond_cut) {\r\n          itemSpecs.push(['Diamond Cut', item.diamond_cut]);\r\n        }\r\n        if (item.diamond_certification) {\r\n          itemSpecs.push(['Diamond Certification', item.diamond_certification]);\r\n        }\r\n      }\r\n      \r\n      // Add gemstone details if present\r\n      if (item.gemstone_weight > 0) {\r\n        itemSpecs.push(['Gemstone Weight', `${item.gemstone_weight} ct`]);\r\n        if (item.gemstone_type) {\r\n          itemSpecs.push(['Gemstone Type', item.gemstone_type]);\r\n        }\r\n        if (item.gemstone_color) {\r\n          itemSpecs.push(['Gemstone Color', item.gemstone_color]);\r\n        }\r\n        if (item.gemstone_clarity) {\r\n          itemSpecs.push(['Gemstone Clarity', item.gemstone_clarity]);\r\n        }\r\n      }\r\n      \r\n      autoTable(doc, {\r\n        startY: currentY,\r\n        body: itemSpecs,\r\n        theme: 'plain',\r\n        styles: { fontSize: 9, cellPadding: 2 },\r\n        columnStyles: {\r\n          0: { fontStyle: 'bold', cellWidth: 40 },\r\n          1: { cellWidth: 'auto' },\r\n        },\r\n        margin: { left: 18, right: 14 },\r\n      });\r\n      \r\n      currentY = (doc as any).lastAutoTable.finalY + 2;\r\n      \r\n      // Item cost breakdown with professional table\r\n      const itemCosts = [\r\n        ['Gold Cost', formatCurrency(item.gold_cost)],\r\n        ['Making Charges', formatCurrency(item.making_charges)],\r\n        ['CAD Design', formatCurrency(item.cad_design_charges)],\r\n        ['Camming', formatCurrency(item.camming_charges)],\r\n        ['Certification', formatCurrency(item.certification_cost)],\r\n        ['Diamond Cost', formatCurrency(item.diamond_cost)],\r\n        ['Gemstone Cost', formatCurrency(item.gemstone_cost)],\r\n      ];\r\n      \r\n      autoTable(doc, {\r\n        startY: currentY,\r\n        body: itemCosts,\r\n        theme: 'plain',\r\n        styles: { \r\n          fontSize: 9, \r\n          cellPadding: 2.5,\r\n          textColor: [70, 70, 80]\r\n        },\r\n        columnStyles: {\r\n          0: { \r\n            cellWidth: 45,\r\n            fontStyle: 'bold',\r\n            textColor: [100, 100, 110]\r\n          },\r\n          1: { \r\n            cellWidth: 'auto', \r\n            halign: 'right',\r\n            fontStyle: 'bold'\r\n          },\r\n        },\r\n        margin: { left: 18, right: 14 },\r\n      });\r\n      \r\n      currentY = (doc as any).lastAutoTable.finalY + 3;\r\n      \r\n      // Item subtotal with enhanced styling\r\n      doc.setFillColor(secondaryRgb.r, secondaryRgb.g, secondaryRgb.b);\r\n      doc.rect(14, currentY, pageWidth - 28, 10, 'F');\r\n      doc.setFontSize(11);\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.setTextColor(255, 255, 255);\r\n      doc.text('Item Subtotal:', 18, currentY + 6.5);\r\n      doc.text(formatCurrency(item.subtotal), pageWidth - 18, currentY + 6.5, { align: 'right' });\r\n      doc.setTextColor(40, 40, 50);\r\n      \r\n      currentY += 18;\r\n    });\r\n  } else {\r\n    // Check if we need a new page\r\n    if (currentY > doc.internal.pageSize.getHeight() - 100) {\r\n      doc.addPage();\r\n      currentY = 20;\r\n    }\r\n    \r\n    // Original single-item specifications (fallback)\r\n    doc.setFontSize(12);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n    doc.text('PRODUCT SPECIFICATIONS', 14, currentY);\r\n    doc.setTextColor(0, 0, 0);\r\n  \r\n  const specsData = [];\r\n  if (data.grossWeight) {\r\n    specsData.push(['Gross Weight', `${data.grossWeight} grams`]);\r\n  }\r\n  if (data.netWeight) {\r\n    specsData.push(['Net Weight', `${data.netWeight} grams`]);\r\n  }\r\n  if (data.purityFraction) {\r\n    specsData.push(['Gold Purity', `${(data.purityFraction * 100).toFixed(0)}%`]);\r\n  }\r\n  if (data.details?.diamond_type) {\r\n    specsData.push(['Diamond Type', data.details.diamond_type]);\r\n  }\r\n  if (data.details?.diamond_shape) {\r\n    specsData.push(['Diamond Shape', data.details.diamond_shape]);\r\n  }\r\n  if (data.details?.diamond_weight) {\r\n    specsData.push(['Diamond Weight', `${data.details.diamond_weight} carats`]);\r\n  }\r\n  if (data.details?.diamond_color) {\r\n    specsData.push(['Diamond Color', data.details.diamond_color]);\r\n  }\r\n  if (data.details?.diamond_clarity) {\r\n    specsData.push(['Diamond Clarity', data.details.diamond_clarity]);\r\n  }\r\n  if (data.details?.diamond_certification && data.details.diamond_certification !== 'none') {\r\n    specsData.push(['Certification', data.details.diamond_certification.toUpperCase()]);\r\n  }\r\n  if (data.details?.gemstone_weight) {\r\n    specsData.push(['Gemstone Weight', `${data.details.gemstone_weight} carats`]);\r\n  }\r\n  \r\n  if (specsData.length > 0) {\r\n    autoTable(doc, {\r\n      startY: currentY + 5,\r\n      body: specsData,\r\n      theme: 'plain',\r\n      styles: { fontSize: 10 },\r\n      columnStyles: {\r\n        0: { fontStyle: 'bold', cellWidth: 50 },\r\n        1: { cellWidth: 'auto' },\r\n      },\r\n      margin: { left: 14, right: 14 },\r\n    });\r\n    currentY = (doc as any).lastAutoTable.finalY + 15;\r\n  } else {\r\n    currentY += 10;\r\n  }\r\n  }\r\n  \r\n  // Cost Breakdown Table (only if no line items) with enhanced styling\r\n  if (!data.lineItems || data.lineItems.length === 0) {\r\n  const costStartY = currentY;\r\n  \r\n  // Check for page break\r\n  if (costStartY > doc.internal.pageSize.getHeight() - 100) {\r\n    doc.addPage();\r\n    currentY = 20;\r\n  }\r\n  \r\n  doc.setFontSize(12);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.text('COST BREAKDOWN', 14, currentY);\r\n  doc.setTextColor(40, 40, 50);\r\n  \r\n  const tableData = [\r\n    ['Gold Cost', formatCurrency(data.goldCost)],\r\n    ['Making Charges', formatCurrency(data.makingCharges)],\r\n    ['CAD Design Charges', formatCurrency(data.cadDesignCharges)],\r\n    ['Camming Charges', formatCurrency(data.cammingCharges)],\r\n    ['Certification Cost', formatCurrency(data.certificationCost)],\r\n    ['Diamond Cost', formatCurrency(data.diamondCost)],\r\n    ['Gemstone Cost', formatCurrency(data.gemstoneCost)],\r\n  ];\r\n  \r\n  autoTable(doc, {\r\n    startY: currentY + 5,\r\n    head: [['Description', 'Amount']],\r\n    body: tableData,\r\n    theme: 'striped',\r\n    headStyles: { \r\n      fillColor: [primaryRgb.r, primaryRgb.g, primaryRgb.b],\r\n      fontSize: 11,\r\n      fontStyle: 'bold',\r\n      textColor: [255, 255, 255],\r\n      cellPadding: 4\r\n    },\r\n    bodyStyles: {\r\n      fontSize: 10,\r\n      textColor: [50, 50, 60],\r\n      cellPadding: 3.5\r\n    },\r\n    alternateRowStyles: { \r\n      fillColor: [250, 252, 255] \r\n    },\r\n    columnStyles: {\r\n      0: { \r\n        cellWidth: 110,\r\n        fontStyle: 'normal'\r\n      },\r\n      1: { \r\n        cellWidth: 'auto',\r\n        halign: 'right',\r\n        fontStyle: 'bold'\r\n      }\r\n    },\r\n    margin: { left: 14, right: 14 },\r\n  });\r\n  \r\n  currentY = (doc as any).lastAutoTable.finalY + 10;\r\n  }\r\n  \r\n  // Total Section with GST and Shipping\r\n  const finalY = currentY;\r\n  \r\n  // Calculate height based on content\r\n  const hasGst = (data.gstMode === 'sgst_cgst' && ((data.sgstAmount && data.sgstAmount > 0) || (data.cgstAmount && data.cgstAmount > 0))) || \r\n                 (data.gstMode === 'igst' && data.igstAmount && data.igstAmount > 0);\r\n  const hasShipping = data.shippingCharges && data.shippingCharges > 0;\r\n  const hasGrandTotal = data.grandTotal !== undefined && data.grandTotal > 0;\r\n  const hasCurrency = data.exchangeRate && data.exchangeRate > 0 && hasGrandTotal;\r\n  \r\n  const baseHeight = 40;\r\n  const gstHeight = hasGst ? (data.gstMode === 'sgst_cgst' ? 12 : 7) : 0;\r\n  const shippingHeight = hasShipping ? 7 : 0;\r\n  const grandTotalHeight = hasGrandTotal ? 12 : 0;\r\n  const currencyHeight = hasCurrency ? 8 : 0;\r\n  const totalSectionHeight = baseHeight + gstHeight + shippingHeight + grandTotalHeight + currencyHeight;\r\n  \r\n  // Check if we need a new page for totals section\r\n  if (finalY + totalSectionHeight > doc.internal.pageSize.getHeight() - 80) {\r\n    doc.addPage();\r\n    currentY = 20;\r\n    const newFinalY = currentY;\r\n    doc.setFillColor(245, 245, 250);\r\n    doc.rect(14, newFinalY, pageWidth - 28, totalSectionHeight, 'F');\r\n    \r\n    renderTotalsSection(doc, newFinalY, data, primaryRgb, pageWidth, hasGst, hasShipping, hasGrandTotal, hasCurrency);\r\n    currentY = newFinalY + totalSectionHeight + 5;\r\n  } else {\r\n    doc.setFillColor(245, 245, 250);\r\n    doc.rect(14, finalY, pageWidth - 28, totalSectionHeight, 'F');\r\n    \r\n    renderTotalsSection(doc, finalY, data, primaryRgb, pageWidth, hasGst, hasShipping, hasGrandTotal, hasCurrency);\r\n    currentY = finalY + totalSectionHeight + 5;\r\n  }\r\n  \r\n  // Invoice Notes Section  \r\n  if (data.invoiceNotes) {\r\n    if (currentY > doc.internal.pageSize.getHeight() - 60) {\r\n      doc.addPage();\r\n      currentY = 20;\r\n    }\r\n    \r\n    doc.setFontSize(12);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n    doc.text('INVOICE NOTES', 14, currentY);\r\n    doc.setTextColor(0, 0, 0);\r\n    \r\n    doc.setFontSize(10);\r\n    doc.setFont('helvetica', 'normal');\r\n    const splitNotes = doc.splitTextToSize(data.invoiceNotes, pageWidth - 28);\r\n    doc.text(splitNotes, 14, currentY + 6);\r\n    currentY += 6 + (splitNotes.length * 5) + 5;\r\n  }\r\n  \r\n  // Payment Instructions with professional card design\r\n  if (currentY > doc.internal.pageSize.getHeight() - 70) {\r\n    doc.addPage();\r\n    currentY = 20;\r\n  }\r\n  \r\n  doc.setFillColor(255, 253, 245);\r\n  doc.roundedRect(14, currentY - 2, pageWidth - 28, 22, 2, 2, 'F');\r\n  doc.setDrawColor(245, 158, 11);\r\n  doc.setLineWidth(2);\r\n  doc.line(14, currentY - 2, 14, currentY + 20);\r\n  doc.setDrawColor(220, 225, 230);\r\n  doc.setLineWidth(0.5);\r\n  doc.roundedRect(14, currentY - 2, pageWidth - 28, 22, 2, 2, 'S');\r\n  \r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.text('PAYMENT INFORMATION', 20, currentY + 4);\r\n  doc.setTextColor(40, 40, 50);\r\n  \r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setFontSize(8.5);\r\n  doc.setTextColor(70, 70, 80);\r\n  doc.text('Please make payment within the specified terms to avoid late fees.', 20, currentY + 10);\r\n  doc.text('For payment inquiries or bank details, contact us at the details above.', 20, currentY + 15);\r\n  currentY += 28;\r\n  \r\n  // Terms & Conditions with professional formatting\r\n  if (currentY > doc.internal.pageSize.getHeight() - 50) {\r\n    doc.addPage();\r\n    currentY = 20;\r\n  }\r\n  \r\n  doc.setFillColor(248, 250, 252);\r\n  doc.rect(14, currentY - 2, pageWidth - 28, 32, 'F');\r\n  doc.setDrawColor(220, 225, 230);\r\n  doc.setLineWidth(0.5);\r\n  doc.rect(14, currentY - 2, pageWidth - 28, 32, 'S');\r\n  \r\n  doc.setFontSize(9);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.text('TERMS & CONDITIONS', 18, currentY + 3);\r\n  \r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setFontSize(7.5);\r\n  doc.setTextColor(70, 70, 80);\r\n  doc.text('- Payment must be received by the due date to avoid late fees.', 18, currentY + 9);\r\n  doc.text('- All prices are final and include applicable taxes unless otherwise stated.', 18, currentY + 13);\r\n  doc.text('- This invoice is valid for the amounts and items listed above.', 18, currentY + 17);\r\n  doc.text('- Goods once sold cannot be returned or exchanged.', 18, currentY + 21);\r\n  doc.text('- Subject to jurisdiction mentioned in the invoice.', 18, currentY + 25);\r\n  \r\n  // Professional footer\r\n  const footerY = doc.internal.pageSize.getHeight() - 7;\r\n  doc.setDrawColor(220, 225, 230);\r\n  doc.setLineWidth(0.5);\r\n  doc.line(14, footerY - 2, pageWidth - 14, footerY - 2);\r\n  \r\n  doc.setFontSize(7.5);\r\n  doc.setTextColor(120, 120, 130);\r\n  doc.text(\r\n    `Generated on ${new Date().toLocaleDateString('en-IN', { day: '2-digit', month: 'short', year: 'numeric' })} at ${new Date().toLocaleTimeString('en-IN', { hour: '2-digit', minute: '2-digit' })}`,\r\n    pageWidth / 2,\r\n    footerY,\r\n    { align: 'center' }\r\n  );\r\n  \r\n  // Save PDF\r\n  const fileName = `Invoice_${data.invoiceNumber.replace(/[^a-z0-9]/gi, '_')}_${Date.now()}.pdf`;\r\n  doc.save(fileName);\r\n};\r\n\r\n// Helper function to render totals section\r\nconst renderTotalsSection = (\r\n  doc: jsPDF,\r\n  startY: number,\r\n  data: InvoiceData,\r\n  primaryRgb: { r: number; g: number; b: number },\r\n  pageWidth: number,\r\n  hasGst: boolean,\r\n  hasShipping: boolean,\r\n  hasGrandTotal: boolean,\r\n  hasCurrency: boolean\r\n) => {\r\n  let lineY = startY + 10;\r\n  \r\n  // Subtotal with better formatting\r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setTextColor(80, 80, 90);\r\n  doc.text('Subtotal:', 20, lineY);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(50, 50, 60);\r\n  doc.text(formatCurrency(data.totalCost), pageWidth - 20, lineY, { align: 'right' });\r\n  lineY += 6;\r\n  \r\n  // Amount before tax with subtle separator\r\n  doc.setDrawColor(220, 225, 235);\r\n  doc.setLineWidth(0.3);\r\n  doc.line(20, lineY, pageWidth - 20, lineY);\r\n  lineY += 5;\r\n  \r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(60, 60, 70);\r\n  doc.text('Amount (Before Tax):', 20, lineY);\r\n  doc.setTextColor(50, 50, 60);\r\n  doc.text(formatCurrency(data.finalSellingPrice), pageWidth - 20, lineY, { align: 'right' });\r\n  lineY += 7;\r\n  \r\n  // GST breakdown with enhanced styling\r\n  if (hasGst) {\r\n    doc.setFontSize(9);\r\n    if (data.gstMode === 'sgst_cgst') {\r\n      doc.setFont('helvetica', 'normal');\r\n      doc.setTextColor(80, 80, 90);\r\n      doc.text(`SGST (${data.sgstPercentage || 0}%):`, 24, lineY);\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.setTextColor(50, 50, 60);\r\n      doc.text(formatCurrency(data.sgstAmount || 0), pageWidth - 20, lineY, { align: 'right' });\r\n      lineY += 4.5;\r\n      \r\n      doc.setFont('helvetica', 'normal');\r\n      doc.setTextColor(80, 80, 90);\r\n      doc.text(`CGST (${data.cgstPercentage || 0}%):`, 24, lineY);\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.setTextColor(50, 50, 60);\r\n      doc.text(formatCurrency(data.cgstAmount || 0), pageWidth - 20, lineY, { align: 'right' });\r\n      lineY += 5;\r\n    } else {\r\n      doc.setFont('helvetica', 'normal');\r\n      doc.setTextColor(80, 80, 90);\r\n      doc.text(`IGST (${data.igstPercentage || 0}%):`, 24, lineY);\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.setTextColor(50, 50, 60);\r\n      doc.text(formatCurrency(data.igstAmount || 0), pageWidth - 20, lineY, { align: 'right' });\r\n      lineY += 5;\r\n    }\r\n    doc.setFontSize(10);\r\n  }\r\n  \r\n  // Shipping charges with professional styling\r\n  if (hasShipping) {\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(80, 80, 90);\r\n    doc.text(`Shipping${data.shippingZone ? ` (${data.shippingZone})` : ''}:`, 20, lineY);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(50, 50, 60);\r\n    doc.text(formatCurrency(data.shippingCharges!), pageWidth - 20, lineY, { align: 'right' });\r\n    lineY += 6;\r\n  }\r\n  \r\n  // Draw prominent line before grand total\r\n  if (hasGrandTotal) {\r\n    doc.setDrawColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n    doc.setLineWidth(1);\r\n    doc.line(20, lineY, pageWidth - 20, lineY);\r\n    lineY += 7;\r\n    \r\n    // Grand Total with enhanced styling\r\n    doc.setFillColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n    doc.roundedRect(18, lineY - 4, pageWidth - 36, 12, 1, 1, 'F');\r\n    \r\n    doc.setFontSize(13);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(255, 255, 255);\r\n    doc.text('GRAND TOTAL (INR):', 22, lineY + 3);\r\n    doc.setFontSize(14);\r\n    doc.text(formatCurrency(data.grandTotal), pageWidth - 22, lineY + 3, { align: 'right' });\r\n    lineY += 10;\r\n    doc.setTextColor(40, 40, 50);\r\n  } else {\r\n    // Draw line before final total\r\n    doc.setDrawColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n    doc.setLineWidth(1);\r\n    doc.line(20, lineY, pageWidth - 20, lineY);\r\n    lineY += 7;\r\n    \r\n    doc.setFontSize(13);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n    doc.text('TOTAL AMOUNT DUE:', 20, lineY);\r\n    doc.text(formatCurrency(data.finalSellingPrice), pageWidth - 20, lineY, { align: 'right' });\r\n    lineY += 7;\r\n    doc.setTextColor(40, 40, 50);\r\n  }\r\n  \r\n  // Currency conversion with enhanced formatting\r\n  if (hasCurrency && data.grandTotal) {\r\n    doc.setFontSize(9);\r\n    doc.setFont('helvetica', 'italic');\r\n    doc.setTextColor(100, 100, 110);\r\n    const usdAmount = (data.grandTotal / (data.exchangeRate || 1)).toLocaleString('en-US', {\r\n      minimumFractionDigits: 2,\r\n      maximumFractionDigits: 2\r\n    });\r\n    doc.text(`Equivalent: USD $${usdAmount} @ Exchange Rate Rs.${(data.exchangeRate || 0).toFixed(2)}/USD`, 20, lineY);\r\n    doc.setTextColor(40, 40, 50);\r\n  }\r\n};\r\n\r\nconst generateSummaryInvoice = async (data: InvoiceData) => {\r\n  const doc = new jsPDF();\r\n  const pageWidth = doc.internal.pageSize.getWidth();\r\n  \r\n  const primaryColor = data.vendorBranding?.primaryColor || '#4F46E5';\r\n  const hexToRgb = (hex: string) => {\r\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n    return result ? {\r\n      r: parseInt(result[1], 16),\r\n      g: parseInt(result[2], 16),\r\n      b: parseInt(result[3], 16)\r\n    } : { r: 79, g: 70, b: 229 };\r\n  };\r\n  const primaryRgb = hexToRgb(primaryColor);\r\n  \r\n  // Header\r\n  doc.setFillColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.rect(0, 0, pageWidth, 35, 'F');\r\n  doc.setFontSize(24);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(255, 255, 255);\r\n  const invoiceLabel = getInvoiceTypeLabel(data.invoiceType);\r\n  doc.text(invoiceLabel, pageWidth / 2, 22, { align: 'center' });\r\n  \r\n  doc.setTextColor(0, 0, 0);\r\n  \r\n  // Invoice info\r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.text(`Invoice: ${data.invoiceNumber}`, 14, 50);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.text(`Date: ${new Date(data.invoiceDate).toLocaleDateString()}`, 14, 56);\r\n  if (data.paymentDueDate) {\r\n    doc.text(`Due: ${new Date(data.paymentDueDate).toLocaleDateString()}`, 14, 62);\r\n  }\r\n  \r\n  // Customer info\r\n  if (data.customerName) {\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text('Bill To:', 14, 75);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.text(data.customerName, 14, 81);\r\n    if (data.customerPhone) doc.text(data.customerPhone, 14, 87);\r\n  }\r\n  \r\n  // Summary table\r\n  const summaryData = [\r\n    ['Gold Cost', `Rs. ${data.goldCost.toFixed(2)}`],\r\n    ['Making & Design', `Rs. ${(data.makingCharges + data.cadDesignCharges + data.cammingCharges).toFixed(2)}`],\r\n    ['Stones & Gems', `Rs. ${(data.diamondCost + data.gemstoneCost).toFixed(2)}`],\r\n    ['Certification', `Rs. ${data.certificationCost.toFixed(2)}`],\r\n  ];\r\n  \r\n  autoTable(doc, {\r\n    startY: 100,\r\n    head: [['Item', 'Amount']],\r\n    body: summaryData,\r\n    theme: 'plain',\r\n    headStyles: { fillColor: [primaryRgb.r, primaryRgb.g, primaryRgb.b], textColor: 255 },\r\n    margin: { left: 14, right: 14 },\r\n  });\r\n  \r\n  const finalY = (doc as any).lastAutoTable.finalY + 10;\r\n  \r\n  // Total\r\n  doc.setFillColor(245, 245, 250);\r\n  doc.rect(14, finalY, pageWidth - 28, 20, 'F');\r\n  doc.setFontSize(14);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.text(`TOTAL: Rs. ${data.finalSellingPrice.toFixed(2)}`, pageWidth - 18, finalY + 13, { align: 'right' });\r\n  \r\n  doc.setTextColor(0, 0, 0);\r\n  \r\n  const fileName = `Invoice_${data.invoiceNumber.replace(/[^a-z0-9]/gi, '_')}_${Date.now()}.pdf`;\r\n  doc.save(fileName);\r\n};\r\n\r\nconst generateMinimalInvoice = async (data: InvoiceData) => {\r\n  const doc = new jsPDF();\r\n  const pageWidth = doc.internal.pageSize.getWidth();\r\n  \r\n  const primaryColor = data.vendorBranding?.primaryColor || '#4F46E5';\r\n  const hexToRgb = (hex: string) => {\r\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n    return result ? {\r\n      r: parseInt(result[1], 16),\r\n      g: parseInt(result[2], 16),\r\n      b: parseInt(result[3], 16)\r\n    } : { r: 79, g: 70, b: 229 };\r\n  };\r\n  const primaryRgb = hexToRgb(primaryColor);\r\n  \r\n  // Simple header\r\n  doc.setFontSize(28);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  const invoiceLabel = getInvoiceTypeLabel(data.invoiceType);\r\n  doc.text(invoiceLabel, pageWidth / 2, 30, { align: 'center' });\r\n  \r\n  doc.setTextColor(0, 0, 0);\r\n  doc.setFontSize(12);\r\n  doc.setFont('helvetica', 'normal');\r\n  \r\n  // Basic info\r\n  let yPos = 50;\r\n  doc.text(`Invoice Number: ${data.invoiceNumber}`, pageWidth / 2, yPos, { align: 'center' });\r\n  yPos += 8;\r\n  doc.text(`Date: ${new Date(data.invoiceDate).toLocaleDateString()}`, pageWidth / 2, yPos, { align: 'center' });\r\n  \r\n  if (data.customerName) {\r\n    yPos += 20;\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text(`Customer: ${data.customerName}`, pageWidth / 2, yPos, { align: 'center' });\r\n  }\r\n  \r\n  // Total amount - large and centered\r\n  yPos += 40;\r\n  doc.setFontSize(36);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.text(`Rs. ${data.finalSellingPrice.toFixed(2)}`, pageWidth / 2, yPos, { align: 'center' });\r\n  \r\n  doc.setTextColor(0, 0, 0);\r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'normal');\r\n  yPos += 10;\r\n  doc.text('Total Amount Due', pageWidth / 2, yPos, { align: 'center' });\r\n  \r\n  if (data.paymentDueDate) {\r\n    yPos += 15;\r\n    doc.setFontSize(11);\r\n    doc.text(`Payment Due: ${new Date(data.paymentDueDate).toLocaleDateString()}`, pageWidth / 2, yPos, { align: 'center' });\r\n  }\r\n  \r\n  const fileName = `Invoice_${data.invoiceNumber.replace(/[^a-z0-9]/gi, '_')}_${Date.now()}.pdf`;\r\n  doc.save(fileName);\r\n};\r\n\r\n// Traditional Template - Classic serif style with ornate borders\r\nconst generateTraditionalInvoice = async (data: InvoiceData) => {\r\n  const doc = new jsPDF();\r\n  const pageWidth = doc.internal.pageSize.getWidth();\r\n  const pageHeight = doc.internal.pageSize.getHeight();\r\n  \r\n  const primaryColor = data.vendorBranding?.primaryColor || '#2C1810';\r\n  const goldAccent = '#8B7355';\r\n  \r\n  const hexToRgb = (hex: string) => {\r\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n    return result ? {\r\n      r: parseInt(result[1], 16),\r\n      g: parseInt(result[2], 16),\r\n      b: parseInt(result[3], 16)\r\n    } : { r: 44, g: 24, b: 16 };\r\n  };\r\n  \r\n  const primaryRgb = hexToRgb(primaryColor);\r\n  const goldRgb = hexToRgb(goldAccent);\r\n  \r\n  // Ornate border\r\n  doc.setDrawColor(goldRgb.r, goldRgb.g, goldRgb.b);\r\n  doc.setLineWidth(2);\r\n  doc.rect(10, 10, pageWidth - 20, pageHeight - 20);\r\n  doc.setLineWidth(0.5);\r\n  doc.rect(12, 12, pageWidth - 24, pageHeight - 24);\r\n  \r\n  // Decorative corner elements\r\n  doc.setFillColor(goldRgb.r, goldRgb.g, goldRgb.b);\r\n  [\r\n    [15, 15], [pageWidth - 15, 15],\r\n    [15, pageHeight - 15], [pageWidth - 15, pageHeight - 15]\r\n  ].forEach(([x, y]) => {\r\n    doc.circle(x, y, 2, 'F');\r\n  });\r\n  \r\n  // Header with business name\r\n  let yPos = 30;\r\n  doc.setFontSize(32);\r\n  doc.setFont('times', 'bold');\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.text(data.vendorBranding?.name || 'FINE JEWELERS', pageWidth / 2, yPos, { align: 'center' });\r\n  \r\n  // Tagline with decorative line\r\n  if (data.vendorBranding?.tagline) {\r\n    yPos += 8;\r\n    doc.setFontSize(11);\r\n    doc.setFont('times', 'italic');\r\n    doc.setTextColor(goldRgb.r, goldRgb.g, goldRgb.b);\r\n    doc.text(data.vendorBranding.tagline, pageWidth / 2, yPos, { align: 'center' });\r\n  }\r\n  \r\n  // Decorative separator line\r\n  yPos += 10;\r\n  doc.setDrawColor(goldRgb.r, goldRgb.g, goldRgb.b);\r\n  doc.setLineWidth(0.5);\r\n  const lineMargin = 40;\r\n  doc.line(lineMargin, yPos, pageWidth - lineMargin, yPos);\r\n  doc.circle(pageWidth / 2, yPos, 1, 'F');\r\n  \r\n  yPos += 12;\r\n  doc.setFontSize(24);\r\n  doc.setFont('times', 'bold');\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  const invoiceLabel = getInvoiceTypeLabel(data.invoiceType);\r\n  doc.text(invoiceLabel, pageWidth / 2, yPos, { align: 'center' });\r\n  \r\n  // Invoice details box\r\n  yPos += 15;\r\n  doc.setFillColor(250, 248, 245);\r\n  doc.rect(20, yPos, (pageWidth - 40) / 2 - 5, 30, 'F');\r\n  \r\n  doc.setFontSize(10);\r\n  doc.setFont('times', 'bold');\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.text('Invoice Number:', 25, yPos + 8);\r\n  doc.setFont('times', 'normal');\r\n  doc.text(data.invoiceNumber, 25, yPos + 14);\r\n  \r\n  doc.setFont('times', 'bold');\r\n  doc.text('Date:', 25, yPos + 20);\r\n  doc.setFont('times', 'normal');\r\n  doc.text(new Date(data.invoiceDate).toLocaleDateString(), 25, yPos + 26);\r\n  \r\n  // Vendor contact box\r\n  doc.setFillColor(250, 248, 245);\r\n  doc.rect(pageWidth / 2 + 5, yPos, (pageWidth - 40) / 2 - 5, 30, 'F');\r\n  \r\n  doc.setFont('times', 'bold');\r\n  let contactY = yPos + 8;\r\n  if (data.vendorBranding?.phone) {\r\n    doc.text('Tel:', pageWidth / 2 + 10, contactY);\r\n    doc.setFont('times', 'normal');\r\n    doc.text(data.vendorBranding.phone, pageWidth / 2 + 25, contactY);\r\n    contactY += 6;\r\n  }\r\n  if (data.vendorBranding?.email) {\r\n    doc.setFont('times', 'bold');\r\n    doc.text('Email:', pageWidth / 2 + 10, contactY);\r\n    doc.setFont('times', 'normal');\r\n    const emailText = doc.splitTextToSize(data.vendorBranding.email, 60);\r\n    doc.text(emailText, pageWidth / 2 + 25, contactY);\r\n  }\r\n  \r\n  // Customer details\r\n  yPos += 40;\r\n  doc.setFont('times', 'bold');\r\n  doc.setFontSize(12);\r\n  doc.setTextColor(goldRgb.r, goldRgb.g, goldRgb.b);\r\n  doc.text('BILL TO', 20, yPos);\r\n  \r\n  yPos += 6;\r\n  doc.setDrawColor(goldRgb.r, goldRgb.g, goldRgb.b);\r\n  doc.line(20, yPos, 80, yPos);\r\n  \r\n  yPos += 8;\r\n  doc.setFont('times', 'normal');\r\n  doc.setFontSize(10);\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  if (data.customerName) doc.text(data.customerName, 20, yPos);\r\n  if (data.customerPhone) {\r\n    yPos += 5;\r\n    doc.text(data.customerPhone, 20, yPos);\r\n  }\r\n  if (data.customerEmail) {\r\n    yPos += 5;\r\n    doc.text(data.customerEmail, 20, yPos);\r\n  }\r\n  if (data.customerAddress) {\r\n    yPos += 5;\r\n    const addressLines = doc.splitTextToSize(data.customerAddress, 70);\r\n    doc.text(addressLines, 20, yPos);\r\n  }\r\n  \r\n  // Cost breakdown table\r\n  yPos += 25;\r\n  const tableData = [\r\n    ['Gold Cost', '', `Rs. ${data.goldCost.toFixed(2)}`],\r\n    ['Diamond Cost', '', `Rs. ${data.diamondCost.toFixed(2)}`],\r\n    ['Gemstone Cost', '', `Rs. ${data.gemstoneCost.toFixed(2)}`],\r\n    ['Making Charges', '', `Rs. ${data.makingCharges.toFixed(2)}`],\r\n    ['Design & CAD', '', `Rs. ${data.cadDesignCharges.toFixed(2)}`],\r\n    ['Certification', '', `Rs. ${data.certificationCost.toFixed(2)}`],\r\n  ];\r\n  \r\n  autoTable(doc, {\r\n    startY: yPos,\r\n    head: [['Description', '', 'Amount']],\r\n    body: tableData,\r\n    theme: 'plain',\r\n    styles: { \r\n      font: 'times',\r\n      fontSize: 10,\r\n      textColor: [primaryRgb.r, primaryRgb.g, primaryRgb.b],\r\n    },\r\n    headStyles: { \r\n      fillColor: [goldRgb.r, goldRgb.g, goldRgb.b],\r\n      textColor: [255, 255, 255],\r\n      fontStyle: 'bold',\r\n      halign: 'left',\r\n    },\r\n    columnStyles: {\r\n      0: { cellWidth: 80 },\r\n      1: { cellWidth: 'auto' },\r\n      2: { cellWidth: 40, halign: 'right' },\r\n    },\r\n    margin: { left: 20, right: 20 },\r\n  });\r\n  \r\n  // Total section with decorative box\r\n  const totalY = (doc as any).lastAutoTable.finalY + 10;\r\n  doc.setDrawColor(goldRgb.r, goldRgb.g, goldRgb.b);\r\n  doc.setLineWidth(1.5);\r\n  doc.rect(pageWidth - 90, totalY, 70, 20);\r\n  \r\n  doc.setFontSize(14);\r\n  doc.setFont('times', 'bold');\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.text('TOTAL:', pageWidth - 85, totalY + 13);\r\n  doc.text(`Rs. ${data.finalSellingPrice.toFixed(2)}`, pageWidth - 25, totalY + 13, { align: 'right' });\r\n  \r\n  // Payment terms\r\n  const footerY = pageHeight - 35;\r\n  doc.setFontSize(9);\r\n  doc.setFont('times', 'italic');\r\n  doc.setTextColor(goldRgb.r, goldRgb.g, goldRgb.b);\r\n  doc.text('Payment Terms:', 20, footerY);\r\n  doc.setFont('times', 'normal');\r\n  doc.text(data.paymentTerms || 'Net 30', 20, footerY + 5);\r\n  \r\n  if (data.invoiceNotes) {\r\n    doc.text('Notes:', 20, footerY + 12);\r\n    const notes = doc.splitTextToSize(data.invoiceNotes, pageWidth - 45);\r\n    doc.text(notes, 20, footerY + 17);\r\n  }\r\n  \r\n  const fileName = `Invoice_${data.invoiceNumber.replace(/[^a-z0-9]/gi, '_')}_Traditional.pdf`;\r\n  doc.save(fileName);\r\n};\r\n\r\n// Modern Template - Clean minimalist design\r\nconst generateModernInvoice = async (data: InvoiceData) => {\r\n  const doc = new jsPDF();\r\n  const pageWidth = doc.internal.pageSize.getWidth();\r\n  \r\n  const primaryColor = data.vendorBranding?.primaryColor || '#000000';\r\n  const accentColor = data.vendorBranding?.secondaryColor || '#6366F1';\r\n  \r\n  const hexToRgb = (hex: string) => {\r\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n    return result ? {\r\n      r: parseInt(result[1], 16),\r\n      g: parseInt(result[2], 16),\r\n      b: parseInt(result[3], 16)\r\n    } : { r: 0, g: 0, b: 0 };\r\n  };\r\n  \r\n  const primaryRgb = hexToRgb(primaryColor);\r\n  const accentRgb = hexToRgb(accentColor);\r\n  \r\n  // Minimal header with thin accent line\r\n  doc.setDrawColor(accentRgb.r, accentRgb.g, accentRgb.b);\r\n  doc.setLineWidth(3);\r\n  doc.line(0, 25, pageWidth, 25);\r\n  \r\n  // Business name - ultra minimal\r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setTextColor(100, 100, 100);\r\n  doc.text(data.vendorBranding?.name?.toUpperCase() || 'JEWELERS', 20, 15);\r\n  \r\n  // INVOICE - large and minimal\r\n  doc.setFontSize(48);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  const invoiceLabel = getInvoiceTypeLabel(data.invoiceType);\r\n  doc.text(invoiceLabel, 20, 50);\r\n  \r\n  // Invoice details - clean alignment\r\n  let yPos = 65;\r\n  doc.setFontSize(9);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setTextColor(100, 100, 100);\r\n  doc.text('NUMBER', 20, yPos);\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.text(data.invoiceNumber, 55, yPos);\r\n  \r\n  yPos += 6;\r\n  doc.setTextColor(100, 100, 100);\r\n  doc.text('DATE', 20, yPos);\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.text(new Date(data.invoiceDate).toLocaleDateString(), 55, yPos);\r\n  \r\n  if (data.paymentDueDate) {\r\n    yPos += 6;\r\n    doc.setTextColor(100, 100, 100);\r\n    doc.text('DUE', 20, yPos);\r\n    doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n    doc.text(new Date(data.paymentDueDate).toLocaleDateString(), 55, yPos);\r\n  }\r\n  \r\n  // Customer info - right aligned\r\n  yPos = 65;\r\n  if (data.customerName) {\r\n    doc.setFontSize(9);\r\n    doc.setTextColor(100, 100, 100);\r\n    doc.text('BILL TO', pageWidth - 20, yPos, { align: 'right' });\r\n    yPos += 6;\r\n    doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n    doc.text(data.customerName, pageWidth - 20, yPos, { align: 'right' });\r\n    if (data.customerEmail) {\r\n      yPos += 5;\r\n      doc.setFontSize(8);\r\n      doc.text(data.customerEmail, pageWidth - 20, yPos, { align: 'right' });\r\n    }\r\n  }\r\n  \r\n  // Items table - ultra clean\r\n  yPos += 25;\r\n  const tableData = [\r\n    ['Gold & Metal Work', `Rs. ${data.goldCost.toFixed(2)}`],\r\n    ['Precious Stones', `Rs. ${(data.diamondCost + data.gemstoneCost).toFixed(2)}`],\r\n    ['Craftsmanship', `Rs. ${data.makingCharges.toFixed(2)}`],\r\n    ['Design & Finishing', `Rs. ${(data.cadDesignCharges + data.cammingCharges).toFixed(2)}`],\r\n    ['Certification', `Rs. ${data.certificationCost.toFixed(2)}`],\r\n  ];\r\n  \r\n  autoTable(doc, {\r\n    startY: yPos,\r\n    body: tableData,\r\n    theme: 'plain',\r\n    styles: { \r\n      fontSize: 10,\r\n      textColor: [primaryRgb.r, primaryRgb.g, primaryRgb.b],\r\n      cellPadding: { top: 4, bottom: 4, left: 0, right: 0 },\r\n    },\r\n    columnStyles: {\r\n      0: { cellWidth: 130, fontStyle: 'normal' },\r\n      1: { cellWidth: 50, halign: 'right', fontStyle: 'bold' },\r\n    },\r\n    margin: { left: 20, right: 20 },\r\n    didDrawCell: (data: any) => {\r\n      // Draw thin separator lines\r\n      if (data.row.index < tableData.length - 1) {\r\n        doc.setDrawColor(230, 230, 230);\r\n        doc.setLineWidth(0.1);\r\n        doc.line(\r\n          data.cell.x,\r\n          data.cell.y + data.cell.height,\r\n          data.cell.x + data.cell.width,\r\n          data.cell.y + data.cell.height\r\n        );\r\n      }\r\n    },\r\n  });\r\n  \r\n  // Total - bold and clean\r\n  const totalY = (doc as any).lastAutoTable.finalY + 15;\r\n  doc.setDrawColor(accentRgb.r, accentRgb.g, accentRgb.b);\r\n  doc.setLineWidth(2);\r\n  doc.line(20, totalY, pageWidth - 20, totalY);\r\n  \r\n  doc.setFontSize(11);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setTextColor(100, 100, 100);\r\n  doc.text('TOTAL', 20, totalY + 10);\r\n  \r\n  doc.setFontSize(24);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.text(`Rs. ${data.finalSellingPrice.toFixed(2)}`, pageWidth - 20, totalY + 10, { align: 'right' });\r\n  \r\n  // Footer - minimal\r\n  const footerY = doc.internal.pageSize.getHeight() - 20;\r\n  doc.setFontSize(8);\r\n  doc.setTextColor(150, 150, 150);\r\n  doc.setFont('helvetica', 'normal');\r\n  if (data.vendorBranding?.email) {\r\n    doc.text(data.vendorBranding.email, 20, footerY);\r\n  }\r\n  if (data.vendorBranding?.phone) {\r\n    doc.text(data.vendorBranding.phone, pageWidth - 20, footerY, { align: 'right' });\r\n  }\r\n  \r\n  const fileName = `Invoice_${data.invoiceNumber.replace(/[^a-z0-9]/gi, '_')}_Modern.pdf`;\r\n  doc.save(fileName);\r\n};\r\n\r\n// Luxury Template - Premium elegant design with gold accents\r\nconst generateLuxuryInvoice = async (data: InvoiceData) => {\r\n  const doc = new jsPDF();\r\n  const pageWidth = doc.internal.pageSize.getWidth();\r\n  const pageHeight = doc.internal.pageSize.getHeight();\r\n  \r\n  // Luxury color palette\r\n  const deepPurple = { r: 25, g: 20, b: 40 };\r\n  const gold = { r: 212, g: 175, b: 55 };\r\n  const cream = { r: 250, g: 248, b: 240 };\r\n  \r\n  // Elegant background\r\n  doc.setFillColor(cream.r, cream.g, cream.b);\r\n  doc.rect(0, 0, pageWidth, pageHeight, 'F');\r\n  \r\n  // Top gold accent bar\r\n  doc.setFillColor(gold.r, gold.g, gold.b);\r\n  doc.rect(0, 0, pageWidth, 8, 'F');\r\n  \r\n  // Ornamental corners\r\n  doc.setDrawColor(gold.r, gold.g, gold.b);\r\n  doc.setLineWidth(1);\r\n  const cornerSize = 15;\r\n  // Top left\r\n  doc.line(15, 15, 15 + cornerSize, 15);\r\n  doc.line(15, 15, 15, 15 + cornerSize);\r\n  // Top right\r\n  doc.line(pageWidth - 15, 15, pageWidth - 15 - cornerSize, 15);\r\n  doc.line(pageWidth - 15, 15, pageWidth - 15, 15 + cornerSize);\r\n  // Bottom left\r\n  doc.line(15, pageHeight - 15, 15 + cornerSize, pageHeight - 15);\r\n  doc.line(15, pageHeight - 15, 15, pageHeight - 15 - cornerSize);\r\n  // Bottom right\r\n  doc.line(pageWidth - 15, pageHeight - 15, pageWidth - 15 - cornerSize, pageHeight - 15);\r\n  doc.line(pageWidth - 15, pageHeight - 15, pageWidth - 15, pageHeight - 15 - cornerSize);\r\n  \r\n  // Business name with luxury styling\r\n  let yPos = 35;\r\n  doc.setFontSize(28);\r\n  doc.setFont('times', 'bold');\r\n  doc.setTextColor(deepPurple.r, deepPurple.g, deepPurple.b);\r\n  doc.text(data.vendorBranding?.name?.toUpperCase() || 'PRESTIGE JEWELERS', pageWidth / 2, yPos, { align: 'center' });\r\n  \r\n  // Tagline with gold\r\n  if (data.vendorBranding?.tagline) {\r\n    yPos += 8;\r\n    doc.setFontSize(10);\r\n    doc.setFont('times', 'italic');\r\n    doc.setTextColor(gold.r, gold.g, gold.b);\r\n    doc.text(data.vendorBranding.tagline, pageWidth / 2, yPos, { align: 'center' });\r\n  }\r\n  \r\n  // Decorative divider\r\n  yPos += 10;\r\n  doc.setDrawColor(gold.r, gold.g, gold.b);\r\n  doc.setLineWidth(0.5);\r\n  doc.line(60, yPos, pageWidth - 60, yPos);\r\n  // Small diamond shapes\r\n  doc.setFillColor(gold.r, gold.g, gold.b);\r\n  [70, pageWidth / 2, pageWidth - 70].forEach(x => {\r\n    doc.circle(x, yPos, 0.8, 'F');\r\n  });\r\n  \r\n  // INVOICE title\r\n  yPos += 12;\r\n  doc.setFontSize(20);\r\n  doc.setFont('times', 'bold');\r\n  doc.setTextColor(deepPurple.r, deepPurple.g, deepPurple.b);\r\n  const invoiceLabel = getInvoiceTypeLabel(data.invoiceType);\r\n  doc.text(invoiceLabel, pageWidth / 2, yPos, { align: 'center' });\r\n  \r\n  // Elegant info boxes\r\n  yPos += 15;\r\n  // Left box - Invoice details\r\n  doc.setFillColor(255, 255, 255);\r\n  doc.setDrawColor(gold.r, gold.g, gold.b);\r\n  doc.setLineWidth(0.5);\r\n  doc.rect(25, yPos, 75, 28, 'FD');\r\n  \r\n  doc.setFontSize(9);\r\n  doc.setFont('times', 'bold');\r\n  doc.setTextColor(gold.r, gold.g, gold.b);\r\n  doc.text('INVOICE NO.', 30, yPos + 7);\r\n  doc.setFont('times', 'normal');\r\n  doc.setTextColor(deepPurple.r, deepPurple.g, deepPurple.b);\r\n  doc.text(data.invoiceNumber, 30, yPos + 12);\r\n  \r\n  doc.setFont('times', 'bold');\r\n  doc.setTextColor(gold.r, gold.g, gold.b);\r\n  doc.text('DATE', 30, yPos + 19);\r\n  doc.setFont('times', 'normal');\r\n  doc.setTextColor(deepPurple.r, deepPurple.g, deepPurple.b);\r\n  doc.text(new Date(data.invoiceDate).toLocaleDateString(), 30, yPos + 24);\r\n  \r\n  // Right box - Customer details\r\n  doc.setFillColor(255, 255, 255);\r\n  doc.rect(pageWidth - 100, yPos, 75, 28, 'FD');\r\n  \r\n  doc.setFont('times', 'bold');\r\n  doc.setTextColor(gold.r, gold.g, gold.b);\r\n  doc.text('ESTEEMED CLIENT', pageWidth - 95, yPos + 7);\r\n  doc.setFont('times', 'normal');\r\n  doc.setTextColor(deepPurple.r, deepPurple.g, deepPurple.b);\r\n  if (data.customerName) {\r\n    doc.text(data.customerName, pageWidth - 95, yPos + 13);\r\n  }\r\n  if (data.customerPhone) {\r\n    doc.setFontSize(8);\r\n    doc.text(data.customerPhone, pageWidth - 95, yPos + 18);\r\n  }\r\n  if (data.customerEmail) {\r\n    doc.setFontSize(7);\r\n    const emailText = doc.splitTextToSize(data.customerEmail, 70);\r\n    doc.text(emailText, pageWidth - 95, yPos + 23);\r\n  }\r\n  \r\n  // Itemized costs table\r\n  yPos += 40;\r\n  const tableData = [\r\n    ['Fine Gold Workmanship', `Rs. ${data.goldCost.toFixed(2)}`],\r\n    ['Precious Diamond Selection', `Rs. ${data.diamondCost.toFixed(2)}`],\r\n    ['Gemstone Accents', `Rs. ${data.gemstoneCost.toFixed(2)}`],\r\n    ['Master Craftsmanship', `Rs. ${data.makingCharges.toFixed(2)}`],\r\n    ['Bespoke Design Services', `Rs. ${data.cadDesignCharges.toFixed(2)}`],\r\n    ['Finishing & Polish', `Rs. ${data.cammingCharges.toFixed(2)}`],\r\n    ['Authentication Certificate', `Rs. ${data.certificationCost.toFixed(2)}`],\r\n  ];\r\n  \r\n  autoTable(doc, {\r\n    startY: yPos,\r\n    body: tableData,\r\n    theme: 'plain',\r\n    styles: { \r\n      font: 'times',\r\n      fontSize: 10,\r\n      textColor: [deepPurple.r, deepPurple.g, deepPurple.b],\r\n      cellPadding: { top: 3, bottom: 3 },\r\n    },\r\n    columnStyles: {\r\n      0: { cellWidth: 130, fontStyle: 'italic' },\r\n      1: { cellWidth: 45, halign: 'right', fontStyle: 'bold' },\r\n    },\r\n    margin: { left: 25, right: 25 },\r\n    didDrawCell: (data: any) => {\r\n      doc.setDrawColor(gold.r, gold.g, gold.b);\r\n      doc.setLineWidth(0.1);\r\n      doc.line(\r\n        data.cell.x,\r\n        data.cell.y + data.cell.height,\r\n        data.cell.x + data.cell.width,\r\n        data.cell.y + data.cell.height\r\n      );\r\n    },\r\n  });\r\n  \r\n  // Grand total section with luxury styling\r\n  const totalY = (doc as any).lastAutoTable.finalY + 15;\r\n  doc.setFillColor(deepPurple.r, deepPurple.g, deepPurple.b);\r\n  doc.rect(pageWidth - 110, totalY, 85, 22, 'F');\r\n  \r\n  doc.setFontSize(11);\r\n  doc.setFont('times', 'bold');\r\n  doc.setTextColor(gold.r, gold.g, gold.b);\r\n  doc.text('TOTAL INVESTMENT', pageWidth - 105, totalY + 8);\r\n  \r\n  doc.setFontSize(18);\r\n  doc.setTextColor(255, 255, 255);\r\n  doc.text(`Rs. ${data.finalSellingPrice.toFixed(2)}`, pageWidth - 105, totalY + 17);\r\n  \r\n  // Elegant footer\r\n  const footerY = pageHeight - 30;\r\n  doc.setDrawColor(gold.r, gold.g, gold.b);\r\n  doc.setLineWidth(0.3);\r\n  doc.line(25, footerY, pageWidth - 25, footerY);\r\n  \r\n  doc.setFontSize(8);\r\n  doc.setFont('times', 'italic');\r\n  doc.setTextColor(gold.r, gold.g, gold.b);\r\n  doc.text('Thank you for choosing exceptional luxury', pageWidth / 2, footerY + 6, { align: 'center' });\r\n  \r\n  if (data.vendorBranding?.phone || data.vendorBranding?.email) {\r\n    doc.setFontSize(7);\r\n    doc.setTextColor(deepPurple.r, deepPurple.g, deepPurple.b);\r\n    let contactText = '';\r\n    if (data.vendorBranding.phone) contactText += data.vendorBranding.phone;\r\n    if (data.vendorBranding.phone && data.vendorBranding.email) contactText += ' | ';\r\n    if (data.vendorBranding.email) contactText += data.vendorBranding.email;\r\n    doc.text(contactText, pageWidth / 2, footerY + 12, { align: 'center' });\r\n  }\r\n  \r\n  const fileName = `Invoice_${data.invoiceNumber.replace(/[^a-z0-9]/gi, '_')}_Luxury.pdf`;\r\n  doc.save(fileName);\r\n};\r\n\r\n// Loose Diamond Invoice Template - specialized for loose diamond sales\r\nconst generateLooseDiamondInvoice = async (data: InvoiceData) => {\r\n  const doc = new jsPDF();\r\n  const pageWidth = doc.internal.pageSize.getWidth();\r\n  const pageHeight = doc.internal.pageSize.getHeight();\r\n  \r\n  // Diamond-themed colors\r\n  const diamondBlue = { r: 37, g: 99, b: 235 };\r\n  const crystalWhite = { r: 248, g: 250, b: 252 };\r\n  const deepGray = { r: 30, g: 41, b: 59 };\r\n  const accentSilver = { r: 148, g: 163, b: 184 };\r\n  \r\n  // Parse vendor colors if available\r\n  const primaryColor = data.vendorBranding?.primaryColor || '#2563eb';\r\n  const hexToRgb = (hex: string) => {\r\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n    return result ? {\r\n      r: parseInt(result[1], 16),\r\n      g: parseInt(result[2], 16),\r\n      b: parseInt(result[3], 16)\r\n    } : diamondBlue;\r\n  };\r\n  const primaryRgb = hexToRgb(primaryColor);\r\n  \r\n  // Header with diamond motif\r\n  doc.setFillColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.rect(0, 0, pageWidth, 45, 'F');\r\n  \r\n  // Diamond pattern accent\r\n  doc.setFillColor(255, 255, 255);\r\n  doc.setGState(new (doc as any).GState({ opacity: 0.1 }));\r\n  for (let i = 0; i < 5; i++) {\r\n    const x = 20 + i * 40;\r\n    doc.moveTo(x, 22);\r\n    doc.lineTo(x + 8, 10);\r\n    doc.lineTo(x + 16, 22);\r\n    doc.lineTo(x + 8, 34);\r\n    doc.close();\r\n    doc.fill();\r\n  }\r\n  doc.setGState(new (doc as any).GState({ opacity: 1 }));\r\n  \r\n  // Invoice Type Label\r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setTextColor(255, 255, 255);\r\n  const invoiceTypeLabel = getInvoiceTypeLabel(data.invoiceType);\r\n  doc.text(invoiceTypeLabel, pageWidth - 20, 12, { align: 'right' });\r\n  \r\n  // Main Title\r\n  doc.setFontSize(24);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(255, 255, 255);\r\n  doc.text('LOOSE DIAMOND INVOICE', 20, 28);\r\n  \r\n  // Invoice Number\r\n  doc.setFontSize(11);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.text(`Invoice: ${data.invoiceNumber}`, 20, 38);\r\n  \r\n  // Vendor logo on header right\r\n  let logoWidth = 0;\r\n  if (data.vendorBranding?.logo) {\r\n    try {\r\n      const logoBase64 = await loadImageAsBase64(data.vendorBranding.logo);\r\n      if (logoBase64) {\r\n        // Add white background for logo\r\n        doc.setFillColor(255, 255, 255);\r\n        doc.roundedRect(pageWidth - 45, 8, 30, 30, 2, 2, 'F');\r\n        doc.addImage(logoBase64, 'PNG', pageWidth - 43, 10, 26, 26);\r\n        logoWidth = 35;\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading logo:', error);\r\n    }\r\n  }\r\n  \r\n  // Vendor info on header right (adjusted for logo)\r\n  const vendorTextX = logoWidth > 0 ? pageWidth - 50 : pageWidth - 20;\r\n  if (data.vendorBranding?.name) {\r\n    doc.setFontSize(12);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text(data.vendorBranding.name, vendorTextX, 28, { align: 'right' });\r\n  }\r\n  if (data.vendorBranding?.phone) {\r\n    doc.setFontSize(9);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.text(`Tel: ${data.vendorBranding.phone}`, vendorTextX, 38, { align: 'right' });\r\n  }\r\n  \r\n  let yPos = 55;\r\n  \r\n  // Date and Payment Status Row\r\n  doc.setFillColor(crystalWhite.r, crystalWhite.g, crystalWhite.b);\r\n  doc.rect(0, yPos, pageWidth, 18, 'F');\r\n  \r\n  doc.setFontSize(9);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n  doc.text(`Date: ${data.invoiceDate}`, 20, yPos + 11);\r\n  \r\n  if (data.paymentDueDate) {\r\n    doc.text(`Due: ${data.paymentDueDate}`, 80, yPos + 11);\r\n  }\r\n  \r\n  // Payment Status Badge\r\n  if (data.status) {\r\n    const statusColors: Record<string, { bg: [number, number, number]; text: [number, number, number] }> = {\r\n      paid: { bg: [220, 252, 231], text: [22, 163, 74] },\r\n      partial: { bg: [254, 249, 195], text: [202, 138, 4] },\r\n      pending: { bg: [254, 226, 226], text: [220, 38, 38] },\r\n    };\r\n    const statusConfig = statusColors[data.status] || statusColors.pending;\r\n    const statusText = data.status.toUpperCase();\r\n    const statusWidth = doc.getTextWidth(statusText) + 12;\r\n    \r\n    doc.setFillColor(...statusConfig.bg);\r\n    doc.roundedRect(pageWidth - 20 - statusWidth, yPos + 4, statusWidth, 10, 2, 2, 'F');\r\n    doc.setFontSize(8);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(...statusConfig.text);\r\n    doc.text(statusText, pageWidth - 20 - statusWidth + 6, yPos + 11);\r\n  }\r\n  \r\n  yPos += 25;\r\n  \r\n  // Customer Information Section\r\n  doc.setFontSize(11);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.text('BILL TO', 20, yPos);\r\n  \r\n  yPos += 6;\r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n  \r\n  if (data.customerName) {\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text(data.customerName, 20, yPos);\r\n    yPos += 5;\r\n    doc.setFont('helvetica', 'normal');\r\n  }\r\n  if (data.customerPhone) {\r\n    doc.text(`Phone: ${data.customerPhone}`, 20, yPos);\r\n    yPos += 5;\r\n  }\r\n  if (data.customerEmail) {\r\n    doc.text(`Email: ${data.customerEmail}`, 20, yPos);\r\n    yPos += 5;\r\n  }\r\n  if (data.customerAddress) {\r\n    const addressLines = doc.splitTextToSize(data.customerAddress, 80);\r\n    doc.text(addressLines, 20, yPos);\r\n    yPos += addressLines.length * 5;\r\n  }\r\n  \r\n  yPos += 10;\r\n  \r\n  // Diamond Specifications Table Header\r\n  doc.setFillColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.rect(15, yPos, pageWidth - 30, 10, 'F');\r\n  \r\n  doc.setFontSize(9);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(255, 255, 255);\r\n  doc.text('DIAMOND SPECIFICATIONS', 20, yPos + 7);\r\n  doc.text('AMOUNT', pageWidth - 20, yPos + 7, { align: 'right' });\r\n  \r\n  yPos += 15;\r\n  \r\n  // Collect certificate images for later\r\n  const certificateImages: { itemName: string; imageUrl: string }[] = [];\r\n  \r\n  // Line items for loose diamonds\r\n  if (data.lineItems && data.lineItems.length > 0) {\r\n    for (let index = 0; index < data.lineItems.length; index++) {\r\n      const item = data.lineItems[index];\r\n      \r\n      // Alternate row background\r\n      if (index % 2 === 0) {\r\n        doc.setFillColor(248, 250, 252);\r\n        doc.rect(15, yPos - 4, pageWidth - 30, 40, 'F');\r\n      }\r\n      \r\n      // Item name with certificate indicator\r\n      doc.setFontSize(10);\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n      const itemName = item.item_name || `Diamond ${index + 1}`;\r\n      doc.text(itemName, 20, yPos);\r\n      \r\n      // If certificate exists, add indicator and store for later\r\n      if (item.certificate_image_url) {\r\n        certificateImages.push({ itemName, imageUrl: item.certificate_image_url });\r\n        doc.setFontSize(7);\r\n        doc.setFont('helvetica', 'italic');\r\n        doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n        doc.text('(Certificate - Page 2)', 20 + doc.getTextWidth(itemName) + 5, yPos);\r\n      }\r\n      \r\n      // Diamond 4Cs specifications\r\n      doc.setFontSize(8);\r\n      doc.setFont('helvetica', 'normal');\r\n      doc.setTextColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n      \r\n      let specY = yPos + 5;\r\n      const specs = [];\r\n      if (item.diamond_weight) specs.push(`Weight: ${item.diamond_weight} ct`);\r\n      if (item.diamond_color) specs.push(`Color: ${item.diamond_color}`);\r\n      if (item.diamond_clarity) specs.push(`Clarity: ${item.diamond_clarity}`);\r\n      if (item.diamond_cut) specs.push(`Cut: ${item.diamond_cut}`);\r\n      if (item.diamond_shape) specs.push(`Shape: ${item.diamond_shape}`);\r\n      if (item.diamond_certification) specs.push(`Cert: ${item.diamond_certification}`);\r\n      \r\n      const specLine1 = specs.slice(0, 3).join(' | ');\r\n      const specLine2 = specs.slice(3).join(' | ');\r\n      \r\n      doc.text(specLine1, 20, specY);\r\n      if (specLine2) {\r\n        doc.text(specLine2, 20, specY + 4);\r\n      }\r\n      \r\n      // Additional specs line\r\n      const additionalSpecs = [];\r\n      if (item.diamond_fluorescence) additionalSpecs.push(`Fluorescence: ${item.diamond_fluorescence}`);\r\n      if (item.diamond_measurements) additionalSpecs.push(`Measurements: ${item.diamond_measurements}`);\r\n      if (additionalSpecs.length > 0) {\r\n        doc.text(additionalSpecs.join(' | '), 20, specY + 8);\r\n      }\r\n      \r\n      // Per carat price\r\n      if (item.diamond_per_carat_price) {\r\n        doc.setTextColor(100, 116, 139);\r\n        doc.text(`Rs. ${item.diamond_per_carat_price.toLocaleString('en-IN')} /ct`, 20, specY + 14);\r\n      }\r\n      \r\n      // Subtotal\r\n      doc.setFontSize(11);\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n      doc.text(formatCurrency(item.diamond_cost || item.subtotal || 0), pageWidth - 20, yPos, { align: 'right' });\r\n      \r\n      yPos += 44;\r\n    }\r\n  } else {\r\n    // Single diamond info from main data\r\n    doc.setFillColor(248, 250, 252);\r\n    doc.rect(15, yPos - 4, pageWidth - 30, 25, 'F');\r\n    \r\n    doc.setFontSize(10);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n    doc.text('Loose Diamond', 20, yPos);\r\n    \r\n    doc.setFontSize(8);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n    doc.text(`Weight: ${data.netWeight || 0} ct`, 20, yPos + 5);\r\n    \r\n    doc.setFontSize(11);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n    doc.text(formatCurrency(data.diamondCost || 0), pageWidth - 20, yPos, { align: 'right' });\r\n    \r\n    yPos += 30;\r\n  }\r\n  \r\n  // Cost breakdown section\r\n  yPos += 5;\r\n  doc.setDrawColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n  doc.setLineWidth(0.3);\r\n  doc.line(15, yPos, pageWidth - 15, yPos);\r\n  yPos += 8;\r\n  \r\n  // Additional costs (if any)\r\n  const additionalCosts = [\r\n    { label: 'Certification Cost', value: data.certificationCost },\r\n    { label: 'Shipping Charges', value: data.shippingCharges },\r\n  ].filter(c => c.value && c.value > 0);\r\n  \r\n  if (additionalCosts.length > 0) {\r\n    doc.setFontSize(9);\r\n    additionalCosts.forEach(cost => {\r\n      doc.setFont('helvetica', 'normal');\r\n      doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n      doc.text(cost.label, 20, yPos);\r\n      doc.text(formatCurrency(cost.value || 0), pageWidth - 20, yPos, { align: 'right' });\r\n      yPos += 6;\r\n    });\r\n  }\r\n  \r\n  // GST if applicable\r\n  if (data.gstMode === 'sgst_cgst' && (data.sgstAmount || data.cgstAmount)) {\r\n    doc.setFontSize(9);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n    if (data.sgstAmount) {\r\n      doc.text(`SGST (${data.sgstPercentage}%)`, 20, yPos);\r\n      doc.text(formatCurrency(data.sgstAmount), pageWidth - 20, yPos, { align: 'right' });\r\n      yPos += 6;\r\n    }\r\n    if (data.cgstAmount) {\r\n      doc.text(`CGST (${data.cgstPercentage}%)`, 20, yPos);\r\n      doc.text(formatCurrency(data.cgstAmount), pageWidth - 20, yPos, { align: 'right' });\r\n      yPos += 6;\r\n    }\r\n  } else if (data.gstMode === 'igst' && data.igstAmount) {\r\n    doc.setFontSize(9);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n    doc.text(`IGST (${data.igstPercentage}%)`, 20, yPos);\r\n    doc.text(formatCurrency(data.igstAmount), pageWidth - 20, yPos, { align: 'right' });\r\n    yPos += 6;\r\n  }\r\n  \r\n  yPos += 5;\r\n  \r\n  // Grand Total Box\r\n  doc.setFillColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.roundedRect(pageWidth - 95, yPos, 80, 22, 3, 3, 'F');\r\n  \r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(255, 255, 255);\r\n  doc.text('GRAND TOTAL', pageWidth - 90, yPos + 8);\r\n  \r\n  doc.setFontSize(14);\r\n  doc.text(formatCurrency(data.grandTotal || data.finalSellingPrice || 0), pageWidth - 90, yPos + 17);\r\n  \r\n  // USD Equivalent if available\r\n  if (data.exchangeRate && data.grandTotal) {\r\n    yPos += 28;\r\n    doc.setFontSize(9);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n    const usdAmount = (data.grandTotal / data.exchangeRate).toFixed(2);\r\n    doc.text(`USD Equivalent: $ ${Number(usdAmount).toLocaleString('en-US')} (Rate: ${data.exchangeRate})`, pageWidth - 20, yPos, { align: 'right' });\r\n  }\r\n  \r\n  // Notes section\r\n  if (data.invoiceNotes) {\r\n    yPos += 15;\r\n    doc.setFillColor(248, 250, 252);\r\n    doc.roundedRect(15, yPos, pageWidth - 30, 25, 2, 2, 'F');\r\n    \r\n    doc.setFontSize(8);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n    doc.text('NOTES', 20, yPos + 6);\r\n    \r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n    const noteLines = doc.splitTextToSize(data.invoiceNotes, pageWidth - 50);\r\n    doc.text(noteLines.slice(0, 2), 20, yPos + 12);\r\n  }\r\n  \r\n  // Footer\r\n  const footerY = pageHeight - 25;\r\n  doc.setDrawColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.setLineWidth(0.5);\r\n  doc.line(15, footerY, pageWidth - 15, footerY);\r\n  \r\n  doc.setFontSize(8);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setTextColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n  doc.text('Thank you for your business', pageWidth / 2, footerY + 6, { align: 'center' });\r\n  \r\n  if (data.vendorBranding?.email || data.vendorBranding?.phone) {\r\n    let contactInfo = '';\r\n    if (data.vendorBranding.phone) contactInfo += `Tel: ${data.vendorBranding.phone}`;\r\n    if (data.vendorBranding.phone && data.vendorBranding.email) contactInfo += ' | ';\r\n    if (data.vendorBranding.email) contactInfo += `Email: ${data.vendorBranding.email}`;\r\n    doc.text(contactInfo, pageWidth / 2, footerY + 12, { align: 'center' });\r\n  }\r\n  \r\n  // Calculate total pages\r\n  const totalPages = certificateImages.length > 0 ? 2 : 1;\r\n  \r\n  // Page number\r\n  doc.setFontSize(7);\r\n  doc.text(`Page 1 of ${totalPages}`, pageWidth - 20, footerY + 18, { align: 'right' });\r\n  \r\n  // Add certificate images page if any certificates exist\r\n  if (certificateImages.length > 0) {\r\n    doc.addPage();\r\n    let certYPos = 20;\r\n    \r\n    // Certificate page header\r\n    doc.setFillColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n    doc.rect(0, 0, pageWidth, 30, 'F');\r\n    \r\n    doc.setFontSize(18);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(255, 255, 255);\r\n    doc.text('DIAMOND CERTIFICATES', 20, 20);\r\n    \r\n    doc.setFontSize(10);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.text(`Invoice: ${data.invoiceNumber}`, pageWidth - 20, 20, { align: 'right' });\r\n    \r\n    certYPos = 45;\r\n    \r\n    // Load and add certificate images\r\n    for (let i = 0; i < certificateImages.length; i++) {\r\n      const cert = certificateImages[i];\r\n      \r\n      // Check if we need a new page (leave room for image + caption)\r\n      if (certYPos > pageHeight - 100) {\r\n        doc.addPage();\r\n        certYPos = 20;\r\n      }\r\n      \r\n      // Certificate label\r\n      doc.setFontSize(11);\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n      doc.text(`Certificate for: ${cert.itemName}`, 20, certYPos);\r\n      certYPos += 8;\r\n      \r\n      // Try to load and embed the certificate image\r\n      try {\r\n        const imageData = await loadImageAsBase64(cert.imageUrl);\r\n        if (imageData) {\r\n          // Calculate image dimensions to fit the page\r\n          const maxWidth = pageWidth - 40;\r\n          const maxHeight = 120;\r\n          \r\n          // Add image with border\r\n          doc.setDrawColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n          doc.setLineWidth(0.5);\r\n          doc.rect(19, certYPos - 1, maxWidth + 2, maxHeight + 2, 'S');\r\n          \r\n          doc.addImage(imageData, 'JPEG', 20, certYPos, maxWidth, maxHeight);\r\n          certYPos += maxHeight + 15;\r\n        } else {\r\n          // Fallback if image fails to load\r\n          doc.setFontSize(9);\r\n          doc.setFont('helvetica', 'italic');\r\n          doc.setTextColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n          doc.text('Certificate image could not be loaded', 20, certYPos);\r\n          certYPos += 15;\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading certificate image:', error);\r\n        doc.setFontSize(9);\r\n        doc.setFont('helvetica', 'italic');\r\n        doc.setTextColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n        doc.text('Certificate image could not be loaded', 20, certYPos);\r\n        certYPos += 15;\r\n      }\r\n    }\r\n    \r\n    // Footer on certificate page\r\n    const certFooterY = pageHeight - 15;\r\n    doc.setFontSize(7);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n    doc.text(`Page 2 of ${totalPages}`, pageWidth - 20, certFooterY, { align: 'right' });\r\n    \r\n    if (data.vendorBranding?.name) {\r\n      doc.text(data.vendorBranding.name, 20, certFooterY);\r\n    }\r\n  }\r\n  \r\n  const fileName = `Invoice_${data.invoiceNumber.replace(/[^a-z0-9]/gi, '_')}_LooseDiamond.pdf`;\r\n  doc.save(fileName);\r\n};\r\n\r\n// Gemstone Invoice Template - Similar to Loose Diamond but with gemstone-focused styling\r\nconst generateGemstoneInvoice = async (data: InvoiceData) => {\r\n  const doc = new jsPDF();\r\n  const pageWidth = doc.internal.pageSize.getWidth();\r\n  const pageHeight = doc.internal.pageSize.getHeight();\r\n  \r\n  // Gemstone-inspired color palette\r\n  const emeraldGreen = { r: 16, g: 185, b: 129 };\r\n  const deepGray = { r: 30, g: 41, b: 59 };\r\n  const crystalWhite = { r: 248, g: 250, b: 252 };\r\n  const accentSilver = { r: 100, g: 116, b: 139 };\r\n  \r\n  const primaryColor = data.vendorBranding?.primaryColor || '#10b981';\r\n  const hexToRgb = (hex: string) => {\r\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n    return result ? {\r\n      r: parseInt(result[1], 16),\r\n      g: parseInt(result[2], 16),\r\n      b: parseInt(result[3], 16)\r\n    } : emeraldGreen;\r\n  };\r\n  const primaryRgb = hexToRgb(primaryColor);\r\n  \r\n  // Header with gemstone motif\r\n  doc.setFillColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.rect(0, 0, pageWidth, 45, 'F');\r\n  \r\n  // Gemstone pattern accent (hexagonal shapes)\r\n  doc.setFillColor(255, 255, 255);\r\n  doc.setGState(new (doc as any).GState({ opacity: 0.1 }));\r\n  for (let i = 0; i < 6; i++) {\r\n    const x = 15 + i * 35;\r\n    doc.moveTo(x, 22);\r\n    doc.lineTo(x + 6, 12);\r\n    doc.lineTo(x + 14, 12);\r\n    doc.lineTo(x + 20, 22);\r\n    doc.lineTo(x + 14, 32);\r\n    doc.lineTo(x + 6, 32);\r\n    doc.close();\r\n    doc.fill();\r\n  }\r\n  doc.setGState(new (doc as any).GState({ opacity: 1 }));\r\n  \r\n  // Invoice Type Label\r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setTextColor(255, 255, 255);\r\n  const invoiceTypeLabel = getInvoiceTypeLabel(data.invoiceType);\r\n  doc.text(invoiceTypeLabel, pageWidth - 20, 12, { align: 'right' });\r\n  \r\n  // Main Title\r\n  doc.setFontSize(24);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(255, 255, 255);\r\n  doc.text('GEMSTONE INVOICE', 20, 28);\r\n  \r\n  // Invoice Number\r\n  doc.setFontSize(11);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.text(`Invoice: ${data.invoiceNumber}`, 20, 38);\r\n  \r\n  // Vendor logo on header right\r\n  let logoWidth = 0;\r\n  if (data.vendorBranding?.logo) {\r\n    try {\r\n      const logoBase64 = await loadImageAsBase64(data.vendorBranding.logo);\r\n      if (logoBase64) {\r\n        // Add white background for logo\r\n        doc.setFillColor(255, 255, 255);\r\n        doc.roundedRect(pageWidth - 45, 8, 30, 30, 2, 2, 'F');\r\n        doc.addImage(logoBase64, 'PNG', pageWidth - 43, 10, 26, 26);\r\n        logoWidth = 35;\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading logo:', error);\r\n    }\r\n  }\r\n  \r\n  // Vendor info on header right (adjusted for logo)\r\n  const vendorTextX = logoWidth > 0 ? pageWidth - 50 : pageWidth - 20;\r\n  if (data.vendorBranding?.name) {\r\n    doc.setFontSize(12);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text(data.vendorBranding.name, vendorTextX, 28, { align: 'right' });\r\n  }\r\n  if (data.vendorBranding?.phone) {\r\n    doc.setFontSize(9);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.text(`Tel: ${data.vendorBranding.phone}`, vendorTextX, 38, { align: 'right' });\r\n  }\r\n  \r\n  let yPos = 55;\r\n  \r\n  // Date and Payment Status Row\r\n  doc.setFillColor(crystalWhite.r, crystalWhite.g, crystalWhite.b);\r\n  doc.rect(0, yPos, pageWidth, 18, 'F');\r\n  \r\n  doc.setFontSize(9);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n  doc.text(`Date: ${data.invoiceDate}`, 20, yPos + 11);\r\n  \r\n  if (data.paymentDueDate) {\r\n    doc.text(`Due: ${data.paymentDueDate}`, 80, yPos + 11);\r\n  }\r\n  \r\n  // Payment Status Badge\r\n  if (data.status) {\r\n    const statusColors: Record<string, { bg: [number, number, number]; text: [number, number, number] }> = {\r\n      paid: { bg: [220, 252, 231], text: [22, 163, 74] },\r\n      partial: { bg: [254, 249, 195], text: [202, 138, 4] },\r\n      pending: { bg: [254, 226, 226], text: [220, 38, 38] },\r\n    };\r\n    const statusConfig = statusColors[data.status] || statusColors.pending;\r\n    const statusText = data.status.toUpperCase();\r\n    const statusWidth = doc.getTextWidth(statusText) + 12;\r\n    \r\n    doc.setFillColor(...statusConfig.bg);\r\n    doc.roundedRect(pageWidth - 20 - statusWidth, yPos + 4, statusWidth, 10, 2, 2, 'F');\r\n    doc.setFontSize(8);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(...statusConfig.text);\r\n    doc.text(statusText, pageWidth - 20 - statusWidth + 6, yPos + 11);\r\n  }\r\n  \r\n  yPos += 25;\r\n  \r\n  // Customer Information Section\r\n  doc.setFontSize(11);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.text('BILL TO', 20, yPos);\r\n  \r\n  yPos += 6;\r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n  \r\n  if (data.customerName) {\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text(data.customerName, 20, yPos);\r\n    yPos += 5;\r\n    doc.setFont('helvetica', 'normal');\r\n  }\r\n  if (data.customerPhone) {\r\n    doc.text(`Phone: ${data.customerPhone}`, 20, yPos);\r\n    yPos += 5;\r\n  }\r\n  if (data.customerEmail) {\r\n    doc.text(`Email: ${data.customerEmail}`, 20, yPos);\r\n    yPos += 5;\r\n  }\r\n  if (data.customerAddress) {\r\n    const addressLines = doc.splitTextToSize(data.customerAddress, 80);\r\n    doc.text(addressLines, 20, yPos);\r\n    yPos += addressLines.length * 5;\r\n  }\r\n  \r\n  yPos += 10;\r\n  \r\n  // Gemstone Specifications Table Header\r\n  doc.setFillColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.rect(15, yPos, pageWidth - 30, 10, 'F');\r\n  \r\n  doc.setFontSize(9);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(255, 255, 255);\r\n  doc.text('GEMSTONE SPECIFICATIONS', 20, yPos + 7);\r\n  doc.text('AMOUNT', pageWidth - 20, yPos + 7, { align: 'right' });\r\n  \r\n  yPos += 15;\r\n  \r\n  // Collect certificate images for later\r\n  const certificateImages: { itemName: string; imageUrl: string }[] = [];\r\n  \r\n  // Line items for gemstones\r\n  if (data.lineItems && data.lineItems.length > 0) {\r\n    for (let index = 0; index < data.lineItems.length; index++) {\r\n      const item = data.lineItems[index];\r\n      \r\n      // Alternate row background\r\n      if (index % 2 === 0) {\r\n        doc.setFillColor(248, 250, 252);\r\n        doc.rect(15, yPos - 4, pageWidth - 30, 44, 'F');\r\n      }\r\n      \r\n      // Item name with certificate indicator\r\n      doc.setFontSize(10);\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n      const itemName = item.item_name || item.gemstone_type || `Gemstone ${index + 1}`;\r\n      doc.text(itemName, 20, yPos);\r\n      \r\n      // If certificate exists, add indicator and store for later\r\n      if (item.certificate_image_url) {\r\n        certificateImages.push({ itemName, imageUrl: item.certificate_image_url });\r\n        doc.setFontSize(7);\r\n        doc.setFont('helvetica', 'italic');\r\n        doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n        doc.text('(Certificate - Page 2)', 20 + doc.getTextWidth(itemName) + 5, yPos);\r\n      }\r\n      \r\n      // Gemstone specifications\r\n      doc.setFontSize(8);\r\n      doc.setFont('helvetica', 'normal');\r\n      doc.setTextColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n      \r\n      let specY = yPos + 5;\r\n      const specs = [];\r\n      if (item.gemstone_type) specs.push(`Type: ${item.gemstone_type}`);\r\n      if (item.gemstone_weight) specs.push(`Weight: ${item.gemstone_weight} ct`);\r\n      if (item.gemstone_color) specs.push(`Color: ${item.gemstone_color}`);\r\n      if (item.gemstone_clarity) specs.push(`Clarity: ${item.gemstone_clarity}`);\r\n      if (item.gemstone_origin) specs.push(`Origin: ${item.gemstone_origin}`);\r\n      if (item.gemstone_treatment) specs.push(`Treatment: ${item.gemstone_treatment}`);\r\n      if (item.gemstone_shape) specs.push(`Shape: ${item.gemstone_shape}`);\r\n      \r\n      const specLine1 = specs.slice(0, 3).join(' | ');\r\n      const specLine2 = specs.slice(3, 6).join(' | ');\r\n      const specLine3 = specs.slice(6).join(' | ');\r\n      \r\n      doc.text(specLine1, 20, specY);\r\n      if (specLine2) {\r\n        doc.text(specLine2, 20, specY + 4);\r\n      }\r\n      if (specLine3) {\r\n        doc.text(specLine3, 20, specY + 8);\r\n      }\r\n      \r\n      // Per carat price\r\n      if (item.gemstone_per_carat_price) {\r\n        doc.setTextColor(100, 116, 139);\r\n        doc.text(`Rs. ${item.gemstone_per_carat_price.toLocaleString('en-IN')} /ct`, 20, specY + 14);\r\n      }\r\n      \r\n      // Certification info\r\n      if (item.diamond_certification) {\r\n        doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n        doc.text(`Cert: ${item.diamond_certification}`, 20, specY + 18);\r\n      }\r\n      \r\n      // Subtotal\r\n      doc.setFontSize(11);\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n      doc.text(formatCurrency(item.gemstone_cost || item.subtotal || 0), pageWidth - 20, yPos, { align: 'right' });\r\n      \r\n      yPos += 48;\r\n    }\r\n  } else {\r\n    // Single gemstone info from main data\r\n    doc.setFillColor(248, 250, 252);\r\n    doc.rect(15, yPos - 4, pageWidth - 30, 25, 'F');\r\n    \r\n    doc.setFontSize(10);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n    doc.text('Loose Gemstone', 20, yPos);\r\n    \r\n    doc.setFontSize(8);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n    doc.text(`Weight: ${data.netWeight || 0} ct`, 20, yPos + 5);\r\n    \r\n    doc.setFontSize(11);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n    doc.text(formatCurrency(data.gemstoneCost || 0), pageWidth - 20, yPos, { align: 'right' });\r\n    \r\n    yPos += 30;\r\n  }\r\n  \r\n  // Cost breakdown section\r\n  yPos += 5;\r\n  doc.setDrawColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n  doc.setLineWidth(0.3);\r\n  doc.line(15, yPos, pageWidth - 15, yPos);\r\n  yPos += 8;\r\n  \r\n  // Additional costs\r\n  const additionalCosts = [\r\n    { label: 'Certification Cost', value: data.certificationCost },\r\n    { label: 'Shipping Charges', value: data.shippingCharges },\r\n  ].filter(c => c.value && c.value > 0);\r\n  \r\n  if (additionalCosts.length > 0) {\r\n    doc.setFontSize(9);\r\n    additionalCosts.forEach(cost => {\r\n      doc.setFont('helvetica', 'normal');\r\n      doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n      doc.text(cost.label, 20, yPos);\r\n      doc.text(formatCurrency(cost.value || 0), pageWidth - 20, yPos, { align: 'right' });\r\n      yPos += 6;\r\n    });\r\n  }\r\n  \r\n  // GST if applicable\r\n  if (data.gstMode === 'sgst_cgst' && (data.sgstAmount || data.cgstAmount)) {\r\n    doc.setFontSize(9);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n    if (data.sgstAmount) {\r\n      doc.text(`SGST (${data.sgstPercentage}%)`, 20, yPos);\r\n      doc.text(formatCurrency(data.sgstAmount), pageWidth - 20, yPos, { align: 'right' });\r\n      yPos += 6;\r\n    }\r\n    if (data.cgstAmount) {\r\n      doc.text(`CGST (${data.cgstPercentage}%)`, 20, yPos);\r\n      doc.text(formatCurrency(data.cgstAmount), pageWidth - 20, yPos, { align: 'right' });\r\n      yPos += 6;\r\n    }\r\n  } else if (data.gstMode === 'igst' && data.igstAmount) {\r\n    doc.setFontSize(9);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n    doc.text(`IGST (${data.igstPercentage}%)`, 20, yPos);\r\n    doc.text(formatCurrency(data.igstAmount), pageWidth - 20, yPos, { align: 'right' });\r\n    yPos += 6;\r\n  }\r\n  \r\n  yPos += 5;\r\n  \r\n  // Grand Total Box\r\n  doc.setFillColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.roundedRect(pageWidth - 95, yPos, 80, 22, 3, 3, 'F');\r\n  \r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(255, 255, 255);\r\n  doc.text('GRAND TOTAL', pageWidth - 90, yPos + 8);\r\n  \r\n  doc.setFontSize(14);\r\n  doc.text(formatCurrency(data.grandTotal || data.finalSellingPrice || 0), pageWidth - 90, yPos + 17);\r\n  \r\n  // USD Equivalent\r\n  if (data.exchangeRate && data.grandTotal) {\r\n    yPos += 28;\r\n    doc.setFontSize(9);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n    const usdAmount = (data.grandTotal / data.exchangeRate).toFixed(2);\r\n    doc.text(`USD Equivalent: $ ${Number(usdAmount).toLocaleString('en-US')} (Rate: ${data.exchangeRate})`, pageWidth - 20, yPos, { align: 'right' });\r\n  }\r\n  \r\n  // Notes section\r\n  if (data.invoiceNotes) {\r\n    yPos += 15;\r\n    doc.setFillColor(248, 250, 252);\r\n    doc.roundedRect(15, yPos, pageWidth - 30, 25, 2, 2, 'F');\r\n    \r\n    doc.setFontSize(8);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n    doc.text('NOTES', 20, yPos + 6);\r\n    \r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n    const noteLines = doc.splitTextToSize(data.invoiceNotes, pageWidth - 50);\r\n    doc.text(noteLines.slice(0, 2), 20, yPos + 12);\r\n  }\r\n  \r\n  // Footer\r\n  const footerY = pageHeight - 25;\r\n  doc.setDrawColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n  doc.setLineWidth(0.5);\r\n  doc.line(15, footerY, pageWidth - 15, footerY);\r\n  \r\n  doc.setFontSize(8);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setTextColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n  doc.text('Thank you for your business', pageWidth / 2, footerY + 6, { align: 'center' });\r\n  \r\n  if (data.vendorBranding?.email || data.vendorBranding?.phone) {\r\n    let contactInfo = '';\r\n    if (data.vendorBranding.phone) contactInfo += `Tel: ${data.vendorBranding.phone}`;\r\n    if (data.vendorBranding.phone && data.vendorBranding.email) contactInfo += ' | ';\r\n    if (data.vendorBranding.email) contactInfo += `Email: ${data.vendorBranding.email}`;\r\n    doc.text(contactInfo, pageWidth / 2, footerY + 12, { align: 'center' });\r\n  }\r\n  \r\n  // Calculate total pages\r\n  const totalPages = certificateImages.length > 0 ? 2 : 1;\r\n  \r\n  // Page number\r\n  doc.setFontSize(7);\r\n  doc.text(`Page 1 of ${totalPages}`, pageWidth - 20, footerY + 18, { align: 'right' });\r\n  \r\n  // Add certificate images page if any certificates exist\r\n  if (certificateImages.length > 0) {\r\n    doc.addPage();\r\n    let certYPos = 20;\r\n    \r\n    // Certificate page header\r\n    doc.setFillColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n    doc.rect(0, 0, pageWidth, 30, 'F');\r\n    \r\n    doc.setFontSize(18);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(255, 255, 255);\r\n    doc.text('GEMSTONE CERTIFICATES', 20, 20);\r\n    \r\n    doc.setFontSize(10);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.text(`Invoice: ${data.invoiceNumber}`, pageWidth - 20, 20, { align: 'right' });\r\n    \r\n    certYPos = 45;\r\n    \r\n    // Load and add certificate images\r\n    for (let i = 0; i < certificateImages.length; i++) {\r\n      const cert = certificateImages[i];\r\n      \r\n      // Check if we need a new page (leave room for image + caption)\r\n      if (certYPos > pageHeight - 100) {\r\n        doc.addPage();\r\n        certYPos = 20;\r\n      }\r\n      \r\n      // Certificate label\r\n      doc.setFontSize(11);\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.setTextColor(deepGray.r, deepGray.g, deepGray.b);\r\n      doc.text(`Certificate for: ${cert.itemName}`, 20, certYPos);\r\n      certYPos += 8;\r\n      \r\n      // Try to load and embed the certificate image\r\n      try {\r\n        const imageData = await loadImageAsBase64(cert.imageUrl);\r\n        if (imageData) {\r\n          // Calculate image dimensions to fit the page\r\n          const maxWidth = pageWidth - 40;\r\n          const maxHeight = 120;\r\n          \r\n          // Add image with border\r\n          doc.setDrawColor(primaryRgb.r, primaryRgb.g, primaryRgb.b);\r\n          doc.setLineWidth(0.5);\r\n          doc.rect(19, certYPos - 1, maxWidth + 2, maxHeight + 2, 'S');\r\n          \r\n          doc.addImage(imageData, 'JPEG', 20, certYPos, maxWidth, maxHeight);\r\n          certYPos += maxHeight + 15;\r\n        } else {\r\n          // Fallback if image fails to load\r\n          doc.setFontSize(9);\r\n          doc.setFont('helvetica', 'italic');\r\n          doc.setTextColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n          doc.text('Certificate image could not be loaded', 20, certYPos);\r\n          certYPos += 15;\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading certificate image:', error);\r\n        doc.setFontSize(9);\r\n        doc.setFont('helvetica', 'italic');\r\n        doc.setTextColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n        doc.text('Certificate image could not be loaded', 20, certYPos);\r\n        certYPos += 15;\r\n      }\r\n    }\r\n    \r\n    // Footer on certificate page\r\n    const certFooterY = pageHeight - 15;\r\n    doc.setFontSize(7);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(accentSilver.r, accentSilver.g, accentSilver.b);\r\n    doc.text(`Page 2 of ${totalPages}`, pageWidth - 20, certFooterY, { align: 'right' });\r\n    \r\n    if (data.vendorBranding?.name) {\r\n      doc.text(data.vendorBranding.name, 20, certFooterY);\r\n    }\r\n  }\r\n  \r\n  const fileName = `Invoice_${data.invoiceNumber.replace(/[^a-z0-9]/gi, '_')}_Gemstone.pdf`;\r\n  doc.save(fileName);\r\n};\r\n"],"names":["getInvoiceTypeLabel","type","formatCurrency","amount","loadImageAsBase64","url","resolve","img","canvas","ctx","dataURL","error","separator","generateInvoicePDF","data","template","generateLooseDiamondInvoice","generateGemstoneInvoice","generateSummaryInvoice","generateMinimalInvoice","generateTraditionalInvoice","generateModernInvoice","generateLuxuryInvoice","generateDetailedInvoice","doc","jsPDF","pageWidth","primaryColor","_a","secondaryColor","_b","accentColor","hexToRgb","hex","result","primaryRgb","secondaryRgb","accentRgb","_c","logoBase64","nameStartX","_d","nameAlign","_e","_f","_g","invoiceLabel","headerY","_h","_i","_j","contactY","email","splitAddress","invoiceInfoY","infoY","statusColors","statusLabels","statusConfig","statusLabel","customerSectionY","yPos","leftColY","midPoint","emailLines","addressLines","currentY","item","index","itemStartY","detailsX","descLines","itemSpecs","autoTable","itemCosts","specsData","_k","_l","_m","_n","_o","_p","_q","tableData","finalY","hasGst","hasShipping","hasGrandTotal","hasCurrency","baseHeight","gstHeight","shippingHeight","grandTotalHeight","currencyHeight","totalSectionHeight","newFinalY","renderTotalsSection","splitNotes","footerY","fileName","startY","lineY","usdAmount","summaryData","pageHeight","goldAccent","goldRgb","x","y","lineMargin","emailText","totalY","notes","deepPurple","gold","cream","cornerSize","contactText","diamondBlue","crystalWhite","deepGray","accentSilver","i","invoiceTypeLabel","logoWidth","vendorTextX","statusText","statusWidth","certificateImages","itemName","specY","specs","specLine1","specLine2","additionalSpecs","additionalCosts","c","cost","noteLines","contactInfo","totalPages","certYPos","cert","imageData","maxWidth","maxHeight","certFooterY","emeraldGreen","specLine3"],"mappings":"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"}