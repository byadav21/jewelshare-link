import{j as r}from"./query-vendor-BLxHmmGk.js";import{r as l,R as U,b as We,u as kn,h as Mn}from"./react-vendor-BeR0k5Z3.js";import{C as be,D as ye,B as te,G as Ee,H as Te,E as On,F as Ge}from"./index-DGlTgSKx.js";import{I as me}from"./input-CEHl5GoJ.js";import{L as ve}from"./label-ClRcubO_.js";import{T as Ln}from"./textarea-DU5hu0UG.js";import{bo as Fn,aR as Pn,C as zn,ay as Bn,aH as en,bp as $n,q as Un,e as Wn,bn as Gn,X as Hn,u as he,J as Xn,ak as _n,at as Yn}from"./ui-vendor-CN4tOqpp.js";import{B as Vn}from"./BackToHomeButton-Dxc739pt.js";import{S as tn}from"./switch-CO0K2nGH.js";import{B as qn}from"./badge-DknkzE8c.js";import{S as Kn,a as Jn,b as Qn,c as Zn,d as Ue}from"./select-CQfvDDtS.js";import{S as er}from"./slider-Hrq8z6J6.js";import{D as Ut}from"./invoiceTemplate-N6fQ82wS.js";import{L as tr}from"./LogoUpload-B5r2v6aH.js";import"./supabase-vendor-VSDMYZ1k.js";import"./index-DjQc2W_p.js";import"./index-BdQq_4o_.js";import"./index-BC78nHQ6.js";import"./index-aqCwQlp3.js";import"./dialog-CRWggOUB.js";import"./index-CVwUD2ep.js";function nr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo(()=>s=>{t.forEach(o=>o(s))},t)}const dt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ae(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Dt(e){return"nodeType"in e}function W(e){var t,n;return e?Ae(e)?e:Dt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Rt(e){const{Document:t}=W(e);return e instanceof t}function Ke(e){return Ae(e)?!1:e instanceof W(e).HTMLElement}function nn(e){return e instanceof W(e).SVGElement}function ke(e){return e?Ae(e)?e.document:Dt(e)?Rt(e)?e:Ke(e)||nn(e)?e.ownerDocument:document:document:document}const ne=dt?l.useLayoutEffect:l.useEffect;function St(e){const t=l.useRef(e);return ne(()=>{t.current=e}),l.useCallback(function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return t.current==null?void 0:t.current(...s)},[])}function rr(){const e=l.useRef(null),t=l.useCallback((s,o)=>{e.current=setInterval(s,o)},[]),n=l.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Ye(e,t){t===void 0&&(t=[e]);const n=l.useRef(e);return ne(()=>{n.current!==e&&(n.current=e)},t),n}function Je(e,t){const n=l.useRef();return l.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function it(e){const t=St(e),n=l.useRef(null),s=l.useCallback(o=>{o!==n.current&&(t==null||t(o,n.current)),n.current=o},[]);return[n,s]}function yt(e){const t=l.useRef();return l.useEffect(()=>{t.current=e},[e]),t.current}let vt={};function Qe(e,t){return l.useMemo(()=>{if(t)return t;const n=vt[e]==null?0:vt[e]+1;return vt[e]=n,e+"-"+n},[e,t])}function rn(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return s.reduce((i,d)=>{const a=Object.entries(d);for(const[c,f]of a){const u=i[c];u!=null&&(i[c]=u+e*f)}return i},{...t})}}const Ie=rn(1),at=rn(-1);function sr(e){return"clientX"in e&&"clientY"in e}function Et(e){if(!e)return!1;const{KeyboardEvent:t}=W(e.target);return t&&e instanceof t}function or(e){if(!e)return!1;const{TouchEvent:t}=W(e.target);return t&&e instanceof t}function wt(e){if(or(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return sr(e)?{x:e.clientX,y:e.clientY}:null}const Ve=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Ve.Translate.toString(e),Ve.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),Wt="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function ir(e){return e.matches(Wt)?e:e.querySelector(Wt)}const ar={display:"none"};function lr(e){let{id:t,value:n}=e;return U.createElement("div",{id:t,style:ar},n)}function cr(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return U.createElement("div",{id:t,style:o,role:"status","aria-live":s,"aria-atomic":!0},n)}function dr(){const[e,t]=l.useState("");return{announce:l.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const sn=l.createContext(null);function ur(e){const t=l.useContext(sn);l.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function fr(){const[e]=l.useState(()=>new Set),t=l.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[l.useCallback(s=>{let{type:o,event:i}=s;e.forEach(d=>{var a;return(a=d[o])==null?void 0:a.call(d,i)})},[e]),t]}const hr={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},pr={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function mr(e){let{announcements:t=pr,container:n,hiddenTextDescribedById:s,screenReaderInstructions:o=hr}=e;const{announce:i,announcement:d}=dr(),a=Qe("DndLiveRegion"),[c,f]=l.useState(!1);if(l.useEffect(()=>{f(!0)},[]),ur(l.useMemo(()=>({onDragStart(p){let{active:g}=p;i(t.onDragStart({active:g}))},onDragMove(p){let{active:g,over:m}=p;t.onDragMove&&i(t.onDragMove({active:g,over:m}))},onDragOver(p){let{active:g,over:m}=p;i(t.onDragOver({active:g,over:m}))},onDragEnd(p){let{active:g,over:m}=p;i(t.onDragEnd({active:g,over:m}))},onDragCancel(p){let{active:g,over:m}=p;i(t.onDragCancel({active:g,over:m}))}}),[i,t])),!c)return null;const u=U.createElement(U.Fragment,null,U.createElement(lr,{id:s,value:o.draggable}),U.createElement(cr,{id:a,announcement:d}));return n?We.createPortal(u,n):u}var O;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(O||(O={}));function lt(){}const K=Object.freeze({x:0,y:0});function vr(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function gr(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function xr(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function br(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Gt(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const yr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const o=Gt(t,t.left,t.top),i=[];for(const d of s){const{id:a}=d,c=n.get(a);if(c){const f=vr(Gt(c),o);i.push({id:a,data:{droppableContainer:d,value:f}})}}return i.sort(gr)};function wr(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),d=o-s,a=i-n;if(s<o&&n<i){const c=t.width*t.height,f=e.width*e.height,u=d*a,p=u/(c+f-u);return Number(p.toFixed(4))}return 0}const jr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const o=[];for(const i of s){const{id:d}=i,a=n.get(d);if(a){const c=wr(a,t);c>0&&o.push({id:d,data:{droppableContainer:i,value:c}})}}return o.sort(xr)};function Cr(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function on(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:K}function Nr(e){return function(n){for(var s=arguments.length,o=new Array(s>1?s-1:0),i=1;i<s;i++)o[i-1]=arguments[i];return o.reduce((d,a)=>({...d,top:d.top+e*a.y,bottom:d.bottom+e*a.y,left:d.left+e*a.x,right:d.right+e*a.x}),{...n})}}const Dr=Nr(1);function Rr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Sr(e,t,n){const s=Rr(t);if(!s)return e;const{scaleX:o,scaleY:i,x:d,y:a}=s,c=e.left-d-(1-o)*parseFloat(n),f=e.top-a-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),u=o?e.width/o:e.width,p=i?e.height/i:e.height;return{width:u,height:p,top:f,right:c+u,bottom:f+p,left:c}}const Er={ignoreTransform:!1};function Me(e,t){t===void 0&&(t=Er);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:u}=W(e).getComputedStyle(e);f&&(n=Sr(n,f,u))}const{top:s,left:o,width:i,height:d,bottom:a,right:c}=n;return{top:s,left:o,width:i,height:d,bottom:a,right:c}}function Ht(e){return Me(e,{ignoreTransform:!0})}function Tr(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Ir(e,t){return t===void 0&&(t=W(e).getComputedStyle(e)),t.position==="fixed"}function Ar(e,t){t===void 0&&(t=W(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const i=t[o];return typeof i=="string"?n.test(i):!1})}function Tt(e,t){const n=[];function s(o){if(t!=null&&n.length>=t||!o)return n;if(Rt(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!Ke(o)||nn(o)||n.includes(o))return n;const i=W(e).getComputedStyle(o);return o!==e&&Ar(o,i)&&n.push(o),Ir(o,i)?n:s(o.parentNode)}return e?s(e):n}function an(e){const[t]=Tt(e,1);return t??null}function gt(e){return!dt||!e?null:Ae(e)?e:Dt(e)?Rt(e)||e===ke(e).scrollingElement?window:Ke(e)?e:null:null}function ln(e){return Ae(e)?e.scrollX:e.scrollLeft}function cn(e){return Ae(e)?e.scrollY:e.scrollTop}function jt(e){return{x:ln(e),y:cn(e)}}var F;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(F||(F={}));function dn(e){return!dt||!e?!1:e===document.scrollingElement}function un(e){const t={x:0,y:0},n=dn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,d=e.scrollTop>=s.y,a=e.scrollLeft>=s.x;return{isTop:o,isLeft:i,isBottom:d,isRight:a,maxScroll:s,minScroll:t}}const kr={x:.2,y:.2};function Mr(e,t,n,s,o){let{top:i,left:d,right:a,bottom:c}=n;s===void 0&&(s=10),o===void 0&&(o=kr);const{isTop:f,isBottom:u,isLeft:p,isRight:g}=un(e),m={x:0,y:0},y={x:0,y:0},v={height:t.height*o.y,width:t.width*o.x};return!f&&i<=t.top+v.height?(m.y=F.Backward,y.y=s*Math.abs((t.top+v.height-i)/v.height)):!u&&c>=t.bottom-v.height&&(m.y=F.Forward,y.y=s*Math.abs((t.bottom-v.height-c)/v.height)),!g&&a>=t.right-v.width?(m.x=F.Forward,y.x=s*Math.abs((t.right-v.width-a)/v.width)):!p&&d<=t.left+v.width&&(m.x=F.Backward,y.x=s*Math.abs((t.left+v.width-d)/v.width)),{direction:m,speed:y}}function Or(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:d}=window;return{top:0,left:0,right:i,bottom:d,width:i,height:d}}const{top:t,left:n,right:s,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:o,width:e.clientWidth,height:e.clientHeight}}function fn(e){return e.reduce((t,n)=>Ie(t,jt(n)),K)}function Lr(e){return e.reduce((t,n)=>t+ln(n),0)}function Fr(e){return e.reduce((t,n)=>t+cn(n),0)}function Pr(e,t){if(t===void 0&&(t=Me),!e)return;const{top:n,left:s,bottom:o,right:i}=t(e);an(e)&&(o<=0||i<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const zr=[["x",["left","right"],Lr],["y",["top","bottom"],Fr]];class It{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=Tt(n),o=fn(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,d,a]of zr)for(const c of d)Object.defineProperty(this,c,{get:()=>{const f=a(s),u=o[i]-f;return this.rect[c]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class He{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var o;(o=this.target)==null||o.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function Br(e){const{EventTarget:t}=W(e);return e instanceof t?e:ke(e)}function xt(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var V;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(V||(V={}));function Xt(e){e.preventDefault()}function $r(e){e.stopPropagation()}var S;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(S||(S={}));const hn={start:[S.Space,S.Enter],cancel:[S.Esc],end:[S.Space,S.Enter,S.Tab]},Ur=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case S.Right:return{...n,x:n.x+25};case S.Left:return{...n,x:n.x-25};case S.Down:return{...n,y:n.y+25};case S.Up:return{...n,y:n.y-25}}};class pn{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new He(ke(n)),this.windowListeners=new He(W(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(V.Resize,this.handleCancel),this.windowListeners.add(V.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(V.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&Pr(s),n(K)}handleKeyDown(t){if(Et(t)){const{active:n,context:s,options:o}=this.props,{keyboardCodes:i=hn,coordinateGetter:d=Ur,scrollBehavior:a="smooth"}=o,{code:c}=t;if(i.end.includes(c)){this.handleEnd(t);return}if(i.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:f}=s.current,u=f?{x:f.left,y:f.top}:K;this.referenceCoordinates||(this.referenceCoordinates=u);const p=d(t,{active:n,context:s.current,currentCoordinates:u});if(p){const g=at(p,u),m={x:0,y:0},{scrollableAncestors:y}=s.current;for(const v of y){const h=t.code,{isTop:x,isRight:w,isLeft:j,isBottom:D,maxScroll:R,minScroll:E}=un(v),N=Or(v),C={x:Math.min(h===S.Right?N.right-N.width/2:N.right,Math.max(h===S.Right?N.left:N.left+N.width/2,p.x)),y:Math.min(h===S.Down?N.bottom-N.height/2:N.bottom,Math.max(h===S.Down?N.top:N.top+N.height/2,p.y))},k=h===S.Right&&!w||h===S.Left&&!j,M=h===S.Down&&!D||h===S.Up&&!x;if(k&&C.x!==p.x){const b=v.scrollLeft+g.x,T=h===S.Right&&b<=R.x||h===S.Left&&b>=E.x;if(T&&!g.y){v.scrollTo({left:b,behavior:a});return}T?m.x=v.scrollLeft-b:m.x=h===S.Right?v.scrollLeft-R.x:v.scrollLeft-E.x,m.x&&v.scrollBy({left:-m.x,behavior:a});break}else if(M&&C.y!==p.y){const b=v.scrollTop+g.y,T=h===S.Down&&b<=R.y||h===S.Up&&b>=E.y;if(T&&!g.x){v.scrollTo({top:b,behavior:a});return}T?m.y=v.scrollTop-b:m.y=h===S.Down?v.scrollTop-R.y:v.scrollTop-E.y,m.y&&v.scrollBy({top:-m.y,behavior:a});break}}this.handleMove(t,Ie(at(p,this.referenceCoordinates),m))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}pn.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=hn,onActivation:o}=t,{active:i}=n;const{code:d}=e.nativeEvent;if(s.start.includes(d)){const a=i.activatorNode.current;return a&&e.target!==a?!1:(e.preventDefault(),o==null||o({event:e.nativeEvent}),!0)}return!1}}];function _t(e){return!!(e&&"distance"in e)}function Yt(e){return!!(e&&"delay"in e)}class At{constructor(t,n,s){var o;s===void 0&&(s=Br(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:d}=i;this.props=t,this.events=n,this.document=ke(d),this.documentListeners=new He(this.document),this.listeners=new He(s),this.windowListeners=new He(W(d)),this.initialCoordinates=(o=wt(i))!=null?o:K,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(V.Resize,this.handleCancel),this.windowListeners.add(V.DragStart,Xt),this.windowListeners.add(V.VisibilityChange,this.handleCancel),this.windowListeners.add(V.ContextMenu,Xt),this.documentListeners.add(V.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Yt(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(_t(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:o}=this.props;o(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(V.Click,$r,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(V.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:o,props:i}=this,{onMove:d,options:{activationConstraint:a}}=i;if(!o)return;const c=(n=wt(t))!=null?n:K,f=at(o,c);if(!s&&a){if(_t(a)){if(a.tolerance!=null&&xt(f,a.tolerance))return this.handleCancel();if(xt(f,a.distance))return this.handleStart()}if(Yt(a)&&xt(f,a.tolerance))return this.handleCancel();this.handlePending(a,f);return}t.cancelable&&t.preventDefault(),d(c)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===S.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Wr={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class mn extends At{constructor(t){const{event:n}=t,s=ke(n.target);super(t,Wr,s)}}mn.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s==null||s({event:n}),!0)}}];const Gr={move:{name:"mousemove"},end:{name:"mouseup"}};var Ct;(function(e){e[e.RightClick=2]="RightClick"})(Ct||(Ct={}));class Hr extends At{constructor(t){super(t,Gr,ke(t.event.target))}}Hr.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===Ct.RightClick?!1:(s==null||s({event:n}),!0)}}];const bt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Xr extends At{constructor(t){super(t,bt)}static setup(){return window.addEventListener(bt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(bt.move.name,t)};function t(){}}}Xr.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:o}=n;return o.length>1?!1:(s==null||s({event:n}),!0)}}];var Xe;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Xe||(Xe={}));var ct;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(ct||(ct={}));function _r(e){let{acceleration:t,activator:n=Xe.Pointer,canScroll:s,draggingRect:o,enabled:i,interval:d=5,order:a=ct.TreeOrder,pointerCoordinates:c,scrollableAncestors:f,scrollableAncestorRects:u,delta:p,threshold:g}=e;const m=Vr({delta:p,disabled:!i}),[y,v]=rr(),h=l.useRef({x:0,y:0}),x=l.useRef({x:0,y:0}),w=l.useMemo(()=>{switch(n){case Xe.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Xe.DraggableRect:return o}},[n,o,c]),j=l.useRef(null),D=l.useCallback(()=>{const E=j.current;if(!E)return;const N=h.current.x*x.current.x,C=h.current.y*x.current.y;E.scrollBy(N,C)},[]),R=l.useMemo(()=>a===ct.TreeOrder?[...f].reverse():f,[a,f]);l.useEffect(()=>{if(!i||!f.length||!w){v();return}for(const E of R){if((s==null?void 0:s(E))===!1)continue;const N=f.indexOf(E),C=u[N];if(!C)continue;const{direction:k,speed:M}=Mr(E,C,w,t,g);for(const b of["x","y"])m[b][k[b]]||(M[b]=0,k[b]=0);if(M.x>0||M.y>0){v(),j.current=E,y(D,d),h.current=M,x.current=k;return}}h.current={x:0,y:0},x.current={x:0,y:0},v()},[t,D,s,v,i,d,JSON.stringify(w),JSON.stringify(m),y,f,R,u,JSON.stringify(g)])}const Yr={x:{[F.Backward]:!1,[F.Forward]:!1},y:{[F.Backward]:!1,[F.Forward]:!1}};function Vr(e){let{delta:t,disabled:n}=e;const s=yt(t);return Je(o=>{if(n||!s||!o)return Yr;const i={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[F.Backward]:o.x[F.Backward]||i.x===-1,[F.Forward]:o.x[F.Forward]||i.x===1},y:{[F.Backward]:o.y[F.Backward]||i.y===-1,[F.Forward]:o.y[F.Forward]||i.y===1}}},[n,t,s])}function qr(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return Je(o=>{var i;return t==null?null:(i=s??o)!=null?i:null},[s,t])}function Kr(e,t){return l.useMemo(()=>e.reduce((n,s)=>{const{sensor:o}=s,i=o.activators.map(d=>({eventName:d.eventName,handler:t(d.handler,s)}));return[...n,...i]},[]),[e,t])}var qe;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(qe||(qe={}));var Nt;(function(e){e.Optimized="optimized"})(Nt||(Nt={}));const Vt=new Map;function Jr(e,t){let{dragging:n,dependencies:s,config:o}=t;const[i,d]=l.useState(null),{frequency:a,measure:c,strategy:f}=o,u=l.useRef(e),p=h(),g=Ye(p),m=l.useCallback(function(x){x===void 0&&(x=[]),!g.current&&d(w=>w===null?x:w.concat(x.filter(j=>!w.includes(j))))},[g]),y=l.useRef(null),v=Je(x=>{if(p&&!n)return Vt;if(!x||x===Vt||u.current!==e||i!=null){const w=new Map;for(let j of e){if(!j)continue;if(i&&i.length>0&&!i.includes(j.id)&&j.rect.current){w.set(j.id,j.rect.current);continue}const D=j.node.current,R=D?new It(c(D),D):null;j.rect.current=R,R&&w.set(j.id,R)}return w}return x},[e,i,n,p,c]);return l.useEffect(()=>{u.current=e},[e]),l.useEffect(()=>{p||m()},[n,p]),l.useEffect(()=>{i&&i.length>0&&d(null)},[JSON.stringify(i)]),l.useEffect(()=>{p||typeof a!="number"||y.current!==null||(y.current=setTimeout(()=>{m(),y.current=null},a))},[a,p,m,...s]),{droppableRects:v,measureDroppableContainers:m,measuringScheduled:i!=null};function h(){switch(f){case qe.Always:return!1;case qe.BeforeDragging:return n;default:return!n}}}function vn(e,t){return Je(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Qr(e,t){return vn(e,t)}function Zr(e){let{callback:t,disabled:n}=e;const s=St(t),o=l.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(s)},[s,n]);return l.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function ut(e){let{callback:t,disabled:n}=e;const s=St(t),o=l.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(s)},[n]);return l.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function es(e){return new It(Me(e),e)}function qt(e,t,n){t===void 0&&(t=es);const[s,o]=l.useState(null);function i(){o(c=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=c??n)!=null?f:null}const u=t(e);return JSON.stringify(c)===JSON.stringify(u)?c:u})}const d=Zr({callback(c){if(e)for(const f of c){const{type:u,target:p}=f;if(u==="childList"&&p instanceof HTMLElement&&p.contains(e)){i();break}}}}),a=ut({callback:i});return ne(()=>{i(),e?(a==null||a.observe(e),d==null||d.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),d==null||d.disconnect())},[e]),s}function ts(e){const t=vn(e);return on(e,t)}const Kt=[];function ns(e){const t=l.useRef(e),n=Je(s=>e?s&&s!==Kt&&e&&t.current&&e.parentNode===t.current.parentNode?s:Tt(e):Kt,[e]);return l.useEffect(()=>{t.current=e},[e]),n}function rs(e){const[t,n]=l.useState(null),s=l.useRef(e),o=l.useCallback(i=>{const d=gt(i.target);d&&n(a=>a?(a.set(d,jt(d)),new Map(a)):null)},[]);return l.useEffect(()=>{const i=s.current;if(e!==i){d(i);const a=e.map(c=>{const f=gt(c);return f?(f.addEventListener("scroll",o,{passive:!0}),[f,jt(f)]):null}).filter(c=>c!=null);n(a.length?new Map(a):null),s.current=e}return()=>{d(e),d(i)};function d(a){a.forEach(c=>{const f=gt(c);f==null||f.removeEventListener("scroll",o)})}},[o,e]),l.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,d)=>Ie(i,d),K):fn(e):K,[e,t])}function Jt(e,t){t===void 0&&(t=[]);const n=l.useRef(null);return l.useEffect(()=>{n.current=null},t),l.useEffect(()=>{const s=e!==K;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?at(e,n.current):K}function ss(e){l.useEffect(()=>{if(!dt)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function os(e,t){return l.useMemo(()=>e.reduce((n,s)=>{let{eventName:o,handler:i}=s;return n[o]=d=>{i(d,t)},n},{}),[e,t])}function gn(e){return l.useMemo(()=>e?Tr(e):null,[e])}const Qt=[];function is(e,t){t===void 0&&(t=Me);const[n]=e,s=gn(n?W(n):null),[o,i]=l.useState(Qt);function d(){i(()=>e.length?e.map(c=>dn(c)?s:new It(t(c),c)):Qt)}const a=ut({callback:d});return ne(()=>{a==null||a.disconnect(),d(),e.forEach(c=>a==null?void 0:a.observe(c))},[e]),o}function as(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ke(t)?t:e}function ls(e){let{measure:t}=e;const[n,s]=l.useState(null),o=l.useCallback(f=>{for(const{target:u}of f)if(Ke(u)){s(p=>{const g=t(u);return p?{...p,width:g.width,height:g.height}:g});break}},[t]),i=ut({callback:o}),d=l.useCallback(f=>{const u=as(f);i==null||i.disconnect(),u&&(i==null||i.observe(u)),s(u?t(u):null)},[t,i]),[a,c]=it(d);return l.useMemo(()=>({nodeRef:a,rect:n,setRef:c}),[n,a,c])}const cs=[{sensor:mn,options:{}},{sensor:pn,options:{}}],ds={current:{}},ot={draggable:{measure:Ht},droppable:{measure:Ht,strategy:qe.WhileDragging,frequency:Nt.Optimized},dragOverlay:{measure:Me}};class _e extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const us={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new _e,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:lt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:ot,measureDroppableContainers:lt,windowRect:null,measuringScheduled:!1},fs={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:lt,draggableNodes:new Map,over:null,measureDroppableContainers:lt},ft=l.createContext(fs),xn=l.createContext(us);function hs(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new _e}}}function ps(e,t){switch(t.type){case O.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case O.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case O.DragEnd:case O.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case O.RegisterDroppable:{const{element:n}=t,{id:s}=n,o=new _e(e.droppable.containers);return o.set(s,n),{...e,droppable:{...e.droppable,containers:o}}}case O.SetDroppableDisabled:{const{id:n,key:s,disabled:o}=t,i=e.droppable.containers.get(n);if(!i||s!==i.key)return e;const d=new _e(e.droppable.containers);return d.set(n,{...i,disabled:o}),{...e,droppable:{...e.droppable,containers:d}}}case O.UnregisterDroppable:{const{id:n,key:s}=t,o=e.droppable.containers.get(n);if(!o||s!==o.key)return e;const i=new _e(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function ms(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:o}=l.useContext(ft),i=yt(s),d=yt(n==null?void 0:n.id);return l.useEffect(()=>{if(!t&&!s&&i&&d!=null){if(!Et(i)||document.activeElement===i.target)return;const a=o.get(d);if(!a)return;const{activatorNode:c,node:f}=a;if(!c.current&&!f.current)return;requestAnimationFrame(()=>{for(const u of[c.current,f.current]){if(!u)continue;const p=ir(u);if(p){p.focus();break}}})}},[s,t,o,d,i]),null}function vs(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((o,i)=>i({transform:o,...s}),n):n}function gs(e){return l.useMemo(()=>({draggable:{...ot.draggable,...e==null?void 0:e.draggable},droppable:{...ot.droppable,...e==null?void 0:e.droppable},dragOverlay:{...ot.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function xs(e){let{activeNode:t,measure:n,initialRect:s,config:o=!0}=e;const i=l.useRef(!1),{x:d,y:a}=typeof o=="boolean"?{x:o,y:o}:o;ne(()=>{if(!d&&!a||!t){i.current=!1;return}if(i.current||!s)return;const f=t==null?void 0:t.node.current;if(!f||f.isConnected===!1)return;const u=n(f),p=on(u,s);if(d||(p.x=0),a||(p.y=0),i.current=!0,Math.abs(p.x)>0||Math.abs(p.y)>0){const g=an(f);g&&g.scrollBy({top:p.y,left:p.x})}},[t,d,a,s,n])}const bn=l.createContext({...K,scaleX:1,scaleY:1});var pe;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(pe||(pe={}));const bs=l.memo(function(t){var n,s,o,i;let{id:d,accessibility:a,autoScroll:c=!0,children:f,sensors:u=cs,collisionDetection:p=jr,measuring:g,modifiers:m,...y}=t;const v=l.useReducer(ps,void 0,hs),[h,x]=v,[w,j]=fr(),[D,R]=l.useState(pe.Uninitialized),E=D===pe.Initialized,{draggable:{active:N,nodes:C,translate:k},droppable:{containers:M}}=h,b=N!=null?C.get(N):null,T=l.useRef({initial:null,translated:null}),I=l.useMemo(()=>{var z;return N!=null?{id:N,data:(z=b==null?void 0:b.data)!=null?z:ds,rect:T}:null},[N,b]),L=l.useRef(null),[ge,we]=l.useState(null),[B,J]=l.useState(null),q=Ye(y,Object.values(y)),Oe=Qe("DndDescribedBy",d),Ze=l.useMemo(()=>M.getEnabled(),[M]),$=gs(g),{droppableRects:re,measureDroppableContainers:xe,measuringScheduled:Le}=Jr(Ze,{dragging:E,dependencies:[k.x,k.y],config:$.droppable}),_=qr(C,N),et=l.useMemo(()=>B?wt(B):null,[B]),ae=An(),se=Qr(_,$.draggable.measure);xs({activeNode:N!=null?C.get(N):null,config:ae.layoutShiftCompensation,initialRect:se,measure:$.draggable.measure});const A=qt(_,$.draggable.measure,se),Fe=qt(_?_.parentElement:null),Q=l.useRef({activatorEvent:null,active:null,activeNode:_,collisionRect:null,collisions:null,droppableRects:re,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:M,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),je=M.getNodeFor((n=Q.current.over)==null?void 0:n.id),oe=ls({measure:$.dragOverlay.measure}),Ce=(s=oe.nodeRef.current)!=null?s:_,Ne=E?(o=oe.rect)!=null?o:A:null,Mt=!!(oe.nodeRef.current&&oe.rect),Ot=ts(Mt?null:A),ht=gn(Ce?W(Ce):null),le=ns(E?je??_:null),tt=is(le),nt=vs(m,{transform:{x:k.x-Ot.x,y:k.y-Ot.y,scaleX:1,scaleY:1},activatorEvent:B,active:I,activeNodeRect:A,containerNodeRect:Fe,draggingNodeRect:Ne,over:Q.current.over,overlayNodeRect:oe.rect,scrollableAncestors:le,scrollableAncestorRects:tt,windowRect:ht}),Lt=et?Ie(et,k):null,Ft=rs(le),Nn=Jt(Ft),Dn=Jt(Ft,[A]),De=Ie(nt,Nn),Re=Ne?Dr(Ne,nt):null,Pe=I&&Re?p({active:I,collisionRect:Re,droppableRects:re,droppableContainers:Ze,pointerCoordinates:Lt}):null,Pt=br(Pe,"id"),[ce,zt]=l.useState(null),Rn=Mt?nt:Ie(nt,Dn),Sn=Cr(Rn,(i=ce==null?void 0:ce.rect)!=null?i:null,A),pt=l.useRef(null),Bt=l.useCallback((z,G)=>{let{sensor:H,options:de}=G;if(L.current==null)return;const Y=C.get(L.current);if(!Y)return;const X=z.nativeEvent,Z=new H({active:L.current,activeNode:Y,event:X,options:de,context:Q,onAbort(P){if(!C.get(P))return;const{onDragAbort:ee}=q.current,ie={id:P};ee==null||ee(ie),w({type:"onDragAbort",event:ie})},onPending(P,ue,ee,ie){if(!C.get(P))return;const{onDragPending:Be}=q.current,fe={id:P,constraint:ue,initialCoordinates:ee,offset:ie};Be==null||Be(fe),w({type:"onDragPending",event:fe})},onStart(P){const ue=L.current;if(ue==null)return;const ee=C.get(ue);if(!ee)return;const{onDragStart:ie}=q.current,ze={activatorEvent:X,active:{id:ue,data:ee.data,rect:T}};We.unstable_batchedUpdates(()=>{ie==null||ie(ze),R(pe.Initializing),x({type:O.DragStart,initialCoordinates:P,active:ue}),w({type:"onDragStart",event:ze}),we(pt.current),J(X)})},onMove(P){x({type:O.DragMove,coordinates:P})},onEnd:Se(O.DragEnd),onCancel:Se(O.DragCancel)});pt.current=Z;function Se(P){return async function(){const{active:ee,collisions:ie,over:ze,scrollAdjustedTranslate:Be}=Q.current;let fe=null;if(ee&&Be){const{cancelDrop:$e}=q.current;fe={activatorEvent:X,active:ee,collisions:ie,delta:Be,over:ze},P===O.DragEnd&&typeof $e=="function"&&await Promise.resolve($e(fe))&&(P=O.DragCancel)}L.current=null,We.unstable_batchedUpdates(()=>{x({type:P}),R(pe.Uninitialized),zt(null),we(null),J(null),pt.current=null;const $e=P===O.DragEnd?"onDragEnd":"onDragCancel";if(fe){const mt=q.current[$e];mt==null||mt(fe),w({type:$e,event:fe})}})}}},[C]),En=l.useCallback((z,G)=>(H,de)=>{const Y=H.nativeEvent,X=C.get(de);if(L.current!==null||!X||Y.dndKit||Y.defaultPrevented)return;const Z={active:X};z(H,G.options,Z)===!0&&(Y.dndKit={capturedBy:G.sensor},L.current=de,Bt(H,G))},[C,Bt]),$t=Kr(u,En);ss(u),ne(()=>{A&&D===pe.Initializing&&R(pe.Initialized)},[A,D]),l.useEffect(()=>{const{onDragMove:z}=q.current,{active:G,activatorEvent:H,collisions:de,over:Y}=Q.current;if(!G||!H)return;const X={active:G,activatorEvent:H,collisions:de,delta:{x:De.x,y:De.y},over:Y};We.unstable_batchedUpdates(()=>{z==null||z(X),w({type:"onDragMove",event:X})})},[De.x,De.y]),l.useEffect(()=>{const{active:z,activatorEvent:G,collisions:H,droppableContainers:de,scrollAdjustedTranslate:Y}=Q.current;if(!z||L.current==null||!G||!Y)return;const{onDragOver:X}=q.current,Z=de.get(Pt),Se=Z&&Z.rect.current?{id:Z.id,rect:Z.rect.current,data:Z.data,disabled:Z.disabled}:null,P={active:z,activatorEvent:G,collisions:H,delta:{x:Y.x,y:Y.y},over:Se};We.unstable_batchedUpdates(()=>{zt(Se),X==null||X(P),w({type:"onDragOver",event:P})})},[Pt]),ne(()=>{Q.current={activatorEvent:B,active:I,activeNode:_,collisionRect:Re,collisions:Pe,droppableRects:re,draggableNodes:C,draggingNode:Ce,draggingNodeRect:Ne,droppableContainers:M,over:ce,scrollableAncestors:le,scrollAdjustedTranslate:De},T.current={initial:Ne,translated:Re}},[I,_,Pe,Re,C,Ce,Ne,re,M,ce,le,De]),_r({...ae,delta:k,draggingRect:Re,pointerCoordinates:Lt,scrollableAncestors:le,scrollableAncestorRects:tt});const Tn=l.useMemo(()=>({active:I,activeNode:_,activeNodeRect:A,activatorEvent:B,collisions:Pe,containerNodeRect:Fe,dragOverlay:oe,draggableNodes:C,droppableContainers:M,droppableRects:re,over:ce,measureDroppableContainers:xe,scrollableAncestors:le,scrollableAncestorRects:tt,measuringConfiguration:$,measuringScheduled:Le,windowRect:ht}),[I,_,A,B,Pe,Fe,oe,C,M,re,ce,xe,le,tt,$,Le,ht]),In=l.useMemo(()=>({activatorEvent:B,activators:$t,active:I,activeNodeRect:A,ariaDescribedById:{draggable:Oe},dispatch:x,draggableNodes:C,over:ce,measureDroppableContainers:xe}),[B,$t,I,A,x,Oe,C,ce,xe]);return U.createElement(sn.Provider,{value:j},U.createElement(ft.Provider,{value:In},U.createElement(xn.Provider,{value:Tn},U.createElement(bn.Provider,{value:Sn},f)),U.createElement(ms,{disabled:(a==null?void 0:a.restoreFocus)===!1})),U.createElement(mr,{...a,hiddenTextDescribedById:Oe}));function An(){const z=(ge==null?void 0:ge.autoScrollEnabled)===!1,G=typeof c=="object"?c.enabled===!1:c===!1,H=E&&!z&&!G;return typeof c=="object"?{...c,enabled:H}:{enabled:H}}}),ys=l.createContext(null),Zt="button",ws="Draggable";function js(e){let{id:t,data:n,disabled:s=!1,attributes:o}=e;const i=Qe(ws),{activators:d,activatorEvent:a,active:c,activeNodeRect:f,ariaDescribedById:u,draggableNodes:p,over:g}=l.useContext(ft),{role:m=Zt,roleDescription:y="draggable",tabIndex:v=0}=o??{},h=(c==null?void 0:c.id)===t,x=l.useContext(h?bn:ys),[w,j]=it(),[D,R]=it(),E=os(d,t),N=Ye(n);ne(()=>(p.set(t,{id:t,key:i,node:w,activatorNode:D,data:N}),()=>{const k=p.get(t);k&&k.key===i&&p.delete(t)}),[p,t]);const C=l.useMemo(()=>({role:m,tabIndex:v,"aria-disabled":s,"aria-pressed":h&&m===Zt?!0:void 0,"aria-roledescription":y,"aria-describedby":u.draggable}),[s,m,v,h,y,u.draggable]);return{active:c,activatorEvent:a,activeNodeRect:f,attributes:C,isDragging:h,listeners:s?void 0:E,node:w,over:g,setNodeRef:j,setActivatorNodeRef:R,transform:x}}function Cs(){return l.useContext(xn)}const Ns="Droppable",Ds={timeout:25};function Rs(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:o}=e;const i=Qe(Ns),{active:d,dispatch:a,over:c,measureDroppableContainers:f}=l.useContext(ft),u=l.useRef({disabled:n}),p=l.useRef(!1),g=l.useRef(null),m=l.useRef(null),{disabled:y,updateMeasurementsFor:v,timeout:h}={...Ds,...o},x=Ye(v??s),w=l.useCallback(()=>{if(!p.current){p.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{f(Array.isArray(x.current)?x.current:[x.current]),m.current=null},h)},[h]),j=ut({callback:w,disabled:y||!d}),D=l.useCallback((C,k)=>{j&&(k&&(j.unobserve(k),p.current=!1),C&&j.observe(C))},[j]),[R,E]=it(D),N=Ye(t);return l.useEffect(()=>{!j||!R.current||(j.disconnect(),p.current=!1,j.observe(R.current))},[R,j]),l.useEffect(()=>(a({type:O.RegisterDroppable,element:{id:s,key:i,disabled:n,node:R,rect:g,data:N}}),()=>a({type:O.UnregisterDroppable,key:i,id:s})),[s]),l.useEffect(()=>{n!==u.current.disabled&&(a({type:O.SetDroppableDisabled,id:s,key:i,disabled:n}),u.current.disabled=n)},[s,i,n,a]),{active:d,rect:g,isOver:(c==null?void 0:c.id)===s,node:R,over:c,setNodeRef:E}}function kt(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function Ss(e,t){return e.reduce((n,s,o)=>{const i=t.get(s);return i&&(n[o]=i),n},Array(e.length))}function rt(e){return e!==null&&e>=0}function Es(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ts(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const yn=e=>{let{rects:t,activeIndex:n,overIndex:s,index:o}=e;const i=kt(t,s,n),d=t[o],a=i[o];return!a||!d?null:{x:a.left-d.left,y:a.top-d.top,scaleX:a.width/d.width,scaleY:a.height/d.height}},st={scaleX:1,scaleY:1},Is=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:o,rects:i,overIndex:d}=e;const a=(t=i[n])!=null?t:s;if(!a)return null;if(o===n){const f=i[d];return f?{x:0,y:n<d?f.top+f.height-(a.top+a.height):f.top-a.top,...st}:null}const c=As(i,o,n);return o>n&&o<=d?{x:0,y:-a.height-c,...st}:o<n&&o>=d?{x:0,y:a.height+c,...st}:{x:0,y:0,...st}};function As(e,t,n){const s=e[t],o=e[t-1],i=e[t+1];return s?n<t?o?s.top-(o.top+o.height):i?i.top-(s.top+s.height):0:i?i.top-(s.top+s.height):o?s.top-(o.top+o.height):0:0}const wn="Sortable",jn=U.createContext({activeIndex:-1,containerId:wn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:yn,disabled:{draggable:!1,droppable:!1}});function ks(e){let{children:t,id:n,items:s,strategy:o=yn,disabled:i=!1}=e;const{active:d,dragOverlay:a,droppableRects:c,over:f,measureDroppableContainers:u}=Cs(),p=Qe(wn,n),g=a.rect!==null,m=l.useMemo(()=>s.map(E=>typeof E=="object"&&"id"in E?E.id:E),[s]),y=d!=null,v=d?m.indexOf(d.id):-1,h=f?m.indexOf(f.id):-1,x=l.useRef(m),w=!Es(m,x.current),j=h!==-1&&v===-1||w,D=Ts(i);ne(()=>{w&&y&&u(m)},[w,m,y,u]),l.useEffect(()=>{x.current=m},[m]);const R=l.useMemo(()=>({activeIndex:v,containerId:p,disabled:D,disableTransforms:j,items:m,overIndex:h,useDragOverlay:g,sortedRects:Ss(m,c),strategy:o}),[v,p,D.draggable,D.droppable,j,m,h,c,g,o]);return U.createElement(jn.Provider,{value:R},t)}const Ms=e=>{let{id:t,items:n,activeIndex:s,overIndex:o}=e;return kt(n,s,o).indexOf(t)},Os=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:o,items:i,newIndex:d,previousItems:a,previousContainerId:c,transition:f}=e;return!f||!s||a!==i&&o===d?!1:n?!0:d!==o&&t===c},Ls={duration:200,easing:"ease"},Cn="transform",Fs=Ve.Transition.toString({property:Cn,duration:0,easing:"linear"}),Ps={roleDescription:"sortable"};function zs(e){let{disabled:t,index:n,node:s,rect:o}=e;const[i,d]=l.useState(null),a=l.useRef(n);return ne(()=>{if(!t&&n!==a.current&&s.current){const c=o.current;if(c){const f=Me(s.current,{ignoreTransform:!0}),u={x:c.left-f.left,y:c.top-f.top,scaleX:c.width/f.width,scaleY:c.height/f.height};(u.x||u.y)&&d(u)}}n!==a.current&&(a.current=n)},[t,n,s,o]),l.useEffect(()=>{i&&d(null)},[i]),i}function Bs(e){let{animateLayoutChanges:t=Os,attributes:n,disabled:s,data:o,getNewIndex:i=Ms,id:d,strategy:a,resizeObserverConfig:c,transition:f=Ls}=e;const{items:u,containerId:p,activeIndex:g,disabled:m,disableTransforms:y,sortedRects:v,overIndex:h,useDragOverlay:x,strategy:w}=l.useContext(jn),j=$s(s,m),D=u.indexOf(d),R=l.useMemo(()=>({sortable:{containerId:p,index:D,items:u},...o}),[p,o,D,u]),E=l.useMemo(()=>u.slice(u.indexOf(d)),[u,d]),{rect:N,node:C,isOver:k,setNodeRef:M}=Rs({id:d,data:R,disabled:j.droppable,resizeObserverConfig:{updateMeasurementsFor:E,...c}}),{active:b,activatorEvent:T,activeNodeRect:I,attributes:L,setNodeRef:ge,listeners:we,isDragging:B,over:J,setActivatorNodeRef:q,transform:Oe}=js({id:d,data:R,attributes:{...Ps,...n},disabled:j.draggable}),Ze=nr(M,ge),$=!!b,re=$&&!y&&rt(g)&&rt(h),xe=!x&&B,Le=xe&&re?Oe:null,et=re?Le??(a??w)({rects:v,activeNodeRect:I,activeIndex:g,overIndex:h,index:D}):null,ae=rt(g)&&rt(h)?i({id:d,items:u,activeIndex:g,overIndex:h}):D,se=b==null?void 0:b.id,A=l.useRef({activeId:se,items:u,newIndex:ae,containerId:p}),Fe=u!==A.current.items,Q=t({active:b,containerId:p,isDragging:B,isSorting:$,id:d,index:D,items:u,newIndex:A.current.newIndex,previousItems:A.current.items,previousContainerId:A.current.containerId,transition:f,wasDragging:A.current.activeId!=null}),je=zs({disabled:!Q,index:D,node:C,rect:N});return l.useEffect(()=>{$&&A.current.newIndex!==ae&&(A.current.newIndex=ae),p!==A.current.containerId&&(A.current.containerId=p),u!==A.current.items&&(A.current.items=u)},[$,ae,p,u]),l.useEffect(()=>{if(se===A.current.activeId)return;if(se!=null&&A.current.activeId==null){A.current.activeId=se;return}const Ce=setTimeout(()=>{A.current.activeId=se},50);return()=>clearTimeout(Ce)},[se]),{active:b,activeIndex:g,attributes:L,data:R,rect:N,index:D,newIndex:ae,items:u,isOver:k,isSorting:$,isDragging:B,listeners:we,node:C,overIndex:h,over:J,setNodeRef:Ze,setActivatorNodeRef:q,setDroppableNodeRef:M,setDraggableNodeRef:ge,transform:je??et,transition:oe()};function oe(){if(je||Fe&&A.current.newIndex===D)return Fs;if(!(xe&&!Et(T)||!f)&&($||Q))return Ve.Transition.toString({...f,property:Cn})}}function $s(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(s=e==null?void 0:e.droppable)!=null?s:t.droppable}}S.Down,S.Right,S.Up,S.Left;const Us=({section:e,onUpdate:t,onRemove:n})=>{const[s,o]=l.useState(!1),{attributes:i,listeners:d,setNodeRef:a,transform:c,transition:f,isDragging:u}=Bs({id:e.id}),p={transform:Ve.Transform.toString(c),transition:f,opacity:u?.5:1},g=y=>{const v=e.fields.map(h=>h.id===y?{...h,visible:!h.visible}:h);t(e.id,{fields:v})},m=(y,v)=>{const h=e.fields.map(x=>x.id===y?{...x,customLabel:v}:x);t(e.id,{fields:h})};return r.jsx(be,{ref:a,style:{...p,borderLeftColor:e.visible?"hsl(var(--primary))":"hsl(var(--muted))"},className:"overflow-hidden border-l-4",children:r.jsxs(ye,{className:"p-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{...i,...d,className:"cursor-grab active:cursor-grabbing touch-none hover:bg-accent rounded p-1 transition-colors",children:r.jsx(Fn,{className:"h-5 w-5 text-muted-foreground"})}),r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(me,{value:e.title,onChange:y=>t(e.id,{title:y.target.value}),className:"font-semibold text-base",placeholder:"Section name..."}),r.jsx(qn,{variant:e.type==="custom"?"secondary":"outline",children:e.type.replace("_"," ")})]})}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:e.visible?"Visible":"Hidden"}),r.jsx(tn,{checked:e.visible,onCheckedChange:y=>t(e.id,{visible:y})})]}),r.jsx(te,{variant:"ghost",size:"sm",onClick:()=>o(!s),className:"hover:bg-accent",children:s?r.jsx(Pn,{className:"h-4 w-4"}):r.jsx(zn,{className:"h-4 w-4"})}),e.type==="custom"&&r.jsx(te,{variant:"ghost",size:"sm",onClick:()=>n(e.id),className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:r.jsx(Bn,{className:"h-4 w-4"})})]})]}),s&&e.fields.length>0&&r.jsxs("div",{className:"mt-4 space-y-3 pl-8 border-l-2 border-primary/20",children:[r.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Configure which fields appear in this section"}),e.fields.map(y=>r.jsxs("div",{className:"flex items-center gap-3 text-sm bg-muted/30 rounded-md p-2",children:[r.jsx(te,{variant:"ghost",size:"sm",onClick:()=>g(y.id),className:y.visible?"text-primary":"text-muted-foreground",children:y.visible?r.jsx(en,{className:"h-4 w-4"}):r.jsx($n,{className:"h-4 w-4"})}),r.jsx(ve,{className:"flex-1 font-medium",children:y.label}),r.jsx(me,{placeholder:"Custom label...",value:y.customLabel||"",onChange:v=>m(y.id,v.target.value),className:"max-w-[200px] h-8"})]},y.id))]})]})})},Ws=({sections:e,globalStyling:t,productImages:n=[]})=>{const s=e.filter(a=>a.visible).sort((a,c)=>a.order-c.order),o=n.find(a=>a.isDefault)||n[0],i=(a,c)=>a.key==="logo"?r.jsx("div",{className:"flex items-center gap-2 mb-2",children:t!=null&&t.logoUrl?r.jsx("img",{src:t.logoUrl,alt:"Business Logo",className:"w-20 h-20 object-contain rounded border border-border"}):r.jsx("div",{className:"w-16 h-16 rounded border border-border flex items-center justify-center bg-muted text-muted-foreground text-xs",children:"Logo"})}):a.key==="itemImage"?r.jsx("div",{className:"flex items-center gap-2 mb-2",children:o?r.jsx("img",{src:o.url,alt:"Product",className:"w-16 h-16 object-cover rounded border border-border"}):r.jsx("div",{className:"w-16 h-16 rounded border border-border flex items-center justify-center bg-muted text-muted-foreground text-xs",children:"Product"})}):c.id==="line_items"?null:r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("span",{className:"text-muted-foreground text-sm",children:[a.customLabel||a.label,":"]}),r.jsxs("span",{className:"font-medium text-sm",children:["[",a.key,"]"]})]}),d=a=>{const c=a.fields.filter(f=>f.visible).sort((f,u)=>f.order-u.order);return r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full border-collapse text-xs",children:[r.jsx("thead",{children:r.jsx("tr",{style:{backgroundColor:(t==null?void 0:t.secondaryColor)||"#FED7AA"},children:c.map(f=>r.jsx("th",{className:"text-center py-2 px-2 font-bold border border-border",children:f.customLabel||f.label},f.id))})}),r.jsx("tbody",{children:[1,2].map(f=>r.jsx("tr",{className:"border border-border",children:c.map(u=>r.jsx("td",{className:"py-2 px-2 text-center border border-border",children:u.key==="itemImage"?o?r.jsx("img",{src:o.url,alt:"Product",className:"w-12 h-12 mx-auto object-cover rounded border border-border"}):r.jsx("div",{className:"w-10 h-10 mx-auto rounded border border-border flex items-center justify-center bg-muted text-muted-foreground text-[10px]",children:"IMG"}):u.key==="itemDescription"?r.jsx("span",{className:"font-semibold",children:"Diamond Ring 18K"}):u.key==="itemHSN"?r.jsx("span",{children:"7113"}):u.key==="grossWeight"?r.jsx("span",{children:"10.50"}):u.key==="diamondWeight"?r.jsx("span",{children:"1.25"}):u.key==="diamondPerCarat"?r.jsx("span",{children:"₹25,000"}):u.key==="diamondCost"?r.jsx("span",{className:"font-semibold",children:"₹31,250"}):u.key==="stoneWeight"?r.jsx("span",{children:"0.50"}):u.key==="stonePerCarat"?r.jsx("span",{children:"₹5,000"}):u.key==="stoneCost"?r.jsx("span",{className:"font-semibold",children:"₹2,500"}):u.key==="netWeight"?r.jsx("span",{children:"8.50"}):u.key==="goldRate"?r.jsx("span",{children:"₹6,500"}):u.key==="goldCost"?r.jsx("span",{className:"font-semibold",children:"₹55,250"}):u.key==="makingChargesPerGram"?r.jsx("span",{children:"₹800"}):u.key==="totalMaking"?r.jsx("span",{className:"font-semibold",children:"₹6,800"}):u.key==="cadCharges"?r.jsx("span",{children:"₹2,000"}):u.key==="cammingCharges"?r.jsx("span",{children:"₹1,500"}):u.key==="certification"?r.jsx("span",{children:"₹3,000"}):u.key==="tax"?r.jsx("span",{children:"₹3,090"}):u.key==="shipping"?r.jsx("span",{children:"₹500"}):u.key==="vaPercent"?r.jsx("span",{children:"10%"}):u.key==="wastage"?r.jsx("span",{children:"0.9"}):u.key==="finalWeight"?r.jsx("span",{children:"9.9"}):u.key==="rate"?r.jsx("span",{children:"₹4,400.00"}):u.key==="makingCharges"?r.jsx("span",{children:"₹500"}):u.key==="amount"?r.jsx("span",{className:"font-semibold text-primary",children:"₹1,05,890"}):r.jsxs("span",{children:["[",u.key,"]"]})},u.id))},f))})]})})};return r.jsx("div",{className:"bg-white rounded-lg shadow-lg border border-border min-h-[600px] max-h-[800px] overflow-y-auto",style:{fontFamily:(t==null?void 0:t.fontFamily)||"Arial",padding:`${(t==null?void 0:t.pageMargin)||20}px`},children:r.jsx("div",{className:"space-y-6",children:s.map(a=>{var c,f,u,p,g,m,y,v;return r.jsxs("div",{className:"pb-4",style:{backgroundColor:(c=a.styling)==null?void 0:c.backgroundColor,color:(f=a.styling)==null?void 0:f.textColor,padding:`${((u=a.styling)==null?void 0:u.padding)||0}px`,borderColor:(p=a.styling)==null?void 0:p.borderColor,borderWidth:((g=a.styling)==null?void 0:g.borderWidth)||0,borderRadius:(m=a.styling)!=null&&m.borderWidth?"8px":"0"},children:[r.jsx("h3",{className:"font-bold mb-4",style:{fontSize:`${((y=a.styling)==null?void 0:y.fontSize)||18}px`,fontWeight:((v=a.styling)==null?void 0:v.fontWeight)||"700",color:t==null?void 0:t.primaryColor},children:a.title}),a.id==="line_items"?d(a):a.id==="header"?r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsx("div",{className:"space-y-2",children:a.fields.filter(h=>h.visible&&(h.key==="logo"||h.key==="businessName"||h.key==="businessTagline")).sort((h,x)=>h.order-x.order).map(h=>i(h,a))}),r.jsx("div",{className:"space-y-2",children:a.fields.filter(h=>h.visible&&["businessAddress","businessPhone","businessLandline","businessEmail","businessGSTN"].includes(h.key)).sort((h,x)=>h.order-x.order).map(h=>i(h,a))}),r.jsx("div",{className:"space-y-2 text-right",children:a.fields.filter(h=>h.visible&&["invoiceNumber","invoiceDate","goldRate","silverRate"].includes(h.key)).sort((h,x)=>h.order-x.order).map(h=>i(h,a))})]}):a.id==="customer_info"?r.jsxs("div",{className:"grid grid-cols-2 gap-6",style:{backgroundColor:(t==null?void 0:t.secondaryColor)||"#FED7AA",padding:"12px",borderRadius:"4px"},children:[r.jsx("div",{className:"space-y-2",children:a.fields.filter(h=>h.visible).slice(0,4).sort((h,x)=>h.order-x.order).map(h=>i(h,a))}),r.jsx("div",{className:"space-y-2",children:a.fields.filter(h=>h.visible).slice(4).sort((h,x)=>h.order-x.order).map(h=>i(h,a))})]}):a.id==="cost_breakdown"?r.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-4 p-3 rounded",style:{backgroundColor:(t==null?void 0:t.secondaryColor)||"#FED7AA"},children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"font-bold text-xs",children:"GOLD TOTAL WEIGHT"}),r.jsx("div",{className:"text-sm mt-1",children:"9.900"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"font-bold text-xs",children:"SILVER TOTAL WEIGHT"}),r.jsx("div",{className:"text-sm mt-1",children:"150.000"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"font-bold text-xs",children:"TOTAL MC"}),r.jsx("div",{className:"text-sm mt-1",children:"₹500.0"})]})]}),r.jsxs("div",{className:"border border-border p-3 rounded text-xs space-y-1",children:[r.jsx("div",{className:"font-bold mb-2",children:"OLD/EXCHANGE"}),r.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center",children:[r.jsx("div",{children:r.jsx("span",{className:"font-semibold",children:"G.WT"})}),r.jsx("div",{children:r.jsx("span",{className:"font-semibold",children:"PURITY"})}),r.jsx("div",{children:r.jsx("span",{className:"font-semibold",children:"N.WT"})}),r.jsx("div",{children:r.jsx("span",{className:"font-semibold",children:"RATE"})})]})]}),r.jsxs("div",{className:"border border-border p-3 rounded text-xs",children:[r.jsx("div",{className:"font-bold mb-2",children:"T&C:"}),r.jsx("div",{className:"text-muted-foreground",children:"* Goods once sold will not be taken back."})]}),r.jsxs("div",{className:"border border-border p-3 rounded text-xs",children:[r.jsx("div",{className:"font-bold mb-2",children:"Declaration:"}),r.jsx("div",{className:"text-muted-foreground",children:"We declare that this invoice shows the"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"grid grid-cols-4 gap-2 p-2 text-xs text-center",style:{backgroundColor:(t==null?void 0:t.secondaryColor)||"#FED7AA"},children:[r.jsx("div",{className:"font-bold",children:"GST"}),r.jsx("div",{className:"font-bold",children:"CGST"}),r.jsx("div",{className:"font-bold",children:"SGST"}),r.jsx("div",{className:"font-bold",children:"IGST"}),r.jsx("div",{children:"3%"}),r.jsx("div",{children:"₹748.65"}),r.jsx("div",{children:"₹748.65"}),r.jsx("div",{children:"0"})]}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between py-1 px-2",children:[r.jsx("span",{className:"font-semibold",children:"TOTAL AMOUNT"}),r.jsx("span",{className:"font-bold",children:"₹49,910"})]}),r.jsxs("div",{className:"flex justify-between py-1 px-2 text-muted-foreground",children:[r.jsx("span",{children:"Add: Other"}),r.jsx("span",{children:"-"})]}),r.jsxs("div",{className:"flex justify-between py-1 px-2 text-muted-foreground",children:[r.jsx("span",{children:"Less: Discount"}),r.jsx("span",{children:"-"})]}),r.jsxs("div",{className:"flex justify-between py-1 px-2 border-t border-border",children:[r.jsx("span",{className:"font-semibold",children:"Taxable Amount"}),r.jsx("span",{className:"font-semibold",children:"₹49,910"})]}),r.jsxs("div",{className:"flex justify-between py-1 px-2",children:[r.jsx("span",{children:"GST Total"}),r.jsx("span",{children:"₹1,497"})]}),r.jsxs("div",{className:"flex justify-between py-1 px-2",children:[r.jsx("span",{children:"After Tax"}),r.jsx("span",{children:"₹51,407"})]}),r.jsxs("div",{className:"flex justify-between py-1 px-2",children:[r.jsx("span",{children:"Less: O/E Value"}),r.jsx("span",{children:"-"})]}),r.jsxs("div",{className:"flex justify-between py-2 px-2 border-t-2 border-border",style:{backgroundColor:(t==null?void 0:t.secondaryColor)||"#FED7AA"},children:[r.jsx("span",{className:"font-bold text-base",children:"GRAND TOTAL"}),r.jsx("span",{className:"font-bold text-base",children:"₹51,407"})]})]}),r.jsxs("div",{className:"border border-border p-2 rounded text-xs mt-4",style:{backgroundColor:(t==null?void 0:t.secondaryColor)||"#FED7AA"},children:[r.jsx("div",{className:"font-bold text-center mb-2",children:"PAYMENT MODE"}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[r.jsx("div",{className:"font-semibold",children:"MODE"}),r.jsx("div",{className:"font-semibold",children:"AMOUNT"}),r.jsx("div",{className:"font-semibold",children:"REF NO."})]})]})]})]}):r.jsx("div",{children:a.fields.filter(h=>h.visible).sort((h,x)=>h.order-x.order).map(h=>i(h,a))})]},a.id)})})})},Gs=({globalStyling:e,onUpdate:t})=>r.jsxs(be,{children:[r.jsx(Ee,{children:r.jsx(Te,{children:"Global Styling"})}),r.jsxs(ye,{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(ve,{children:"Primary Color"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(me,{type:"color",value:e.primaryColor||"#4F46E5",onChange:n=>t({...e,primaryColor:n.target.value}),className:"w-20 h-10"}),r.jsx(me,{type:"text",value:e.primaryColor||"#4F46E5",onChange:n=>t({...e,primaryColor:n.target.value}),placeholder:"#4F46E5"})]})]}),r.jsxs("div",{children:[r.jsx(ve,{children:"Secondary Color"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(me,{type:"color",value:e.secondaryColor||"#8B5CF6",onChange:n=>t({...e,secondaryColor:n.target.value}),className:"w-20 h-10"}),r.jsx(me,{type:"text",value:e.secondaryColor||"#8B5CF6",onChange:n=>t({...e,secondaryColor:n.target.value}),placeholder:"#8B5CF6"})]})]})]}),r.jsxs("div",{children:[r.jsx(ve,{children:"Font Family"}),r.jsxs(Kn,{value:e.fontFamily||"Arial",onValueChange:n=>t({...e,fontFamily:n}),children:[r.jsx(Jn,{children:r.jsx(Qn,{})}),r.jsxs(Zn,{children:[r.jsx(Ue,{value:"Arial",children:"Arial"}),r.jsx(Ue,{value:"Helvetica",children:"Helvetica"}),r.jsx(Ue,{value:"Times New Roman",children:"Times New Roman"}),r.jsx(Ue,{value:"Georgia",children:"Georgia"}),r.jsx(Ue,{value:"Courier New",children:"Courier New"})]})]})]}),r.jsxs("div",{children:[r.jsxs(ve,{children:["Page Margin (px): ",e.pageMargin||20]}),r.jsx(er,{value:[e.pageMargin||20],onValueChange:([n])=>t({...e,pageMargin:n}),min:10,max:50,step:5,className:"mt-2"})]})]})]}),Hs=({images:e,onUpdate:t})=>{const[n,s]=l.useState(!1),{toast:o}=On(),i=async c=>{const f=c.target.files;if(!(!f||f.length===0)){s(!0);try{const u=[];for(let p=0;p<f.length;p++){const g=f[p];if(!g.type.startsWith("image/")){o({title:"Invalid File",description:`${g.name} is not an image file`,variant:"destructive"});continue}if(g.size>5*1024*1024){o({title:"File Too Large",description:`${g.name} exceeds 5MB limit`,variant:"destructive"});continue}const m=g.name.split(".").pop(),v=`product-images/${`${Date.now()}-${Math.random().toString(36).substring(7)}.${m}`}`,{data:h,error:x}=await Ge.storage.from("manufacturing-estimates").upload(v,g,{cacheControl:"3600",upsert:!1});if(x)throw x;const w=h.path;u.push({id:`img_${Date.now()}_${p}`,url:w,name:g.name,isDefault:e.length===0&&p===0})}t([...e,...u]),o({title:"Upload Successful",description:`${u.length} image(s) uploaded successfully`})}catch(u){console.error("Upload error:",u),o({title:"Upload Failed",description:"Failed to upload images. Please try again.",variant:"destructive"})}finally{s(!1),c.target.value=""}}},d=c=>{const f=e.filter(u=>u.id!==c);f.length>0&&!f.some(u=>u.isDefault)&&(f[0].isDefault=!0),t(f),o({title:"Image Removed",description:"Product image removed from gallery"})},a=c=>{const f=e.map(u=>({...u,isDefault:u.id===c}));t(f),o({title:"Default Image Set",description:"This image will be used as the default for line items"})};return r.jsxs(be,{children:[r.jsx(Ee,{children:r.jsxs(Te,{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Product Image Gallery"}),r.jsxs("label",{children:[r.jsx(me,{type:"file",accept:"image/*",multiple:!0,onChange:i,className:"hidden",disabled:n}),r.jsxs(te,{type:"button",variant:"outline",size:"sm",disabled:n,onClick:c=>{var f;c.preventDefault(),(f=c.currentTarget.previousElementSibling)==null||f.click()},children:[r.jsx(Un,{className:"h-4 w-4 mr-2"}),n?"Uploading...":"Upload Images"]})]})]})}),r.jsxs(ye,{children:[e.length===0?r.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[r.jsx("p",{className:"text-sm mb-2",children:"No product images uploaded yet"}),r.jsx("p",{className:"text-xs",children:"Upload images to use in invoice line items"})]}):r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:e.map(c=>r.jsxs("div",{className:"relative group rounded-lg border border-border overflow-hidden bg-muted",children:[r.jsxs("div",{className:"aspect-square relative",children:[r.jsx("img",{src:c.url,alt:c.name,className:"w-full h-full object-cover"}),r.jsxs("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[r.jsx(te,{size:"icon",variant:"secondary",onClick:()=>a(c.id),title:c.isDefault?"Default image":"Set as default",children:c.isDefault?r.jsx(Wn,{className:"h-4 w-4 fill-yellow-500 text-yellow-500"}):r.jsx(Gn,{className:"h-4 w-4"})}),r.jsx(te,{size:"icon",variant:"destructive",onClick:()=>d(c.id),title:"Remove image",children:r.jsx(Hn,{className:"h-4 w-4"})})]})]}),r.jsxs("div",{className:"p-2 bg-background",children:[r.jsx("p",{className:"text-xs truncate",title:c.name,children:c.name}),c.isDefault&&r.jsx("p",{className:"text-xs text-primary font-medium",children:"Default"})]})]},c.id))}),r.jsx("p",{className:"text-xs text-muted-foreground mt-4",children:"Upload product images to use in invoice line items. Mark one as default to automatically apply it to line items. Max 5MB per image."})]})]})},ho=()=>{const e=kn(),{id:t}=Mn(),[n,s]=l.useState(null),[o,i]=l.useState(!1),[d,a]=l.useState(!1),[c,f]=l.useState(""),[u,p]=l.useState(""),[g,m]=l.useState(!1),[y,v]=l.useState(Ut),[h,x]=l.useState({primaryColor:"#4F46E5",secondaryColor:"#8B5CF6",fontFamily:"Arial",pageMargin:20,logoUrl:""}),[w,j]=l.useState([]);l.useEffect(()=>{D()},[]),l.useEffect(()=>{t&&n&&R()},[t,n]);const D=async()=>{const{data:{user:b}}=await Ge.auth.getUser();if(!b){he.error("Please sign in to create templates"),e("/auth");return}s(b)},R=async()=>{if(!t)return;const{data:b,error:T}=await Ge.from("invoice_templates").select("*").eq("id",t).single();if(T){he.error("Failed to load template"),console.error(T);return}if(b){f(b.name),p(b.description||""),m(b.is_default);const I=b.template_data;v(I.sections||Ut),j(I.productImages||[]),I.globalStyling&&x({primaryColor:I.globalStyling.primaryColor||"#4F46E5",secondaryColor:I.globalStyling.secondaryColor||"#8B5CF6",fontFamily:I.globalStyling.fontFamily||"Arial",pageMargin:I.globalStyling.pageMargin||20,logoUrl:I.globalStyling.logoUrl||""})}},E=b=>{const{active:T,over:I}=b;I&&T.id!==I.id&&v(L=>{const ge=L.findIndex(J=>J.id===T.id),we=L.findIndex(J=>J.id===I.id);return kt(L,ge,we).map((J,q)=>({...J,order:q}))})},N=(b,T)=>{v(I=>I.map(L=>L.id===b?{...L,...T}:L))},C=()=>{const b={id:`custom_${Date.now()}`,type:"custom",title:"Custom Section",visible:!0,order:y.length,fields:[]};v([...y,b]),he.success("Custom section added")},k=b=>{v(T=>T.filter(I=>I.id!==b)),he.success("Section removed")},M=async()=>{if(!c.trim()){he.error("Please enter a template name");return}i(!0);const b={name:c,description:u,template_data:{sections:y,globalStyling:h,productImages:w},is_default:g};try{if(t){const{error:T}=await Ge.from("invoice_templates").update(b).eq("id",t);if(T)throw T;he.success("Template updated successfully")}else{const{error:T}=await Ge.from("invoice_templates").insert({user_id:n.id,...b});if(T)throw T;he.success("Template created successfully")}e("/invoice-templates")}catch(T){console.error("Error saving template:",T),he.error("Failed to save template")}finally{i(!1)}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-muted/20 p-4 md:p-8",children:r.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs(te,{variant:"ghost",onClick:()=>e("/invoice-templates"),className:"gap-2",children:[r.jsx(Xn,{className:"h-4 w-4"}),"Back to Templates"]}),r.jsx(Vn,{})]}),r.jsxs("div",{className:"text-center space-y-4",children:[r.jsxs("h1",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-primary via-accent to-primary bg-clip-text text-transparent",children:[t?"Edit":"Create"," Invoice Template"]}),r.jsx("p",{className:"text-muted-foreground text-lg max-w-2xl mx-auto",children:"Design beautiful, professional invoices with product images, business branding, and customizable layouts - all with simple drag-and-drop"})]}),r.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[r.jsxs("div",{className:"space-y-6",children:[r.jsxs(be,{children:[r.jsx(Ee,{children:r.jsx(Te,{children:"Template Details"})}),r.jsxs(ye,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(ve,{children:"Template Name *"}),r.jsx(me,{value:c,onChange:b=>f(b.target.value),placeholder:"e.g., Premium Invoice Template"})]}),r.jsxs("div",{children:[r.jsx(ve,{children:"Description"}),r.jsx(Ln,{value:u,onChange:b=>p(b.target.value),placeholder:"Describe this template...",rows:3})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(ve,{children:"Set as Default Template"}),r.jsx(tn,{checked:g,onCheckedChange:m})]})]})]}),r.jsxs(be,{children:[r.jsx(Ee,{children:r.jsx(Te,{children:"Business Logo"})}),r.jsxs(ye,{children:[r.jsx(tr,{onUploadComplete:b=>x({...h,logoUrl:b}),currentImage:h.logoUrl}),r.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Upload your company logo to appear on the invoice header"})]})]}),r.jsx(Gs,{globalStyling:h,onUpdate:x}),r.jsx(Hs,{images:w,onUpdate:j}),r.jsxs(be,{children:[r.jsxs(Ee,{className:"flex flex-row items-center justify-between",children:[r.jsx(Te,{children:"Template Sections"}),r.jsxs(te,{onClick:C,size:"sm",variant:"outline",children:[r.jsx(_n,{className:"h-4 w-4 mr-2"}),"Add Custom Section"]})]}),r.jsx(ye,{children:r.jsx(bs,{collisionDetection:yr,onDragEnd:E,children:r.jsx(ks,{items:y.map(b=>b.id),strategy:Is,children:r.jsx("div",{className:"space-y-3",children:y.map(b=>r.jsx(Us,{section:b,onUpdate:N,onRemove:k},b.id))})})})})]})]}),r.jsx("div",{className:"lg:sticky lg:top-6 h-fit",children:r.jsxs(be,{children:[r.jsx(Ee,{children:r.jsx(Te,{children:"Live Preview"})}),r.jsx(ye,{children:r.jsx(Ws,{sections:y,globalStyling:h,productImages:w})})]})})]}),r.jsxs("div",{className:"flex justify-center gap-4",children:[r.jsxs(te,{onClick:()=>a(!d),variant:"outline",size:"lg",children:[r.jsx(en,{className:"mr-2 h-5 w-5"}),d?"Hide":"Show"," Full Preview"]}),r.jsxs(te,{onClick:M,size:"lg",disabled:o,children:[r.jsx(Yn,{className:"mr-2 h-5 w-5"}),o?"Saving...":"Save Template"]})]})]})})};export{ho as default};
//# sourceMappingURL=InvoiceTemplateBuilder-ByWRjhtw.js.map
