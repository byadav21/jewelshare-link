{"version":3,"file":"WhatsAppButton-B0ESRJlY.js","sources":["../../src/components/WhatsAppButton.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { MessageCircle, X } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { useKeyboardHeight } from \"@/hooks/useKeyboardHeight\";\r\n\r\ninterface WhatsAppButtonProps {\r\n  whatsappNumber?: string;\r\n  message?: string;\r\n  businessName?: string;\r\n}\r\n\r\nexport const WhatsAppButton = ({ \r\n  whatsappNumber: propNumber, \r\n  message: propMessage,\r\n  businessName \r\n}: WhatsAppButtonProps = {}) => {\r\n  const [isExpanded, setIsExpanded] = useState(false);\r\n  const [whatsappNumber, setWhatsappNumber] = useState(propNumber || \"1234567890\");\r\n  const { keyboardHeight, isKeyboardVisible } = useKeyboardHeight();\r\n\r\n  useEffect(() => {\r\n    if (!propNumber) {\r\n      fetchWhatsAppNumber();\r\n    }\r\n  }, [propNumber]);\r\n\r\n  const fetchWhatsAppNumber = async () => {\r\n    const { data, error } = await supabase\r\n      .from(\"settings\")\r\n      .select(\"value\")\r\n      .eq(\"key\", \"whatsapp_number\")\r\n      .maybeSingle();\r\n\r\n    if (!error && data) {\r\n      // Remove quotes from JSON string value\r\n      const number = String(data.value).replace(/\"/g, \"\");\r\n      setWhatsappNumber(number);\r\n    }\r\n  };\r\n\r\n  const handleWhatsAppClick = () => {\r\n    const defaultMessage = businessName \r\n      ? `Hi! I'm interested in your jewelry collection from ${businessName}.`\r\n      : \"Hi! I'm interested in learning more about your jewelry catalog platform.\";\r\n    \r\n    const message = encodeURIComponent(propMessage || defaultMessage);\r\n    const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${message}`;\r\n    \r\n    window.open(whatsappUrl, '_blank', 'noopener,noreferrer');\r\n  };\r\n\r\n  // Calculate dynamic bottom positions based on keyboard\r\n  const expandedBottomPosition = isKeyboardVisible \r\n    ? `${keyboardHeight + 80}px` \r\n    : '6rem';\r\n  \r\n  const buttonBottomPosition = isKeyboardVisible \r\n    ? `${keyboardHeight + 16}px` \r\n    : '1rem';\r\n\r\n  return (\r\n    <>\r\n      <AnimatePresence>\r\n        {isExpanded && (\r\n          <motion.div\r\n            initial={{ opacity: 0, scale: 0.8, y: 20 }}\r\n            animate={{ \r\n              opacity: 1, \r\n              scale: 1, \r\n              y: 0,\r\n              bottom: expandedBottomPosition\r\n            }}\r\n            exit={{ opacity: 0, scale: 0.8, y: 20 }}\r\n            transition={{ duration: 0.3, ease: \"easeOut\" }}\r\n            className=\"fixed right-4 z-50 md:right-6\"\r\n          >\r\n            <div className=\"relative rounded-lg border-2 border-emerald-500/20 bg-background p-4 shadow-2xl\">\r\n              <button\r\n                onClick={() => setIsExpanded(false)}\r\n                className=\"absolute -right-2 -top-2 rounded-full bg-background p-1 shadow-lg transition-colors hover:bg-muted\"\r\n                aria-label=\"Close chat\"\r\n              >\r\n                <X className=\"h-4 w-4\" />\r\n              </button>\r\n              \r\n              <div className=\"w-64 space-y-3\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"flex h-10 w-10 items-center justify-center rounded-full bg-emerald-500\">\r\n                    <MessageCircle className=\"h-5 w-5 text-white\" />\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"font-semibold\">Chat with us</p>\r\n                    <p className=\"text-xs text-muted-foreground\">We typically reply instantly</p>\r\n                  </div>\r\n                </div>\r\n                \r\n                <p className=\"text-sm text-muted-foreground\">\r\n                  {businessName \r\n                    ? `Have questions about ${businessName}'s jewelry collection? We're here to help!`\r\n                    : \"Have questions about our jewelry catalog platform? We're here to help!\"\r\n                  }\r\n                </p>\r\n                \r\n                <Button\r\n                  onClick={handleWhatsAppClick}\r\n                  className=\"w-full gap-2 bg-emerald-500 hover:bg-emerald-600\"\r\n                >\r\n                  <MessageCircle className=\"h-4 w-4\" />\r\n                  Start Chat on WhatsApp\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      <motion.div\r\n        initial={{ scale: 0 }}\r\n        animate={{ \r\n          scale: 1,\r\n          bottom: buttonBottomPosition\r\n        }}\r\n        transition={{ duration: 0.3, ease: \"easeOut\" }}\r\n        className=\"fixed right-4 z-50 md:right-6 group\"\r\n      >\r\n        <Button\r\n          onClick={() => setIsExpanded(!isExpanded)}\r\n          size=\"icon\"\r\n          className=\"h-14 w-14 rounded-full bg-emerald-500/60 shadow-lg transition-all hover:bg-emerald-600 hover:scale-110 opacity-60 hover:opacity-100\"\r\n          aria-label=\"Open WhatsApp chat\"\r\n        >\r\n          <MessageCircle className=\"h-6 w-6 text-white\" />\r\n        </Button>\r\n      </motion.div>\r\n    </>\r\n  );\r\n};"],"names":["WhatsAppButton","propNumber","propMessage","businessName","isExpanded","setIsExpanded","useState","whatsappNumber","setWhatsappNumber","keyboardHeight","isKeyboardVisible","useKeyboardHeight","useEffect","fetchWhatsAppNumber","data","error","supabase","number","handleWhatsAppClick","defaultMessage","message","whatsappUrl","expandedBottomPosition","buttonBottomPosition","jsxs","Fragment","jsx","AnimatePresence","motion","X","MessageCircle","Button"],"mappings":"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"}