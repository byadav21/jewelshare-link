import{j as e}from"./query-vendor-BLxHmmGk.js";import{u as k,r as o}from"./react-vendor-BeR0k5Z3.js";import{w as D,A as d,B as l,C as A,i as M,k as B,g as P,s as j}from"./index-CX6yiz0b.js";import{T as E,a as I,b as f,c as i,d as V,e as n}from"./table-CYMzKz5T.js";import{B as F}from"./badge-45Abp579.js";import{E as v,aP as p,ar as H,u as t,aV as R,aW as Y}from"./ui-vendor-DjQqXt9S.js";import{u as U}from"./useVendorPermissions-CoV6zMFq.js";import"./supabase-vendor-VSDMYZ1k.js";const X=()=>{const m=k(),{role:c,loading:g}=D(),{permissions:x,loading:w}=U(),[r,N]=o.useState([]),[b,y]=o.useState(!0),C=c==="admin"||c==="team_member"||x.can_view_sessions,u=c==="admin"||x.can_manage_sessions,h=async()=>{try{const{data:a,error:s}=await j.from("user_sessions").select("*").order("last_activity",{ascending:!1});if(s)throw s;N(a||[])}catch{t.error("Failed to load sessions")}finally{y(!1)}};o.useEffect(()=>{h()},[]);const _=async a=>{if(!u){t.error("You don't have permission to manage sessions");return}try{const{error:s}=await j.from("user_sessions").delete().eq("id",a);if(s)throw s;t.success("Session removed successfully"),h()}catch{t.error("Failed to remove session")}},L=a=>{const s=a.toLowerCase();return s.includes("mobile")||s.includes("android")||s.includes("iphone")?e.jsx(R,{className:"h-4 w-4"}):s.includes("tablet")||s.includes("ipad")?e.jsx(Y,{className:"h-4 w-4"}):e.jsx(p,{className:"h-4 w-4"})},S=a=>{const s=a.toLowerCase();return s.includes("mobile")||s.includes("android")?"Mobile (Android)":s.includes("iphone")?"Mobile (iPhone)":s.includes("ipad")?"Tablet (iPad)":s.includes("mac")?"Desktop (Mac)":s.includes("windows")?"Desktop (Windows)":s.includes("linux")?"Desktop (Linux)":"Unknown Device"},T=a=>!1;return g||w?e.jsx(d,{children:e.jsx("div",{className:"container mx-auto p-6 max-w-6xl",children:e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"animate-pulse text-primary",children:"Loading..."})})})}):C?e.jsx(d,{children:e.jsxs("div",{className:"container mx-auto p-6 max-w-6xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Active Sessions"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage your active devices (Maximum 5 devices)"})]}),e.jsxs(l,{variant:"outline",onClick:()=>m("/"),children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"Back to Catalog"]})]}),e.jsxs(A,{children:[e.jsx(M,{children:e.jsx(B,{children:"Your Devices"})}),e.jsx(P,{children:b?e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"animate-pulse text-primary",children:"Loading sessions..."})}):r.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(p,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No active sessions found"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.length," of 5 devices active"]}),r.length>=5&&e.jsx(F,{variant:"destructive",children:"Maximum devices reached"})]}),e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs(f,{children:[e.jsx(i,{children:"Device"}),e.jsx(i,{children:"IP Address"}),e.jsx(i,{children:"Last Active"}),e.jsx(i,{children:"Logged In"}),e.jsx(i,{children:"Actions"})]})}),e.jsx(V,{children:r.map(a=>e.jsxs(f,{children:[e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[L(a.device_info),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:S(a.device_info)}),T(a.session_id)]})]})}),e.jsx(n,{className:"font-mono text-sm",children:a.ip_address}),e.jsx(n,{children:new Date(a.last_activity).toLocaleString()}),e.jsx(n,{children:new Date(a.created_at).toLocaleString()}),e.jsx(n,{children:u?e.jsx(l,{size:"sm",variant:"ghost",onClick:()=>_(a.id),children:e.jsx(H,{className:"h-4 w-4 text-destructive"})}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"View only"})})]},a.id))})]})]})})]})]})}):e.jsx(d,{children:e.jsx("div",{className:"container mx-auto p-6 max-w-6xl",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:"You don't have permission to view active sessions"}),e.jsxs(l,{variant:"outline",onClick:()=>m("/"),className:"mt-4",children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"Back to Catalog"]})]})})})};export{X as default};
//# sourceMappingURL=ActiveSessions-o-fBNk0v.js.map
