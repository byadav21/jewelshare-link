import{j as e}from"./query-vendor-CIvqgC9B.js";import{r as l,u as He}from"./react-vendor-BCzWReGx.js";import{C as we,t as pt,o as xt,W as Ht,S as H,B as C,X as Yt,l as R,k as W,x as Kt,G as je,A as Ve,H as be,I as Ne,J as ve,Y as Qt,Z as Jt}from"./index-DBHw7ps1.js";import{C as _e}from"./checkbox-UeKqwDGT.js";import{B as ee}from"./badge-HmGNQ04n.js";import{O as Zt}from"./OptimizedImage-CZRxPWyo.js";import{g as ft,h as Xt,E as es,Z as ts,a2 as ss,d as he,e as re,j as as,ai as rs,Y as is,X as yt,u as _,aB as ns,Q as tt,aU as ls,ag as os,P as ye,o as Be,p as jt,aM as cs,m as ds,aZ as st,l as ms,ay as Ge,A as hs,aE as us,ak as at,aJ as gs,T as ps,H as rt,V as it,aj as nt,a_ as lt,a$ as ot,U as ct,b0 as xs,aG as fs,aY as dt,b1 as ys,a8 as js}from"./ui-vendor-B3Ur81tx.js";import{C as bs}from"./CatalogFilters-CR-GjX2q.js";import{D as Ce,b as ke,c as Se,d as Pe,e as De,f as bt}from"./dialog-acGhLkoK.js";import{S as Ye}from"./scroll-area-CVjIZmgT.js";import{N as Ns,D as vs,a as _s,b as ws,c as B,d as Ie}from"./NavLink-B_nTQT1l.js";import{u as Cs}from"./useVendorPermissions-DsnlAYIJ.js";import{E as ks,a as Ss}from"./jspdf.plugin.autotable-BU4UTuZh.js";import{P as Ps}from"./PlanLimitWarning-Dvbnb2vk.js";import{P as mt}from"./progress-DER2Hipk.js";import{A as Ds,a as Fs}from"./alert-D-6GOIHR.js";import{I}from"./input-CpEp8mrX.js";import{L as k}from"./label-Di_dI0OZ.js";import{u as Nt}from"./useKeyboardHeight-BG0IWOn_.js";import{S as Ue,a as $e,b as Ee,c as ze,d as J}from"./select-B1aOqld7.js";import{T as Ls,a as Ts,b as Me,c as We}from"./tabs-BCLftEi3.js";import{T as Rs,a as As,b as ht,c as Oe,d as Is,e as qe}from"./table-CywLfQKL.js";import{z as T}from"./index-ibl8YJur.js";import{A as Us,a as $s,b as Es,c as zs,d as Ms,e as Ws,f as Os,g as qs}from"./alert-dialog-C5S5s-18.js";import{H as Vs}from"./Header-DHpmpg_r.js";import{B as Bs,a as Gs,b as ut,c as Hs,d as Ys,e as Ks}from"./breadcrumb-B-6L9B5f.js";import"./supabase-vendor-DJknrin8.js";import"./index-D6hZrTqZ.js";import"./index-BswhvY0M.js";import"./index-vsC2Ycwh.js";import"./index-lgWsV-kP.js";import"./index-BdQq_4o_.js";import"./index-vM6_qKqc.js";import"./sheet-BWMSKSTq.js";const Qs=({product:t,isSelected:o,onToggleSelection:m,usdRate:c,vendorLogoUrl:h})=>{const p=[t.image_url,t.image_url_2,t.image_url_3].filter(Boolean),[n,i]=l.useState(0),[y,N]=l.useState(!1),U=()=>{i(x=>(x+1)%p.length)},g=()=>{i(x=>(x-1+p.length)%p.length)},r=()=>{N(!0),p.length>1&&U()},u=()=>{N(!1),i(0)};return e.jsx("div",{className:"transform hover:-translate-y-2 transition-transform duration-300",children:e.jsxs(we,{className:"overflow-hidden relative group bg-gradient-to-b from-card to-card/95 border-border/50 shadow-lg hover:shadow-2xl hover:shadow-primary/10 transition-all duration-300 active:scale-[0.98] touch-manipulation",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 via-transparent to-accent/5 opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"}),e.jsx("div",{className:"absolute top-3 left-3 z-10",onClick:x=>x.stopPropagation(),children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-primary/20 blur-md rounded opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsx(_e,{checked:o,onCheckedChange:x=>{m(t.id)},className:"relative bg-background/95 backdrop-blur-sm border-2 border-primary/30 w-5 h-5 sm:w-6 sm:h-6 shadow-lg cursor-pointer"})]})}),p.length>0?e.jsxs("div",{className:"aspect-square overflow-hidden bg-muted relative group",onMouseEnter:r,onMouseLeave:u,children:[e.jsx(Zt,{src:p[n],alt:`${t.name} - Image ${n+1}`,className:"w-full h-full object-cover",width:400,height:400,blurPlaceholder:!0,priority:!1}),p.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:g,className:"absolute left-1 sm:left-2 top-1/2 -translate-y-1/2 bg-background/90 hover:bg-background p-1.5 sm:p-2 rounded-full opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-all duration-300 active:scale-95 shadow-lg touch-manipulation","aria-label":"Previous image",children:e.jsx(ft,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),e.jsx("button",{onClick:U,className:"absolute right-1 sm:right-2 top-1/2 -translate-y-1/2 bg-background/90 hover:bg-background p-1.5 sm:p-2 rounded-full opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-all duration-300 active:scale-95 shadow-lg touch-manipulation","aria-label":"Next image",children:e.jsx(Xt,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),e.jsx("div",{className:"absolute bottom-2 sm:bottom-3 left-1/2 -translate-x-1/2 flex gap-1.5 sm:gap-2 bg-background/80 backdrop-blur-sm px-2 sm:px-3 py-1 sm:py-1.5 rounded-full",children:p.map((x,A)=>e.jsx("button",{onClick:()=>i(A),className:`transition-all duration-300 rounded-full touch-manipulation ${A===n?"bg-primary w-5 sm:w-6 h-1.5 sm:h-2":"bg-muted-foreground/40 w-1.5 sm:w-2 h-1.5 sm:h-2 active:bg-muted-foreground/60"}`,"aria-label":`Go to image ${A+1}`},A))}),e.jsxs("div",{className:"absolute top-2 sm:top-3 right-2 sm:right-3 bg-background/90 backdrop-blur-sm px-2 sm:px-2.5 py-0.5 sm:py-1 rounded-full text-[10px] sm:text-xs font-medium shadow-sm",children:[n+1," / ",p.length]})]})]}):e.jsx("div",{className:"aspect-square overflow-hidden bg-muted flex items-center justify-center",children:e.jsx(es,{className:"h-24 w-24 text-muted-foreground/30"})}),e.jsxs(pt,{className:"p-4 sm:p-6 relative",children:[e.jsx("h3",{className:"font-serif text-lg sm:text-xl font-bold text-foreground group-hover:text-primary transition-colors duration-300",children:t.name}),t.sku&&e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground/80 mb-3 font-medium",children:["SKU: ",t.sku]}),e.jsxs("div",{className:"space-y-1.5 sm:space-y-2 text-xs sm:text-sm border-t border-border/50 pt-3 sm:pt-4 bg-gradient-to-b from-transparent to-muted/20 -mx-4 sm:-mx-6 px-4 sm:px-6 pb-2",children:[t.diamond_color&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground font-medium",children:"Diamond Color:"}),e.jsx("span",{className:"text-foreground font-semibold",children:t.diamond_color})]}),t.clarity&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground font-medium",children:"Diamond Clarity:"}),e.jsx("span",{className:"text-foreground font-semibold",children:t.clarity})]}),t.diamond_weight&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground font-medium",children:"T DWT:"}),e.jsxs("span",{className:"text-foreground font-semibold",children:[t.diamond_weight,"g"]})]}),t.weight_grams&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground font-medium",children:"Gross Weight:"}),e.jsxs("span",{className:"text-foreground font-semibold",children:[t.weight_grams,"g"]})]}),t.net_weight&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground font-medium",children:"NET WT:"}),e.jsxs("span",{className:"text-foreground font-semibold",children:[t.net_weight,"g"]})]})]}),t.metal_type&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground font-medium",children:"Metal Type:"}),e.jsx("span",{className:"text-foreground font-semibold",children:t.metal_type})]}),t.purity_fraction_used&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground font-medium",children:"Metal Purity:"}),e.jsxs("span",{className:"text-foreground font-semibold",children:[(t.purity_fraction_used*100).toFixed(0),"%"]})]})]})]}),e.jsxs(xt,{className:"p-3 sm:p-6",children:[t.description&&e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-2 sm:mb-3 line-clamp-2",children:t.description}),t.category&&e.jsxs("div",{className:"text-xs sm:text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Category:"})," ",e.jsx("span",{className:"text-foreground font-medium",children:t.category})]})]}),e.jsxs(Ht,{className:"flex flex-col gap-3.5 border-t border-border/50 p-4 sm:p-6 pt-4 sm:pt-5 bg-gradient-to-b from-muted/5 to-transparent",children:[t.delivery_type&&e.jsx("div",{className:"w-full",children:t.delivery_type==="immediate delivery"?e.jsxs(ee,{variant:"secondary",className:"w-full justify-center gap-2 py-2 bg-gradient-to-r from-emerald-500/20 via-green-500/20 to-emerald-500/20 border-emerald-500/40 text-emerald-700 dark:text-emerald-400 hover:from-emerald-500/30 hover:to-green-500/30 shadow-sm font-semibold",children:[e.jsx(ts,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"text-xs",children:"Immediate Dispatch"})]}):e.jsxs(ee,{variant:"outline",className:"w-full justify-center gap-2 py-2 border-primary/40 text-primary hover:bg-primary/10 shadow-sm font-semibold",children:[e.jsx(ss,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"text-xs",children:t.delivery_type})]})}),e.jsxs("div",{className:"flex justify-between w-full items-end",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground font-medium",children:"Retail Price"}),e.jsxs("div",{className:"relative",children:[e.jsxs("p",{className:"text-xl sm:text-2xl font-bold bg-gradient-to-r from-primary via-primary to-accent bg-clip-text text-transparent drop-shadow-sm",children:["â‚¹",t.retail_price.toLocaleString("en-IN")]}),e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-primary/20 to-accent/20 blur-lg opacity-30 -z-10"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground font-medium",children:["$",(t.retail_price/c).toLocaleString("en-US",{maximumFractionDigits:0})]})]}),e.jsxs("div",{className:"text-right space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground font-medium",children:"Stock"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-foreground",children:t.stock_quantity})]})]})]})]})})},Js=l.memo(Qs,(t,o)=>t.product.id===o.product.id&&t.isSelected===o.isSelected&&t.usdRate===o.usdRate&&t.product.retail_price===o.product.retail_price),Zs=()=>e.jsxs(we,{className:"overflow-hidden bg-gradient-to-b from-card to-card/95 border-border/50 shadow-lg",children:[e.jsx(H,{className:"aspect-square w-full"}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{className:"h-6 w-3/4"}),e.jsx(H,{className:"h-4 w-1/2"})]}),e.jsxs("div",{className:"space-y-2 border-t border-border/50 pt-3",children:[e.jsx(H,{className:"h-3 w-full"}),e.jsx(H,{className:"h-3 w-full"}),e.jsx(H,{className:"h-3 w-2/3"})]}),e.jsxs("div",{className:"border-t border-border/50 pt-4",children:[e.jsx(H,{className:"h-10 w-full mb-3"}),e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{className:"h-3 w-16"}),e.jsx(H,{className:"h-8 w-24"})]}),e.jsxs("div",{className:"space-y-2 text-right",children:[e.jsx(H,{className:"h-3 w-12"}),e.jsx(H,{className:"h-8 w-12"})]})]})]})]})]}),Xs=[{category:"Ladies Rings",patterns:[/\bCLR\d+/i,/ladies?\s*rings?/i,/women'?s?\s*rings?/i,/female\s*rings?/i],priority:10},{category:"Gents Rings",patterns:[/\bCGR\d+/i,/gents?\s*rings?/i,/men'?s?\s*rings?/i,/male\s*rings?/i],priority:10},{category:"Rings",patterns:[/\brings?\b/i,/\bband\b/i,/\bwedding\s*band/i],priority:5},{category:"Ladies Bangles",patterns:[/\bCLB\d+/i,/ladies?\s*bangles?/i,/women'?s?\s*bangles?/i,/kadas?/i],priority:10},{category:"Gents Bangles",patterns:[/\bCGB\d+/i,/gents?\s*bangles?/i,/men'?s?\s*bangles?/i],priority:10},{category:"Bangles",patterns:[/\bbangles?\b/i,/\bbracelets?\b/i],priority:5},{category:"Bracelets",patterns:[/\bCBR\d+/i,/\bbracelets?\b/i,/\bwrist\s*band/i,/\bchain\s*bracelet/i],priority:8},{category:"Necklaces",patterns:[/\bCLN\d+/i,/\bnecklaces?\b/i,/\bhaar\b/i,/\bmangalsutra/i,/\bchoker/i,/\bcollar\b/i],priority:9},{category:"Earrings",patterns:[/\bCLE\d+/i,/\bearrings?\b/i,/\bstuds?\b/i,/\bhoops?\b/i,/\bdrops?\b/i,/\bjhumka/i,/\bjhumki/i],priority:9},{category:"Pendants",patterns:[/\bCLP\d+/i,/\bpendants?\b/i,/\blockets?\b/i,/\bcharm\b/i],priority:9},{category:"Chains",patterns:[/\bCLC\d+/i,/\bchains?\b/i,/\bgold\s*chain/i,/\bsilver\s*chain/i],priority:9},{category:"Toe Rings",patterns:[/\btoe\s*rings?/i,/\bmetti/i,/\bfoot\s*rings?/i],priority:9},{category:"Nose Pins",patterns:[/\bnose\s*pins?/i,/\bnath\b/i,/\bbullak/i],priority:9},{category:"Mangalsutra",patterns:[/\bmangalsutra/i,/\bthali/i],priority:9},{category:"Anklets",patterns:[/\banklets?/i,/\bpayal/i,/\bpajeb/i],priority:9},{category:"Sets",patterns:[/\bsets?\b/i,/\bcomplete\s*set/i,/\bbridal\s*set/i,/\bjewel(?:le)?ry\s*set/i],priority:8}];function ea(t,o){const m=`${t} ${o||""}`,c=[...Xs].sort((h,p)=>p.priority-h.priority);for(const{category:h,patterns:p,priority:n}of c)for(const i of p)if(i.test(m)){let y;return n>=10?y="high":n>=7?y="medium":y="low",{category:h,confidence:y,pattern:i.source}}return null}function ta(t){const o=[];for(const m of t){if(m.category)continue;const c=ea(m.name,m.sku);c&&o.push({productId:m.id,productName:m.name,currentCategory:m.category,suggestedCategory:c.category,confidence:c.confidence,matchedPattern:c.pattern})}return o}function sa(t){const o=t.reduce((c,h)=>(c[h.suggestedCategory]=(c[h.suggestedCategory]||0)+1,c),{}),m=t.reduce((c,h)=>(c[h.confidence]=(c[h.confidence]||0)+1,c),{});return{total:t.length,byCategory:o,byConfidence:m}}function aa({open:t,onOpenChange:o,suggestions:m,onApply:c}){const[h,p]=l.useState(new Set(m.map(u=>u.productId))),[n,i]=l.useState(!1),y=sa(m),N=u=>{const x=new Set(h);x.has(u)?x.delete(u):x.add(u),p(x)},U=()=>{h.size===m.length?p(new Set):p(new Set(m.map(u=>u.productId)))},g=async()=>{i(!0);try{await c(Array.from(h)),o(!1)}finally{i(!1)}},r=u=>{switch(u){case"high":return e.jsx(ee,{className:"bg-green-500/20 text-green-700 dark:text-green-400",children:"High"});case"medium":return e.jsx(ee,{className:"bg-yellow-500/20 text-yellow-700 dark:text-yellow-400",children:"Medium"});case"low":return e.jsx(ee,{className:"bg-orange-500/20 text-orange-700 dark:text-orange-400",children:"Low"});default:return null}};return e.jsx(Ce,{open:t,onOpenChange:o,children:e.jsxs(ke,{className:"max-w-4xl max-h-[80vh]",children:[e.jsxs(Se,{children:[e.jsxs(Pe,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5 text-primary"}),"Smart Category Suggestions"]}),e.jsxs(De,{children:["Found ",y.total," products that can be auto-categorized based on their names and SKUs"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 py-4",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:y.total}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Suggestions"})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:y.byConfidence.high||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"High Confidence"})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:y.byConfidence.medium||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Medium Confidence"})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:y.byConfidence.low||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Low Confidence"})]})]}),e.jsxs("div",{className:"py-2",children:[e.jsxs("div",{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),"Categories Found"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(y.byCategory).map(([u,x])=>e.jsxs(ee,{variant:"secondary",children:[u,": ",x]},u))})]}),e.jsx(Ye,{className:"h-[300px] border rounded-lg",children:e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b sticky top-0 bg-background",children:[e.jsx(_e,{checked:h.size===m.length,onCheckedChange:U}),e.jsxs("span",{className:"text-sm font-medium",children:["Select All (",h.size,"/",m.length,")"]})]}),m.map(u=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border bg-card hover:bg-muted/50 transition-colors",children:[e.jsx(_e,{checked:h.has(u.productId),onCheckedChange:()=>N(u.productId)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:u.productName}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"â†’"}),e.jsx(ee,{variant:"outline",className:"text-xs",children:u.suggestedCategory}),r(u.confidence)]})]})]},u.productId))]})}),e.jsxs(bt,{children:[e.jsx(C,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsxs(C,{onClick:g,disabled:h.size===0||n,children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Apply ",h.size," Categories"]})]})]})})}const gt=999999,Ke=()=>{const[t,o]=l.useState(null),[m,c]=l.useState(null),[h,p]=l.useState(!0),n=l.useCallback(async()=>{try{p(!0);const g=await Yt();if(!g){p(!1);return}const[r,u,x]=await Promise.all([R.from("vendor_permissions").select("subscription_plan, max_products, max_share_links, max_team_members, max_product_images").eq("user_id",g.id).single(),R.from("products").select("id",{count:"exact",head:!0}).eq("user_id",g.id).is("deleted_at",null),R.from("share_links").select("id",{count:"exact",head:!0}).eq("user_id",g.id)]);if(r.error)throw r.error;o(r.data),c({products_count:u.count||0,share_links_count:x.count||0})}catch(g){console.error("Error fetching limits:",g)}finally{p(!1)}},[]);if(l.useEffect(()=>{n()},[n]),!t||!m)return{canAddProducts:!0,canAddShareLinks:!0,productsRemaining:0,shareLinksRemaining:0,productUsagePercent:0,shareLinksUsagePercent:0,plan:null,limits:null,usage:null,loading:h,refresh:n};const i=m.products_count/t.max_products*100,y=m.share_links_count/t.max_share_links*100,N=t.max_products===gt,U=t.max_share_links===gt;return{canAddProducts:N||m.products_count<t.max_products,canAddShareLinks:U||m.share_links_count<t.max_share_links,productsRemaining:N?1/0:t.max_products-m.products_count,shareLinksRemaining:U?1/0:t.max_share_links-m.share_links_count,productUsagePercent:i,shareLinksUsagePercent:y,plan:t.subscription_plan,limits:t,usage:m,loading:h,refresh:n}},ra=(t,o,m,c,h,p)=>{var g;const n=new ks("landscape","mm","a4"),i=n.internal.pageSize.getWidth();if(n.setFontSize(20),n.setFont("helvetica","bold"),n.text((o==null?void 0:o.business_name)||"Product Catalog",i/2,20,{align:"center"}),o){n.setFontSize(10),n.setFont("helvetica","normal");let r=30;o.address_line1&&(n.text(`${o.address_line1}${o.address_line2?", "+o.address_line2:""}`,i/2,r,{align:"center"}),r+=5),o.city&&(n.text(`${o.city}, ${o.state} ${o.pincode}`,i/2,r,{align:"center"}),r+=5);const u=[];o.email&&u.push(`Email: ${o.email}`),o.phone&&u.push(`Phone: ${o.phone}`),o.whatsapp_number&&u.push(`WhatsApp: ${o.whatsapp_number}`),u.length>0&&n.text(u.join(" | "),i/2,r,{align:"center"})}n.setFillColor(248,250,252),n.rect(0,45,i,8,"F"),n.setFontSize(8.5),n.setFont("helvetica","bold"),n.setTextColor(70,70,80),n.text(`Date: ${new Date().toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})} | Exchange Rate: 1 USD = Rs.${m.toFixed(2)} | Gold Rate (24K): Rs.${c.toLocaleString("en-IN")}/g`,i/2,49,{align:"center"});const y=t.map((r,u)=>[r.sku||`${u+1}`,r.name,r.diamond_color||"-",r.clarity||"-",r.d_wt_1?`${r.d_wt_1}`:"-",r.d_wt_2?`${r.d_wt_2}`:"-",r.diamond_weight?`${r.diamond_weight}`:"-",r.weight_grams?`${r.weight_grams}`:"-",r.net_weight?`${r.net_weight}`:"-",r.purity_fraction_used?`${r.purity_fraction_used>1?r.purity_fraction_used:(r.purity_fraction_used*100).toFixed(0)}%`:"-",r.d_rate_1?`${r.d_rate_1.toLocaleString("en-IN")}`:"-",r.pointer_diamond?`${r.pointer_diamond.toLocaleString("en-IN")}`:"-",r.d_value?`${r.d_value.toLocaleString("en-IN")}`:"-",r.gemstone||"NONE",r.mkg?`${r.mkg.toLocaleString("en-IN",{maximumFractionDigits:2})}`:"-",r.certification_cost?`${r.certification_cost.toLocaleString("en-IN")}`:"-",r.gemstone_cost?`${r.gemstone_cost.toLocaleString("en-IN")}`:"-",r.retail_price.toLocaleString("en-IN",{maximumFractionDigits:0}),r.total_usd?r.total_usd.toFixed(2):(r.retail_price/m).toFixed(2)]);Ss(n,{head:[["SKU","PRODUCT NAME",`DIAMOND
COLOR`,"CLARITY",`D.WT 1
(ct)`,`D.WT 2
(ct)`,`TOTAL
D.WT (ct)`,`GROSS
WT (g)`,`NET
WT (g)`,`PURITY
%`,`D RATE 1
(Rs/ct)`,`POINTER
DIAMOND`,`D VALUE
(Rs)`,`GEMSTONE
TYPE`,`MKG
(Rs)`,`CERT
COST (Rs)`,`GEM
COST (Rs)`,`TOTAL
(Rs)`,`TOTAL
(USD)`]],body:y,startY:53,styles:{fontSize:8,cellPadding:3,lineColor:[220,220,220],lineWidth:.15,overflow:"linebreak",halign:"left",valign:"middle",textColor:[50,50,50]},headStyles:{fillColor:[41,128,185],textColor:[255,255,255],fontStyle:"bold",halign:"center",fontSize:7.5,minCellHeight:14,valign:"middle",cellPadding:3},alternateRowStyles:{fillColor:[250,252,255]},columnStyles:{0:{cellWidth:15,halign:"left"},1:{cellWidth:32,halign:"left"},2:{cellWidth:12,halign:"center"},3:{cellWidth:12,halign:"center"},4:{cellWidth:12,halign:"right"},5:{cellWidth:12,halign:"right"},6:{cellWidth:14,halign:"right"},7:{cellWidth:12,halign:"right"},8:{cellWidth:12,halign:"right"},9:{cellWidth:12,halign:"right"},10:{cellWidth:14,halign:"right"},11:{cellWidth:14,halign:"right"},12:{cellWidth:14,halign:"right"},13:{cellWidth:16,halign:"center"},14:{cellWidth:14,halign:"right"},15:{cellWidth:13,halign:"right"},16:{cellWidth:13,halign:"right"},17:{cellWidth:22,halign:"right",fontStyle:"bold",textColor:[30,64,175]},18:{cellWidth:18,halign:"right",fontStyle:"bold",textColor:[30,64,175]}},margin:{top:53,left:5,right:5},tableWidth:"auto",didParseCell:function(r){r.column.index===17&&r.section==="body"&&(r.cell.text=[`Rs. ${r.cell.text[0]}`]),r.column.index===18&&r.section==="body"&&(r.cell.text=[`$ ${r.cell.text[0]}`])}});const N=n.lastAutoTable.finalY||50;n.setFillColor(250,252,255),n.roundedRect(14,N+6,i-28,20,2,2,"F"),n.setDrawColor(41,128,185),n.setLineWidth(.5),n.roundedRect(14,N+6,i-28,20,2,2,"S"),n.setFontSize(11),n.setFont("helvetica","bold"),n.setTextColor(41,128,185),n.text(`Total: Rs.${h.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})} | USD $${p.toFixed(2)}`,i/2,N+13,{align:"center"}),n.setTextColor(50,50,60),n.setFontSize(9),n.text(`Total Products: ${t.length}`,i/2,N+20,{align:"center"});const U=`catalog_${((g=o==null?void 0:o.business_name)==null?void 0:g.replace(/\s+/g,"_"))||"products"}_${new Date().toLocaleDateString("en-IN").replace(/\//g,"-")}.pdf`;n.save(U)},ia=()=>{const{productUsagePercent:t,shareLinksUsagePercent:o,productsRemaining:m,shareLinksRemaining:c,loading:h}=Ke();if(h)return null;const p=m===1/0,n=c===1/0,i=t>=80||o>=80,y=t>=100||o>=100;return i?e.jsx(Ds,{className:`mb-6 ${y?"border-destructive bg-destructive/5":"border-warning bg-warning/5"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[y?e.jsx(rs,{className:"h-5 w-5 text-destructive mt-0.5"}):e.jsx(re,{className:"h-5 w-5 text-warning mt-0.5"}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx(Fs,{className:"font-medium",children:y?"Plan Limits Reached":"Approaching Plan Limits"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Products"}),e.jsx("span",{className:"font-medium",children:p?"Unlimited":`${m} remaining`})]}),!p&&e.jsx(mt,{value:Math.min(t,100),className:t>=100?"[&>div]:bg-destructive":t>=80?"[&>div]:bg-warning":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Share Links"}),e.jsx("span",{className:"font-medium",children:n?"Unlimited":`${c} remaining`})]}),!n&&e.jsx(mt,{value:Math.min(o,100),className:o>=100?"[&>div]:bg-destructive":o>=80?"[&>div]:bg-warning":""})]})]})]})]})}):null},vt=({open:t,onOpenChange:o,limitType:m})=>{const c=He(),h=()=>{o(!1),c("/pricing")},p=()=>{switch(m){case"products":return"You've reached your product limit";case"share_links":return"You've reached your share link limit";default:return"You've reached your plan limit"}},n=[{name:"Professional",price:"â‚¹2,999/mo",features:["1,000 Products","10 Share Links","3 Team Members","Unlimited Product Images","Custom Orders","Import Data","Priority Support"]},{name:"Enterprise",price:"Custom",features:["Unlimited Products","Unlimited Share Links","Unlimited Team Members","Unlimited Product Images","All Professional Features","Dedicated Account Manager","Custom Integrations"],highlight:!0}];return e.jsx(Ce,{open:t,onOpenChange:o,children:e.jsxs(ke,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Se,{children:[e.jsxs(Pe,{className:"text-2xl flex items-center gap-2",children:[e.jsx(he,{className:"h-6 w-6 text-primary"}),"Upgrade Your Plan"]}),e.jsxs(De,{className:"text-base",children:[p(),". Upgrade to continue growing your business."]})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6 mt-6",children:n.map(i=>e.jsxs("div",{className:`relative rounded-lg border-2 p-6 ${i.highlight?"border-primary bg-primary/5":"border-border"}`,children:[i.highlight&&e.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 bg-primary text-primary-foreground px-3 py-1 rounded-full text-xs font-semibold",children:"RECOMMENDED"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold",children:i.name}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:i.price})]}),e.jsx("ul",{className:"space-y-3",children:i.features.map(y=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(is,{className:"h-5 w-5 text-primary mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:y})]},y))}),e.jsx(C,{onClick:h,className:"w-full",variant:i.highlight?"default":"outline",children:i.name==="Enterprise"?"Contact Sales":"Upgrade Now"})]})]},i.name))})]})})},na=({currentGoldRate:t,onUpdate:o,onSkip:m})=>{const[c,h]=l.useState(!1),[p,n]=l.useState(""),[i,y]=l.useState(!1);l.useEffect(()=>{const g=new Date().toDateString();localStorage.getItem("gold_rate_last_prompt")!==g&&setTimeout(()=>h(!0),1e3)},[]);const N=async()=>{const g=parseFloat(p);if(!p||p.trim()===""){_.error("Please enter a gold rate");return}if(isNaN(g)||g<=0){_.error("Please enter a valid positive number");return}if(g<1e3||g>2e5){_.error("Gold rate must be between â‚¹1,000 and â‚¹2,00,000 per gram");return}y(!0);try{await o(g);const r=new Date().toDateString();localStorage.setItem("gold_rate_last_prompt",r),localStorage.removeItem("gold_rate_skip_timestamp"),h(!1),_.success("Gold rate updated successfully!")}catch(r){console.error("Error updating gold rate:",r),_.error("Failed to update gold rate")}finally{y(!1)}},U=()=>{const g=new Date().toDateString();localStorage.setItem("gold_rate_last_prompt",g),h(!1),m(),_.info("Gold rate update skipped for today.")};return e.jsx(Ce,{open:c,onOpenChange:h,children:e.jsxs(ke,{className:"sm:max-w-md border-2 border-primary/20 shadow-2xl",children:[e.jsxs("button",{onClick:U,className:"absolute right-4 top-4 rounded-full p-1.5 opacity-70 ring-offset-background transition-all hover:opacity-100 hover:bg-accent hover:scale-110 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(yt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]}),e.jsxs(Se,{className:"space-y-4",children:[e.jsx(W.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-gradient-to-br from-amber-500/20 to-amber-600/20 border-2 border-amber-500/30 shadow-lg",children:e.jsx(re,{className:"h-8 w-8 text-amber-600"})}),e.jsxs("div",{className:"space-y-2 text-center",children:[e.jsx(Pe,{className:"text-2xl font-bold bg-gradient-to-r from-amber-600 to-amber-500 bg-clip-text text-transparent",children:"Update Gold Rate"}),e.jsx(De,{className:"text-base",children:"Start your day by updating today's 24K gold rate"})]})]}),e.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"space-y-5 pt-4",children:[e.jsx("div",{className:"bg-muted/50 rounded-lg p-4 border border-border/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Current Rate"}),e.jsxs("p",{className:"text-xl font-bold text-amber-600",children:["â‚¹",t.toLocaleString("en-IN"),"/g"]})]}),e.jsx(he,{className:"h-6 w-6 text-amber-500/50"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"goldRate",className:"text-sm font-medium",children:"New Gold Rate (per gram)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground font-medium",children:"â‚¹"}),e.jsx(I,{id:"goldRate",type:"number",value:p,onChange:g=>n(g.target.value),onKeyDown:g=>{g.key==="Enter"&&!i&&N()},placeholder:"Enter today's rate",min:"1000",max:"200000",step:"100",disabled:i,className:"pl-8 h-12 text-lg font-semibold border-2 focus:border-amber-500 focus:ring-amber-500",autoFocus:!0})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This will automatically recalculate prices for all products with weight"})]}),e.jsxs("div",{className:"flex flex-col gap-2 pt-2",children:[e.jsx(C,{onClick:N,disabled:i,size:"lg",className:"w-full h-12 bg-gradient-to-r from-amber-600 to-amber-500 hover:from-amber-700 hover:to-amber-600 text-white font-semibold shadow-lg hover:shadow-xl transition-all",children:i?e.jsxs(e.Fragment,{children:[e.jsx(W.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"mr-2",children:e.jsx(re,{className:"h-5 w-5"})}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"h-5 w-5 mr-2"}),"Update Gold Rate"]})}),e.jsx(C,{onClick:U,disabled:i,variant:"ghost",size:"lg",className:"w-full",children:"Skip for Today"})]}),e.jsx("div",{className:"bg-amber-500/5 border border-amber-500/20 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-center text-muted-foreground leading-relaxed",children:["ðŸ’¡ ",e.jsx("strong",{children:"Pro Tip:"})," Update your gold rate daily to keep your pricing accurate and competitive"]})})]})]})})},la=({goldRate:t,silverRate:o,platinumRate:m,onRatesUpdated:c})=>{const[h,p]=l.useState(t.toString()),[n,i]=l.useState(o.toString()),[y,N]=l.useState(m.toString()),[U,g]=l.useState(!1),r=async()=>{const u=parseFloat(h),x=parseFloat(n),A=parseFloat(y);if(isNaN(u)||u<=0||isNaN(x)||x<=0||isNaN(A)||A<=0){_.error("Please enter valid positive rates");return}g(!0);try{const{data:{user:S}}=await R.auth.getUser();if(!S){_.error("Please sign in to update rates");return}const{error:Y}=await R.from("vendor_profiles").update({gold_rate_24k_per_gram:u,silver_rate_per_gram:x,platinum_rate_per_gram:A,gold_rate_updated_at:new Date().toISOString()}).eq("user_id",S.id);if(Y)throw Y;c({goldRate:u,silverRate:x,platinumRate:A}),_.success("Metal rates updated successfully!")}catch(S){console.error("Error updating rates:",S),_.error("Failed to update metal rates")}finally{g(!1)}};return e.jsxs(we,{className:"border-2 border-amber-500/20 bg-gradient-to-br from-amber-500/5 to-transparent",children:[e.jsx(pt,{className:"pb-3",children:e.jsxs(Kt,{className:"flex items-center gap-2 text-base",children:[e.jsx(W.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},className:"flex h-8 w-8 items-center justify-center rounded-full bg-gradient-to-br from-amber-500/20 to-amber-600/20 border border-amber-500/30",children:e.jsx(re,{className:"h-4 w-4 text-amber-600"})}),e.jsx("span",{className:"bg-gradient-to-r from-amber-600 to-amber-500 bg-clip-text text-transparent font-semibold",children:"Today's Metal Rates"}),e.jsx(he,{className:"h-4 w-4 text-amber-500/50 ml-auto"})]})}),e.jsxs(xt,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(k,{htmlFor:"goldRate",className:"text-xs font-medium text-amber-700",children:"Gold (24K/g)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"â‚¹"}),e.jsx(I,{id:"goldRate",type:"number",value:h,onChange:u=>p(u.target.value),className:"pl-5 h-9 text-sm border-amber-500/30 focus:border-amber-500",placeholder:"Gold"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(k,{htmlFor:"silverRate",className:"text-xs font-medium text-slate-600",children:"Silver (/g)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"â‚¹"}),e.jsx(I,{id:"silverRate",type:"number",value:n,onChange:u=>i(u.target.value),className:"pl-5 h-9 text-sm border-slate-400/30 focus:border-slate-500",placeholder:"Silver"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(k,{htmlFor:"platinumRate",className:"text-xs font-medium text-slate-500",children:"Platinum (/g)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"â‚¹"}),e.jsx(I,{id:"platinumRate",type:"number",value:y,onChange:u=>N(u.target.value),className:"pl-5 h-9 text-sm border-slate-400/30 focus:border-slate-500",placeholder:"Platinum"})]})]})]}),e.jsx(C,{onClick:r,disabled:U,size:"sm",className:"w-full bg-gradient-to-r from-amber-600 to-amber-500 hover:from-amber-700 hover:to-amber-600 text-white",children:U?e.jsxs(e.Fragment,{children:[e.jsx(W.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"mr-2",children:e.jsx(re,{className:"h-4 w-4"})}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"Update Rates"]})})]})]})},oa=({instagramQrUrl:t,whatsappQrUrl:o})=>{const[m,c]=l.useState(!1),{keyboardHeight:h,isKeyboardVisible:p}=Nt();if(!t&&!o)return null;const n=p?`${h+16}px`:"1.5rem";return e.jsx(je,{children:e.jsx(W.div,{className:"fixed left-6 z-50",animate:{bottom:n},transition:{duration:.3,ease:"easeOut"},children:e.jsx(Ve,{mode:"wait",children:m?e.jsx(W.div,{initial:{scale:.8,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.8,opacity:0,y:20},transition:{type:"spring",stiffness:260,damping:20},children:e.jsxs(we,{className:"p-4 shadow-2xl border-2 border-primary/20 bg-card/95 backdrop-blur-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tt,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"font-semibold text-foreground",children:"Connect With Us"})]}),e.jsx(C,{variant:"ghost",size:"sm",onClick:()=>c(!1),className:"h-8 w-8 p-0 hover:bg-destructive/10 hover:text-destructive transition-colors",children:e.jsx(yt,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex gap-4",children:[t&&e.jsx(W.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.1},className:"group cursor-pointer",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-32 h-32 rounded-2xl overflow-hidden border-2 border-primary/30 shadow-lg group-hover:border-primary/60 transition-all duration-300 group-hover:shadow-xl group-hover:scale-105",children:e.jsx("img",{src:t,alt:"Instagram QR Code",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"mt-2 flex items-center justify-center gap-1.5 text-sm font-medium text-muted-foreground group-hover:text-primary transition-colors",children:[e.jsx(ls,{className:"h-4 w-4"}),e.jsx("span",{children:"Instagram"})]}),e.jsx(W.div,{className:"absolute -top-1 -right-1 h-3 w-3 rounded-full bg-pink-500 shadow-lg",animate:{scale:[1,1.2,1],opacity:[1,.8,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}})]})}),o&&e.jsx(W.div,{initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2},className:"group cursor-pointer",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-32 h-32 rounded-2xl overflow-hidden border-2 border-primary/30 shadow-lg group-hover:border-primary/60 transition-all duration-300 group-hover:shadow-xl group-hover:scale-105",children:e.jsx("img",{src:o,alt:"WhatsApp QR Code",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"mt-2 flex items-center justify-center gap-1.5 text-sm font-medium text-muted-foreground group-hover:text-primary transition-colors",children:[e.jsx(os,{className:"h-4 w-4"}),e.jsx("span",{children:"WhatsApp"})]}),e.jsx(W.div,{className:"absolute -top-1 -right-1 h-3 w-3 rounded-full bg-green-500 shadow-lg",animate:{scale:[1,1.2,1],opacity:[1,.8,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut",delay:.5}})]})})]}),e.jsx(W.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-xs text-center text-muted-foreground mt-4 pt-3 border-t border-border",children:"Scan to connect instantly"})]})},"expanded"):e.jsx(W.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:260,damping:20},children:e.jsxs(be,{children:[e.jsx(Ne,{asChild:!0,children:e.jsxs(C,{onClick:()=>c(!0),size:"lg",className:"h-16 w-16 rounded-full shadow-2xl bg-gradient-to-br from-primary to-primary/80 hover:from-primary/90 hover:to-primary hover:scale-110 transition-all duration-300 relative overflow-hidden group",children:[e.jsx("span",{className:"absolute inset-0 rounded-full bg-primary/30 animate-ping"}),e.jsx(tt,{className:"h-7 w-7 text-primary-foreground relative z-10 group-hover:rotate-12 transition-transform"})]})}),e.jsx(ve,{side:"right",className:"font-medium",children:e.jsx("p",{children:"Connect with us"})})]})},"collapsed")})})})},ca=({onExportPDF:t,onAutoCategorize:o})=>{const[m,c]=l.useState(!1),h=He(),[p,n]=l.useState(!1),[i,y]=l.useState(),{keyboardHeight:N,isKeyboardVisible:U}=Nt(),{canAddProducts:g,canAddShareLinks:r,productsRemaining:u,shareLinksRemaining:x}=Ke(),A=()=>{if(!g){y("products"),n(!0),c(!1);return}h("/add-product"),c(!1)},S=()=>{if(!r){y("share_links"),n(!0),c(!1);return}h("/share"),c(!1)},Y=()=>g?u!==1/0&&u<100?`Add Product (${u} left)`:"Add Product":"Add Product (Limit reached)",q=()=>r?x!==1/0&&x<100?`Share Catalog (${x} left)`:"Share Catalog":"Share Catalog (Limit reached)",ie=[{icon:ye,label:Y(),onClick:A,gradient:"from-primary/20 to-primary/5",iconColor:"text-primary",disabled:!g,tooltip:g?void 0:"Product limit reached"},{icon:Be,label:q(),onClick:S,gradient:"from-blue-500/20 to-blue-500/5",iconColor:"text-blue-500",disabled:!r,tooltip:r?void 0:"Share link limit reached"},...o?[{icon:he,label:"Auto-Categorize",onClick:()=>{o(),c(!1)},gradient:"from-violet-500/20 to-violet-500/5",iconColor:"text-violet-500",disabled:!1,tooltip:"Automatically categorize products"}]:[],{icon:jt,label:"Purchase Inquiries",onClick:()=>{h("/purchase-inquiries"),c(!1)},gradient:"from-purple-500/20 to-purple-500/5",iconColor:"text-purple-500",disabled:!1},{icon:cs,label:"Rewards",onClick:()=>{h("/rewards"),c(!1)},gradient:"from-yellow-500/20 to-yellow-500/5",iconColor:"text-yellow-500",disabled:!1},{icon:ds,label:"Create Invoice",onClick:()=>{h("/invoice-generator"),c(!1)},gradient:"from-orange-500/20 to-orange-500/5",iconColor:"text-orange-500",disabled:!1},{icon:st,label:"View Invoices",onClick:()=>{h("/invoice-history"),c(!1)},gradient:"from-amber-500/20 to-amber-500/5",iconColor:"text-amber-500",disabled:!1},{icon:ms,label:"Create Estimate",onClick:()=>{h("/manufacturing-cost"),c(!1)},gradient:"from-emerald-500/20 to-emerald-500/5",iconColor:"text-emerald-500",disabled:!1},{icon:st,label:"View Estimates",onClick:()=>{h("/estimate-history"),c(!1)},gradient:"from-cyan-500/20 to-cyan-500/5",iconColor:"text-cyan-500",disabled:!1},{icon:Ge,label:"Export PDF",onClick:()=>{t(),c(!1)},gradient:"from-green-500/20 to-green-500/5",iconColor:"text-green-500",disabled:!1}],ne=U?`${N+16}px`:"2rem";return e.jsxs(e.Fragment,{children:[e.jsxs(W.div,{className:"fixed right-8 z-50",animate:{bottom:ne},transition:{duration:.3,ease:"easeOut"},children:[e.jsx(Ve,{children:m&&e.jsx(W.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:20},transition:{duration:.2},className:"absolute bottom-20 right-0 flex flex-col gap-3 mb-2",children:ie.map((M,P)=>{const K=e.jsxs(W.button,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{delay:P*.05},onClick:()=>{M.disabled||(M.onClick(),c(!1))},disabled:M.disabled,className:`
                    group relative flex items-center gap-3 px-4 py-3 rounded-xl
                    bg-gradient-to-br ${M.gradient} backdrop-blur-sm
                    border border-border/50 shadow-lg hover:shadow-xl
                    transition-all duration-300 hover:scale-105
                    ${M.disabled?"opacity-50 cursor-not-allowed hover:scale-100":""}
                  `,children:[e.jsx("div",{className:`
                    w-10 h-10 rounded-lg bg-background/50 flex items-center justify-center
                    ${M.iconColor} group-hover:scale-110 transition-transform duration-300
                    ${M.disabled?"group-hover:scale-100":""}
                  `,children:e.jsx(M.icon,{className:"w-5 h-5"})}),e.jsx("span",{className:"font-medium text-foreground pr-2 whitespace-nowrap",children:M.label})]},M.label);return M.tooltip?e.jsx(je,{children:e.jsxs(be,{children:[e.jsx(Ne,{asChild:!0,children:K}),e.jsx(ve,{side:"left",children:e.jsx("p",{children:M.tooltip})})]})},M.label):K})})}),e.jsx(W.button,{whileHover:{scale:1.1},whileTap:{scale:.95},onClick:()=>c(!m),className:`
          relative w-16 h-16 rounded-full
          bg-gradient-to-br from-primary to-primary/80
          text-primary-foreground shadow-xl hover:shadow-2xl
          transition-all duration-300
          ${m?"rotate-45":""}
        `,children:!m&&e.jsx("span",{className:"absolute inset-0 rounded-full bg-primary animate-ping opacity-20"})}),e.jsx(Ve,{children:!m&&e.jsx(W.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},className:`absolute right-full mr-4 top-1/2 -translate-y-1/2 whitespace-nowrap\r
              px-3 py-2 rounded-lg bg-background/95 backdrop-blur-sm\r
              border border-border/50 shadow-lg text-sm font-medium\r
              pointer-events-none`,children:"Quick Actions"})})]}),e.jsx(vt,{open:p,onOpenChange:n,limitType:i})]})},da=T.object({category:T.string().max(100).optional(),metal_type:T.string().max(50).optional(),delivery_type:T.enum(["immediate","scheduled"]).optional(),dispatches_in_days:T.number().int().min(0).max(365).optional(),status:T.string().max(50).optional(),stock_quantity:T.number().int().min(0).optional(),description:T.string().max(1e3).optional(),cost_price:T.number().min(0).optional(),retail_price:T.number().min(0).optional(),weight_grams:T.number().min(0).optional(),diamond_color:T.string().max(50).optional(),clarity:T.string().max(50).optional(),gemstone:T.string().max(100).optional(),gemstone_type:T.string().max(100).optional(),certification:T.string().max(100).optional(),cut:T.string().max(50).optional(),polish:T.string().max(50).optional(),symmetry:T.string().max(50).optional(),purity_fraction_used:T.number().min(0).max(1).optional(),pricingAdjustment:T.object({type:T.enum(["markup","discount"]),percentage:T.number().min(0).max(100)}).optional()});function ma({open:t,onOpenChange:o,onUpdate:m,selectedCount:c,selectedProductIds:h}){const[p,n]=l.useState(!1),[i,y]=l.useState({}),[N,U]=l.useState("markup"),[g,r]=l.useState(""),[u,x]=l.useState(!1),[A,S]=l.useState([]),[Y,q]=l.useState(!1),ie=async()=>{var d;q(!0);try{const E={...i};g&&parseFloat(g)>0&&(E.pricingAdjustment={type:N,percentage:parseFloat(g)});try{da.parse(E)}catch(O){_.error(`Validation error: ${((d=O.errors[0])==null?void 0:d.message)||"Invalid input"}`),q(!1);return}const{data:V,error:te}=await R.from("products").select("id, name, sku, category, metal_type, delivery_type, dispatches_in_days, status, stock_quantity, description, cost_price, retail_price, weight_grams, diamond_color, clarity, cut, polish, symmetry, gemstone, gemstone_type, certification, purity_fraction_used").in("id",h);if(te)throw te;if(!V){_.error("Failed to fetch product data");return}const Fe=V.map(O=>{const le=[],ue={category:"Category",metal_type:"Metal Type",delivery_type:"Delivery Type",dispatches_in_days:"Dispatch Days",status:"Status",stock_quantity:"Stock Quantity",description:"Description",cost_price:"Cost Price",retail_price:"Retail Price",weight_grams:"Weight",diamond_color:"Diamond Color",clarity:"Clarity",cut:"Cut",polish:"Polish",symmetry:"Symmetry",gemstone:"Gemstone",gemstone_type:"Gemstone Type",certification:"Certification",purity_fraction_used:"Purity Fraction"};if(Object.entries(i).forEach(([Z,Q])=>{if(Q!==""&&Q!==null&&Q!=="no-change"){const se=O[Z];se!==Q&&le.push({field:ue[Z]||Z,oldValue:se||"â€”",newValue:Q})}}),E.pricingAdjustment&&E.pricingAdjustment.percentage>0){const Z=E.pricingAdjustment.type==="markup"?1+E.pricingAdjustment.percentage/100:1-E.pricingAdjustment.percentage/100,Q=Math.max(0,O.cost_price*Z),se=Math.max(0,O.retail_price*Z);i.cost_price||le.push({field:"Cost Price",oldValue:`â‚¹${O.cost_price.toFixed(2)}`,newValue:`â‚¹${Q.toFixed(2)}`}),i.retail_price||le.push({field:"Retail Price",oldValue:`â‚¹${O.retail_price.toFixed(2)}`,newValue:`â‚¹${se.toFixed(2)}`})}return{id:O.id,name:O.name,sku:O.sku||"N/A",changes:le}});S(Fe.filter(O=>O.changes.length>0)),x(!0)}catch(E){console.error("Failed to generate preview:",E),_.error(`Failed to generate preview: ${E.message||"Unknown error"}`)}finally{q(!1)}},ne=async()=>{n(!0);try{const d={...i};g&&parseFloat(g)>0&&(d.pricingAdjustment={type:N,percentage:parseFloat(g)}),await m(d),y({}),r(""),x(!1),o(!1)}finally{n(!1)}},M=()=>{x(!1)};l.useEffect(()=>{t||(x(!1),S([]),y({}),r(""))},[t]);const P=(d,E)=>{if(E===""||E==="no-change"){const V={...i};delete V[d],y(V)}else y({...i,[d]:E})},K=Object.keys(i).length>0||g&&parseFloat(g)>0;return e.jsx(Ce,{open:t,onOpenChange:o,children:e.jsxs(ke,{className:"max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs(Se,{children:[e.jsxs(Pe,{className:"flex items-center gap-2",children:[u&&e.jsx(C,{variant:"ghost",size:"sm",onClick:M,className:"mr-2 -ml-2",children:e.jsx(ft,{className:"h-4 w-4"})}),u?"Preview Changes":"Bulk Edit Products"]}),e.jsx(De,{children:u?`Review changes for ${A.length} product${A.length!==1?"s":""} before applying`:`Update ${c} selected product${c!==1?"s":""}. Leave fields empty to keep existing values.`})]}),u?e.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:A.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"No changes detected for any products."})}):e.jsx(Ye,{className:"flex-1 pr-4",children:e.jsx("div",{className:"space-y-6 pb-4",children:A.map((d,E)=>e.jsxs("div",{className:"border rounded-lg p-4 bg-muted/30",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm",children:d.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["SKU: ",d.sku]})]}),e.jsxs(ee,{variant:"secondary",className:"text-xs",children:[d.changes.length," change",d.changes.length!==1?"s":""]})]}),e.jsxs(Rs,{children:[e.jsx(As,{children:e.jsxs(ht,{children:[e.jsx(Oe,{className:"w-[30%]",children:"Field"}),e.jsx(Oe,{className:"w-[35%]",children:"Current Value"}),e.jsx(Oe,{className:"w-[35%]",children:"New Value"})]})}),e.jsx(Is,{children:d.changes.map((V,te)=>e.jsxs(ht,{children:[e.jsx(qe,{className:"font-medium text-sm",children:V.field}),e.jsx(qe,{className:"text-sm text-muted-foreground",children:typeof V.oldValue=="number"?V.oldValue.toLocaleString():V.oldValue}),e.jsxs(qe,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(hs,{className:"h-3 w-3 text-primary"}),typeof V.newValue=="number"?V.newValue.toLocaleString():V.newValue]})]},te))})]})]},d.id))})})}):e.jsxs(Ls,{defaultValue:"basic",className:"w-full",children:[e.jsxs(Ts,{className:"grid w-full grid-cols-3",children:[e.jsx(Me,{value:"basic",children:"Basic Info"}),e.jsx(Me,{value:"jewelry",children:"Jewelry Details"}),e.jsx(Me,{value:"pricing",children:"Pricing"})]}),e.jsxs(We,{value:"basic",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"category",children:"Category"}),e.jsx(I,{id:"category",placeholder:"Leave empty to keep current",maxLength:100,value:i.category||"",onChange:d=>P("category",d.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"metal_type",children:"Metal Type"}),e.jsxs(Ue,{value:i.metal_type||"no-change",onValueChange:d=>P("metal_type",d),children:[e.jsx($e,{children:e.jsx(Ee,{placeholder:"No change"})}),e.jsxs(ze,{children:[e.jsx(J,{value:"no-change",children:"No change"}),e.jsx(J,{value:"Gold",children:"Gold"}),e.jsx(J,{value:"Silver",children:"Silver"}),e.jsx(J,{value:"Platinum",children:"Platinum"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"delivery_type",children:"Delivery Type"}),e.jsxs(Ue,{value:i.delivery_type||"no-change",onValueChange:d=>P("delivery_type",d),children:[e.jsx($e,{children:e.jsx(Ee,{placeholder:"No change"})}),e.jsxs(ze,{children:[e.jsx(J,{value:"no-change",children:"No change"}),e.jsx(J,{value:"immediate",children:"Immediate"}),e.jsx(J,{value:"scheduled",children:"Scheduled"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"dispatches_in_days",children:"Dispatch Days"}),e.jsx(I,{id:"dispatches_in_days",type:"number",min:"0",max:"365",placeholder:"Leave empty to keep current",value:i.dispatches_in_days||"",onChange:d=>P("dispatches_in_days",d.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"status",children:"Status"}),e.jsx(I,{id:"status",placeholder:"Leave empty to keep current",maxLength:50,value:i.status||"",onChange:d=>P("status",d.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"stock_quantity",children:"Stock Quantity"}),e.jsx(I,{id:"stock_quantity",type:"number",min:"0",placeholder:"Leave empty to keep current",value:i.stock_quantity||"",onChange:d=>P("stock_quantity",d.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"description",children:"Description"}),e.jsx(I,{id:"description",placeholder:"Leave empty to keep current",maxLength:1e3,value:i.description||"",onChange:d=>P("description",d.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"weight_grams",children:"Weight (g)"}),e.jsx(I,{id:"weight_grams",type:"number",step:"0.01",min:"0",placeholder:"Leave empty",value:i.weight_grams||"",onChange:d=>P("weight_grams",d.target.value)})]})]}),e.jsxs(We,{value:"jewelry",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"diamond_color",children:"Diamond Color"}),e.jsx(I,{id:"diamond_color",placeholder:"Leave empty to keep current",maxLength:50,value:i.diamond_color||"",onChange:d=>P("diamond_color",d.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"clarity",children:"Clarity"}),e.jsx(I,{id:"clarity",placeholder:"Leave empty to keep current",maxLength:50,value:i.clarity||"",onChange:d=>P("clarity",d.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"cut",children:"Cut"}),e.jsx(I,{id:"cut",placeholder:"Leave empty to keep current",maxLength:50,value:i.cut||"",onChange:d=>P("cut",d.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"polish",children:"Polish"}),e.jsx(I,{id:"polish",placeholder:"Leave empty to keep current",maxLength:50,value:i.polish||"",onChange:d=>P("polish",d.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"symmetry",children:"Symmetry"}),e.jsx(I,{id:"symmetry",placeholder:"Leave empty to keep current",maxLength:50,value:i.symmetry||"",onChange:d=>P("symmetry",d.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"gemstone",children:"Gemstone"}),e.jsx(I,{id:"gemstone",placeholder:"Leave empty to keep current",maxLength:100,value:i.gemstone||"",onChange:d=>P("gemstone",d.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"gemstone_type",children:"Gemstone Type"}),e.jsx(I,{id:"gemstone_type",placeholder:"Leave empty to keep current",maxLength:100,value:i.gemstone_type||"",onChange:d=>P("gemstone_type",d.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"certification",children:"Certification"}),e.jsx(I,{id:"certification",placeholder:"Leave empty to keep current",maxLength:100,value:i.certification||"",onChange:d=>P("certification",d.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"purity_fraction_used",children:"Purity Fraction (0-1)"}),e.jsx(I,{id:"purity_fraction_used",type:"number",step:"0.01",min:"0",max:"1",placeholder:"Leave empty to keep current",value:i.purity_fraction_used||"",onChange:d=>P("purity_fraction_used",d.target.value)})]})]}),e.jsxs(We,{value:"pricing",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(us,{className:"h-5 w-5 text-primary"}),e.jsx("h4",{className:"font-semibold",children:"Percentage-Based Price Adjustment"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Apply a percentage markup or discount to all selected products"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"adjustment_type",children:"Adjustment Type"}),e.jsxs(Ue,{value:N,onValueChange:d=>U(d),children:[e.jsx($e,{children:e.jsx(Ee,{})}),e.jsxs(ze,{children:[e.jsx(J,{value:"markup",children:"Markup (Increase Price)"}),e.jsx(J,{value:"discount",children:"Discount (Decrease Price)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"adjustment_percent",children:"Percentage (%)"}),e.jsx(I,{id:"adjustment_percent",type:"number",min:"0",max:"100",step:"0.1",placeholder:"e.g., 10 for 10%",value:g,onChange:d=>r(d.target.value)})]})]}),g&&parseFloat(g)>0&&e.jsxs("div",{className:"bg-background p-3 rounded border border-border",children:[e.jsxs("p",{className:"text-sm font-medium",children:[N==="markup"?"â†‘":"â†“"," ",N==="markup"?"Increase":"Decrease"," prices by ",g,"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Example: â‚¹1,000 â†’ â‚¹",N==="markup"?(1e3*(1+parseFloat(g)/100)).toFixed(0):(1e3*(1-parseFloat(g)/100)).toFixed(0)]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Or Set Fixed Prices"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"cost_price",children:"Cost Price (â‚¹)"}),e.jsx(I,{id:"cost_price",type:"number",step:"0.01",min:"0",placeholder:"Leave empty",value:i.cost_price||"",onChange:d=>P("cost_price",d.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"retail_price",children:"Retail Price (â‚¹)"}),e.jsx(I,{id:"retail_price",type:"number",step:"0.01",min:"0",placeholder:"Leave empty",value:i.retail_price||"",onChange:d=>P("retail_price",d.target.value)})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Note: Fixed prices will override percentage adjustments"})]})]})]}),e.jsx(bt,{className:"mt-4",children:u?e.jsxs(e.Fragment,{children:[e.jsx(C,{variant:"outline",onClick:M,disabled:p,children:"Back to Edit"}),e.jsxs(C,{onClick:ne,disabled:p||A.length===0,className:"bg-primary",children:[p&&e.jsx(at,{className:"mr-2 h-4 w-4 animate-spin"}),"Confirm & Apply Changes"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{variant:"outline",onClick:()=>o(!1),disabled:Y,children:"Cancel"}),e.jsx(C,{onClick:ie,disabled:Y||!K,children:Y?e.jsxs(e.Fragment,{children:[e.jsx(at,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading Preview..."]}):e.jsxs(e.Fragment,{children:[e.jsx(gs,{className:"mr-2 h-4 w-4"}),"Preview Changes"]})})]})})]})})}const ha=({open:t,onOpenChange:o,onConfirm:m,products:c,isDeleting:h=!1})=>e.jsx(Us,{open:t,onOpenChange:o,children:e.jsxs($s,{className:"max-w-2xl",children:[e.jsxs(Es,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ps,{className:"h-5 w-5 text-destructive"}),e.jsx(zs,{children:"Delete Selected Products?"})]}),e.jsxs(Ms,{children:["You are about to delete ",e.jsxs("strong",{children:[c.length," product(s)"]}),". This action cannot be undone."]})]}),e.jsxs("div",{className:"my-4",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Products to be deleted:"}),e.jsx(Ye,{className:"h-[200px] w-full border rounded-md p-4",children:e.jsx("div",{className:"space-y-2",children:c.map((p,n)=>e.jsxs("div",{className:"flex items-start gap-2 py-2 border-b last:border-0",children:[e.jsxs("span",{className:"text-xs text-muted-foreground min-w-[20px]",children:[n+1,"."]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:p.name}),p.sku&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["SKU: ",p.sku]})]})]},p.id))})})]}),e.jsxs(Ws,{children:[e.jsx(Os,{disabled:h,children:"Cancel"}),e.jsx(qs,{onClick:m,disabled:h,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:h?"Deleting...":`Delete ${c.length} Product${c.length>1?"s":""}`})]})]})}),Ha=()=>{const[t,o]=l.useState([]),[m,c]=l.useState(!0),[h,p]=l.useState(!1),[n,i]=l.useState(87.67),[y,N]=l.useState(0),[U,g]=l.useState(95),[r,u]=l.useState(3200),[x,A]=l.useState(new Set),[S,Y]=l.useState(null),[q,ie]=l.useState("Jewellery"),[ne,M]=l.useState(["Jewellery"]),[P,K]=l.useState(!1),[d,E]=l.useState(),[V,te]=l.useState(!1),[Fe,O]=l.useState(!1),[le,ue]=l.useState(!1),[Z,Q]=l.useState(!1),[se,_t]=l.useState([]),[w,wt]=l.useState({category:"",metalType:"",minPrice:"",maxPrice:"",diamondColor:"",diamondClarity:"",searchQuery:"",deliveryType:"",minDiamondWeight:"",maxDiamondWeight:"",minNetWeight:"",maxNetWeight:"",gemstoneType:"",color:"",clarity:"",cut:"",minCarat:"",maxCarat:"",diamondType:"",shape:"",polish:"",symmetry:"",fluorescence:"",lab:""}),D=He(),{isAdmin:j,loading:Qe}=Qt(),{permissions:z}=Cs(),{canAddProducts:ce,canAddShareLinks:de,productsRemaining:Le,shareLinksRemaining:Te}=Ke(),[ge,Je]=l.useState(50),Ct=50;l.useEffect(()=>{!Qe&&j&&D("/admin")},[j,Qe,D]),l.useEffect(()=>{(async()=>{const s=sessionStorage.getItem("usd_rate"),f=sessionStorage.getItem("usd_rate_time");s&&f&&Date.now()-parseInt(f)<36e5&&i(parseFloat(s)),await Promise.all([Pt(),kt(),s?Promise.resolve():St()]),p(!0)})()},[]),l.useEffect(()=>{q&&h&&ae()},[q,h]),l.useEffect(()=>{Je(50)},[w,q]);const kt=async()=>{try{const{data:{user:a}}=await R.auth.getUser();if(!a)return;const{data:s,error:f}=await R.from("user_approval_status").select("approved_categories").eq("user_id",a.id).single();if(f)throw f;const v=(s==null?void 0:s.approved_categories)||["Jewellery"];M(v),ie(v[0])}catch(a){console.error("Failed to fetch approved categories:",a)}},St=async()=>{var a;try{const f=await(await fetch("https://api.exchangerate-api.com/v4/latest/USD")).json();(a=f.rates)!=null&&a.INR&&(i(f.rates.INR),sessionStorage.setItem("usd_rate",f.rates.INR.toString()),sessionStorage.setItem("usd_rate_time",Date.now().toString()))}catch(s){console.error("Failed to fetch USD rate:",s)}},Pt=async()=>{try{const{data:{user:a}}=await R.auth.getUser();if(!a)return;const{data:s,error:f}=await R.from("vendor_profiles").select("*").eq("user_id",a.id).maybeSingle();f&&f.code!=="PGRST116"?console.error("Error fetching vendor profile:",f):s&&(Y(s),s.gold_rate_24k_per_gram&&N(s.gold_rate_24k_per_gram),s.silver_rate_per_gram&&g(s.silver_rate_per_gram),s.platinum_rate_per_gram&&u(s.platinum_rate_per_gram))}catch(a){console.error("Failed to fetch vendor profile:",a)}},ae=l.useCallback(async()=>{try{c(!0);const{data:{user:a}}=await R.auth.getUser();if(!a){c(!1);return}let s=R.from("products").select("id, name, sku, image_url, image_url_2, image_url_3, cost_price, retail_price, stock_quantity, category, metal_type, gemstone, color, diamond_color, clarity, delivery_type, product_type, weight_grams, gemstone_type, carat_weight, cut, diamond_type, shape, carat, polish, symmetry, fluorescence, lab, created_at, purity_fraction_used, net_weight, d_value, mkg, certification_cost, gemstone_cost, gold_per_gram_price, d_rate_1, d_wt_1, d_wt_2, pointer_diamond, diamond_weight").eq("user_id",a.id).is("deleted_at",null);q==="Jewellery"?s=s.or(`product_type.eq.${q},product_type.is.null`):s=s.eq("product_type",q);const{data:f,error:v}=await s.order("created_at",{ascending:!1});if(v)throw v;o(f||[])}catch(a){console.error("Failed to load products:",a),_.error("Failed to load products. Please refresh the page.")}finally{c(!1)}},[q]),Dt=async a=>{const{data:{user:s}}=await R.auth.getUser();if(!s)return;const{error:f}=await R.from("vendor_profiles").update({gold_rate_24k_per_gram:a,gold_rate_updated_at:new Date().toISOString()}).eq("user_id",s.id);if(f)throw f;const F=t.filter(b=>b.net_weight||b.weight_grams).map(b=>{const L=b.purity_fraction_used||18;let G;L<=1?G=L:L<=24?G=L/24:G=L/100;const xe=(b.net_weight||b.weight_grams||0)*G*a,$=b.d_value||0,fe=b.mkg||0,me=b.certification_cost||0,Gt=b.gemstone_cost||0,et=xe+$+fe+me+Gt;return{id:b.id,cost_price:Math.round(et*100)/100,retail_price:Math.round(et*100)/100,gold_per_gram_price:a}}).map(b=>R.from("products").update({cost_price:b.cost_price,retail_price:b.retail_price,gold_per_gram_price:b.gold_per_gram_price}).eq("id",b.id));await Promise.all(F),N(a),await ae(),_.success(`Gold rate updated to â‚¹${a.toLocaleString("en-IN")}/g`)},Ft=l.useMemo(()=>{const a=t.map(s=>s.category).filter(Boolean);return[...new Set(a)].sort()},[t]),Lt=l.useMemo(()=>{const a={all:t.length};return t.forEach(s=>{if(s.category){const f=s.category.toUpperCase().trim();a[f]=(a[f]||0)+1}}),a},[t]),Tt=l.useMemo(()=>[...new Set(t.map(a=>a.metal_type).filter(Boolean))].sort(),[t]),Rt=l.useMemo(()=>[...new Set(t.map(a=>{var s;return(s=a.gemstone)==null?void 0:s.split(" ")[0]}).filter(Boolean))].sort(),[t]),At=l.useMemo(()=>[...new Set(t.map(a=>{var s;return(s=a.gemstone)==null?void 0:s.split(" ")[1]}).filter(Boolean))].sort(),[t]),It=l.useMemo(()=>[...new Set(t.map(a=>a.delivery_type).filter(Boolean))].sort(),[t]),X=l.useMemo(()=>t.filter(s=>{var f,v,F,b,L,G,oe,xe;if(w.searchQuery){const $=w.searchQuery.toLowerCase().trim();if(![s.name,s.category,s.sku,s.description,s.metal_type,s.gemstone,s.color,s.clarity,(f=s.diamond_weight)==null?void 0:f.toString(),(v=s.net_weight)==null?void 0:v.toString(),(F=s.retail_price)==null?void 0:F.toString()].filter(Boolean).some(me=>me==null?void 0:me.toLowerCase().includes($)))return!1}if(w.category){const $=((b=s.category)==null?void 0:b.toUpperCase().trim())===w.category.toUpperCase().trim(),fe=(L=s.name)==null?void 0:L.toUpperCase().trim().includes(w.category.toUpperCase().trim());if(!$&&!fe)return!1}if(w.metalType&&((G=s.metal_type)==null?void 0:G.toUpperCase().trim())!==w.metalType.toUpperCase().trim()||w.minPrice&&s.retail_price<parseFloat(w.minPrice)||w.maxPrice&&s.retail_price>parseFloat(w.maxPrice))return!1;if(w.diamondColor){const $=(oe=s.gemstone)==null?void 0:oe.split(" ")[0];if(($==null?void 0:$.toUpperCase().trim())!==w.diamondColor.toUpperCase().trim())return!1}if(w.diamondClarity){const $=(xe=s.gemstone)==null?void 0:xe.split(" ")[1];if(($==null?void 0:$.toUpperCase().trim())!==w.diamondClarity.toUpperCase().trim())return!1}if(w.deliveryType&&s.delivery_type!==w.deliveryType)return!1;if(w.minDiamondWeight){const $=parseFloat(w.minDiamondWeight);if(!s.diamond_weight||s.diamond_weight<$)return!1}if(w.maxDiamondWeight){const $=parseFloat(w.maxDiamondWeight);if(!s.diamond_weight||s.diamond_weight>$)return!1}if(w.minNetWeight){const $=parseFloat(w.minNetWeight);if(!s.net_weight||s.net_weight<$)return!1}if(w.maxNetWeight){const $=parseFloat(w.maxNetWeight);if(!s.net_weight||s.net_weight>$)return!1}return!0}).sort((s,f)=>{var b,L;const v=(b=s.name)==null?void 0:b.match(/^(.+?)\s*(\d+)$/),F=(L=f.name)==null?void 0:L.match(/^(.+?)\s*(\d+)$/);return v&&F&&v[1]===F[1]?parseInt(v[2],10)-parseInt(F[2],10):(s.name||"").localeCompare(f.name||"")}),[t,w]),Re=l.useMemo(()=>X.slice(0,ge),[X,ge]),Ut=X.length>ge,pe=X.reduce((a,s)=>a+(s.retail_price||0),0),Ze=pe/n,$t=()=>Je(a=>a+Ct),Ae=l.useCallback(async()=>{try{ra(X,S,n,y,pe,Ze),_.success("Catalog exported to PDF!")}catch{_.error("Failed to export catalog to PDF")}},[X,S,n,y,pe,Ze]),Et=l.useCallback(a=>a==="Jewellery"?t.filter(s=>s.product_type==="Jewellery"||s.product_type===null).length:t.filter(s=>s.product_type===a).length,[t]),zt=l.useCallback(async()=>{ue(!0);try{const{data:{user:a}}=await R.auth.getUser();if(!a){_.error("You must be logged in to delete products");return}const{error:s}=await R.from("products").update({deleted_at:new Date().toISOString()}).in("id",Array.from(x)).eq("user_id",a.id);if(s)throw s;_.success(`${x.size} product(s) deleted`),A(new Set),O(!1),await ae()}catch(a){_.error(`Failed to delete: ${a.message||"Unknown error"}`)}finally{ue(!1)}},[x,ae]),Mt=l.useMemo(()=>t.filter(a=>x.has(a.id)).map(a=>({id:a.id,name:a.name,sku:a.sku})),[t,x]),Wt=l.useCallback(async a=>{if(x.size===0){_.error("No products selected");return}try{const{data:{user:s}}=await R.auth.getUser();if(!s)throw new Error("Not authenticated");const f=a.pricingAdjustment;delete a.pricingAdjustment;const v={};if(Object.entries(a).forEach(([F,b])=>{if(!(b===""||b===null))if(["cost_price","retail_price","weight_grams","stock_quantity","dispatches_in_days"].includes(F)){const L=parseFloat(b);!isNaN(L)&&L>=0&&(v[F]=L)}else if(F==="purity_fraction_used"){const L=parseFloat(b);!isNaN(L)&&L>=0&&(v[F]=L>1?L/100:L)}else v[F]=b}),f&&f.percentage>0){const{data:F,error:b}=await R.from("products").select("id, cost_price, retail_price").in("id",Array.from(x)).eq("user_id",s.id);if(b)throw b;if(F){const L=F.map(async G=>{const oe=f.type==="markup"?1+f.percentage/100:1-f.percentage/100;return R.from("products").update({...v,cost_price:v.cost_price||Math.max(0,G.cost_price*oe),retail_price:v.retail_price||Math.max(0,G.retail_price*oe)}).eq("id",G.id).eq("user_id",s.id)});await Promise.all(L),_.success(`${x.size} product(s) updated`)}}else{if(Object.keys(v).length===0){_.error("No changes to update");return}const{error:F}=await R.from("products").update(v).in("id",Array.from(x)).eq("user_id",s.id);if(F)throw F;_.success(`${x.size} product(s) updated`)}A(new Set),await ae()}catch(s){_.error(`Failed to update: ${s.message||"Unknown error"}`)}},[x,ae]),Ot=()=>{if(!t||t.length===0){_.info("No products found");return}const a=ta(t.map(s=>({id:s.id,name:s.name,sku:s.sku,category:s.category})));if(a.length===0){_.info("All products already have categories");return}_t(a),Q(!0)},qt=async a=>{try{const s=se.filter(f=>a.includes(f.productId)).reduce((f,v)=>(f[v.suggestedCategory]||(f[v.suggestedCategory]=[]),f[v.suggestedCategory].push(v.productId),f),{});for(const[f,v]of Object.entries(s)){const{error:F}=await R.from("products").update({category:f}).in("id",v);if(F)throw F}_.success(`Categorized ${a.length} products!`),await ae()}catch(s){throw _.error("Failed to apply categorization"),s}},Vt=l.useCallback(a=>{A(s=>{const f=new Set(s);return f.has(a)?f.delete(a):f.add(a),f})},[]),Bt=l.useCallback(()=>{A(a=>a.size===t.length?new Set:new Set(t.map(s=>s.id)))},[t]),Xe=l.useCallback(async()=>{await R.auth.signOut(),D("/auth")},[D]);return e.jsxs(Jt,{children:[e.jsx(na,{currentGoldRate:y,onUpdate:Dt,onSkip:()=>{}}),e.jsx(oa,{instagramQrUrl:S==null?void 0:S.instagram_qr_url,whatsappQrUrl:S==null?void 0:S.whatsapp_qr_url}),e.jsx(ca,{onExportPDF:Ae,onAutoCategorize:Ot}),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background via-muted/10 to-background relative overflow-hidden",children:[e.jsx(Vs,{}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 via-transparent to-accent/5 pointer-events-none"}),e.jsx("div",{className:"relative bg-background/50 backdrop-blur-sm border-b border-border/30 z-10",children:e.jsx("div",{className:"container mx-auto px-3 md:px-4 py-2 md:py-3",children:e.jsx(Bs,{children:e.jsxs(Gs,{className:"text-sm",children:[e.jsx(ut,{children:e.jsx(Hs,{asChild:!0,children:e.jsx(Ns,{to:"/",children:"Home"})})}),e.jsx(Ys,{className:"text-xs"}),e.jsx(ut,{children:e.jsx(Ks,{className:"text-sm",children:"Catalog"})})]})})})}),e.jsx("header",{className:"relative border-b border-border/50 bg-card/95 backdrop-blur-xl shadow-xl z-10",children:e.jsxs("div",{className:"container mx-auto px-3 sm:px-4 lg:px-6 py-3 sm:py-4 max-w-[1800px] relative z-10",children:[S&&e.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4 lg:gap-6 mb-4 pb-4 border-b border-border/30",children:[e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4 flex-1 w-full lg:w-auto",children:[S.logo_url&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:S.logo_url,alt:"Logo",className:"w-12 h-12 sm:w-16 sm:h-16 object-contain rounded-lg border border-border/30"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-foreground truncate",children:S.business_name||"My Catalog"}),S.brand_tagline&&e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1 line-clamp-2",children:S.brand_tagline})]})]}),e.jsxs("div",{className:"flex items-center gap-4 sm:gap-6 text-xs sm:text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-foreground",children:t.length}),e.jsx("div",{className:"text-muted-foreground",children:"Products"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"font-bold text-foreground",children:["â‚¹",y.toLocaleString("en-IN")]}),e.jsx("div",{className:"text-muted-foreground",children:"Gold Rate/g"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"font-bold text-foreground",children:["â‚¹",pe.toLocaleString("en-IN")]}),e.jsx("div",{className:"text-muted-foreground",children:"Total Value"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"hidden lg:flex items-center flex-wrap gap-2 justify-center",children:[(z.can_view_interests||j)&&e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>D("/interests"),children:[e.jsx(rt,{className:"h-4 w-4 mr-2"}),"Interests"]}),(z.can_view_interests||j)&&e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>D("/video-requests"),children:[e.jsx(it,{className:"h-4 w-4 mr-2"}),"Video Requests"]}),(z.can_edit_profile||j)&&e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>D("/vendor-profile"),children:[e.jsx(nt,{className:"h-4 w-4 mr-2"}),"Profile"]}),(z.can_share_catalog||j)&&e.jsx(je,{children:e.jsxs(be,{children:[e.jsx(Ne,{asChild:!0,children:e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>{if(!de&&!j){E("share_links"),K(!0);return}D("/share")},disabled:!de&&!j,children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Share",!j&&Te!==1/0&&Te<100&&e.jsxs("span",{className:"ml-1 text-xs text-muted-foreground",children:["(",Te," left)"]})]})}),!de&&!j&&e.jsx(ve,{children:e.jsx("p",{children:"Share link limit reached"})})]})}),j&&e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>D("/admin"),children:[e.jsx(lt,{className:"h-4 w-4 mr-2"}),"Admin"]}),(z.can_add_products||j)&&e.jsx(je,{children:e.jsxs(be,{children:[e.jsx(Ne,{asChild:!0,children:e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>{if(!ce&&!j){E("products"),K(!0);return}D("/add-product")},disabled:!ce&&!j,children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Add",!j&&Le!==1/0&&Le<100&&e.jsxs("span",{className:"ml-1 text-xs text-muted-foreground",children:["(",Le," left)"]})]})}),!ce&&!j&&e.jsx(ve,{children:e.jsx("p",{children:"Product limit reached"})})]})}),(z.can_import_data||j)&&e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>D("/import"),children:[e.jsx(ot,{className:"h-4 w-4 mr-2"}),"Import"]}),e.jsxs(C,{variant:"outline",size:"sm",onClick:Ae,children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),"Export PDF"]}),(z.can_manage_team||j)&&e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>D("/team"),children:[e.jsx(ct,{className:"h-4 w-4 mr-2"}),"Team"]}),(z.can_delete_products||j)&&x.size>0&&e.jsxs(e.Fragment,{children:[e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>te(!0),children:[e.jsx(xs,{className:"h-4 w-4 mr-2"}),"Update (",x.size,")"]}),e.jsxs(C,{variant:"destructive",size:"sm",onClick:()=>O(!0),children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Delete (",x.size,")"]})]}),e.jsxs(C,{variant:"ghost",size:"sm",onClick:Xe,children:[e.jsx(dt,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]}),e.jsx("div",{className:"lg:hidden w-full",children:e.jsxs(vs,{children:[e.jsx(_s,{asChild:!0,children:e.jsxs(C,{variant:"outline",size:"default",className:"w-full h-11",children:[e.jsx(ys,{className:"h-5 w-5 mr-2"}),e.jsx("span",{className:"font-medium",children:"Menu"})]})}),e.jsxs(ws,{align:"center",className:"w-[calc(100vw-2rem)] sm:w-80 max-h-[70vh] overflow-y-auto",children:[(z.can_view_interests||j)&&e.jsxs(B,{onClick:()=>D("/interests"),className:"py-3",children:[e.jsx(rt,{className:"h-5 w-5 mr-3 text-primary"}),"View Interests"]}),(z.can_view_interests||j)&&e.jsxs(B,{onClick:()=>D("/video-requests"),className:"py-3",children:[e.jsx(it,{className:"h-5 w-5 mr-3 text-primary"}),"Video Requests"]}),(z.can_view_interests||j)&&e.jsxs(B,{onClick:()=>D("/purchase-inquiries"),className:"py-3",children:[e.jsx(jt,{className:"h-5 w-5 mr-3 text-primary"}),"Purchase Inquiries"]}),(z.can_edit_profile||j)&&e.jsxs(B,{onClick:()=>D("/vendor-profile"),className:"py-3",children:[e.jsx(nt,{className:"h-5 w-5 mr-3 text-primary"}),"Vendor Profile"]}),(z.can_share_catalog||j)&&e.jsxs(B,{onClick:()=>{if(!de&&!j){E("share_links"),K(!0);return}D("/share")},disabled:!de&&!j,className:"py-3",children:[e.jsx(Be,{className:"h-5 w-5 mr-3 text-primary"}),"Share Catalog"]}),j&&e.jsxs(e.Fragment,{children:[e.jsx(Ie,{}),e.jsxs(B,{onClick:()=>D("/admin"),className:"py-3",children:[e.jsx(lt,{className:"h-5 w-5 mr-3 text-primary"}),"Admin Dashboard"]})]}),e.jsx(Ie,{}),(z.can_add_products||j)&&e.jsxs(B,{onClick:()=>{if(!ce&&!j){E("products"),K(!0);return}D("/add-product")},disabled:!ce&&!j,className:"py-3",children:[e.jsx(ye,{className:"h-5 w-5 mr-3 text-primary"}),"Add Product"]}),(z.can_import_data||j)&&e.jsxs(B,{onClick:()=>D("/import"),className:"py-3",children:[e.jsx(ot,{className:"h-5 w-5 mr-3 text-primary"}),"Import Data"]}),e.jsxs(B,{onClick:Ae,className:"py-3",children:[e.jsx(Ge,{className:"h-5 w-5 mr-3 text-primary"}),"Export PDF"]}),(z.can_manage_team||j)&&e.jsxs(B,{onClick:()=>D("/team"),className:"py-3",children:[e.jsx(ct,{className:"h-5 w-5 mr-3 text-primary"}),"Manage Team"]}),e.jsx(Ie,{}),(z.can_view_sessions||j)&&e.jsxs(B,{onClick:()=>D("/active-sessions"),className:"py-3",children:[e.jsx(js,{className:"h-5 w-5 mr-3 text-primary"}),"Active Sessions"]}),e.jsxs(B,{onClick:Xe,className:"py-3 text-destructive",children:[e.jsx(dt,{className:"h-5 w-5 mr-3"}),"Sign Out"]})]})]})})]})]})}),e.jsxs("main",{className:"container mx-auto px-3 sm:px-4 lg:px-6 py-6 sm:py-8 lg:py-10 max-w-[1800px]",children:[e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsx(Ps,{}),e.jsx(ia,{}),e.jsx(la,{goldRate:y,silverRate:U,platinumRate:r,onRatesUpdated:a=>{N(a.goldRate),g(a.silverRate),u(a.platinumRate)}})]}),m?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:Array.from({length:6}).map((a,s)=>e.jsx(Zs,{},s))}):e.jsxs("div",{className:"animate-fade-in",children:[ne.length>1&&e.jsx("div",{className:"mb-6 flex gap-2 overflow-x-auto justify-start md:justify-center pb-2 px-2",children:ne.map(a=>e.jsxs("button",{onClick:()=>ie(a),disabled:m,className:`px-4 py-2 rounded-xl font-medium text-sm transition-all ${q===a?"bg-primary text-primary-foreground scale-105":"bg-card border border-border hover:bg-muted"}`,children:[a," (",Et(a),")"]},a))}),e.jsx(bs,{filters:w,onFilterChange:wt,productType:q,categories:Ft,metalTypes:Tt,diamondColors:Rt,diamondClarities:At,deliveryTypes:It,categoryCounts:Lt,gemstoneTypes:[],colors:[],clarities:[],cuts:[],shapes:[],polishes:[],symmetries:[],fluorescences:[],labs:[]}),(z.can_delete_products||j)&&t.length>0&&e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(_e,{checked:x.size===t.length&&t.length>0,onCheckedChange:Bt,id:"select-all"}),e.jsxs("label",{htmlFor:"select-all",className:"text-sm text-muted-foreground cursor-pointer",children:["Select All (",x.size,"/",t.length,")"]})]}),Re.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ’Ž"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No products found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Add your first product to get started"}),(z.can_add_products||j)&&e.jsxs(C,{onClick:()=>D("/add-product"),children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Add Product"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 sm:gap-4 lg:gap-5",children:Re.map(a=>e.jsx(Js,{product:a,isSelected:x.has(a.id),onToggleSelection:Vt,usdRate:n},a.id))}),Ut&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs(C,{variant:"outline",size:"lg",onClick:$t,children:["Load More (",X.length-ge," remaining)"]})}),e.jsxs("div",{className:"mt-6 text-center text-sm text-muted-foreground",children:["Showing ",Re.length," of ",X.length," products"]})]})]})]})]}),e.jsx(vt,{open:P,onOpenChange:K,limitType:d}),e.jsx(ma,{open:V,onOpenChange:te,selectedCount:x.size,onUpdate:Wt,selectedProductIds:Array.from(x)}),e.jsx(ha,{open:Fe,onOpenChange:O,onConfirm:zt,isDeleting:le,products:Mt}),e.jsx(aa,{open:Z,onOpenChange:Q,suggestions:se,onApply:qt})]})};export{Ha as default};
//# sourceMappingURL=Catalog-CjQJx7_G.js.map
