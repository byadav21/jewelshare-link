{"version":3,"file":"CustomerDatabase-BP-TwF7Q.js","sources":["../../src/pages/CustomerDatabase.tsx"],"sourcesContent":["import { useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useQuery } from \"@tanstack/react-query\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { useUserRole } from \"@/hooks/useUserRole\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { ArrowLeft, Search, Mail, Phone, MessageSquare, Heart } from \"lucide-react\";\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from \"@/components/ui/table\";\r\nimport { format } from \"date-fns\";\r\n\r\nconst CustomerDatabase = () => {\r\n  const navigate = useNavigate();\r\n  const { isAdmin, loading: roleLoading } = useUserRole();\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [statusFilter, setStatusFilter] = useState(\"all\");\r\n\r\n  // Fetch product interests\r\n  const { data: interestsData, isLoading: interestsLoading } = useQuery({\r\n    queryKey: [\"customer-interests\"],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from(\"product_interests\")\r\n        .select(`\r\n          *,\r\n          product:product_id (\r\n            name,\r\n            sku,\r\n            category\r\n          ),\r\n          share_link:share_link_id (\r\n            share_token\r\n          )\r\n        `)\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    enabled: isAdmin,\r\n  });\r\n\r\n  // Fetch catalog inquiries\r\n  const { data: inquiriesData, isLoading: inquiriesLoading } = useQuery({\r\n    queryKey: [\"customer-inquiries\"],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from(\"catalog_inquiries\")\r\n        .select(`\r\n          *,\r\n          share_link:share_link_id (\r\n            share_token\r\n          )\r\n        `)\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    enabled: isAdmin,\r\n  });\r\n\r\n  // Fetch manufacturing estimates with customer data\r\n  const { data: estimatesData, isLoading: estimatesLoading } = useQuery({\r\n    queryKey: [\"manufacturing-estimates-customers\"],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from(\"manufacturing_cost_estimates\")\r\n        .select(\"*\")\r\n        .not(\"customer_name\", \"is\", null)\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    enabled: isAdmin,\r\n  });\r\n\r\n  // Filter interests\r\n  const filteredInterests = interestsData?.filter((interest: any) => {\r\n    if (!searchQuery) return true;\r\n    const query = searchQuery.toLowerCase();\r\n    return (\r\n      interest.customer_name?.toLowerCase().includes(query) ||\r\n      interest.customer_email?.toLowerCase().includes(query) ||\r\n      interest.customer_phone?.toLowerCase().includes(query) ||\r\n      interest.product?.name?.toLowerCase().includes(query)\r\n    );\r\n  });\r\n\r\n  // Filter inquiries\r\n  const filteredInquiries = inquiriesData?.filter((inquiry: any) => {\r\n    if (!searchQuery) return true;\r\n    const query = searchQuery.toLowerCase();\r\n    return (\r\n      inquiry.customer_name?.toLowerCase().includes(query) ||\r\n      inquiry.customer_email?.toLowerCase().includes(query) ||\r\n      inquiry.customer_phone?.toLowerCase().includes(query) ||\r\n      inquiry.message?.toLowerCase().includes(query)\r\n    );\r\n  });\r\n\r\n  // Filter manufacturing estimates\r\n  const filteredEstimates = estimatesData?.filter((estimate: any) => {\r\n    const matchesSearch = !searchQuery || (\r\n      estimate.customer_name?.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n      estimate.customer_email?.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n      estimate.customer_phone?.includes(searchQuery) ||\r\n      estimate.estimate_name?.toLowerCase().includes(searchQuery.toLowerCase())\r\n    );\r\n    \r\n    const matchesStatus = statusFilter === \"all\" || estimate.status === statusFilter;\r\n    \r\n    return matchesSearch && matchesStatus;\r\n  });\r\n\r\n  // Get unique customers\r\n  const uniqueCustomers = () => {\r\n    const customerMap = new Map();\r\n\r\n    interestsData?.forEach((interest: any) => {\r\n      const email = interest.customer_email;\r\n      if (!customerMap.has(email)) {\r\n        customerMap.set(email, {\r\n          name: interest.customer_name,\r\n          email: interest.customer_email,\r\n          phone: interest.customer_phone,\r\n          interests: 0,\r\n          inquiries: 0,\r\n          lastActivity: interest.created_at,\r\n        });\r\n      }\r\n      const customer = customerMap.get(email);\r\n      customer.interests++;\r\n      if (new Date(interest.created_at) > new Date(customer.lastActivity)) {\r\n        customer.lastActivity = interest.created_at;\r\n      }\r\n    });\r\n\r\n    inquiriesData?.forEach((inquiry: any) => {\r\n      const email = inquiry.customer_email;\r\n      if (!customerMap.has(email)) {\r\n        customerMap.set(email, {\r\n          name: inquiry.customer_name,\r\n          email: inquiry.customer_email,\r\n          phone: inquiry.customer_phone,\r\n          interests: 0,\r\n          inquiries: 0,\r\n          lastActivity: inquiry.created_at,\r\n        });\r\n      }\r\n      const customer = customerMap.get(email);\r\n      customer.inquiries++;\r\n      if (new Date(inquiry.created_at) > new Date(customer.lastActivity)) {\r\n        customer.lastActivity = inquiry.created_at;\r\n      }\r\n    });\r\n\r\n    return Array.from(customerMap.values()).filter((customer: any) => {\r\n      if (!searchQuery) return true;\r\n      const query = searchQuery.toLowerCase();\r\n      return (\r\n        customer.name?.toLowerCase().includes(query) ||\r\n        customer.email?.toLowerCase().includes(query) ||\r\n        customer.phone?.toLowerCase().includes(query)\r\n      );\r\n    });\r\n  };\r\n\r\n  if (roleLoading) {\r\n    return <div className=\"flex items-center justify-center min-h-screen\">Loading...</div>;\r\n  }\r\n\r\n  if (!isAdmin) {\r\n    navigate(\"/\");\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mx-auto p-6 space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <Button variant=\"ghost\" onClick={() => navigate(\"/super-admin\")}>\r\n            <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n            Back to Dashboard\r\n          </Button>\r\n          <h1 className=\"text-3xl font-bold\">Customer Database</h1>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Total Customers</CardTitle>\r\n            <Mail className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{uniqueCustomers().length}</div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Product Interests</CardTitle>\r\n            <Heart className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{interestsData?.length || 0}</div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Catalog Inquiries</CardTitle>\r\n            <MessageSquare className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{inquiriesData?.length || 0}</div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Search Bar */}\r\n      <Card>\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-muted-foreground\" />\r\n            <Input\r\n              type=\"text\"\r\n              placeholder=\"Search customers by name, email, or phone...\"\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              className=\"pl-10 h-12 text-base\"\r\n            />\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Results Tabs */}\r\n      <Tabs defaultValue=\"customers\" className=\"w-full\">\r\n        <TabsList className=\"grid w-full max-w-2xl grid-cols-4\">\r\n          <TabsTrigger value=\"customers\">Customers</TabsTrigger>\r\n          <TabsTrigger value=\"interests\">Interests</TabsTrigger>\r\n          <TabsTrigger value=\"inquiries\">Inquiries</TabsTrigger>\r\n          <TabsTrigger value=\"manufacturing\">Manufacturing</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"customers\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>All Customers</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"overflow-x-auto\">\r\n                <Table>\r\n                  <TableHeader>\r\n                    <TableRow>\r\n                      <TableHead>Name</TableHead>\r\n                      <TableHead>Contact</TableHead>\r\n                      <TableHead>Interests</TableHead>\r\n                      <TableHead>Inquiries</TableHead>\r\n                      <TableHead>Last Activity</TableHead>\r\n                    </TableRow>\r\n                  </TableHeader>\r\n                  <TableBody>\r\n                    {uniqueCustomers().map((customer: any, index: number) => (\r\n                      <TableRow key={index}>\r\n                        <TableCell className=\"font-medium\">{customer.name}</TableCell>\r\n                        <TableCell>\r\n                          <div className=\"space-y-1\">\r\n                            <div className=\"flex items-center gap-1 text-sm\">\r\n                              <Mail className=\"h-3 w-3\" />\r\n                              {customer.email}\r\n                            </div>\r\n                            {customer.phone && (\r\n                              <div className=\"flex items-center gap-1 text-sm\">\r\n                                <Phone className=\"h-3 w-3\" />\r\n                                {customer.phone}\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        </TableCell>\r\n                        <TableCell>\r\n                          <Badge variant=\"outline\">{customer.interests}</Badge>\r\n                        </TableCell>\r\n                        <TableCell>\r\n                          <Badge variant=\"outline\">{customer.inquiries}</Badge>\r\n                        </TableCell>\r\n                        <TableCell className=\"text-sm text-muted-foreground\">\r\n                          {format(new Date(customer.lastActivity), \"MMM dd, yyyy HH:mm\")}\r\n                        </TableCell>\r\n                      </TableRow>\r\n                    ))}\r\n                  </TableBody>\r\n                </Table>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"interests\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Product Interests</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              {interestsLoading ? (\r\n                <div className=\"text-center py-8\">Loading...</div>\r\n              ) : (\r\n                <div className=\"overflow-x-auto\">\r\n                  <Table>\r\n                    <TableHeader>\r\n                      <TableRow>\r\n                        <TableHead>Customer</TableHead>\r\n                        <TableHead>Product</TableHead>\r\n                        <TableHead>Contact</TableHead>\r\n                        <TableHead>Notes</TableHead>\r\n                        <TableHead>Date</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {filteredInterests?.map((interest: any) => (\r\n                        <TableRow key={interest.id}>\r\n                          <TableCell className=\"font-medium\">\r\n                            {interest.customer_name}\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <div>\r\n                              <div className=\"font-medium\">{interest.product?.name || \"N/A\"}</div>\r\n                              {interest.product?.sku && (\r\n                                <div className=\"text-xs text-muted-foreground\">\r\n                                  SKU: {interest.product.sku}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <div className=\"space-y-1 text-sm\">\r\n                              {interest.customer_email && (\r\n                                <div className=\"flex items-center gap-1\">\r\n                                  <Mail className=\"h-3 w-3\" />\r\n                                  {interest.customer_email}\r\n                                </div>\r\n                              )}\r\n                              {interest.customer_phone && (\r\n                                <div className=\"flex items-center gap-1\">\r\n                                  <Phone className=\"h-3 w-3\" />\r\n                                  {interest.customer_phone}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          </TableCell>\r\n                          <TableCell className=\"max-w-xs truncate\">\r\n                            {interest.notes || \"-\"}\r\n                          </TableCell>\r\n                          <TableCell className=\"text-sm text-muted-foreground\">\r\n                            {format(new Date(interest.created_at), \"MMM dd, yyyy\")}\r\n                          </TableCell>\r\n                        </TableRow>\r\n                      ))}\r\n                    </TableBody>\r\n                  </Table>\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"inquiries\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Catalog Inquiries</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              {inquiriesLoading ? (\r\n                <div className=\"text-center py-8\">Loading...</div>\r\n              ) : (\r\n                <div className=\"overflow-x-auto\">\r\n                  <Table>\r\n                    <TableHeader>\r\n                      <TableRow>\r\n                        <TableHead>Customer</TableHead>\r\n                        <TableHead>Contact</TableHead>\r\n                        <TableHead>Message</TableHead>\r\n                        <TableHead>Date</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {filteredInquiries?.map((inquiry: any) => (\r\n                        <TableRow key={inquiry.id}>\r\n                          <TableCell className=\"font-medium\">\r\n                            {inquiry.customer_name}\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <div className=\"space-y-1 text-sm\">\r\n                              <div className=\"flex items-center gap-1\">\r\n                                <Mail className=\"h-3 w-3\" />\r\n                                {inquiry.customer_email}\r\n                              </div>\r\n                              {inquiry.customer_phone && (\r\n                                <div className=\"flex items-center gap-1\">\r\n                                  <Phone className=\"h-3 w-3\" />\r\n                                  {inquiry.customer_phone}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          </TableCell>\r\n                          <TableCell className=\"max-w-md\">\r\n                            <div className=\"line-clamp-2\">{inquiry.message}</div>\r\n                          </TableCell>\r\n                          <TableCell className=\"text-sm text-muted-foreground\">\r\n                            {format(new Date(inquiry.created_at), \"MMM dd, yyyy\")}\r\n                          </TableCell>\r\n                        </TableRow>\r\n                      ))}\r\n                    </TableBody>\r\n                  </Table>\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n        \r\n        <TabsContent value=\"manufacturing\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Manufacturing Orders</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              {estimatesLoading ? (\r\n                <div className=\"text-center py-8\">Loading...</div>\r\n              ) : !filteredEstimates || filteredEstimates.length === 0 ? (\r\n                <div className=\"text-center py-8 text-muted-foreground\">No manufacturing orders found</div>\r\n              ) : (\r\n                <div className=\"overflow-x-auto\">\r\n                  <Table>\r\n                    <TableHeader>\r\n                      <TableRow>\r\n                        <TableHead>Customer</TableHead>\r\n                        <TableHead>Contact</TableHead>\r\n                        <TableHead>Estimate</TableHead>\r\n                        <TableHead>Status</TableHead>\r\n                        <TableHead>Value</TableHead>\r\n                        <TableHead>Date</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {filteredEstimates?.map((estimate: any) => (\r\n                        <TableRow key={estimate.id}>\r\n                          <TableCell className=\"font-medium\">\r\n                            {estimate.customer_name}\r\n                            {estimate.customer_address && (\r\n                              <div className=\"text-xs text-muted-foreground mt-1\">\r\n                                {estimate.customer_address}\r\n                              </div>\r\n                            )}\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <div className=\"space-y-1 text-sm\">\r\n                              {estimate.customer_email && (\r\n                                <div className=\"flex items-center gap-1\">\r\n                                  <Mail className=\"h-3 w-3\" />\r\n                                  {estimate.customer_email}\r\n                                </div>\r\n                              )}\r\n                              {estimate.customer_phone && (\r\n                                <div className=\"flex items-center gap-1\">\r\n                                  <Phone className=\"h-3 w-3\" />\r\n                                  {estimate.customer_phone}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          </TableCell>\r\n                          <TableCell>{estimate.estimate_name}</TableCell>\r\n                          <TableCell>\r\n                            <Badge variant={\r\n                              estimate.status === 'completed' ? 'default' : \r\n                              estimate.status === 'cancelled' ? 'destructive' : \r\n                              'secondary'\r\n                            }>\r\n                              {estimate.status?.replace('_', ' ') || 'draft'}\r\n                            </Badge>\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <div className=\"font-semibold\">â‚¹{estimate.final_selling_price?.toFixed(2)}</div>\r\n                          </TableCell>\r\n                          <TableCell className=\"text-sm text-muted-foreground\">\r\n                            {format(new Date(estimate.created_at), \"MMM dd, yyyy\")}\r\n                          </TableCell>\r\n                        </TableRow>\r\n                      ))}\r\n                    </TableBody>\r\n                  </Table>\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CustomerDatabase;\r\n"],"names":["CustomerDatabase","navigate","useNavigate","isAdmin","roleLoading","useUserRole","searchQuery","setSearchQuery","useState","statusFilter","setStatusFilter","interestsData","interestsLoading","useQuery","data","error","supabase","inquiriesData","inquiriesLoading","estimatesData","estimatesLoading","filteredInterests","interest","query","_a","_b","_c","_e","_d","filteredInquiries","inquiry","filteredEstimates","estimate","matchesSearch","matchesStatus","uniqueCustomers","customerMap","email","customer","jsx","jsxs","Button","ArrowLeft","Card","CardHeader","CardTitle","Mail","CardContent","Heart","MessageSquare","Search","Input","e","Tabs","TabsList","TabsTrigger","TabsContent","Table","TableHeader","TableRow","TableHead","TableBody","index","TableCell","Phone","Badge","format"],"mappings":"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"}