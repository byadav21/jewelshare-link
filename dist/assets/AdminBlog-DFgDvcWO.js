import{b as P,u as B,c as j,j as e}from"./query-vendor-BLxHmmGk.js";import{r as v}from"./react-vendor-BeR0k5Z3.js";import{B as m,C as F,i as T,k as A,g as E,s as u}from"./index-CX6yiz0b.js";import{A as k}from"./AdminLayout-iDUtkfn_.js";import{I as o}from"./input-CiHC6UAI.js";import{T as y}from"./textarea-CBQfWmvq.js";import{B as g}from"./badge-45Abp579.js";import{S as I}from"./switch-7lvrHTHU.js";import{L as i}from"./label-DbIM3Eg1.js";import{ai as L,l as M,aT as O,ar as Q,u as n}from"./ui-vendor-DjQqXt9S.js";import{D as K,a as R,b as U,c as z,d as H}from"./dialog-KVJ8gRMk.js";import{M as $}from"./MediaUpload-D_Yhy2BU.js";import{A as G}from"./AdminLoadingSkeleton-DpaOBF9G.js";import{A as J}from"./AdminEmptyState-1jKiT_K8.js";import"./supabase-vendor-VSDMYZ1k.js";import"./separator-D0WC8Ha9.js";import"./index-DhS5fNEb.js";import"./index-D6fUEw85.js";import"./NavLink-Bvq0lq1P.js";import"./index-BC78nHQ6.js";import"./index-DVcnno33.js";import"./index-DjQc2W_p.js";function je(){const h=P(),[b,c]=v.useState(!1),[d,f]=v.useState(null),[a,r]=v.useState({title:"",slug:"",excerpt:"",content:"",author_name:"",author_role:"",cover_image:"",published:!1,tags:"",category:"",read_time:5}),{data:x,isLoading:N}=B({queryKey:["admin-blog-posts"],queryFn:async()=>{const{data:s,error:t}=await u.from("blog_posts").select("*").order("created_at",{ascending:!1});if(t)throw t;return s}}),C=j({mutationFn:async s=>{const{error:t}=await u.from("blog_posts").insert({...s,tags:s.tags?s.tags.split(",").map(l=>l.trim()):[],published_at:s.published?new Date().toISOString():null});if(t)throw t},onSuccess:()=>{h.invalidateQueries({queryKey:["admin-blog-posts"]}),n.success("Blog post created successfully"),c(!1),p()},onError:()=>n.error("Failed to create blog post")}),_=j({mutationFn:async({id:s,data:t})=>{const{error:l}=await u.from("blog_posts").update({...t,tags:t.tags?t.tags.split(",").map(q=>q.trim()):[],published_at:t.published?new Date().toISOString():null}).eq("id",s);if(l)throw l},onSuccess:()=>{h.invalidateQueries({queryKey:["admin-blog-posts"]}),n.success("Blog post updated successfully"),c(!1),p()},onError:()=>n.error("Failed to update blog post")}),w=j({mutationFn:async s=>{const{error:t}=await u.from("blog_posts").delete().eq("id",s);if(t)throw t},onSuccess:()=>{h.invalidateQueries({queryKey:["admin-blog-posts"]}),n.success("Blog post deleted successfully")},onError:()=>n.error("Failed to delete blog post")}),p=()=>{r({title:"",slug:"",excerpt:"",content:"",author_name:"",author_role:"",cover_image:"",published:!1,tags:"",category:"",read_time:5}),f(null)},S=s=>{var t;f(s),r({title:s.title,slug:s.slug,excerpt:s.excerpt||"",content:s.content,author_name:s.author_name,author_role:s.author_role||"",cover_image:s.cover_image||"",published:s.published||!1,tags:((t=s.tags)==null?void 0:t.join(", "))||"",category:s.category||"",read_time:s.read_time||5}),c(!0)},D=s=>{s.preventDefault(),d?_.mutate({id:d.id,data:a}):C.mutate(a)};return e.jsx(k,{children:e.jsxs("div",{className:"p-6 space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-primary to-primary/60 bg-clip-text text-transparent",children:"Blog Posts"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage your blog content"})]}),e.jsxs(K,{open:b,onOpenChange:c,children:[e.jsx(R,{asChild:!0,children:e.jsxs(m,{onClick:p,className:"shadow-md hover:shadow-lg transition-all",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"New Post"]})}),e.jsxs(U,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(z,{children:e.jsx(H,{children:d?"Edit Blog Post":"Create Blog Post"})}),e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Title"}),e.jsx(o,{value:a.title,onChange:s=>r({...a,title:s.target.value}),required:!0,className:"mt-1.5"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Slug (URL)"}),e.jsx(o,{value:a.slug,onChange:s=>r({...a,slug:s.target.value}),required:!0,className:"mt-1.5"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Excerpt"}),e.jsx(y,{value:a.excerpt,onChange:s=>r({...a,excerpt:s.target.value}),className:"mt-1.5"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Content"}),e.jsx(y,{value:a.content,onChange:s=>r({...a,content:s.target.value}),rows:10,required:!0,className:"mt-1.5"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Author Name"}),e.jsx(o,{value:a.author_name,onChange:s=>r({...a,author_name:s.target.value}),required:!0,className:"mt-1.5"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Author Role"}),e.jsx(o,{value:a.author_role,onChange:s=>r({...a,author_role:s.target.value}),className:"mt-1.5"})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Cover Image"}),e.jsx("div",{className:"mt-1.5",children:e.jsx($,{bucket:"blog-images",onUploadComplete:s=>r({...a,cover_image:s}),currentImage:a.cover_image})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Category"}),e.jsx(o,{value:a.category,onChange:s=>r({...a,category:s.target.value}),className:"mt-1.5"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Read Time (minutes)"}),e.jsx(o,{type:"number",value:a.read_time,onChange:s=>r({...a,read_time:parseInt(s.target.value)}),className:"mt-1.5"})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Tags (comma-separated)"}),e.jsx(o,{value:a.tags,onChange:s=>r({...a,tags:s.target.value}),placeholder:"jewelry, trends, tips",className:"mt-1.5"})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsx(I,{checked:a.published,onCheckedChange:s=>r({...a,published:s})}),e.jsx(i,{children:"Published"})]}),e.jsxs(m,{type:"submit",className:"w-full",children:[d?"Update":"Create"," Post"]})]})]})]})]}),N?e.jsx(G,{}):!x||x.length===0?e.jsx(J,{icon:M,title:"No blog posts yet",description:"Create your first blog post to start sharing content with your audience",actionLabel:"Create First Post",onAction:()=>c(!0)}):e.jsx("div",{className:"grid gap-4",children:x.map((s,t)=>e.jsxs(F,{className:"bg-gradient-card border-border/50 shadow-md hover:shadow-lg transition-all duration-300 animate-fade-in",style:{animationDelay:`${t*50}ms`},children:[e.jsx(T,{children:e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(A,{className:"text-xl",children:s.title}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center text-sm text-muted-foreground",children:[e.jsx("span",{className:"font-medium text-foreground",children:s.author_name}),s.category&&e.jsx(g,{variant:"secondary",className:"bg-gradient-primary",children:s.category}),s.published?e.jsx(g,{className:"bg-success text-success-foreground",children:"Published"}):e.jsx(g,{variant:"outline",children:"Draft"}),e.jsxs("span",{className:"text-xs",children:[s.read_time," min read"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{size:"sm",variant:"outline",onClick:()=>S(s),className:"hover:bg-primary/10 hover:border-primary transition-colors",children:e.jsx(O,{className:"h-4 w-4"})}),e.jsx(m,{size:"sm",variant:"destructive",onClick:()=>w.mutate(s.id),className:"hover:shadow-md transition-shadow",children:e.jsx(Q,{className:"h-4 w-4"})})]})]})}),e.jsxs(E,{className:"space-y-3",children:[s.excerpt&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.excerpt}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.map(l=>e.jsx(g,{variant:"outline",className:"text-xs",children:l},l))})]})]},s.id))})]})})}export{je as default};
//# sourceMappingURL=AdminBlog-DFgDvcWO.js.map
