import{j as e}from"./query-vendor-CIvqgC9B.js";import{u as q,r as p}from"./react-vendor-BCzWReGx.js";import{q as k,B as x,C as R,t as T,x as G,y as W,o as M,l as v}from"./index-DBHw7ps1.js";import{I as u}from"./input-CpEp8mrX.js";import{L as c}from"./label-Di_dI0OZ.js";import{T as V}from"./textarea-Bx7WjwE9.js";import{S as C,a as S,b as w,c as F,d as a}from"./select-B1aOqld7.js";import{a as O}from"./validations-Dq2g6qv0.js";import{a3 as L,s as Y,X as A}from"./ui-vendor-B3Ur81tx.js";import"./supabase-vendor-DJknrin8.js";import"./index-BdQq_4o_.js";import"./index-lgWsV-kP.js";import"./index-vsC2Ycwh.js";import"./index-D6hZrTqZ.js";import"./index-ibl8YJur.js";const de=()=>{const U=q(),{toast:o}=k(),[f,j]=p.useState(!1),[l,h]=p.useState([]),[g,_]=p.useState(!1),[n,y]=p.useState({customer_name:"",customer_email:"",customer_phone:"",metal_type:"",gemstone_preference:"",design_description:"",budget_range:""}),d=(s,t)=>{y(r=>({...r,[s]:t}))},B=async s=>{const t=s.target.files;if(!t||t.length===0)return;if(l.length+t.length>5){o({title:"Too many files",description:"You can upload up to 5 reference images or videos",variant:"destructive"});return}_(!0);const r=[];try{for(let m=0;m<t.length;m++){const i=t[m],I=i.type.startsWith("video/")?20*1024*1024:5*1024*1024;if(i.size>I){o({title:"File too large",description:`${i.name} is larger than ${i.type.startsWith("video/")?"20MB":"5MB"}`,variant:"destructive"});continue}if(!i.type.startsWith("image/")&&!i.type.startsWith("video/")){o({title:"Invalid file type",description:`${i.name} must be an image or video`,variant:"destructive"});continue}const P=i.name.split(".").pop(),b=`custom-orders/${`${Math.random().toString(36).substring(2)}-${Date.now()}.${P}`}`,{error:N,data:J}=await v.storage.from("vendor-qr-codes").upload(b,i,{cacheControl:"3600",upsert:!1});if(N)throw N;const{data:{publicUrl:$}}=v.storage.from("vendor-qr-codes").getPublicUrl(b);r.push($)}h([...l,...r]),o({title:"Success",description:`${r.length} file(s) uploaded successfully`})}catch(m){console.error("Error uploading files:",m),o({title:"Upload failed",description:"Failed to upload files. Please try again.",variant:"destructive"})}finally{_(!1),s.target.value=""}},D=s=>{h(l.filter((t,r)=>r!==s))},E=async s=>{s.preventDefault();const t=O.safeParse(n);if(!t.success){const m=t.error.issues[0];o({title:"Validation Error",description:m.message,variant:"destructive"});return}j(!0);const{error:r}=await v.from("custom_orders").insert({customer_name:t.data.customer_name,customer_email:t.data.customer_email,customer_phone:t.data.customer_phone||null,metal_type:t.data.metal_type||null,gemstone_preference:t.data.gemstone_preference||null,design_description:t.data.design_description,budget_range:t.data.budget_range||null,reference_images:l.length>0?l:null});if(j(!1),r){o({title:"Error",description:"Failed to submit your request. Please try again.",variant:"destructive"});return}o({title:"Success!",description:"Your custom order request has been submitted. We'll contact you soon!"}),y({customer_name:"",customer_email:"",customer_phone:"",metal_type:"",gemstone_preference:"",design_description:"",budget_range:""}),h([])};return e.jsx("div",{className:"min-h-screen bg-background p-4 md:p-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs(x,{variant:"outline",onClick:()=>U("/"),className:"mb-6",children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Back to Catalog"]}),e.jsxs(R,{children:[e.jsxs(T,{children:[e.jsx(G,{className:"text-3xl",children:"Build Your Custom Jewelry"}),e.jsx(W,{children:"Tell us about your dream piece and we'll bring it to life"})]}),e.jsx(M,{children:e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"customer_name",children:["Your Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(u,{id:"customer_name",value:n.customer_name,onChange:s=>d("customer_name",s.target.value),placeholder:"John Doe",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"customer_email",children:["Email ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(u,{id:"customer_email",type:"email",value:n.customer_email,onChange:s=>d("customer_email",s.target.value),placeholder:"john@example.com",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"customer_phone",children:"Phone Number (Optional)"}),e.jsx(u,{id:"customer_phone",type:"tel",value:n.customer_phone,onChange:s=>d("customer_phone",s.target.value),placeholder:"+1 (555) 000-0000"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"metal_type",children:"Preferred Metal Type"}),e.jsxs(C,{value:n.metal_type,onValueChange:s=>d("metal_type",s),children:[e.jsx(S,{id:"metal_type",children:e.jsx(w,{placeholder:"Select metal type"})}),e.jsxs(F,{children:[e.jsx(a,{value:"Gold",children:"Gold"}),e.jsx(a,{value:"White Gold",children:"White Gold"}),e.jsx(a,{value:"Rose Gold",children:"Rose Gold"}),e.jsx(a,{value:"Platinum",children:"Platinum"}),e.jsx(a,{value:"Silver",children:"Silver"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"gemstone_preference",children:"Gemstone Preference"}),e.jsx(u,{id:"gemstone_preference",value:n.gemstone_preference,onChange:s=>d("gemstone_preference",s.target.value),placeholder:"e.g., Diamond, Sapphire, Ruby"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"budget_range",children:"Budget Range"}),e.jsxs(C,{value:n.budget_range,onValueChange:s=>d("budget_range",s),children:[e.jsx(S,{id:"budget_range",children:e.jsx(w,{placeholder:"Select your budget range"})}),e.jsxs(F,{children:[e.jsx(a,{value:"Under ₹50,000",children:"Under ₹50,000"}),e.jsx(a,{value:"₹50,000 - ₹1,00,000",children:"₹50,000 - ₹1,00,000"}),e.jsx(a,{value:"₹1,00,000 - ₹2,50,000",children:"₹1,00,000 - ₹2,50,000"}),e.jsx(a,{value:"₹2,50,000 - ₹5,00,000",children:"₹2,50,000 - ₹5,00,000"}),e.jsx(a,{value:"Above ₹5,00,000",children:"Above ₹5,00,000"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"design_description",children:["Design Description ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(V,{id:"design_description",value:n.design_description,onChange:s=>d("design_description",s.target.value),placeholder:"Describe your ideal piece in detail - style, occasion, any specific features you'd like...",rows:6,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"reference_images",children:"Reference Images/Videos (Optional)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload up to 5 images or videos for design inspiration (max 5MB for images, 20MB for videos)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{type:"button",variant:"outline",onClick:()=>{var s;return(s=document.getElementById("reference_images"))==null?void 0:s.click()},disabled:g||l.length>=5,children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),g?"Uploading...":"Upload Files"]}),e.jsx(u,{id:"reference_images",type:"file",accept:"image/*,video/*",multiple:!0,onChange:B,className:"hidden"})]}),l.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mt-4",children:l.map((s,t)=>{const r=s.match(/\.(mp4|mov|avi|webm|mkv)(\?|$)/i);return e.jsxs("div",{className:"relative group",children:[r?e.jsx("video",{src:s,className:"w-full h-32 object-cover rounded-lg border border-border",controls:!0}):e.jsx("img",{src:s,alt:`Reference ${t+1}`,className:"w-full h-32 object-cover rounded-lg border border-border"}),e.jsx("button",{type:"button",onClick:()=>D(t),className:"absolute top-2 right-2 bg-destructive text-destructive-foreground rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(A,{className:"h-4 w-4"})})]},t)})})]}),e.jsx(x,{type:"submit",className:"w-full",disabled:f||g,children:f?"Submitting...":"Submit Custom Order Request"})]})})]})]})})};export{de as default};
//# sourceMappingURL=CustomOrder-DPW6pQ3a.js.map
