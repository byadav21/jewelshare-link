import{j as e}from"./query-vendor-BLxHmmGk.js";import{r as a,h as U,u as W}from"./react-vendor-BeR0k5Z3.js";import{B as v,s as u,C as E,i as F,g as L}from"./index-CX6yiz0b.js";import{B as A}from"./badge-45Abp579.js";import{O as B}from"./OptimizedImage-DQ051bg0.js";import{u as O,W as q}from"./WishlistButton-CGX_nMpt.js";import{m as R,a6 as M,v as H,w as z,h as P,D as Y,L as G,u as D,H as $,a7 as K,E as V}from"./ui-vendor-DjQqXt9S.js";import{D as J,a as Q,b as X,c as Z,d as ee,e as se}from"./dialog-KVJ8gRMk.js";import{k as N}from"./proxy-8agjeDDu.js";import{A as te,a as ae}from"./alert-DIsJjuyH.js";import"./supabase-vendor-VSDMYZ1k.js";import"./index-DhS5fNEb.js";import"./index-D6fUEw85.js";const re=({wishlistId:d,wishlistName:x,itemCount:r})=>{const[m,i]=a.useState(!1),[p,l]=a.useState(!1),[n,k]=a.useState(""),[f,g]=a.useState(!1),b=async()=>{if(n)return n;g(!0);try{const{data:s,error:t}=await u.from("wishlists").update({is_public:!0}).eq("id",d).select("share_token").single();if(t)throw t;return k(s.share_token),s.share_token}catch(s){return console.error("Error generating share link:",s),D.error("Failed to generate share link"),""}finally{g(!1)}},C=s=>`${window.location.origin}/wishlist/${encodeURIComponent(s)}`,j=async s=>{l(s),s&&!n&&await b()},c=`Check out my jewelry wishlist: ${x} (${r} items)`,o=n?C(n):"",_=[{name:"WhatsApp",icon:M,color:"bg-green-500 hover:bg-green-600",textColor:"text-green-700 dark:text-green-400",bgColor:"bg-green-50 dark:bg-green-950/30",action:()=>{window.open(`https://wa.me/?text=${encodeURIComponent(`${c}

${o}`)}`,"_blank")}},{name:"Facebook",icon:H,color:"bg-blue-600 hover:bg-blue-700",textColor:"text-blue-700 dark:text-blue-400",bgColor:"bg-blue-50 dark:bg-blue-950/30",action:()=>{window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(o)}`,"_blank")}},{name:"Twitter",icon:z,color:"bg-sky-500 hover:bg-sky-600",textColor:"text-sky-700 dark:text-sky-400",bgColor:"bg-sky-50 dark:bg-sky-950/30",action:()=>{window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(c)}&url=${encodeURIComponent(o)}`,"_blank")}},{name:"Email",icon:P,color:"bg-purple-500 hover:bg-purple-600",textColor:"text-purple-700 dark:text-purple-400",bgColor:"bg-purple-50 dark:bg-purple-950/30",action:()=>{window.location.href=`mailto:?subject=${encodeURIComponent(x)}&body=${encodeURIComponent(`${c}

${o}`)}`}}],S=async()=>{try{await navigator.clipboard.writeText(o),i(!0),D.success("Link copied to clipboard!"),setTimeout(()=>i(!1),2e3)}catch{D.error("Failed to copy link")}};return e.jsxs(J,{open:p,onOpenChange:j,children:[e.jsx(Q,{asChild:!0,children:e.jsxs(v,{variant:"outline",className:"gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),"Share Wishlist"]})}),e.jsxs(X,{className:"sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs(Z,{children:[e.jsxs(ee,{className:"flex items-center gap-2 text-xl",children:[e.jsx(N.div,{animate:{rotate:[0,15,-15,0]},transition:{duration:.5,repeat:2},children:e.jsx(R,{className:"h-6 w-6 text-primary"})}),"Share Your Wishlist"]}),e.jsx(se,{className:"text-sm",children:"Share your favorite jewelry picks with friends and family"})]}),f?e.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"Generating share link..."}):o?e.jsxs("div",{className:"space-y-5 mt-2",children:[e.jsxs("div",{className:"bg-gradient-to-br from-muted/50 to-background rounded-xl p-4 border border-border",children:[e.jsx("h4",{className:"font-semibold text-sm text-foreground mb-1",children:x}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r," ",r===1?"item":"items"," saved"]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:_.map((s,t)=>{const h=s.icon;return e.jsx(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:t*.1},children:e.jsxs(v,{onClick:s.action,variant:"outline",className:`w-full h-auto flex-col gap-2 py-4 ${s.bgColor} border-2 hover:scale-105 transition-transform`,children:[e.jsx("div",{className:`p-2 rounded-full ${s.color} text-white`,children:e.jsx(h,{className:"h-5 w-5"})}),e.jsx("span",{className:`text-sm font-medium ${s.textColor}`,children:s.name})]})},s.name)})}),e.jsxs(N.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"pt-4 border-t border-border space-y-3",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Or copy link"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1 bg-muted/50 rounded-lg px-3 py-2.5 border border-border overflow-hidden",children:e.jsx("p",{className:"text-xs text-muted-foreground break-all",children:o})}),e.jsx(v,{onClick:S,variant:"outline",size:"sm",className:`gap-2 min-w-[100px] transition-all ${m?"bg-green-50 dark:bg-green-950/30 border-green-500":""}`,children:m?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-green-600",children:"Copied!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-4 w-4"}),"Copy"]})})]})]}),e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"bg-gradient-to-r from-primary/10 to-primary/5 border border-primary/20 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["ðŸ’ ",e.jsx("span",{className:"font-medium",children:"Tip:"})," Share on WhatsApp to send your wishlist directly!"]})})]}):null]})]})},be=()=>{const{token:d}=U(),x=W(),{wishlistId:r,loading:m}=O(),[i,p]=a.useState(null),[l,n]=a.useState([]),[k,f]=a.useState(!0),[g,b]=a.useState(null),[C,j]=a.useState(83),c=!!d;a.useEffect(()=>{const s=sessionStorage.getItem("usd_rate"),t=sessionStorage.getItem("usd_rate_time");s&&t&&Date.now()-parseInt(t)<36e5?j(parseFloat(s)):o(),c?_():!m&&r&&S()},[d,r,m]);const o=async()=>{try{const t=await(await fetch("https://api.exchangerate-api.com/v4/latest/USD")).json();t.rates&&t.rates.INR&&(j(t.rates.INR),sessionStorage.setItem("usd_rate",t.rates.INR.toString()),sessionStorage.setItem("usd_rate_time",Date.now().toString()))}catch{console.error("Failed to fetch exchange rate")}},_=async()=>{try{const s=d?decodeURIComponent(d):"",{data:t,error:h}=await u.from("wishlists").select("*, wishlist_items(product_id)").eq("share_token",s).eq("is_public",!0).single();if(h)throw h;if(p(t),t.wishlist_items&&t.wishlist_items.length>0){const I=t.wishlist_items.map(T=>T.product_id),{data:w,error:y}=await u.from("products").select("*").in("id",I).is("deleted_at",null);if(y)throw y;n(w||[])}}catch(s){b(s.message||"Failed to load wishlist")}finally{f(!1)}},S=async()=>{try{const{data:s,error:t}=await u.from("wishlists").select("*, wishlist_items(product_id)").eq("id",r).single();if(t)throw t;if(p(s),s.wishlist_items&&s.wishlist_items.length>0){const h=s.wishlist_items.map(y=>y.product_id),{data:I,error:w}=await u.from("products").select("*").in("id",h).is("deleted_at",null);if(w)throw w;n(I||[])}}catch(s){b(s.message||"Failed to load wishlist")}finally{f(!1)}};return k||m?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx($,{className:"h-12 w-12 text-primary mx-auto mb-4 animate-pulse"}),e.jsx("p",{className:"text-xl text-foreground",children:"Loading wishlist..."})]})}):g?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs(te,{variant:"destructive",className:"max-w-md",children:[e.jsx(K,{className:"h-4 w-4"}),e.jsx(ae,{children:g})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-muted/5 to-background",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(v,{variant:"ghost",onClick:()=>x(-1),className:"gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),"Back"]}),!c&&r&&e.jsx(re,{wishlistId:r,wishlistName:(i==null?void 0:i.name)||"My Wishlist",itemCount:l.length})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/20 to-accent/20 blur-xl rounded-full"}),e.jsx($,{className:"relative h-12 w-12 text-primary fill-primary drop-shadow-2xl"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl lg:text-4xl font-serif font-bold bg-gradient-to-r from-foreground via-foreground to-primary/80 bg-clip-text text-transparent",children:(i==null?void 0:i.name)||"My Wishlist"}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:[l.length," ",l.length===1?"item":"items"," saved"]})]})]})]}),l.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx($,{className:"h-16 w-16 text-muted-foreground/30 mx-auto mb-4"}),e.jsx("p",{className:"text-xl text-muted-foreground",children:"Your wishlist is empty"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Start adding products you love!"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:l.map(s=>e.jsxs(E,{className:"group overflow-hidden hover:shadow-2xl hover:shadow-primary/10 transition-all duration-500 border-border/50 hover:border-primary/40 bg-gradient-to-b from-card to-card/95",children:[s.image_url&&e.jsxs("div",{className:"aspect-square overflow-hidden bg-gradient-to-br from-muted/30 to-muted/10 relative",children:[e.jsx(B,{src:s.image_url,alt:s.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700",width:400,height:400}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),!c&&e.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10",children:e.jsx("div",{className:"bg-background/90 backdrop-blur-sm rounded-full shadow-lg",children:e.jsx(q,{productId:s.id})})})]}),e.jsxs(F,{className:"pb-3",children:[e.jsx("h3",{className:"font-serif text-lg font-bold text-foreground line-clamp-2",children:s.name}),s.sku&&e.jsxs("p",{className:"text-xs text-muted-foreground font-mono",children:["SKU: ",s.sku]})]}),e.jsxs(L,{children:[s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:s.description}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"INR"}),e.jsxs("p",{className:"text-xl font-bold text-primary",children:["â‚¹",s.retail_price.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"USD"}),e.jsxs("p",{className:"text-base font-semibold text-foreground",children:["$",(s.retail_price/C).toFixed(2)]})]})]}),s.category&&e.jsx(A,{variant:"outline",className:"mt-3",children:s.category})]})]},s.id))})]})})};export{be as default};
//# sourceMappingURL=Wishlist-BtiXeLTX.js.map
