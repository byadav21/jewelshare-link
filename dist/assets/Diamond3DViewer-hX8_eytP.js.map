{"version":3,"file":"Diamond3DViewer-hX8_eytP.js","sources":["../../node_modules/@react-three/drei/web/Html.js","../../src/components/Diamond3DViewer.tsx"],"sourcesContent":["import _extends from '@babel/runtime/helpers/esm/extends';\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom/client';\nimport { Vector3, DoubleSide, OrthographicCamera, PerspectiveCamera, Vector2 } from 'three';\nimport { useThree, useFrame } from '@react-three/fiber';\n\nconst v1 = /* @__PURE__ */new Vector3();\nconst v2 = /* @__PURE__ */new Vector3();\nconst v3 = /* @__PURE__ */new Vector3();\nconst v4 = /* @__PURE__ */new Vector2();\nfunction defaultCalculatePosition(el, camera, size) {\n  const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\n  objectPos.project(camera);\n  const widthHalf = size.width / 2;\n  const heightHalf = size.height / 2;\n  return [objectPos.x * widthHalf + widthHalf, -(objectPos.y * heightHalf) + heightHalf];\n}\nfunction isObjectBehindCamera(el, camera) {\n  const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\n  const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\n  const deltaCamObj = objectPos.sub(cameraPos);\n  const camDir = camera.getWorldDirection(v3);\n  return deltaCamObj.angleTo(camDir) > Math.PI / 2;\n}\nfunction isObjectVisible(el, camera, raycaster, occlude) {\n  const elPos = v1.setFromMatrixPosition(el.matrixWorld);\n  const screenPos = elPos.clone();\n  screenPos.project(camera);\n  v4.set(screenPos.x, screenPos.y);\n  raycaster.setFromCamera(v4, camera);\n  const intersects = raycaster.intersectObjects(occlude, true);\n  if (intersects.length) {\n    const intersectionDistance = intersects[0].distance;\n    const pointDistance = elPos.distanceTo(raycaster.ray.origin);\n    return pointDistance < intersectionDistance;\n  }\n  return true;\n}\nfunction objectScale(el, camera) {\n  if (camera instanceof OrthographicCamera) {\n    return camera.zoom;\n  } else if (camera instanceof PerspectiveCamera) {\n    const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\n    const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\n    const vFOV = camera.fov * Math.PI / 180;\n    const dist = objectPos.distanceTo(cameraPos);\n    const scaleFOV = 2 * Math.tan(vFOV / 2) * dist;\n    return 1 / scaleFOV;\n  } else {\n    return 1;\n  }\n}\nfunction objectZIndex(el, camera, zIndexRange) {\n  if (camera instanceof PerspectiveCamera || camera instanceof OrthographicCamera) {\n    const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\n    const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\n    const dist = objectPos.distanceTo(cameraPos);\n    const A = (zIndexRange[1] - zIndexRange[0]) / (camera.far - camera.near);\n    const B = zIndexRange[1] - A * camera.far;\n    return Math.round(A * dist + B);\n  }\n  return undefined;\n}\nconst epsilon = value => Math.abs(value) < 1e-10 ? 0 : value;\nfunction getCSSMatrix(matrix, multipliers, prepend = '') {\n  let matrix3d = 'matrix3d(';\n  for (let i = 0; i !== 16; i++) {\n    matrix3d += epsilon(multipliers[i] * matrix.elements[i]) + (i !== 15 ? ',' : ')');\n  }\n  return prepend + matrix3d;\n}\nconst getCameraCSSMatrix = (multipliers => {\n  return matrix => getCSSMatrix(matrix, multipliers);\n})([1, -1, 1, 1, 1, -1, 1, 1, 1, -1, 1, 1, 1, -1, 1, 1]);\nconst getObjectCSSMatrix = (scaleMultipliers => {\n  return (matrix, factor) => getCSSMatrix(matrix, scaleMultipliers(factor), 'translate(-50%,-50%)');\n})(f => [1 / f, 1 / f, 1 / f, 1, -1 / f, -1 / f, -1 / f, -1, 1 / f, 1 / f, 1 / f, 1, 1, 1, 1, 1]);\nfunction isRefObject(ref) {\n  return ref && typeof ref === 'object' && 'current' in ref;\n}\nconst Html = /* @__PURE__ */React.forwardRef(({\n  children,\n  eps = 0.001,\n  style,\n  className,\n  prepend,\n  center,\n  fullscreen,\n  portal,\n  distanceFactor,\n  sprite = false,\n  transform = false,\n  occlude,\n  onOcclude,\n  castShadow,\n  receiveShadow,\n  material,\n  geometry,\n  zIndexRange = [16777271, 0],\n  calculatePosition = defaultCalculatePosition,\n  as = 'div',\n  wrapperClass,\n  pointerEvents = 'auto',\n  ...props\n}, ref) => {\n  const {\n    gl,\n    camera,\n    scene,\n    size,\n    raycaster,\n    events,\n    viewport\n  } = useThree();\n  const [el] = React.useState(() => document.createElement(as));\n  const root = React.useRef();\n  const group = React.useRef(null);\n  const oldZoom = React.useRef(0);\n  const oldPosition = React.useRef([0, 0]);\n  const transformOuterRef = React.useRef(null);\n  const transformInnerRef = React.useRef(null);\n  // Append to the connected element, which makes HTML work with views\n  const target = (portal == null ? void 0 : portal.current) || events.connected || gl.domElement.parentNode;\n  const occlusionMeshRef = React.useRef(null);\n  const isMeshSizeSet = React.useRef(false);\n  const isRayCastOcclusion = React.useMemo(() => {\n    return occlude && occlude !== 'blending' || Array.isArray(occlude) && occlude.length && isRefObject(occlude[0]);\n  }, [occlude]);\n  React.useLayoutEffect(() => {\n    const el = gl.domElement;\n    if (occlude && occlude === 'blending') {\n      el.style.zIndex = `${Math.floor(zIndexRange[0] / 2)}`;\n      el.style.position = 'absolute';\n      el.style.pointerEvents = 'none';\n    } else {\n      el.style.zIndex = null;\n      el.style.position = null;\n      el.style.pointerEvents = null;\n    }\n  }, [occlude]);\n  React.useLayoutEffect(() => {\n    if (group.current) {\n      const currentRoot = root.current = ReactDOM.createRoot(el);\n      scene.updateMatrixWorld();\n      if (transform) {\n        el.style.cssText = `position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;`;\n      } else {\n        const vec = calculatePosition(group.current, camera, size);\n        el.style.cssText = `position:absolute;top:0;left:0;transform:translate3d(${vec[0]}px,${vec[1]}px,0);transform-origin:0 0;`;\n      }\n      if (target) {\n        if (prepend) target.prepend(el);else target.appendChild(el);\n      }\n      return () => {\n        if (target) target.removeChild(el);\n        currentRoot.unmount();\n      };\n    }\n  }, [target, transform]);\n  React.useLayoutEffect(() => {\n    if (wrapperClass) el.className = wrapperClass;\n  }, [wrapperClass]);\n  const styles = React.useMemo(() => {\n    if (transform) {\n      return {\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: size.width,\n        height: size.height,\n        transformStyle: 'preserve-3d',\n        pointerEvents: 'none'\n      };\n    } else {\n      return {\n        position: 'absolute',\n        transform: center ? 'translate3d(-50%,-50%,0)' : 'none',\n        ...(fullscreen && {\n          top: -size.height / 2,\n          left: -size.width / 2,\n          width: size.width,\n          height: size.height\n        }),\n        ...style\n      };\n    }\n  }, [style, center, fullscreen, size, transform]);\n  const transformInnerStyles = React.useMemo(() => ({\n    position: 'absolute',\n    pointerEvents\n  }), [pointerEvents]);\n  React.useLayoutEffect(() => {\n    isMeshSizeSet.current = false;\n    if (transform) {\n      var _root$current;\n      (_root$current = root.current) == null || _root$current.render(/*#__PURE__*/React.createElement(\"div\", {\n        ref: transformOuterRef,\n        style: styles\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        ref: transformInnerRef,\n        style: transformInnerStyles\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        ref: ref,\n        className: className,\n        style: style,\n        children: children\n      }))));\n    } else {\n      var _root$current2;\n      (_root$current2 = root.current) == null || _root$current2.render(/*#__PURE__*/React.createElement(\"div\", {\n        ref: ref,\n        style: styles,\n        className: className,\n        children: children\n      }));\n    }\n  });\n  const visible = React.useRef(true);\n  useFrame(gl => {\n    if (group.current) {\n      camera.updateMatrixWorld();\n      group.current.updateWorldMatrix(true, false);\n      const vec = transform ? oldPosition.current : calculatePosition(group.current, camera, size);\n      if (transform || Math.abs(oldZoom.current - camera.zoom) > eps || Math.abs(oldPosition.current[0] - vec[0]) > eps || Math.abs(oldPosition.current[1] - vec[1]) > eps) {\n        const isBehindCamera = isObjectBehindCamera(group.current, camera);\n        let raytraceTarget = false;\n        if (isRayCastOcclusion) {\n          if (Array.isArray(occlude)) {\n            raytraceTarget = occlude.map(item => item.current);\n          } else if (occlude !== 'blending') {\n            raytraceTarget = [scene];\n          }\n        }\n        const previouslyVisible = visible.current;\n        if (raytraceTarget) {\n          const isvisible = isObjectVisible(group.current, camera, raycaster, raytraceTarget);\n          visible.current = isvisible && !isBehindCamera;\n        } else {\n          visible.current = !isBehindCamera;\n        }\n        if (previouslyVisible !== visible.current) {\n          if (onOcclude) onOcclude(!visible.current);else el.style.display = visible.current ? 'block' : 'none';\n        }\n        const halfRange = Math.floor(zIndexRange[0] / 2);\n        const zRange = occlude ? isRayCastOcclusion //\n        ? [zIndexRange[0], halfRange] : [halfRange - 1, 0] : zIndexRange;\n        el.style.zIndex = `${objectZIndex(group.current, camera, zRange)}`;\n        if (transform) {\n          const [widthHalf, heightHalf] = [size.width / 2, size.height / 2];\n          const fov = camera.projectionMatrix.elements[5] * heightHalf;\n          const {\n            isOrthographicCamera,\n            top,\n            left,\n            bottom,\n            right\n          } = camera;\n          const cameraMatrix = getCameraCSSMatrix(camera.matrixWorldInverse);\n          const cameraTransform = isOrthographicCamera ? `scale(${fov})translate(${epsilon(-(right + left) / 2)}px,${epsilon((top + bottom) / 2)}px)` : `translateZ(${fov}px)`;\n          let matrix = group.current.matrixWorld;\n          if (sprite) {\n            matrix = camera.matrixWorldInverse.clone().transpose().copyPosition(matrix).scale(group.current.scale);\n            matrix.elements[3] = matrix.elements[7] = matrix.elements[11] = 0;\n            matrix.elements[15] = 1;\n          }\n          el.style.width = size.width + 'px';\n          el.style.height = size.height + 'px';\n          el.style.perspective = isOrthographicCamera ? '' : `${fov}px`;\n          if (transformOuterRef.current && transformInnerRef.current) {\n            transformOuterRef.current.style.transform = `${cameraTransform}${cameraMatrix}translate(${widthHalf}px,${heightHalf}px)`;\n            transformInnerRef.current.style.transform = getObjectCSSMatrix(matrix, 1 / ((distanceFactor || 10) / 400));\n          }\n        } else {\n          const scale = distanceFactor === undefined ? 1 : objectScale(group.current, camera) * distanceFactor;\n          el.style.transform = `translate3d(${vec[0]}px,${vec[1]}px,0) scale(${scale})`;\n        }\n        oldPosition.current = vec;\n        oldZoom.current = camera.zoom;\n      }\n    }\n    if (!isRayCastOcclusion && occlusionMeshRef.current && !isMeshSizeSet.current) {\n      if (transform) {\n        if (transformOuterRef.current) {\n          const el = transformOuterRef.current.children[0];\n          if (el != null && el.clientWidth && el != null && el.clientHeight) {\n            const {\n              isOrthographicCamera\n            } = camera;\n            if (isOrthographicCamera || geometry) {\n              if (props.scale) {\n                if (!Array.isArray(props.scale)) {\n                  occlusionMeshRef.current.scale.setScalar(1 / props.scale);\n                } else if (props.scale instanceof Vector3) {\n                  occlusionMeshRef.current.scale.copy(props.scale.clone().divideScalar(1));\n                } else {\n                  occlusionMeshRef.current.scale.set(1 / props.scale[0], 1 / props.scale[1], 1 / props.scale[2]);\n                }\n              }\n            } else {\n              const ratio = (distanceFactor || 10) / 400;\n              const w = el.clientWidth * ratio;\n              const h = el.clientHeight * ratio;\n              occlusionMeshRef.current.scale.set(w, h, 1);\n            }\n            isMeshSizeSet.current = true;\n          }\n        }\n      } else {\n        const ele = el.children[0];\n        if (ele != null && ele.clientWidth && ele != null && ele.clientHeight) {\n          const ratio = 1 / viewport.factor;\n          const w = ele.clientWidth * ratio;\n          const h = ele.clientHeight * ratio;\n          occlusionMeshRef.current.scale.set(w, h, 1);\n          isMeshSizeSet.current = true;\n        }\n        occlusionMeshRef.current.lookAt(gl.camera.position);\n      }\n    }\n  });\n  const shaders = React.useMemo(() => ({\n    vertexShader: !transform ? /* glsl */`\n          /*\n            This shader is from the THREE's SpriteMaterial.\n            We need to turn the backing plane into a Sprite\n            (make it always face the camera) if \"transfrom\"\n            is false.\n          */\n          #include <common>\n\n          void main() {\n            vec2 center = vec2(0., 1.);\n            float rotation = 0.0;\n\n            // This is somewhat arbitrary, but it seems to work well\n            // Need to figure out how to derive this dynamically if it even matters\n            float size = 0.03;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n            vec2 scale;\n            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n            bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n            if ( isPerspective ) scale *= - mvPosition.z;\n\n            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n            vec2 rotatedPosition;\n            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n            mvPosition.xy += rotatedPosition;\n\n            gl_Position = projectionMatrix * mvPosition;\n          }\n      ` : undefined,\n    fragmentShader: /* glsl */`\n        void main() {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n      `\n  }), [transform]);\n  return /*#__PURE__*/React.createElement(\"group\", _extends({}, props, {\n    ref: group\n  }), occlude && !isRayCastOcclusion && /*#__PURE__*/React.createElement(\"mesh\", {\n    castShadow: castShadow,\n    receiveShadow: receiveShadow,\n    ref: occlusionMeshRef\n  }, geometry || /*#__PURE__*/React.createElement(\"planeGeometry\", null), material || /*#__PURE__*/React.createElement(\"shaderMaterial\", {\n    side: DoubleSide,\n    vertexShader: shaders.vertexShader,\n    fragmentShader: shaders.fragmentShader\n  })));\n});\n\nexport { Html };\n","import { useRef, useState, Suspense, useMemo, useEffect } from \"react\";\r\nimport { Canvas, useFrame, useThree } from \"@react-three/fiber\";\r\nimport { OrbitControls, Environment, ContactShadows, Html, Sparkles } from \"@react-three/drei\";\r\nimport * as THREE from \"three\";\r\n\r\ntype DiamondShape = \"round\" | \"princess\" | \"oval\" | \"cushion\" | \"emerald\" | \"pear\" | \"marquise\" | \"heart\" | \"radiant\" | \"asscher\";\r\n\r\ninterface Diamond3DProps {\r\n  shape: DiamondShape;\r\n  autoRotate?: boolean;\r\n  color?: string;\r\n  showFire?: boolean;\r\n  caratSize?: number;\r\n}\r\n\r\n// Create shape-specific outline for girdle\r\nconst createShapeOutline = (shape: DiamondShape, segments: number = 64): THREE.Vector2[] => {\r\n  const points: THREE.Vector2[] = [];\r\n  \r\n  switch (shape) {\r\n    case \"round\":\r\n      for (let i = 0; i < segments; i++) {\r\n        const angle = (i / segments) * Math.PI * 2;\r\n        points.push(new THREE.Vector2(Math.cos(angle), Math.sin(angle)));\r\n      }\r\n      break;\r\n      \r\n    case \"oval\":\r\n      for (let i = 0; i < segments; i++) {\r\n        const angle = (i / segments) * Math.PI * 2;\r\n        points.push(new THREE.Vector2(Math.cos(angle) * 1.4, Math.sin(angle) * 0.9));\r\n      }\r\n      break;\r\n      \r\n    case \"pear\":\r\n      for (let i = 0; i < segments; i++) {\r\n        const t = (i / segments) * Math.PI * 2;\r\n        // Pear/teardrop shape parametric equation\r\n        const r = 0.8 + 0.4 * Math.sin(t / 2);\r\n        const x = r * Math.sin(t) * 0.85;\r\n        const y = r * Math.cos(t) * 1.1 - 0.2;\r\n        points.push(new THREE.Vector2(x, y));\r\n      }\r\n      break;\r\n      \r\n    case \"marquise\":\r\n      for (let i = 0; i < segments; i++) {\r\n        const t = (i / segments) * Math.PI * 2;\r\n        // Pointed oval (marquise) shape\r\n        const x = Math.sin(t) * 0.55;\r\n        const y = Math.cos(t) * 1.5;\r\n        // Taper the ends\r\n        const taper = Math.pow(Math.abs(Math.sin(t)), 0.3);\r\n        points.push(new THREE.Vector2(x * taper, y));\r\n      }\r\n      break;\r\n      \r\n    case \"heart\":\r\n      for (let i = 0; i < segments; i++) {\r\n        const t = (i / segments) * Math.PI * 2;\r\n        // Heart shape parametric equation\r\n        const x = 16 * Math.pow(Math.sin(t), 3);\r\n        const y = 13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t);\r\n        points.push(new THREE.Vector2(x / 18, y / 18 - 0.1));\r\n      }\r\n      break;\r\n      \r\n    case \"princess\":\r\n    case \"asscher\":\r\n      // Square with slightly rounded corners\r\n      const cornerRadius = shape === \"asscher\" ? 0.15 : 0.08;\r\n      const size = 1.0;\r\n      const corners = [\r\n        { x: -size, y: -size },\r\n        { x: size, y: -size },\r\n        { x: size, y: size },\r\n        { x: -size, y: size },\r\n      ];\r\n      const segsPerSide = Math.floor(segments / 4);\r\n      for (let c = 0; c < 4; c++) {\r\n        const start = corners[c];\r\n        const end = corners[(c + 1) % 4];\r\n        for (let i = 0; i < segsPerSide; i++) {\r\n          const t = i / segsPerSide;\r\n          let x = start.x + (end.x - start.x) * t;\r\n          let y = start.y + (end.y - start.y) * t;\r\n          // Round the corners\r\n          const distFromCorner = Math.min(\r\n            Math.hypot(x - start.x, y - start.y),\r\n            Math.hypot(x - end.x, y - end.y)\r\n          );\r\n          if (distFromCorner < cornerRadius * 2) {\r\n            const blend = distFromCorner / (cornerRadius * 2);\r\n            const angle = Math.atan2(y, x);\r\n            const targetR = Math.max(Math.abs(x), Math.abs(y));\r\n            const smoothR = targetR * (0.95 + 0.05 * blend);\r\n            x = Math.cos(angle) * smoothR * Math.sign(x) * (Math.abs(x) > 0.01 ? 1 : 0) || x;\r\n            y = Math.sin(angle) * smoothR * Math.sign(y) * (Math.abs(y) > 0.01 ? 1 : 0) || y;\r\n          }\r\n          points.push(new THREE.Vector2(x * 0.75, y * 0.75));\r\n        }\r\n      }\r\n      break;\r\n      \r\n    case \"cushion\":\r\n      // Rounded square (cushion)\r\n      for (let i = 0; i < segments; i++) {\r\n        const t = (i / segments) * Math.PI * 2;\r\n        // Superellipse formula for cushion shape\r\n        const n = 3; // Higher = more rounded\r\n        const a = 1.0, b = 1.0;\r\n        const cosT = Math.cos(t);\r\n        const sinT = Math.sin(t);\r\n        const x = Math.sign(cosT) * a * Math.pow(Math.abs(cosT), 2/n);\r\n        const y = Math.sign(sinT) * b * Math.pow(Math.abs(sinT), 2/n);\r\n        points.push(new THREE.Vector2(x, y));\r\n      }\r\n      break;\r\n      \r\n    case \"emerald\":\r\n    case \"radiant\":\r\n      // Elongated octagon (emerald cut)\r\n      const ratio = shape === \"emerald\" ? 1.5 : 1.2;\r\n      const cutCorner = 0.25;\r\n      const octPoints = [\r\n        new THREE.Vector2(-1 + cutCorner, -ratio),\r\n        new THREE.Vector2(1 - cutCorner, -ratio),\r\n        new THREE.Vector2(1, -ratio + cutCorner * ratio),\r\n        new THREE.Vector2(1, ratio - cutCorner * ratio),\r\n        new THREE.Vector2(1 - cutCorner, ratio),\r\n        new THREE.Vector2(-1 + cutCorner, ratio),\r\n        new THREE.Vector2(-1, ratio - cutCorner * ratio),\r\n        new THREE.Vector2(-1, -ratio + cutCorner * ratio),\r\n      ];\r\n      const segsPerEdge = Math.floor(segments / 8);\r\n      for (let e = 0; e < 8; e++) {\r\n        const p1 = octPoints[e];\r\n        const p2 = octPoints[(e + 1) % 8];\r\n        for (let i = 0; i < segsPerEdge; i++) {\r\n          const t = i / segsPerEdge;\r\n          points.push(new THREE.Vector2(\r\n            (p1.x + (p2.x - p1.x) * t) * 0.65,\r\n            (p1.y + (p2.y - p1.y) * t) * 0.65\r\n          ));\r\n        }\r\n      }\r\n      break;\r\n      \r\n    default:\r\n      // Fallback to round\r\n      for (let i = 0; i < segments; i++) {\r\n        const angle = (i / segments) * Math.PI * 2;\r\n        points.push(new THREE.Vector2(Math.cos(angle), Math.sin(angle)));\r\n      }\r\n  }\r\n  \r\n  return points;\r\n};\r\n\r\n// Create diamond geometry from shape outline\r\nconst createDiamondGeometry = (shape: DiamondShape): THREE.BufferGeometry => {\r\n  const geometry = new THREE.BufferGeometry();\r\n  const segments = 64;\r\n  const outline = createShapeOutline(shape, segments);\r\n  \r\n  const crownHeight = 0.22;\r\n  const pavilionDepth = 0.5;\r\n  const tableRatio = 0.55;\r\n  const girdleThickness = 0.04;\r\n  \r\n  const vertices: number[] = [];\r\n  const indices: number[] = [];\r\n  \r\n  const addVertex = (x: number, y: number, z: number): number => {\r\n    vertices.push(x, y, z);\r\n    return vertices.length / 3 - 1;\r\n  };\r\n  \r\n  // Table center\r\n  const tableCenterIdx = addVertex(0, crownHeight, 0);\r\n  \r\n  // Table outline vertices\r\n  const tableVertices: number[] = [];\r\n  for (let i = 0; i < outline.length; i++) {\r\n    const p = outline[i];\r\n    const idx = addVertex(p.x * tableRatio, crownHeight, p.y * tableRatio);\r\n    tableVertices.push(idx);\r\n  }\r\n  \r\n  // Upper girdle vertices (crown meets girdle)\r\n  const upperGirdleVertices: number[] = [];\r\n  for (let i = 0; i < outline.length; i++) {\r\n    const p = outline[i];\r\n    const idx = addVertex(p.x, girdleThickness / 2, p.y);\r\n    upperGirdleVertices.push(idx);\r\n  }\r\n  \r\n  // Lower girdle vertices\r\n  const lowerGirdleVertices: number[] = [];\r\n  for (let i = 0; i < outline.length; i++) {\r\n    const p = outline[i];\r\n    const idx = addVertex(p.x, -girdleThickness / 2, p.y);\r\n    lowerGirdleVertices.push(idx);\r\n  }\r\n  \r\n  // Culet (bottom point)\r\n  const culetIdx = addVertex(0, -pavilionDepth, 0);\r\n  \r\n  // Build table facets\r\n  for (let i = 0; i < outline.length; i++) {\r\n    const next = (i + 1) % outline.length;\r\n    indices.push(tableCenterIdx, tableVertices[i], tableVertices[next]);\r\n  }\r\n  \r\n  // Build crown facets (table to girdle)\r\n  for (let i = 0; i < outline.length; i++) {\r\n    const next = (i + 1) % outline.length;\r\n    // Triangle from table edge to girdle\r\n    indices.push(tableVertices[i], upperGirdleVertices[i], tableVertices[next]);\r\n    indices.push(tableVertices[next], upperGirdleVertices[i], upperGirdleVertices[next]);\r\n  }\r\n  \r\n  // Build girdle facets\r\n  for (let i = 0; i < outline.length; i++) {\r\n    const next = (i + 1) % outline.length;\r\n    indices.push(upperGirdleVertices[i], lowerGirdleVertices[i], upperGirdleVertices[next]);\r\n    indices.push(upperGirdleVertices[next], lowerGirdleVertices[i], lowerGirdleVertices[next]);\r\n  }\r\n  \r\n  // Build pavilion facets (girdle to culet)\r\n  for (let i = 0; i < outline.length; i++) {\r\n    const next = (i + 1) % outline.length;\r\n    indices.push(lowerGirdleVertices[i], culetIdx, lowerGirdleVertices[next]);\r\n  }\r\n  \r\n  geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));\r\n  geometry.setIndex(indices);\r\n  geometry.computeVertexNormals();\r\n  \r\n  return geometry;\r\n};\r\n\r\n// Prismatic fire sparkles\r\nconst PrismaticSparkles = ({ intensity = 1 }: { intensity?: number }) => {\r\n  const groupRef = useRef<THREE.Group>(null);\r\n  \r\n  useFrame((state) => {\r\n    if (groupRef.current) {\r\n      groupRef.current.rotation.y = state.clock.elapsedTime * 0.2;\r\n    }\r\n  });\r\n\r\n  return (\r\n    <group ref={groupRef}>\r\n      <Sparkles count={50} scale={2.5} size={3 * intensity} speed={0.4} opacity={0.6} color=\"#ffffff\" />\r\n      <Sparkles count={15} scale={2} size={2.5} speed={0.3} opacity={0.4} color=\"#ff6b6b\" />\r\n      <Sparkles count={15} scale={2} size={2.5} speed={0.35} opacity={0.4} color=\"#4ecdc4\" />\r\n      <Sparkles count={15} scale={2} size={2.5} speed={0.4} opacity={0.4} color=\"#a855f7\" />\r\n    </group>\r\n  );\r\n};\r\n\r\n// Rainbow fire beams\r\nconst FireBeams = ({ visible = true }: { visible?: boolean }) => {\r\n  const beamsRef = useRef<THREE.Group>(null);\r\n  \r\n  useFrame((state) => {\r\n    if (beamsRef.current && visible) {\r\n      beamsRef.current.rotation.y = state.clock.elapsedTime * 0.6;\r\n      beamsRef.current.children.forEach((child, i) => {\r\n        const mesh = child as THREE.Mesh;\r\n        const mat = mesh.material as THREE.MeshBasicMaterial;\r\n        const t = state.clock.elapsedTime + i * 0.4;\r\n        mesh.scale.y = 0.5 + Math.sin(t * 3) * 0.3;\r\n        mat.opacity = 0.15 + Math.sin(t * 2) * 0.1;\r\n      });\r\n    }\r\n  });\r\n\r\n  const colors = [\"#ff4444\", \"#ff8844\", \"#ffff44\", \"#44ff44\", \"#44ffff\", \"#4444ff\", \"#ff44ff\", \"#ff4488\"];\r\n\r\n  if (!visible) return null;\r\n\r\n  return (\r\n    <group ref={beamsRef} position={[0, 0.1, 0]}>\r\n      {colors.map((color, i) => (\r\n        <mesh key={i} rotation={[0, (i / colors.length) * Math.PI * 2, Math.PI / 6]}>\r\n          <coneGeometry args={[0.012, 2, 4]} />\r\n          <meshBasicMaterial color={color} transparent opacity={0.2} blending={THREE.AdditiveBlending} />\r\n        </mesh>\r\n      ))}\r\n    </group>\r\n  );\r\n};\r\n\r\n// Shape label component\r\nconst ShapeLabel = ({ shape }: { shape: DiamondShape }) => {\r\n  const labelMap: Record<DiamondShape, string> = {\r\n    round: \"Round Brilliant\",\r\n    princess: \"Princess Cut\",\r\n    oval: \"Oval\",\r\n    cushion: \"Cushion\",\r\n    emerald: \"Emerald Cut\",\r\n    pear: \"Pear\",\r\n    marquise: \"Marquise\",\r\n    heart: \"Heart\",\r\n    radiant: \"Radiant\",\r\n    asscher: \"Asscher\"\r\n  };\r\n  \r\n  return (\r\n    <Html position={[0, -1.2, 0]} center>\r\n      <div className=\"bg-black/70 backdrop-blur-sm text-white text-xs px-3 py-1.5 rounded-full whitespace-nowrap font-medium\">\r\n        {labelMap[shape]}\r\n      </div>\r\n    </Html>\r\n  );\r\n};\r\n\r\n// Diamond mesh with accurate shape geometries\r\nconst DiamondMesh = ({ \r\n  shape, \r\n  color = \"#f8fcff\", \r\n  showFire = true,\r\n  caratSize = 1 \r\n}: { \r\n  shape: DiamondShape; \r\n  color?: string; \r\n  showFire?: boolean;\r\n  caratSize?: number;\r\n}) => {\r\n  const groupRef = useRef<THREE.Group>(null);\r\n  const [hovered, setHovered] = useState(false);\r\n  \r\n  const scale = useMemo(() => 0.7 + caratSize * 0.12, [caratSize]);\r\n  \r\n  // Create the actual shape-specific geometry\r\n  const geometry = useMemo(() => createDiamondGeometry(shape), [shape]);\r\n\r\n  useFrame((state) => {\r\n    if (groupRef.current) {\r\n      const breathe = 1 + Math.sin(state.clock.elapsedTime * 0.8) * 0.008;\r\n      groupRef.current.scale.setScalar(scale * breathe);\r\n    }\r\n  });\r\n\r\n  const diamondColor = useMemo(() => new THREE.Color(color), [color]);\r\n\r\n  return (\r\n    <group ref={groupRef} scale={scale}>\r\n      <mesh\r\n        geometry={geometry}\r\n        onPointerOver={() => setHovered(true)}\r\n        onPointerOut={() => setHovered(false)}\r\n        castShadow\r\n        receiveShadow\r\n      >\r\n        <meshPhysicalMaterial\r\n          color={diamondColor}\r\n          metalness={0}\r\n          roughness={0}\r\n          transmission={0.95}\r\n          thickness={1.8}\r\n          ior={2.417}\r\n          clearcoat={1}\r\n          clearcoatRoughness={0}\r\n          envMapIntensity={hovered ? 4.5 : 3.5}\r\n          transparent\r\n          opacity={1}\r\n          attenuationDistance={0.6}\r\n          attenuationColor={diamondColor}\r\n          sheen={0.4}\r\n          sheenRoughness={0.2}\r\n          sheenColor={new THREE.Color(\"#ffffff\")}\r\n          specularIntensity={1}\r\n          specularColor={new THREE.Color(\"#ffffff\")}\r\n        />\r\n      </mesh>\r\n\r\n      {showFire && (\r\n        <>\r\n          <FireBeams visible={true} />\r\n          <PrismaticSparkles intensity={hovered ? 1.3 : 1} />\r\n        </>\r\n      )}\r\n      \r\n      <ShapeLabel shape={shape} />\r\n    </group>\r\n  );\r\n};\r\n\r\n// Advanced lighting rig\r\nconst DiamondLighting = ({ showFire }: { showFire: boolean }) => {\r\n  const lightsRef = useRef<THREE.Group>(null);\r\n  \r\n  useFrame((state) => {\r\n    if (lightsRef.current && showFire) {\r\n      lightsRef.current.rotation.y = state.clock.elapsedTime * 0.25;\r\n    }\r\n  });\r\n\r\n  return (\r\n    <>\r\n      {/* Key light */}\r\n      <directionalLight\r\n        position={[4, 7, 4]}\r\n        intensity={1.5}\r\n        castShadow\r\n        shadow-mapSize-width={1024}\r\n        shadow-mapSize-height={1024}\r\n        color=\"#ffffff\"\r\n      />\r\n      \r\n      {/* Fill light */}\r\n      <directionalLight position={[-3, 5, -3]} intensity={0.8} color=\"#f0f8ff\" />\r\n      \r\n      {/* Rim lights */}\r\n      <pointLight position={[2.5, 1.5, 2.5]} intensity={0.6} color=\"#fff5e6\" distance={8} />\r\n      <pointLight position={[-2.5, 1.5, -2.5]} intensity={0.6} color=\"#e6f0ff\" distance={8} />\r\n      \r\n      {/* Top brilliance */}\r\n      <spotLight\r\n        position={[0, 5, 0]}\r\n        angle={0.5}\r\n        penumbra={0.6}\r\n        intensity={1.5}\r\n        color=\"#ffffff\"\r\n        castShadow\r\n      />\r\n      \r\n      {/* Rotating accent lights */}\r\n      {showFire && (\r\n        <group ref={lightsRef}>\r\n          <pointLight position={[2.5, 0.8, 0]} intensity={0.4} color=\"#ff6666\" distance={5} />\r\n          <pointLight position={[-1.25, 0.8, 2.2]} intensity={0.4} color=\"#66ff66\" distance={5} />\r\n          <pointLight position={[-1.25, 0.8, -2.2]} intensity={0.4} color=\"#6666ff\" distance={5} />\r\n        </group>\r\n      )}\r\n      \r\n      <ambientLight intensity={0.3} />\r\n    </>\r\n  );\r\n};\r\n\r\n// Camera controller\r\nconst CameraController = ({ shape }: { shape: DiamondShape }) => {\r\n  const { camera } = useThree();\r\n  \r\n  useEffect(() => {\r\n    const elongatedShapes = [\"marquise\", \"pear\", \"oval\", \"emerald\"];\r\n    const distance = elongatedShapes.includes(shape) ? 4.2 : 3.8;\r\n    camera.position.set(0, 1.2, distance);\r\n    camera.lookAt(0, 0, 0);\r\n  }, [shape, camera]);\r\n  \r\n  return null;\r\n};\r\n\r\n// Loading fallback\r\nconst LoadingFallback = () => (\r\n  <Html center>\r\n    <div className=\"flex flex-col items-center gap-3 text-white/80\">\r\n      <div className=\"relative w-10 h-10\">\r\n        <div className=\"absolute inset-0 border-3 border-white/20 rounded-full\" />\r\n        <div className=\"absolute inset-0 border-3 border-transparent border-t-white rounded-full animate-spin\" />\r\n      </div>\r\n      <span className=\"text-sm font-medium\">Loading Diamond...</span>\r\n    </div>\r\n  </Html>\r\n);\r\n\r\nexport const Diamond3DViewer = ({ \r\n  shape, \r\n  autoRotate = true, \r\n  color = \"#f8fcff\", \r\n  showFire = true,\r\n  caratSize = 1\r\n}: Diamond3DProps) => {\r\n  return (\r\n    <div \r\n      className=\"w-full h-full min-h-[300px] rounded-xl overflow-hidden\"\r\n      style={{\r\n        background: \"radial-gradient(ellipse at 50% 30%, #1e293b 0%, #0f172a 50%, #020617 100%)\"\r\n      }}\r\n    >\r\n      <Canvas\r\n        shadows\r\n        dpr={[1, 2]}\r\n        camera={{ position: [0, 1.2, 3.8], fov: 42 }}\r\n        gl={{ \r\n          antialias: true, \r\n          alpha: true,\r\n          powerPreference: \"high-performance\",\r\n          toneMapping: THREE.ACESFilmicToneMapping,\r\n          toneMappingExposure: 1.2,\r\n        }}\r\n      >\r\n        <Suspense fallback={<LoadingFallback />}>\r\n          <CameraController shape={shape} />\r\n          <DiamondLighting showFire={showFire} />\r\n          \r\n          <DiamondMesh \r\n            shape={shape} \r\n            color={color} \r\n            showFire={showFire} \r\n            caratSize={caratSize}\r\n          />\r\n          \r\n          <ContactShadows\r\n            position={[0, -1.1, 0]}\r\n            opacity={0.5}\r\n            scale={6}\r\n            blur={2}\r\n            far={3}\r\n          />\r\n          \r\n          <Environment preset=\"city\" />\r\n          \r\n          <OrbitControls\r\n            enableZoom={true}\r\n            enablePan={false}\r\n            autoRotate={autoRotate}\r\n            autoRotateSpeed={1.2}\r\n            minDistance={2}\r\n            maxDistance={8}\r\n            minPolarAngle={Math.PI / 6}\r\n            maxPolarAngle={Math.PI / 1.5}\r\n            dampingFactor={0.05}\r\n            enableDamping\r\n          />\r\n        </Suspense>\r\n      </Canvas>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Diamond3DViewer;\r\n"],"names":["v1","Vector3","v2","v3","v4","Vector2","defaultCalculatePosition","el","camera","size","objectPos","widthHalf","heightHalf","isObjectBehindCamera","cameraPos","deltaCamObj","camDir","isObjectVisible","raycaster","occlude","elPos","screenPos","intersects","intersectionDistance","objectScale","OrthographicCamera","PerspectiveCamera","vFOV","dist","objectZIndex","zIndexRange","A","B","epsilon","value","getCSSMatrix","matrix","multipliers","prepend","matrix3d","i","getCameraCSSMatrix","getObjectCSSMatrix","scaleMultipliers","factor","f","isRefObject","ref","Html","React.forwardRef","children","eps","style","className","center","fullscreen","portal","distanceFactor","sprite","transform","onOcclude","castShadow","receiveShadow","material","geometry","calculatePosition","as","wrapperClass","pointerEvents","props","gl","scene","events","viewport","useThree","React.useState","root","React.useRef","group","oldZoom","oldPosition","transformOuterRef","transformInnerRef","target","occlusionMeshRef","isMeshSizeSet","isRayCastOcclusion","React.useMemo","React.useLayoutEffect","currentRoot","ReactDOM.createRoot","vec","styles","transformInnerStyles","_root$current","React.createElement","_root$current2","visible","useFrame","isBehindCamera","raytraceTarget","item","previouslyVisible","isvisible","halfRange","zRange","fov","isOrthographicCamera","top","left","bottom","right","cameraMatrix","cameraTransform","scale","ratio","w","h","ele","shaders","_extends","DoubleSide","createShapeOutline","shape","segments","points","angle","THREE.Vector2","t","r","x","y","taper","cornerRadius","corners","segsPerSide","c","start","end","distFromCorner","blend","smoothR","n","a","b","cosT","sinT","cutCorner","octPoints","segsPerEdge","e","p1","p2","createDiamondGeometry","THREE.BufferGeometry","outline","crownHeight","tableRatio","girdleThickness","vertices","indices","addVertex","z","tableCenterIdx","tableVertices","p","idx","upperGirdleVertices","lowerGirdleVertices","culetIdx","next","THREE.Float32BufferAttribute","PrismaticSparkles","intensity","groupRef","useRef","state","jsxs","jsx","Sparkles","FireBeams","beamsRef","child","mesh","mat","colors","color","THREE.AdditiveBlending","ShapeLabel","labelMap","DiamondMesh","showFire","caratSize","hovered","setHovered","useState","useMemo","breathe","diamondColor","THREE.Color","Fragment","DiamondLighting","lightsRef","CameraController","useEffect","distance","LoadingFallback","Diamond3DViewer","autoRotate","Canvas","THREE.ACESFilmicToneMapping","Suspense","ContactShadows","Environment","OrbitControls"],"mappings":"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","x_google_ignoreList":[0]}