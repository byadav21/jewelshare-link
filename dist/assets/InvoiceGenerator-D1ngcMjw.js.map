{"version":3,"file":"InvoiceGenerator-D1ngcMjw.js","sources":["../../src/pages/InvoiceGenerator.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\r\nimport { toast } from \"sonner\";\r\nimport { FileText, Calendar, Plus, History, Download, Sparkles, Diamond, Gem, Coins, AlertCircle } from \"lucide-react\";\r\nimport { generateInvoicePDF, type InvoiceData, type LineItem as InvoiceLineItem } from \"@/utils/invoiceGenerator\";\r\nimport { BackToHomeButton } from \"@/components/BackToHomeButton\";\r\nimport { InvoiceLineItems, type LineItem } from \"@/components/InvoiceLineItems\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\r\nimport { Calendar as CalendarPicker } from \"@/components/ui/calendar\";\r\nimport { format } from \"date-fns\";\r\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\r\n\r\nconst InvoiceGenerator = () => {\r\n  const navigate = useNavigate();\r\n  const [searchParams] = useSearchParams();\r\n  const [user, setUser] = useState<any>(null);\r\n  const [vendorProfile, setVendorProfile] = useState<any>(null);\r\n  const [estimates, setEstimates] = useState<any[]>([]);\r\n  const [showEstimateDialog, setShowEstimateDialog] = useState(false);\r\n  \r\n  // Invoice fields\r\n  const [invoicePrefix, setInvoicePrefix] = useState(\"INV\");\r\n  const [invoiceNumber, setInvoiceNumber] = useState(\"\");\r\n  const [invoiceDate, setInvoiceDate] = useState<Date>(new Date());\r\n  const [paymentTerms, setPaymentTerms] = useState(\"Net 30\");\r\n  const [paymentDueDate, setPaymentDueDate] = useState<Date>();\r\n  const [invoiceNotes, setInvoiceNotes] = useState(\"\");\r\n  const [invoiceType, setInvoiceType] = useState<'tax' | 'export' | 'proforma'>('tax');\r\n  const [paymentStatus, setPaymentStatus] = useState<'pending' | 'paid' | 'partial'>('pending');\r\n  const [estimateCategory, setEstimateCategory] = useState<'jewelry' | 'loose_diamond' | 'gemstone'>('jewelry');\r\n  const [estimateName, setEstimateName] = useState(\"\");\r\n  \r\n  // Customer details\r\n  const [customerName, setCustomerName] = useState(\"\");\r\n  const [customerPhone, setCustomerPhone] = useState(\"\");\r\n  const [customerEmail, setCustomerEmail] = useState(\"\");\r\n  const [customerAddress, setCustomerAddress] = useState(\"\");\r\n  const [customerGSTIN, setCustomerGSTIN] = useState(\"\");\r\n  const [vendorGSTIN, setVendorGSTIN] = useState(\"\");\r\n  \r\n  // Line items (the primary data source)\r\n  const [lineItems, setLineItems] = useState<LineItem[]>([]);\r\n  \r\n  // Pricing\r\n  const [profitMargin, setProfitMargin] = useState(0);\r\n  const [goldRate24k, setGoldRate24k] = useState(0);\r\n  const [platinumRate, setPlatinumRate] = useState(3200);\r\n  const [silverRate, setSilverRate] = useState(95);\r\n  const [purityFraction, setPurityFraction] = useState(0.76);\r\n  \r\n  // GST & Shipping\r\n  const [gstMode, setGstMode] = useState<'sgst_cgst' | 'igst' | 'none'>('sgst_cgst');\r\n  const [sgstPercentage, setSgstPercentage] = useState(1.5);\r\n  const [cgstPercentage, setCgstPercentage] = useState(1.5);\r\n  const [igstPercentage, setIgstPercentage] = useState(3);\r\n  const [shippingCharges, setShippingCharges] = useState(0);\r\n  const [shippingZone, setShippingZone] = useState('local');\r\n  const [exchangeRate, setExchangeRate] = useState(83);\r\n\r\n  // Calculated values\r\n  const [costs, setCosts] = useState({\r\n    totalCost: 0,\r\n    finalSellingPrice: 0,\r\n    sgstAmount: 0,\r\n    cgstAmount: 0,\r\n    igstAmount: 0,\r\n    grandTotal: 0,\r\n    totalInUSD: 0\r\n  });\r\n\r\n  // Calculate costs from line items\r\n  useEffect(() => {\r\n    const lineItemsTotal = lineItems.reduce((sum, item) => sum + (item.subtotal || 0), 0);\r\n    const totalCost = lineItemsTotal;\r\n    const finalSellingPrice = totalCost * (1 + profitMargin / 100);\r\n\r\n    let sgstAmount = 0;\r\n    let cgstAmount = 0;\r\n    let igstAmount = 0;\r\n    \r\n    if (gstMode === 'sgst_cgst') {\r\n      sgstAmount = finalSellingPrice * sgstPercentage / 100;\r\n      cgstAmount = finalSellingPrice * cgstPercentage / 100;\r\n    } else if (gstMode === 'igst') {\r\n      igstAmount = finalSellingPrice * igstPercentage / 100;\r\n    }\r\n\r\n    const grandTotal = finalSellingPrice + sgstAmount + cgstAmount + igstAmount + shippingCharges;\r\n    const totalInUSD = grandTotal / exchangeRate;\r\n\r\n    setCosts({\r\n      totalCost: parseFloat(totalCost.toFixed(2)),\r\n      finalSellingPrice: parseFloat(finalSellingPrice.toFixed(2)),\r\n      sgstAmount: parseFloat(sgstAmount.toFixed(2)),\r\n      cgstAmount: parseFloat(cgstAmount.toFixed(2)),\r\n      igstAmount: parseFloat(igstAmount.toFixed(2)),\r\n      grandTotal: parseFloat(grandTotal.toFixed(2)),\r\n      totalInUSD: parseFloat(totalInUSD.toFixed(2))\r\n    });\r\n  }, [lineItems, profitMargin, gstMode, sgstPercentage, cgstPercentage, igstPercentage, shippingCharges, exchangeRate]);\r\n\r\n  useEffect(() => {\r\n    checkAuth();\r\n  }, []);\r\n\r\n  const checkAuth = async () => {\r\n    const { data: { user } } = await supabase.auth.getUser();\r\n    if (!user) {\r\n      toast.error(\"Please sign in to generate invoices\");\r\n      navigate(\"/auth\");\r\n      return;\r\n    }\r\n    setUser(user);\r\n    await fetchVendorProfile();\r\n    await fetchEstimates();\r\n    \r\n    const estimateId = searchParams.get('estimate');\r\n    if (estimateId) {\r\n      await loadEstimateById(estimateId);\r\n    }\r\n  };\r\n\r\n  const fetchVendorProfile = async () => {\r\n    const { data: { user } } = await supabase.auth.getUser();\r\n    if (!user) return;\r\n\r\n    const { data, error } = await supabase\r\n      .from('vendor_profiles')\r\n      .select('*')\r\n      .eq('user_id', user.id)\r\n      .single();\r\n\r\n    if (!error && data) {\r\n      setVendorProfile(data);\r\n      setGoldRate24k(data.gold_rate_24k_per_gram || 0);\r\n      setPlatinumRate(data.platinum_rate_per_gram || 3200);\r\n      setSilverRate(data.silver_rate_per_gram || 95);\r\n    }\r\n  };\r\n\r\n  const fetchEstimates = async () => {\r\n    const { data: { user } } = await supabase.auth.getUser();\r\n    if (!user) return;\r\n\r\n    const { data, error } = await supabase\r\n      .from('manufacturing_cost_estimates')\r\n      .select('*')\r\n      .eq('user_id', user.id)\r\n      .order('created_at', { ascending: false });\r\n\r\n    if (!error) {\r\n      setEstimates(data || []);\r\n    }\r\n  };\r\n\r\n  const generateNextInvoiceNumber = async () => {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) return;\r\n\r\n      const { data } = await supabase\r\n        .from(\"manufacturing_cost_estimates\")\r\n        .select(\"invoice_number\")\r\n        .eq(\"user_id\", user.id)\r\n        .not(\"invoice_number\", \"is\", null)\r\n        .order(\"created_at\", { ascending: false })\r\n        .limit(1);\r\n\r\n      const currentYear = new Date().getFullYear();\r\n      let nextNumber = 1;\r\n\r\n      if (data && data.length > 0) {\r\n        const lastInvoice = data[0].invoice_number;\r\n        const match = lastInvoice.match(/(\\d+)$/);\r\n        if (match) {\r\n          nextNumber = parseInt(match[1]) + 1;\r\n        }\r\n      }\r\n\r\n      const newInvoiceNumber = `${invoicePrefix}-${currentYear}-${String(nextNumber).padStart(3, '0')}`;\r\n      setInvoiceNumber(newInvoiceNumber);\r\n      return newInvoiceNumber;\r\n    } catch (error) {\r\n      console.error(\"Error generating invoice number:\", error);\r\n      return `${invoicePrefix}-${new Date().getFullYear()}-001`;\r\n    }\r\n  };\r\n\r\n  const loadEstimateById = async (estimateId: string) => {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('manufacturing_cost_estimates')\r\n        .select('*')\r\n        .eq('id', estimateId)\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      if (data) {\r\n        loadFromEstimate(data);\r\n        await generateNextInvoiceNumber();\r\n        toast.success(\"Estimate loaded - ready to generate invoice\");\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading estimate:', error);\r\n      toast.error('Failed to load estimate');\r\n    }\r\n  };\r\n\r\n  const loadFromEstimate = (estimate: any) => {\r\n    // Set basic info\r\n    setEstimateName(estimate.estimate_name);\r\n    setEstimateCategory(estimate.estimate_category || 'jewelry');\r\n    setCustomerName(estimate.customer_name || \"\");\r\n    setCustomerPhone(estimate.customer_phone || \"\");\r\n    setCustomerEmail(estimate.customer_email || \"\");\r\n    setCustomerAddress(estimate.customer_address || \"\");\r\n    setProfitMargin(estimate.profit_margin_percentage || 0);\r\n    setPurityFraction(estimate.purity_fraction || 0.76);\r\n    \r\n    if (estimate.gold_rate_24k) {\r\n      setGoldRate24k(estimate.gold_rate_24k);\r\n    }\r\n\r\n    // Parse line items - handle both old and new format\r\n    const lineItemsData = estimate.line_items;\r\n    let items: LineItem[] = [];\r\n    let meta: any = {};\r\n    \r\n    if (Array.isArray(lineItemsData)) {\r\n      items = lineItemsData;\r\n    } else if (lineItemsData?.items) {\r\n      items = lineItemsData.items;\r\n      meta = lineItemsData.meta || {};\r\n    }\r\n    \r\n    // Set line items\r\n    setLineItems(items);\r\n    \r\n    // Load GST and shipping settings from meta\r\n    if (meta.customer_gstin) setCustomerGSTIN(meta.customer_gstin);\r\n    if (meta.vendor_gstin) setVendorGSTIN(meta.vendor_gstin);\r\n    if (meta.gst_mode) setGstMode(meta.gst_mode);\r\n    if (meta.sgst_percentage) setSgstPercentage(meta.sgst_percentage);\r\n    if (meta.cgst_percentage) setCgstPercentage(meta.cgst_percentage);\r\n    if (meta.igst_percentage) setIgstPercentage(meta.igst_percentage);\r\n    if (meta.shipping_charges) setShippingCharges(meta.shipping_charges);\r\n    if (meta.shipping_zone) setShippingZone(meta.shipping_zone);\r\n    if (meta.exchange_rate) setExchangeRate(meta.exchange_rate);\r\n    \r\n    // Load existing invoice settings if present\r\n    if (estimate.invoice_number) setInvoiceNumber(estimate.invoice_number);\r\n    if (estimate.invoice_notes) setInvoiceNotes(estimate.invoice_notes);\r\n    if (estimate.payment_terms) setPaymentTerms(estimate.payment_terms);\r\n    if (estimate.payment_due_date) setPaymentDueDate(new Date(estimate.payment_due_date));\r\n    \r\n    setShowEstimateDialog(false);\r\n  };\r\n\r\n  const getCategoryIcon = () => {\r\n    switch (estimateCategory) {\r\n      case 'loose_diamond': return <Diamond className=\"h-5 w-5\" />;\r\n      case 'gemstone': return <Gem className=\"h-5 w-5\" />;\r\n      default: return <Coins className=\"h-5 w-5\" />;\r\n    }\r\n  };\r\n\r\n  const getCategoryLabel = () => {\r\n    switch (estimateCategory) {\r\n      case 'loose_diamond': return 'Loose Diamond Invoice';\r\n      case 'gemstone': return 'Gemstone Invoice';\r\n      default: return 'Jewelry Invoice';\r\n    }\r\n  };\r\n\r\n  const handleGenerateInvoice = async () => {\r\n    if (!estimateName) {\r\n      toast.error(\"Please enter an order/estimate name\");\r\n      return;\r\n    }\r\n\r\n    if (!customerName) {\r\n      toast.error(\"Please enter customer name\");\r\n      return;\r\n    }\r\n\r\n    if (lineItems.length === 0) {\r\n      toast.error(\"Please add at least one line item\");\r\n      return;\r\n    }\r\n\r\n    let finalInvoiceNumber = invoiceNumber;\r\n    if (!finalInvoiceNumber) {\r\n      finalInvoiceNumber = await generateNextInvoiceNumber() || \"\";\r\n    }\r\n\r\n    // Build vendor address\r\n    const addressParts = [\r\n      vendorProfile?.address_line1,\r\n      vendorProfile?.address_line2,\r\n      vendorProfile?.city,\r\n      vendorProfile?.state,\r\n      vendorProfile?.pincode,\r\n      vendorProfile?.country,\r\n    ].filter(Boolean);\r\n    const vendorAddress = addressParts.length > 0 ? addressParts.join(', ') : undefined;\r\n\r\n    // Prepare invoice data with line items\r\n    const invoiceData: InvoiceData = {\r\n      invoiceNumber: finalInvoiceNumber,\r\n      invoiceDate: invoiceDate.toISOString(),\r\n      paymentDueDate: paymentDueDate?.toISOString(),\r\n      paymentTerms,\r\n      estimateName,\r\n      status: paymentStatus,\r\n      invoiceType,\r\n      customerName,\r\n      customerPhone,\r\n      customerEmail,\r\n      customerAddress,\r\n      customerGSTIN,\r\n      vendorGSTIN,\r\n      // Line items are the primary data source\r\n      lineItems: lineItems as InvoiceLineItem[],\r\n      estimateCategory,\r\n      // Calculated totals\r\n      netWeight: 0,\r\n      grossWeight: 0,\r\n      purityFraction,\r\n      goldRate24k,\r\n      makingCharges: 0,\r\n      cadDesignCharges: 0,\r\n      cammingCharges: 0,\r\n      certificationCost: 0,\r\n      diamondCost: 0,\r\n      gemstoneCost: 0,\r\n      goldCost: 0,\r\n      totalCost: costs.totalCost,\r\n      profitMargin,\r\n      finalSellingPrice: costs.finalSellingPrice,\r\n      // GST\r\n      gstMode: gstMode === 'none' ? undefined : gstMode,\r\n      sgstPercentage,\r\n      cgstPercentage,\r\n      igstPercentage,\r\n      sgstAmount: costs.sgstAmount,\r\n      cgstAmount: costs.cgstAmount,\r\n      igstAmount: costs.igstAmount,\r\n      shippingCharges,\r\n      shippingZone,\r\n      exchangeRate,\r\n      grandTotal: costs.grandTotal,\r\n      invoiceNotes,\r\n      vendorBranding: vendorProfile ? {\r\n        name: vendorProfile.business_name,\r\n        logo: vendorProfile.logo_url,\r\n        primaryColor: vendorProfile.primary_brand_color,\r\n        secondaryColor: vendorProfile.secondary_brand_color,\r\n        tagline: vendorProfile.brand_tagline,\r\n        email: vendorProfile.email,\r\n        phone: vendorProfile.phone,\r\n        address: vendorAddress,\r\n      } : undefined,\r\n    };\r\n\r\n    // Generate PDF - the generator auto-selects template based on estimateCategory\r\n    await generateInvoicePDF(invoiceData);\r\n\r\n    // Save to database\r\n    try {\r\n      const estimateId = searchParams.get('estimate');\r\n      \r\n      if (estimateId) {\r\n        await supabase\r\n          .from('manufacturing_cost_estimates')\r\n          .update({\r\n            invoice_number: finalInvoiceNumber,\r\n            invoice_date: invoiceDate.toISOString(),\r\n            payment_terms: paymentTerms,\r\n            payment_due_date: paymentDueDate?.toISOString(),\r\n            invoice_notes: invoiceNotes,\r\n            is_invoice_generated: true,\r\n            invoice_status: paymentStatus,\r\n          })\r\n          .eq('id', estimateId);\r\n      } else {\r\n        // Create new invoice record with line items\r\n        const lineItemsWithMeta = {\r\n          items: lineItems,\r\n          meta: {\r\n            customer_gstin: customerGSTIN,\r\n            vendor_gstin: vendorGSTIN,\r\n            gst_mode: gstMode,\r\n            sgst_percentage: sgstPercentage,\r\n            cgst_percentage: cgstPercentage,\r\n            igst_percentage: igstPercentage,\r\n            shipping_charges: shippingCharges,\r\n            shipping_zone: shippingZone,\r\n            exchange_rate: exchangeRate\r\n          }\r\n        };\r\n\r\n        await supabase\r\n          .from('manufacturing_cost_estimates')\r\n          .insert({\r\n            user_id: user.id,\r\n            estimate_name: estimateName,\r\n            estimate_category: estimateCategory,\r\n            invoice_number: finalInvoiceNumber,\r\n            invoice_date: invoiceDate.toISOString(),\r\n            payment_terms: paymentTerms,\r\n            payment_due_date: paymentDueDate?.toISOString(),\r\n            invoice_notes: invoiceNotes,\r\n            is_invoice_generated: true,\r\n            invoice_status: paymentStatus,\r\n            customer_name: customerName,\r\n            customer_phone: customerPhone,\r\n            customer_email: customerEmail,\r\n            customer_address: customerAddress,\r\n            purity_fraction: purityFraction,\r\n            gold_rate_24k: goldRate24k,\r\n            total_cost: costs.totalCost,\r\n            profit_margin_percentage: profitMargin,\r\n            final_selling_price: costs.grandTotal,\r\n            line_items: lineItemsWithMeta as any,\r\n            status: 'completed',\r\n          });\r\n      }\r\n      \r\n      toast.success(\"Invoice generated and saved\");\r\n    } catch (error: any) {\r\n      console.error(\"Error saving invoice:\", error);\r\n      toast.error(\"Invoice generated but failed to save\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-background via-background to-muted/20 p-4 md:p-8\">\r\n      <div className=\"max-w-6xl mx-auto space-y-6\">\r\n        <BackToHomeButton />\r\n\r\n        <div className=\"text-center space-y-4\">\r\n          <div className=\"flex items-center justify-center gap-3\">\r\n            <FileText className=\"h-10 w-10 text-primary\" />\r\n            <h1 className=\"text-4xl md:text-5xl font-bold bg-gradient-to-r from-primary via-accent to-primary bg-clip-text text-transparent\">\r\n              Invoice Generator\r\n            </h1>\r\n          </div>\r\n          <p className=\"text-muted-foreground text-lg max-w-2xl mx-auto\">\r\n            Create professional invoices with automatic category-based formatting\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"flex flex-wrap gap-3 justify-center\">\r\n          <Button onClick={() => setShowEstimateDialog(true)} variant=\"default\" className=\"bg-gradient-to-r from-primary to-accent\">\r\n            <Sparkles className=\"mr-2 h-4 w-4\" />\r\n            Load from Estimate\r\n          </Button>\r\n          <Button onClick={generateNextInvoiceNumber} variant=\"outline\">\r\n            <FileText className=\"mr-2 h-4 w-4\" />\r\n            Auto-Generate Invoice #\r\n          </Button>\r\n          <Button onClick={() => navigate(\"/invoice-history\")} variant=\"outline\">\r\n            <History className=\"mr-2 h-4 w-4\" />\r\n            View History\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Category Selection Card */}\r\n        <Card className=\"border-primary/30\">\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              {getCategoryIcon()}\r\n              Invoice Category\r\n            </CardTitle>\r\n            <CardDescription>\r\n              Select the category to automatically format the invoice correctly\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"grid grid-cols-3 gap-3\">\r\n              <Button\r\n                variant={estimateCategory === 'jewelry' ? 'default' : 'outline'}\r\n                onClick={() => setEstimateCategory('jewelry')}\r\n                className=\"flex flex-col h-auto py-4 gap-2\"\r\n              >\r\n                <Coins className=\"h-6 w-6\" />\r\n                <span>Jewelry</span>\r\n              </Button>\r\n              <Button\r\n                variant={estimateCategory === 'loose_diamond' ? 'default' : 'outline'}\r\n                onClick={() => setEstimateCategory('loose_diamond')}\r\n                className=\"flex flex-col h-auto py-4 gap-2\"\r\n              >\r\n                <Diamond className=\"h-6 w-6\" />\r\n                <span>Loose Diamond</span>\r\n              </Button>\r\n              <Button\r\n                variant={estimateCategory === 'gemstone' ? 'default' : 'outline'}\r\n                onClick={() => setEstimateCategory('gemstone')}\r\n                className=\"flex flex-col h-auto py-4 gap-2\"\r\n              >\r\n                <Gem className=\"h-6 w-6\" />\r\n                <span>Gemstone</span>\r\n              </Button>\r\n            </div>\r\n            <Alert className=\"mt-4\">\r\n              <AlertCircle className=\"h-4 w-4\" />\r\n              <AlertDescription>\r\n                <strong>{getCategoryLabel()}</strong> - The invoice PDF will be formatted specifically for {estimateCategory === 'jewelry' ? 'jewelry with gold, diamonds, and gemstones' : estimateCategory === 'loose_diamond' ? 'loose diamonds with 4Cs specifications' : 'colored gemstones with origin and treatment details'}.\r\n              </AlertDescription>\r\n            </Alert>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <div className=\"grid gap-6 md:grid-cols-2\">\r\n          {/* Invoice Details */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Invoice Details</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div>\r\n                  <Label>Invoice Prefix</Label>\r\n                  <Input\r\n                    value={invoicePrefix}\r\n                    onChange={(e) => setInvoicePrefix(e.target.value.toUpperCase())}\r\n                    placeholder=\"INV\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label>Invoice Number</Label>\r\n                  <Input\r\n                    value={invoiceNumber}\r\n                    onChange={(e) => setInvoiceNumber(e.target.value)}\r\n                    placeholder=\"Auto-generated\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <Label>Order/Estimate Name *</Label>\r\n                <Input\r\n                  value={estimateName}\r\n                  onChange={(e) => setEstimateName(e.target.value)}\r\n                  placeholder=\"e.g., Diamond Ring Order\"\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <Label>Invoice Date</Label>\r\n                <Popover>\r\n                  <PopoverTrigger asChild>\r\n                    <Button variant=\"outline\" className=\"w-full justify-start\">\r\n                      <Calendar className=\"mr-2 h-4 w-4\" />\r\n                      {format(invoiceDate, \"PPP\")}\r\n                    </Button>\r\n                  </PopoverTrigger>\r\n                  <PopoverContent className=\"w-auto p-0\">\r\n                    <CalendarPicker\r\n                      mode=\"single\"\r\n                      selected={invoiceDate}\r\n                      onSelect={(date) => date && setInvoiceDate(date)}\r\n                    />\r\n                  </PopoverContent>\r\n                </Popover>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div>\r\n                  <Label>Payment Terms</Label>\r\n                  <Select value={paymentTerms} onValueChange={setPaymentTerms}>\r\n                    <SelectTrigger>\r\n                      <SelectValue />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"Due on Receipt\">Due on Receipt</SelectItem>\r\n                      <SelectItem value=\"Net 15\">Net 15</SelectItem>\r\n                      <SelectItem value=\"Net 30\">Net 30</SelectItem>\r\n                      <SelectItem value=\"Net 45\">Net 45</SelectItem>\r\n                      <SelectItem value=\"Net 60\">Net 60</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n                <div>\r\n                  <Label>Payment Status</Label>\r\n                  <Select value={paymentStatus} onValueChange={(value: any) => setPaymentStatus(value)}>\r\n                    <SelectTrigger>\r\n                      <SelectValue />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"pending\">Pending</SelectItem>\r\n                      <SelectItem value=\"partial\">Partial Payment</SelectItem>\r\n                      <SelectItem value=\"paid\">Paid</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <Label>Invoice Type</Label>\r\n                <Select value={invoiceType} onValueChange={(value: any) => setInvoiceType(value)}>\r\n                  <SelectTrigger>\r\n                    <SelectValue />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"tax\">Tax Invoice</SelectItem>\r\n                    <SelectItem value=\"export\">Export Invoice</SelectItem>\r\n                    <SelectItem value=\"proforma\">Proforma Invoice</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Customer Details */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Customer Information</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <div>\r\n                <Label>Customer Name *</Label>\r\n                <Input\r\n                  value={customerName}\r\n                  onChange={(e) => setCustomerName(e.target.value)}\r\n                  placeholder=\"Full name\"\r\n                />\r\n              </div>\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div>\r\n                  <Label>Phone Number</Label>\r\n                  <Input\r\n                    value={customerPhone}\r\n                    onChange={(e) => setCustomerPhone(e.target.value)}\r\n                    placeholder=\"+1234567890\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label>Email</Label>\r\n                  <Input\r\n                    type=\"email\"\r\n                    value={customerEmail}\r\n                    onChange={(e) => setCustomerEmail(e.target.value)}\r\n                    placeholder=\"customer@example.com\"\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <Label>Customer GSTIN</Label>\r\n                <Input\r\n                  value={customerGSTIN}\r\n                  onChange={(e) => setCustomerGSTIN(e.target.value)}\r\n                  placeholder=\"e.g., 22AAAAA0000A1Z5\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <Label>Address</Label>\r\n                <Textarea\r\n                  value={customerAddress}\r\n                  onChange={(e) => setCustomerAddress(e.target.value)}\r\n                  placeholder=\"Complete address\"\r\n                  rows={2}\r\n                />\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Line Items - The primary data entry */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              {getCategoryIcon()}\r\n              {getCategoryLabel()} - Line Items\r\n            </CardTitle>\r\n            <CardDescription>\r\n              Add items with {estimateCategory === 'jewelry' ? 'gold, diamond, and gemstone details' : estimateCategory === 'loose_diamond' ? 'diamond specifications (4Cs)' : 'gemstone specifications'}\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <InvoiceLineItems \r\n              items={lineItems} \r\n              onChange={setLineItems} \r\n              goldRate24k={goldRate24k}\r\n              platinumRate={platinumRate}\r\n              silverRate={silverRate}\r\n              purityFraction={purityFraction}\r\n              estimateCategory={estimateCategory}\r\n            />\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Pricing & Tax */}\r\n        <div className=\"grid gap-6 md:grid-cols-2\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Pricing</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              {estimateCategory === 'jewelry' && (\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div>\r\n                      <Label>Gold Rate (24K/gram)</Label>\r\n                      <Input\r\n                        type=\"number\"\r\n                        value={goldRate24k}\r\n                        onChange={(e) => setGoldRate24k(Number(e.target.value))}\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <Label>Default Purity</Label>\r\n                      <Input\r\n                        type=\"number\"\r\n                        step=\"0.01\"\r\n                        value={purityFraction}\r\n                        onChange={(e) => setPurityFraction(Number(e.target.value))}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div>\r\n                      <Label>Platinum Rate (/gram)</Label>\r\n                      <Input\r\n                        type=\"number\"\r\n                        value={platinumRate}\r\n                        onChange={(e) => setPlatinumRate(Number(e.target.value))}\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <Label>Silver Rate (/gram)</Label>\r\n                      <Input\r\n                        type=\"number\"\r\n                        value={silverRate}\r\n                        onChange={(e) => setSilverRate(Number(e.target.value))}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              <div>\r\n                <Label>Profit Margin (%)</Label>\r\n                <Input\r\n                  type=\"number\"\r\n                  value={profitMargin}\r\n                  onChange={(e) => setProfitMargin(Number(e.target.value))}\r\n                />\r\n              </div>\r\n              <div className=\"pt-4 border-t space-y-2\">\r\n                <div className=\"flex justify-between text-sm\">\r\n                  <span>Subtotal:</span>\r\n                  <span>₹{costs.totalCost.toLocaleString('en-IN')}</span>\r\n                </div>\r\n                <div className=\"flex justify-between text-sm\">\r\n                  <span>After Margin ({profitMargin}%):</span>\r\n                  <span>₹{costs.finalSellingPrice.toLocaleString('en-IN')}</span>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Tax & Shipping</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <div>\r\n                <Label>GST Mode</Label>\r\n                <Select value={gstMode} onValueChange={(v: any) => setGstMode(v)}>\r\n                  <SelectTrigger>\r\n                    <SelectValue />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"sgst_cgst\">SGST + CGST (Intra-state)</SelectItem>\r\n                    <SelectItem value=\"igst\">IGST (Inter-state)</SelectItem>\r\n                    <SelectItem value=\"none\">No GST</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n              \r\n              {gstMode === 'sgst_cgst' && (\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <Label>SGST (%)</Label>\r\n                    <Input\r\n                      type=\"number\"\r\n                      step=\"0.5\"\r\n                      value={sgstPercentage}\r\n                      onChange={(e) => setSgstPercentage(Number(e.target.value))}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <Label>CGST (%)</Label>\r\n                    <Input\r\n                      type=\"number\"\r\n                      step=\"0.5\"\r\n                      value={cgstPercentage}\r\n                      onChange={(e) => setCgstPercentage(Number(e.target.value))}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {gstMode === 'igst' && (\r\n                <div>\r\n                  <Label>IGST (%)</Label>\r\n                  <Input\r\n                    type=\"number\"\r\n                    step=\"0.5\"\r\n                    value={igstPercentage}\r\n                    onChange={(e) => setIgstPercentage(Number(e.target.value))}\r\n                  />\r\n                </div>\r\n              )}\r\n\r\n              <div>\r\n                <Label>Shipping Charges (₹)</Label>\r\n                <Input\r\n                  type=\"number\"\r\n                  value={shippingCharges}\r\n                  onChange={(e) => setShippingCharges(Number(e.target.value))}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"pt-4 border-t space-y-2\">\r\n                {gstMode === 'sgst_cgst' && (\r\n                  <>\r\n                    <div className=\"flex justify-between text-sm\">\r\n                      <span>SGST ({sgstPercentage}%):</span>\r\n                      <span>₹{costs.sgstAmount.toLocaleString('en-IN')}</span>\r\n                    </div>\r\n                    <div className=\"flex justify-between text-sm\">\r\n                      <span>CGST ({cgstPercentage}%):</span>\r\n                      <span>₹{costs.cgstAmount.toLocaleString('en-IN')}</span>\r\n                    </div>\r\n                  </>\r\n                )}\r\n                {gstMode === 'igst' && (\r\n                  <div className=\"flex justify-between text-sm\">\r\n                    <span>IGST ({igstPercentage}%):</span>\r\n                    <span>₹{costs.igstAmount.toLocaleString('en-IN')}</span>\r\n                  </div>\r\n                )}\r\n                <div className=\"flex justify-between text-sm\">\r\n                  <span>Shipping:</span>\r\n                  <span>₹{shippingCharges.toLocaleString('en-IN')}</span>\r\n                </div>\r\n                <div className=\"flex justify-between font-bold text-lg pt-2 border-t\">\r\n                  <span>Grand Total:</span>\r\n                  <span className=\"text-primary\">₹{costs.grandTotal.toLocaleString('en-IN')}</span>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Notes */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Invoice Notes</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <Textarea\r\n              value={invoiceNotes}\r\n              onChange={(e) => setInvoiceNotes(e.target.value)}\r\n              placeholder=\"Payment instructions, terms & conditions, bank details...\"\r\n              rows={3}\r\n            />\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Generate Button */}\r\n        <div className=\"flex justify-center gap-4\">\r\n          <Button \r\n            onClick={handleGenerateInvoice} \r\n            size=\"lg\" \r\n            className=\"bg-gradient-to-r from-primary to-accent\"\r\n            disabled={lineItems.length === 0}\r\n          >\r\n            <Download className=\"mr-2 h-5 w-5\" />\r\n            Generate {getCategoryLabel()} PDF\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Load Estimate Dialog */}\r\n        <Dialog open={showEstimateDialog} onOpenChange={setShowEstimateDialog}>\r\n          <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-y-auto\">\r\n            <DialogHeader>\r\n              <DialogTitle>Load from Saved Estimate</DialogTitle>\r\n              <DialogDescription>\r\n                Select an estimate to pre-fill all invoice details including line items\r\n              </DialogDescription>\r\n            </DialogHeader>\r\n            <div className=\"space-y-2\">\r\n              {estimates.length === 0 ? (\r\n                <p className=\"text-center text-muted-foreground py-8\">\r\n                  No saved estimates found. Create estimates in the Cost Estimator first.\r\n                </p>\r\n              ) : (\r\n                estimates.map((estimate) => (\r\n                  <Card\r\n                    key={estimate.id}\r\n                    className=\"cursor-pointer hover:border-primary transition-colors\"\r\n                    onClick={() => loadFromEstimate(estimate)}\r\n                  >\r\n                    <CardContent className=\"p-4\">\r\n                      <div className=\"flex justify-between items-start\">\r\n                        <div className=\"flex items-start gap-3\">\r\n                          <div className=\"mt-1\">\r\n                            {estimate.estimate_category === 'loose_diamond' ? (\r\n                              <Diamond className=\"h-5 w-5 text-primary\" />\r\n                            ) : estimate.estimate_category === 'gemstone' ? (\r\n                              <Gem className=\"h-5 w-5 text-primary\" />\r\n                            ) : (\r\n                              <Coins className=\"h-5 w-5 text-primary\" />\r\n                            )}\r\n                          </div>\r\n                          <div>\r\n                            <h3 className=\"font-semibold\">{estimate.estimate_name}</h3>\r\n                            <p className=\"text-sm text-muted-foreground\">\r\n                              {estimate.customer_name || \"No customer\"} • {estimate.estimate_category || 'jewelry'}\r\n                            </p>\r\n                            <p className=\"text-sm font-semibold text-primary mt-1\">\r\n                              ₹{(estimate.final_selling_price || 0).toLocaleString('en-IN')}\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                          <p className=\"text-xs text-muted-foreground\">\r\n                            {new Date(estimate.created_at).toLocaleDateString()}\r\n                          </p>\r\n                          {estimate.is_invoice_generated && (\r\n                            <span className=\"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded mt-1 inline-block\">\r\n                              Invoiced\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                ))\r\n              )}\r\n            </div>\r\n          </DialogContent>\r\n        </Dialog>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InvoiceGenerator;\r\n"],"names":["InvoiceGenerator","navigate","useNavigate","searchParams","useSearchParams","user","setUser","useState","vendorProfile","setVendorProfile","estimates","setEstimates","showEstimateDialog","setShowEstimateDialog","invoicePrefix","setInvoicePrefix","invoiceNumber","setInvoiceNumber","invoiceDate","setInvoiceDate","paymentTerms","setPaymentTerms","paymentDueDate","setPaymentDueDate","invoiceNotes","setInvoiceNotes","invoiceType","setInvoiceType","paymentStatus","setPaymentStatus","estimateCategory","setEstimateCategory","estimateName","setEstimateName","customerName","setCustomerName","customerPhone","setCustomerPhone","customerEmail","setCustomerEmail","customerAddress","setCustomerAddress","customerGSTIN","setCustomerGSTIN","vendorGSTIN","setVendorGSTIN","lineItems","setLineItems","profitMargin","setProfitMargin","goldRate24k","setGoldRate24k","platinumRate","setPlatinumRate","silverRate","setSilverRate","purityFraction","setPurityFraction","gstMode","setGstMode","sgstPercentage","setSgstPercentage","cgstPercentage","setCgstPercentage","igstPercentage","setIgstPercentage","shippingCharges","setShippingCharges","shippingZone","setShippingZone","exchangeRate","setExchangeRate","costs","setCosts","useEffect","totalCost","sum","item","finalSellingPrice","sgstAmount","cgstAmount","igstAmount","grandTotal","totalInUSD","checkAuth","supabase","toast","fetchVendorProfile","fetchEstimates","estimateId","loadEstimateById","data","error","generateNextInvoiceNumber","currentYear","nextNumber","match","newInvoiceNumber","loadFromEstimate","estimate","lineItemsData","items","meta","getCategoryIcon","jsx","Diamond","Gem","Coins","getCategoryLabel","handleGenerateInvoice","finalInvoiceNumber","addressParts","vendorAddress","invoiceData","generateInvoicePDF","lineItemsWithMeta","jsxs","BackToHomeButton","FileText","Button","Sparkles","History","Card","CardHeader","CardTitle","CardDescription","CardContent","Alert","AlertCircle","AlertDescription","Label","Input","e","Popover","PopoverTrigger","Calendar","format","PopoverContent","CalendarPicker","date","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","value","Textarea","InvoiceLineItems","v","Fragment","Download","Dialog","DialogContent","DialogHeader","DialogTitle","DialogDescription"],"mappings":"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"}