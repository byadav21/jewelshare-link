import{b as N,u as y,c as g,j as e}from"./query-vendor-BLxHmmGk.js";import{C as i,i as d,k as n,g as o,B as m,s as l}from"./index-CX6yiz0b.js";import{A as w}from"./AdminLayout-iDUtkfn_.js";import{B as u}from"./badge-45Abp579.js";import{a3 as C,D as _,X as A,ar as S,u as c}from"./ui-vendor-DjQqXt9S.js";import{A as q}from"./AdminLoadingSkeleton-DpaOBF9G.js";import{A as k}from"./AdminEmptyState-1jKiT_K8.js";import"./react-vendor-BeR0k5Z3.js";import"./supabase-vendor-VSDMYZ1k.js";import"./input-CiHC6UAI.js";import"./separator-D0WC8Ha9.js";import"./index-DhS5fNEb.js";import"./index-D6fUEw85.js";import"./NavLink-Bvq0lq1P.js";import"./index-BC78nHQ6.js";import"./index-DVcnno33.js";function X(){const x=N(),{data:t,isLoading:j}=y({queryKey:["admin-comments"],queryFn:async()=>{const{data:s,error:a}=await l.from("blog_comments").select("*, blog_posts(title)").order("created_at",{ascending:!1});if(a)throw a;return s}}),p=g({mutationFn:async({id:s,status:a})=>{var h;const{error:r}=await l.from("blog_comments").update({status:a,moderated_at:new Date().toISOString(),moderated_by:(h=(await l.auth.getUser()).data.user)==null?void 0:h.id}).eq("id",s);if(r)throw r},onSuccess:()=>{x.invalidateQueries({queryKey:["admin-comments"]}),c.success("Comment status updated")},onError:()=>c.error("Failed to update comment")}),f=g({mutationFn:async s=>{const{error:a}=await l.from("blog_comments").delete().eq("id",s);if(a)throw a},onSuccess:()=>{x.invalidateQueries({queryKey:["admin-comments"]}),c.success("Comment deleted")},onError:()=>c.error("Failed to delete comment")}),b=(t==null?void 0:t.filter(s=>s.status==="pending").length)||0,v=(t==null?void 0:t.filter(s=>s.status==="approved").length)||0;return e.jsx(w,{children:e.jsxs("div",{className:"p-6 space-y-6 animate-fade-in",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-primary to-primary/60 bg-clip-text text-transparent",children:"Comment Moderation"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Review and moderate blog comments"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(i,{className:"bg-gradient-card border-border/50 shadow-md",children:[e.jsx(d,{className:"pb-3",children:e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Total Comments"})}),e.jsx(o,{children:e.jsx("div",{className:"text-3xl font-bold",children:(t==null?void 0:t.length)||0})})]}),e.jsxs(i,{className:"bg-gradient-info border-border/50 shadow-md",children:[e.jsx(d,{className:"pb-3",children:e.jsx(n,{className:"text-sm font-medium text-info-foreground",children:"Pending Review"})}),e.jsx(o,{children:e.jsx("div",{className:"text-3xl font-bold text-info",children:b})})]}),e.jsxs(i,{className:"bg-gradient-success border-border/50 shadow-md",children:[e.jsx(d,{className:"pb-3",children:e.jsx(n,{className:"text-sm font-medium text-success-foreground",children:"Approved"})}),e.jsx(o,{children:e.jsx("div",{className:"text-3xl font-bold text-success",children:v})})]})]}),j?e.jsx(q,{}):!t||t.length===0?e.jsx(k,{icon:C,title:"No comments yet",description:"Comments will appear here when visitors start engaging with your blog posts"}):e.jsx("div",{className:"space-y-4",children:t.map((s,a)=>{var r;return e.jsxs(i,{className:"bg-gradient-card border-border/50 shadow-md hover:shadow-lg transition-all duration-300 animate-fade-in",style:{animationDelay:`${a*50}ms`},children:[e.jsx(d,{children:e.jsx("div",{className:"flex justify-between items-start gap-4",children:e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(n,{className:"text-lg",children:s.author_name}),s.status==="pending"?e.jsx(u,{variant:"outline",className:"bg-warning/10 text-warning border-warning/20",children:"Pending"}):s.status==="approved"?e.jsx(u,{className:"bg-success text-success-foreground",children:"Approved"}):e.jsx(u,{variant:"destructive",children:"Rejected"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("p",{children:s.author_email}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("span",{children:new Date(s.created_at).toLocaleDateString()}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{className:"text-foreground/70",children:(r=s.blog_posts)==null?void 0:r.title})]})]})]})})}),e.jsxs(o,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm leading-relaxed border-l-2 border-primary/30 pl-4 py-2",children:s.content}),e.jsxs("div",{className:"flex gap-2",children:[s.status!=="approved"&&e.jsxs(m,{size:"sm",onClick:()=>p.mutate({id:s.id,status:"approved"}),className:"bg-success hover:bg-success/90 text-success-foreground shadow-md",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Approve"]}),s.status!=="rejected"&&e.jsxs(m,{size:"sm",variant:"outline",onClick:()=>p.mutate({id:s.id,status:"rejected"}),className:"hover:bg-destructive/10 hover:border-destructive hover:text-destructive",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Reject"]}),e.jsxs(m,{size:"sm",variant:"destructive",onClick:()=>f.mutate(s.id),className:"ml-auto",children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]},s.id)})})]})})}export{X as default};
//# sourceMappingURL=AdminComments-BooPZQfA.js.map
