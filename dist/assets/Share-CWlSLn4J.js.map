{"version":3,"file":"Share-CWlSLn4J.js","sources":["../../src/components/ShareLinkQRCode.tsx","../../src/components/ShareLinkAnalytics.tsx","../../src/pages/Share.tsx"],"sourcesContent":["import { QRCodeSVG } from \"qrcode.react\";\r\nimport { Download, Share2 } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\nimport { toast } from \"sonner\";\r\n\r\ninterface ShareLinkQRCodeProps {\r\n  shareToken: string;\r\n  businessName?: string;\r\n}\r\n\r\nexport const ShareLinkQRCode = ({ shareToken, businessName }: ShareLinkQRCodeProps) => {\r\n  const shareUrl = `${window.location.origin}/shared/${encodeURIComponent(shareToken)}`;\r\n\r\n  const downloadQRCode = () => {\r\n    const svg = document.getElementById(`qr-${shareToken}`);\r\n    if (!svg) return;\r\n\r\n    const svgData = new XMLSerializer().serializeToString(svg);\r\n    const canvas = document.createElement(\"canvas\");\r\n    const ctx = canvas.getContext(\"2d\");\r\n    const img = new Image();\r\n\r\n    img.onload = () => {\r\n      canvas.width = img.width;\r\n      canvas.height = img.height;\r\n      ctx?.drawImage(img, 0, 0);\r\n      \r\n      canvas.toBlob((blob) => {\r\n        if (blob) {\r\n          const url = URL.createObjectURL(blob);\r\n          const link = document.createElement(\"a\");\r\n          link.href = url;\r\n          link.download = `catalog-qr-${shareToken.substring(0, 8)}.png`;\r\n          link.click();\r\n          URL.revokeObjectURL(url);\r\n          toast.success(\"QR code downloaded!\");\r\n        }\r\n      });\r\n    };\r\n\r\n    img.src = \"data:image/svg+xml;base64,\" + btoa(svgData);\r\n  };\r\n\r\n  const printQRCode = () => {\r\n    const printWindow = window.open(\"\", \"_blank\");\r\n    if (!printWindow) return;\r\n\r\n    const title = businessName || \"Jewelry Catalog\";\r\n    printWindow.document.write(`\r\n      <!DOCTYPE html>\r\n      <html>\r\n        <head>\r\n          <title>QR Code - ${title}</title>\r\n          <style>\r\n            body {\r\n              display: flex;\r\n              flex-direction: column;\r\n              align-items: center;\r\n              justify-content: center;\r\n              min-height: 100vh;\r\n              margin: 0;\r\n              font-family: Arial, sans-serif;\r\n            }\r\n            .container {\r\n              text-align: center;\r\n              padding: 40px;\r\n            }\r\n            h1 {\r\n              margin-bottom: 20px;\r\n              color: #333;\r\n            }\r\n            .qr-container {\r\n              background: white;\r\n              padding: 30px;\r\n              border: 2px solid #333;\r\n              border-radius: 10px;\r\n              display: inline-block;\r\n            }\r\n            .instructions {\r\n              margin-top: 30px;\r\n              font-size: 14px;\r\n              color: #666;\r\n            }\r\n          </style>\r\n        </head>\r\n        <body>\r\n          <div class=\"container\">\r\n            <h1>${title}</h1>\r\n            <div class=\"qr-container\">\r\n              ${document.getElementById(`qr-${shareToken}`)?.outerHTML || \"\"}\r\n            </div>\r\n            <div class=\"instructions\">\r\n              <p>Scan this QR code to view our jewelry collection</p>\r\n              <p style=\"font-size: 12px; margin-top: 10px;\">${shareUrl}</p>\r\n            </div>\r\n          </div>\r\n        </body>\r\n      </html>\r\n    `);\r\n    printWindow.document.close();\r\n    setTimeout(() => {\r\n      printWindow.print();\r\n    }, 250);\r\n  };\r\n\r\n  return (\r\n    <Dialog>\r\n      <DialogTrigger asChild>\r\n        <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\r\n          <Share2 className=\"h-4 w-4\" />\r\n          QR Code\r\n        </Button>\r\n      </DialogTrigger>\r\n      <DialogContent className=\"sm:max-w-md\">\r\n        <DialogHeader>\r\n          <DialogTitle>Share Link QR Code</DialogTitle>\r\n          <DialogDescription>\r\n            Print or download this QR code to share your catalog offline\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"flex flex-col items-center gap-6 py-4\">\r\n          {/* QR Code */}\r\n          <div className=\"bg-white p-6 rounded-xl border-2 border-primary/20 shadow-lg\">\r\n            <QRCodeSVG\r\n              id={`qr-${shareToken}`}\r\n              value={shareUrl}\r\n              size={256}\r\n              level=\"H\"\r\n              includeMargin\r\n            />\r\n          </div>\r\n\r\n          {/* URL Display */}\r\n          <div className=\"w-full\">\r\n            <p className=\"text-xs text-muted-foreground text-center mb-2\">\r\n              Catalog Link:\r\n            </p>\r\n            <div className=\"bg-muted rounded-lg px-3 py-2 text-xs text-center break-all\">\r\n              {shareUrl}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Actions */}\r\n          <div className=\"flex gap-2 w-full\">\r\n            <Button\r\n              onClick={downloadQRCode}\r\n              variant=\"outline\"\r\n              className=\"flex-1 gap-2\"\r\n            >\r\n              <Download className=\"h-4 w-4\" />\r\n              Download\r\n            </Button>\r\n            <Button\r\n              onClick={printQRCode}\r\n              className=\"flex-1 gap-2\"\r\n            >\r\n              <svg\r\n                className=\"h-4 w-4\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z\"\r\n                />\r\n              </svg>\r\n              Print\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n","import { useEffect, useState } from \"react\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Eye, TrendingUp, Users, Package } from \"lucide-react\";\r\nimport { format, subDays, startOfDay, endOfDay } from \"date-fns\";\r\nimport {\r\n  LineChart,\r\n  Line,\r\n  BarChart,\r\n  Bar,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  ResponsiveContainer,\r\n  Legend,\r\n} from \"recharts\";\r\n\r\ninterface ShareLinkAnalyticsProps {\r\n  shareLinkId: string;\r\n  viewCount: number;\r\n}\r\n\r\nexport const ShareLinkAnalytics = ({ shareLinkId, viewCount }: ShareLinkAnalyticsProps) => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [viewsOverTime, setViewsOverTime] = useState<any[]>([]);\r\n  const [topProducts, setTopProducts] = useState<any[]>([]);\r\n  const [totalProductViews, setTotalProductViews] = useState(0);\r\n\r\n  useEffect(() => {\r\n    fetchAnalytics();\r\n  }, [shareLinkId]);\r\n\r\n  const fetchAnalytics = async () => {\r\n    setLoading(true);\r\n    try {\r\n      // Fetch views over time (last 7 days)\r\n      const sevenDaysAgo = subDays(new Date(), 7);\r\n      \r\n      const { data: productViews, error } = await supabase\r\n        .from(\"share_link_product_views\")\r\n        .select(\"viewed_at, product_id, products(name, image_url)\")\r\n        .eq(\"share_link_id\", shareLinkId)\r\n        .gte(\"viewed_at\", sevenDaysAgo.toISOString());\r\n\r\n      if (error) throw error;\r\n\r\n      // Process views over time\r\n      const viewsByDay: Record<string, number> = {};\r\n      const last7Days = Array.from({ length: 7 }, (_, i) => {\r\n        const date = subDays(new Date(), 6 - i);\r\n        const dateKey = format(date, \"MMM dd\");\r\n        viewsByDay[dateKey] = 0;\r\n        return dateKey;\r\n      });\r\n\r\n      productViews?.forEach((view) => {\r\n        const dateKey = format(new Date(view.viewed_at), \"MMM dd\");\r\n        if (dateKey in viewsByDay) {\r\n          viewsByDay[dateKey]++;\r\n        }\r\n      });\r\n\r\n      const viewsData = last7Days.map((date) => ({\r\n        date,\r\n        views: viewsByDay[date] || 0,\r\n      }));\r\n\r\n      setViewsOverTime(viewsData);\r\n\r\n      // Process top products\r\n      const productCounts: Record<string, { count: number; name: string; image: string | null }> = {};\r\n      productViews?.forEach((view) => {\r\n        const productData = view.products as any;\r\n        if (productData && view.product_id) {\r\n          if (!productCounts[view.product_id]) {\r\n            productCounts[view.product_id] = {\r\n              count: 0,\r\n              name: productData.name || \"Unknown Product\",\r\n              image: productData.image_url || null,\r\n            };\r\n          }\r\n          productCounts[view.product_id].count++;\r\n        }\r\n      });\r\n\r\n      const topProductsData = Object.entries(productCounts)\r\n        .map(([id, data]) => ({\r\n          id,\r\n          name: data.name,\r\n          image: data.image,\r\n          views: data.count,\r\n        }))\r\n        .sort((a, b) => b.views - a.views)\r\n        .slice(0, 5);\r\n\r\n      setTopProducts(topProductsData);\r\n      setTotalProductViews(productViews?.length || 0);\r\n    } catch (error) {\r\n      console.error(\"Error fetching analytics:\", error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <div className=\"h-32 bg-muted animate-pulse rounded-lg\" />\r\n        <div className=\"h-64 bg-muted animate-pulse rounded-lg\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Stats Overview */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Catalog Views</CardTitle>\r\n            <Eye className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{viewCount}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Total link opens</p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Product Views</CardTitle>\r\n            <Package className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{totalProductViews}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Individual product views</p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Engagement Rate</CardTitle>\r\n            <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {viewCount > 0 ? ((totalProductViews / viewCount) * 100).toFixed(1) : \"0\"}%\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">Products per visit</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Views Over Time Chart */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base\">Views Over Time (Last 7 Days)</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <ResponsiveContainer width=\"100%\" height={250}>\r\n            <LineChart data={viewsOverTime}>\r\n              <CartesianGrid strokeDasharray=\"3 3\" />\r\n              <XAxis dataKey=\"date\" />\r\n              <YAxis />\r\n              <Tooltip />\r\n              <Legend />\r\n              <Line\r\n                type=\"monotone\"\r\n                dataKey=\"views\"\r\n                stroke=\"hsl(var(--primary))\"\r\n                strokeWidth={2}\r\n                dot={{ fill: \"hsl(var(--primary))\" }}\r\n              />\r\n            </LineChart>\r\n          </ResponsiveContainer>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Top Products */}\r\n      {topProducts.length > 0 && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base\">Most Viewed Products</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-4\">\r\n              {topProducts.map((product, index) => (\r\n                <div key={product.id} className=\"flex items-center gap-4\">\r\n                  <Badge variant=\"secondary\" className=\"min-w-[2rem] justify-center\">\r\n                    {index + 1}\r\n                  </Badge>\r\n                  {product.image && (\r\n                    <img\r\n                      src={product.image}\r\n                      alt={product.name}\r\n                      className=\"h-12 w-12 object-cover rounded-md\"\r\n                    />\r\n                  )}\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <p className=\"text-sm font-medium truncate\">{product.name}</p>\r\n                    <p className=\"text-xs text-muted-foreground\">{product.views} views</p>\r\n                  </div>\r\n                  <div className=\"w-32 bg-muted rounded-full h-2\">\r\n                    <div\r\n                      className=\"bg-primary h-2 rounded-full\"\r\n                      style={{\r\n                        width: `${(product.views / topProducts[0].views) * 100}%`,\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { ApprovalGuard } from \"@/components/ApprovalGuard\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { SocialShareButton } from \"@/components/SocialShareButton\";\r\nimport { ShareStats } from \"@/components/ShareStats\";\r\nimport { ShareLinkQRCode } from \"@/components/ShareLinkQRCode\";\r\nimport { ShareLinkAnalytics } from \"@/components/ShareLinkAnalytics\";\r\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from \"@/components/ui/collapsible\";\r\nimport { toast } from \"sonner\";\r\nimport { ArrowLeft, Copy, ExternalLink, ChevronDown, BarChart3 } from \"lucide-react\";\r\nimport { PlanLimitWarning } from \"@/components/PlanLimitWarning\";\r\nimport { useRewardsSystem } from \"@/hooks/useRewardsSystem\";\r\n\r\nconst Share = () => {\r\n  const navigate = useNavigate();\r\n  const { awardPoints } = useRewardsSystem();\r\n  const [loading, setLoading] = useState(false);\r\n  const [shareLinks, setShareLinks] = useState<any[]>([]);\r\n  const [vendorProfile, setVendorProfile] = useState<any>(null);\r\n  const [expandedAnalytics, setExpandedAnalytics] = useState<string | null>(null);\r\n  const [formData, setFormData] = useState({\r\n    markup_percentage: \"\",\r\n    markdown_percentage: \"\",\r\n    expires_at: \"\",\r\n    show_vendor_details: true,\r\n    shared_categories: [\"Jewellery\", \"Gemstones\", \"Loose Diamonds\"],\r\n  });\r\n\r\n  useEffect(() => {\r\n    fetchShareLinks();\r\n    fetchVendorProfile();\r\n  }, []);\r\n\r\n  const fetchVendorProfile = async () => {\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) return;\r\n\r\n      const { data, error } = await supabase\r\n        .from(\"vendor_profiles\")\r\n        .select(\"business_name\")\r\n        .eq(\"user_id\", user.id)\r\n        .maybeSingle();\r\n\r\n      if (!error && data) {\r\n        setVendorProfile(data);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching vendor profile:\", error);\r\n    }\r\n  };\r\n\r\n  const fetchShareLinks = async () => {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from(\"share_links\")\r\n        .select(\"*\")\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n      if (error) throw error;\r\n      setShareLinks(data || []);\r\n    } catch (error: any) {\r\n      toast.error(\"Failed to load share links\");\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) throw new Error(\"Not authenticated\");\r\n\r\n      const markup = formData.markup_percentage ? parseFloat(formData.markup_percentage) : 0;\r\n      const markdown = formData.markdown_percentage ? parseFloat(formData.markdown_percentage) : 0;\r\n\r\n      if (markup > 0 && markdown > 0) {\r\n        toast.error(\"Please use either markup or markdown, not both\");\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      if (formData.shared_categories.length === 0) {\r\n        toast.error(\"Please select at least one product category to share\");\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      // Validate expiration date is in the future\r\n      const expirationDate = new Date(formData.expires_at);\r\n      const now = new Date();\r\n      \r\n      if (expirationDate <= now) {\r\n        toast.error(\"Expiration date must be in the future\");\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      const { data, error } = await supabase\r\n        .from(\"share_links\")\r\n        .insert([\r\n          {\r\n            user_id: user.id,\r\n            markup_percentage: markup,\r\n            markdown_percentage: markdown,\r\n            expires_at: formData.expires_at,\r\n            show_vendor_details: formData.show_vendor_details,\r\n            shared_categories: formData.shared_categories,\r\n          },\r\n        ])\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      // Award points for creating share link\r\n      try {\r\n        await awardPoints('share_link_created');\r\n      } catch (pointsError) {\r\n        console.error('Failed to award points:', pointsError);\r\n      }\r\n\r\n      toast.success(\"Share link created successfully! ðŸŽ‰\");\r\n      setFormData({ \r\n        markup_percentage: \"\", \r\n        markdown_percentage: \"\", \r\n        expires_at: \"\", \r\n        show_vendor_details: true,\r\n        shared_categories: [\"Jewellery\", \"Gemstones\", \"Loose Diamonds\"]\r\n      });\r\n      fetchShareLinks();\r\n    } catch (error: any) {\r\n      toast.error(error.message || \"Failed to create share link\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const copyToClipboard = (token: string) => {\r\n    const url = `${window.location.origin}/shared/${encodeURIComponent(token)}`;\r\n    navigator.clipboard.writeText(url);\r\n    toast.success(\"Link copied to clipboard!\");\r\n  };\r\n\r\n  const toggleLinkStatus = async (id: string, currentStatus: boolean) => {\r\n    try {\r\n      const { error } = await supabase\r\n        .from(\"share_links\")\r\n        .update({ is_active: !currentStatus })\r\n        .eq(\"id\", id);\r\n\r\n      if (error) throw error;\r\n      toast.success(currentStatus ? \"Link deactivated\" : \"Link activated\");\r\n      fetchShareLinks();\r\n    } catch (error: any) {\r\n      toast.error(\"Failed to update link status\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ApprovalGuard>\r\n      <div className=\"min-h-screen bg-background py-8\">\r\n        <div className=\"container mx-auto px-4 max-w-4xl\">\r\n          <Button variant=\"ghost\" onClick={() => navigate(\"/\")} className=\"mb-6\">\r\n            <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n            Back to Catalog\r\n          </Button>\r\n\r\n          <Card className=\"mb-8\">\r\n            <CardHeader>\r\n              <CardTitle className=\"text-3xl font-serif\">Create Share Link</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              {/* Plan Limit Warning */}\r\n              <div className=\"mb-6\">\r\n                <PlanLimitWarning />\r\n              </div>\r\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"markup_percentage\">Markup % (optional)</Label>\r\n                    <Input\r\n                      id=\"markup_percentage\"\r\n                      name=\"markup_percentage\"\r\n                      type=\"number\"\r\n                      step=\"0.01\"\r\n                      min=\"0\"\r\n                      max=\"1000\"\r\n                      value={formData.markup_percentage}\r\n                      onChange={(e) =>\r\n                        setFormData({ ...formData, markup_percentage: e.target.value, markdown_percentage: \"\" })\r\n                      }\r\n                      placeholder=\"10\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"markdown_percentage\">Markdown % (optional)</Label>\r\n                    <Input\r\n                      id=\"markdown_percentage\"\r\n                      name=\"markdown_percentage\"\r\n                      type=\"number\"\r\n                      step=\"0.01\"\r\n                      min=\"0\"\r\n                      max=\"100\"\r\n                      value={formData.markdown_percentage}\r\n                      onChange={(e) =>\r\n                        setFormData({ ...formData, markdown_percentage: e.target.value, markup_percentage: \"\" })\r\n                      }\r\n                      placeholder=\"5\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"expires_at\">Expiration Date *</Label>\r\n                  <Input\r\n                    id=\"expires_at\"\r\n                    name=\"expires_at\"\r\n                    type=\"datetime-local\"\r\n                    value={formData.expires_at}\r\n                    onChange={(e) => setFormData({ ...formData, expires_at: e.target.value })}\r\n                    min={new Date().toISOString().slice(0, 16)}\r\n                    required\r\n                  />\r\n                  <p className=\"text-xs text-muted-foreground\">\r\n                    Set when this catalog link should stop working\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label>Product Categories to Share *</Label>\r\n                  <div className=\"space-y-2\">\r\n                    {[\"Jewellery\", \"Gemstones\", \"Loose Diamonds\"].map((category) => (\r\n                      <div key={category} className=\"flex items-center space-x-2\">\r\n                        <Checkbox\r\n                          id={`category-${category}`}\r\n                          checked={formData.shared_categories.includes(category)}\r\n                          onCheckedChange={(checked) => {\r\n                            if (checked) {\r\n                              setFormData({\r\n                                ...formData,\r\n                                shared_categories: [...formData.shared_categories, category],\r\n                              });\r\n                            } else {\r\n                              setFormData({\r\n                                ...formData,\r\n                                shared_categories: formData.shared_categories.filter((c) => c !== category),\r\n                              });\r\n                            }\r\n                          }}\r\n                        />\r\n                        <Label htmlFor={`category-${category}`} className=\"cursor-pointer font-normal\">\r\n                          {category}\r\n                        </Label>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                  <p className=\"text-xs text-muted-foreground\">\r\n                    Select which product types to include in this share link\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      id=\"show_vendor_details\"\r\n                      checked={formData.show_vendor_details}\r\n                      onChange={(e) => setFormData({ ...formData, show_vendor_details: e.target.checked })}\r\n                      className=\"h-4 w-4 rounded border-input\"\r\n                    />\r\n                    <Label htmlFor=\"show_vendor_details\" className=\"cursor-pointer\">\r\n                      Show vendor details in shared catalog header\r\n                    </Label>\r\n                  </div>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    When enabled, your business name, contact info, and QR codes will be visible in the shared catalog\r\n                  </p>\r\n                </div>\r\n\r\n                <Button type=\"submit\" className=\"w-full\" disabled={loading}>\r\n                  {loading ? \"Creating Link...\" : \"Create Share Link\"}\r\n                </Button>\r\n              </form>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"text-2xl font-serif\">Your Share Links</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              {shareLinks.length === 0 ? (\r\n                <p className=\"text-center text-muted-foreground py-8\">No share links yet</p>\r\n              ) : (\r\n                <div className=\"space-y-4\">\r\n                  {shareLinks.map((link) => {\r\n                    const shareUrl = `${window.location.origin}/shared/${encodeURIComponent(link.share_token)}`;\r\n                    const isExpiringSoon = new Date(link.expires_at).getTime() - new Date().getTime() < 24 * 60 * 60 * 1000;\r\n                    const isAnalyticsExpanded = expandedAnalytics === link.id;\r\n                    \r\n                    return (\r\n                      <Card\r\n                        key={link.id}\r\n                        className=\"border-border hover:border-primary/30 transition-colors\"\r\n                      >\r\n                        <CardContent className=\"p-4 space-y-3\">\r\n                          {/* Viral Stats */}\r\n                          <ShareStats\r\n                            viewCount={link.view_count}\r\n                            isExpiringSoon={isExpiringSoon}\r\n                            showTrending\r\n                          />\r\n                          \r\n                          <div className=\"flex items-start justify-between gap-4\">\r\n                            <div className=\"flex-1 min-w-0\">\r\n                              <div className=\"flex items-center gap-2 flex-wrap\">\r\n                                <code className=\"text-sm bg-muted px-2 py-1 rounded truncate max-w-[200px]\">\r\n                                  {link.share_token.substring(0, 20)}...\r\n                                </code>\r\n                                <Button\r\n                                  size=\"sm\"\r\n                                  variant=\"ghost\"\r\n                                  onClick={() => copyToClipboard(link.share_token)}\r\n                                >\r\n                                  <Copy className=\"h-4 w-4\" />\r\n                                </Button>\r\n                                <Button\r\n                                  size=\"sm\"\r\n                                  variant=\"ghost\"\r\n                                  onClick={() => window.open(shareUrl, \"_blank\")}\r\n                                >\r\n                                  <ExternalLink className=\"h-4 w-4\" />\r\n                                </Button>\r\n                                \r\n                                {/* QR Code */}\r\n                                <ShareLinkQRCode\r\n                                  shareToken={link.share_token}\r\n                                  businessName={vendorProfile?.business_name}\r\n                                />\r\n                                \r\n                                {/* Social Share */}\r\n                                <SocialShareButton\r\n                                  url={shareUrl}\r\n                                  title={vendorProfile?.business_name || \"Exclusive Jewelry Collection\"}\r\n                                  description=\"Discover stunning jewelry pieces\"\r\n                                />\r\n                              </div>\r\n                              <div className=\"text-sm text-muted-foreground mt-2\">\r\n                                {link.markup_percentage > 0 && `+${link.markup_percentage}% markup`}\r\n                                {link.markdown_percentage > 0 && `-${link.markdown_percentage}% markdown`}\r\n                                {link.markup_percentage === 0 && link.markdown_percentage === 0 && \"No price adjustment\"}\r\n                                {\" â€¢ \"}\r\n                                Expires: {new Date(link.expires_at).toLocaleString()}\r\n                              </div>\r\n                              <div className=\"flex gap-1 mt-2 flex-wrap\">\r\n                                {link.shared_categories?.map((category: string) => (\r\n                                  <Badge key={category} variant=\"secondary\" className=\"text-xs\">\r\n                                    {category}\r\n                                  </Badge>\r\n                                ))}\r\n                              </div>\r\n                            </div>\r\n                            <Button\r\n                              size=\"sm\"\r\n                              variant={link.is_active ? \"destructive\" : \"default\"}\r\n                              onClick={() => toggleLinkStatus(link.id, link.is_active)}\r\n                            >\r\n                              {link.is_active ? \"Deactivate\" : \"Activate\"}\r\n                            </Button>\r\n                          </div>\r\n\r\n                          {/* Analytics Section */}\r\n                          <Collapsible\r\n                            open={isAnalyticsExpanded}\r\n                            onOpenChange={() => setExpandedAnalytics(isAnalyticsExpanded ? null : link.id)}\r\n                          >\r\n                            <CollapsibleTrigger asChild>\r\n                              <Button\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                className=\"w-full gap-2\"\r\n                              >\r\n                                <BarChart3 className=\"h-4 w-4\" />\r\n                                {isAnalyticsExpanded ? \"Hide Analytics\" : \"View Analytics\"}\r\n                                <ChevronDown\r\n                                  className={`h-4 w-4 transition-transform ${\r\n                                    isAnalyticsExpanded ? \"rotate-180\" : \"\"\r\n                                  }`}\r\n                                />\r\n                              </Button>\r\n                            </CollapsibleTrigger>\r\n                            <CollapsibleContent className=\"mt-4\">\r\n                              <ShareLinkAnalytics\r\n                                shareLinkId={link.id}\r\n                                viewCount={link.view_count}\r\n                              />\r\n                            </CollapsibleContent>\r\n                          </Collapsible>\r\n                        </CardContent>\r\n                      </Card>\r\n                    );\r\n                  })}\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n    </ApprovalGuard>\r\n  );\r\n};\r\n\r\nexport default Share;"],"names":["ShareLinkQRCode","shareToken","businessName","shareUrl","downloadQRCode","svg","svgData","canvas","ctx","img","blob","url","link","toast","printQRCode","printWindow","title","_a","Dialog","jsx","DialogTrigger","jsxs","Button","Share2","DialogContent","DialogHeader","DialogTitle","DialogDescription","QRCodeSVG","Download","ShareLinkAnalytics","shareLinkId","viewCount","loading","setLoading","useState","viewsOverTime","setViewsOverTime","topProducts","setTopProducts","totalProductViews","setTotalProductViews","useEffect","fetchAnalytics","sevenDaysAgo","subDays","productViews","error","supabase","viewsByDay","last7Days","_","date","dateKey","format","view","viewsData","productCounts","productData","topProductsData","id","data","b","Card","CardHeader","CardTitle","Eye","CardContent","Package","TrendingUp","ResponsiveContainer","LineChart","CartesianGrid","XAxis","YAxis","Tooltip","Legend","Line","product","index","Badge","Share","navigate","useNavigate","awardPoints","useRewardsSystem","shareLinks","setShareLinks","vendorProfile","setVendorProfile","expandedAnalytics","setExpandedAnalytics","formData","setFormData","fetchShareLinks","fetchVendorProfile","user","handleSubmit","e","markup","markdown","pointsError","copyToClipboard","token","toggleLinkStatus","currentStatus","ApprovalGuard","ArrowLeft","PlanLimitWarning","Label","Input","category","Checkbox","checked","c","isExpiringSoon","isAnalyticsExpanded","ShareStats","Copy","ExternalLink","SocialShareButton","Collapsible","CollapsibleTrigger","BarChart3","ChevronDown","CollapsibleContent"],"mappings":"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"}