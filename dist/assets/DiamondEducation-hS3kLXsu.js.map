{"version":3,"mappings":"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","names":["COLOR_GRADES","CLARITY_GRADES","generateInclusions","clarityGrade","seed","params","inclusions","random","s","x","inclusionTypes","i","isCarbon","radius","theta","phi","position","THREE.Vector3","type","size","THREE.Euler","createBrilliantCutGeometry","geometry","THREE.BufferGeometry","tableRatio","crownHeight","girdleRadius","vertices","indices","addVertex","y","z","tableY","tableCenterIdx","tableVertices","angle","idx","starVertices","starRadius","starY","upperGirdleVertices","upperGirdleY","lowerGirdleVertices","lowerGirdleY","pavilionMainVertices","pavilionMainRadius","pavilionMainY","culetIdx","nextI","girdleIdx1","girdleIdx2","girdleIdx3","next","THREE.Float32BufferAttribute","InclusionMesh","inclusion","microscopeMode","meshRef","useRef","useFrame","state","useMemo","scale","THREE.SphereGeometry","shape","THREE.Shape","w","h","THREE.ShapeGeometry","cloudGeo","cloudPositions","r","THREE.OctahedronGeometry","THREE.CylinderGeometry","THREE.IcosahedronGeometry","material","opacityMultiplier","THREE.MeshStandardMaterial","THREE.Color","baseColor","THREE.MeshPhysicalMaterial","jsx","DiamondSparkles","intensity","sparkleRef","time","setTime","useState","Sparkles","DiamondMesh","colorGrade","autoRotate","viewMode","groupRef","diamondRef","diamondColor","grade","useEffect","delta","jsxs","GemologicalLighting","lightsRef","Fragment","CameraController","camera","useThree","distance","RealisticDiamond3D","showControls","className","bgGradient","Canvas","THREE.ACESFilmicToneMapping","ContactShadows","Environment","OrbitControls","gradeToKey","LoadingFallback","DiamondColorModule","colorIndex","setColorIndex","setViewMode","comparisonMode","setComparisonMode","isRotating","setIsRotating","currentGrade","lowerIndex","upperIndex","fraction","lowerGrade","upperGrade","lowerColor","upperColor","interpolatedColor","Card","CardHeader","CardTitle","CardContent","Button","Eye","Layers","SplitSquareVertical","Suspense","Badge","motion","g","TooltipProvider","Tooltip","TooltipTrigger","TooltipContent","Slider","value","AnimatePresence","Info","DiamondClarityModule","clarityIndex","setClarityIndex","setAutoRotate","setMicroscopeMode","setSeed","regenerateInclusions","useCallback","prev","isEyeClean","Search","Switch","Label","RotateCcw","e","getCaratDimensions","carat","roundDiameter","roundDepth","princessSide","getPriceMultiplier","SHAPES","CARAT_PRESETS","FingerComparison","dims","SizeComparisonGrid","currentCarat","carats","baseScale","isSelected","CoinComparison","diamondSize","coins","coin","DiamondCaratModule","setCarat","setShape","handleSliderChange","dimensions","estimatedPrice","multiplier","Scale","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","Tabs","v","TabsList","TabsTrigger","Hand","CircleDot","Coins","preset","Ruler","lazy","__vitePreload","RealisticDiamond3D$3","IDEAL_CUT","CUT_GRADE_PRESETS","calculateCutGrade","tableDeviation","crownDeviation","pavilionDeviation","depthDeviation","brilliance","fire","scintillation","avgScore","description","getGradeColor","LightPathVisualization","isIdeal","isDeep","isShallow","PerformanceMeter","label","Icon","color","DiamondCutModule","setParams","gradeResult","handleParamChange","key","applyPreset","Sun","Zap","ArrowUp","generateQuestion","id","correctIdx","correct","options","offset","generateQuiz","count","questions","getGradeHint","QuizResults","score","total","onRestart","onNewQuiz","percentage","gradeColor","Trophy","Star","Progress","ArrowRight","DiamondGradingQuiz","quizType","setQuizType","setQuestions","currentIndex","setCurrentIndex","selectedAnswer","setSelectedAnswer","showResult","setShowResult","setScore","showHint","setShowHint","quizComplete","setQuizComplete","currentQuestion","progress","startQuiz","handleAnswer","answer","nextQuestion","resetQuiz","restartSameQuiz","GraduationCap","XCircle","Lightbulb","option","isCorrect","showCorrect","showIncorrect","CheckCircle2","Palette","BASE_PRICES_PER_CARAT","getCaratMultiplier","CUT_ADJUSTMENTS","SHAPE_ADJUSTMENTS","FLUOR_ADJUSTMENTS","CUT_GRADES","FLUORESCENCE","calculatePrice","clarity","cut","fluorescence","basePrice","_a","caratMultiplier","caratAdjusted","cutMultiplier","cutAdjusted","shapeMultiplier","shapeAdjusted","fluorMultiplier","fluorAdjusted","PriceFactorBar","maxValue","impact","TrendingUp","TrendingDown","DiamondValueCalculator","setColor","setClarity","setCut","setFluorescence","priceBreakdown","idealPrice","budgetPrice","savingsVsIdeal","savingsPercent","DollarSign","Gem","f","FLUORESCENCE_LEVELS","FluorescentDiamond","fluorescenceLevel","uvLightOn","glowRef","level","pulse","diamondBaseColor","base","glow","THREE.BackSide","UVLight","isOn","lightRef","FluorescenceScene","DiamondFluorescenceModule","fluorescenceIndex","setFluorescenceIndex","setUvLightOn","setColorGrade","currentLevel","priceImpactIcon","Minus","colorGrades","Moon","l","DiamondEducation","educationSchema","faqSchema","SEOHead","StructuredData","BreadcrumbNav","BackToHomeButton","TabsContent"],"ignoreList":[],"sources":["../../src/components/diamond-education/RealisticDiamond3D.tsx","../../src/components/diamond-education/DiamondColorModule.tsx","../../src/components/diamond-education/DiamondClarityModule.tsx","../../src/components/diamond-education/DiamondCaratModule.tsx","../../src/components/diamond-education/DiamondCutModule.tsx","../../src/components/diamond-education/DiamondGradingQuiz.tsx","../../src/components/diamond-education/DiamondValueCalculator.tsx","../../src/components/diamond-education/DiamondFluorescenceModule.tsx","../../src/pages/DiamondEducation.tsx"],"sourcesContent":["import { useRef, useMemo, useEffect, useState } from \"react\";\r\nimport { Canvas, useFrame, useThree } from \"@react-three/fiber\";\r\nimport { OrbitControls, Environment, ContactShadows, Sparkles } from \"@react-three/drei\";\r\nimport * as THREE from \"three\";\r\n\r\n// Diamond color grades with accurate spectral absorption\r\nconst COLOR_GRADES = {\r\n  D: { hue: 210, saturation: 0.03, lightness: 0.98, warmth: 0 },\r\n  E: { hue: 210, saturation: 0.02, lightness: 0.97, warmth: 0.02 },\r\n  F: { hue: 200, saturation: 0.02, lightness: 0.96, warmth: 0.04 },\r\n  G: { hue: 50, saturation: 0.04, lightness: 0.95, warmth: 0.08 },\r\n  H: { hue: 48, saturation: 0.08, lightness: 0.94, warmth: 0.12 },\r\n  I: { hue: 46, saturation: 0.12, lightness: 0.92, warmth: 0.18 },\r\n  J: { hue: 44, saturation: 0.18, lightness: 0.90, warmth: 0.25 },\r\n  K: { hue: 42, saturation: 0.25, lightness: 0.88, warmth: 0.35 },\r\n  L: { hue: 40, saturation: 0.32, lightness: 0.85, warmth: 0.42 },\r\n  M: { hue: 38, saturation: 0.38, lightness: 0.82, warmth: 0.50 },\r\n  N: { hue: 36, saturation: 0.44, lightness: 0.78, warmth: 0.58 },\r\n  O: { hue: 34, saturation: 0.48, lightness: 0.75, warmth: 0.65 },\r\n  P: { hue: 32, saturation: 0.52, lightness: 0.72, warmth: 0.70 },\r\n  Q: { hue: 30, saturation: 0.55, lightness: 0.70, warmth: 0.75 },\r\n  R: { hue: 28, saturation: 0.58, lightness: 0.68, warmth: 0.78 },\r\n  S: { hue: 26, saturation: 0.60, lightness: 0.66, warmth: 0.82 },\r\n  T: { hue: 24, saturation: 0.62, lightness: 0.64, warmth: 0.85 },\r\n  U: { hue: 22, saturation: 0.64, lightness: 0.62, warmth: 0.88 },\r\n  V: { hue: 20, saturation: 0.66, lightness: 0.60, warmth: 0.90 },\r\n  W: { hue: 18, saturation: 0.68, lightness: 0.58, warmth: 0.92 },\r\n  X: { hue: 16, saturation: 0.70, lightness: 0.56, warmth: 0.94 },\r\n  Y: { hue: 14, saturation: 0.72, lightness: 0.54, warmth: 0.96 },\r\n  Z: { hue: 12, saturation: 0.75, lightness: 0.50, warmth: 1.0 },\r\n};\r\n\r\n// Clarity grades with inclusion parameters\r\nconst CLARITY_GRADES = {\r\n  FL: { count: 0, maxSize: 0, visibility: 0, centerChance: 0, carbonChance: 0 },\r\n  IF: { count: 0, maxSize: 0, visibility: 0, centerChance: 0, carbonChance: 0 },\r\n  VVS1: { count: 1, maxSize: 0.012, visibility: 0.12, centerChance: 0.05, carbonChance: 0 },\r\n  VVS2: { count: 2, maxSize: 0.018, visibility: 0.2, centerChance: 0.1, carbonChance: 0 },\r\n  VS1: { count: 3, maxSize: 0.025, visibility: 0.35, centerChance: 0.15, carbonChance: 0.05 },\r\n  VS2: { count: 5, maxSize: 0.035, visibility: 0.5, centerChance: 0.25, carbonChance: 0.1 },\r\n  SI1: { count: 7, maxSize: 0.05, visibility: 0.65, centerChance: 0.4, carbonChance: 0.2 },\r\n  SI2: { count: 10, maxSize: 0.07, visibility: 0.8, centerChance: 0.55, carbonChance: 0.3 },\r\n  I1: { count: 15, maxSize: 0.1, visibility: 0.95, centerChance: 0.7, carbonChance: 0.5 },\r\n  I2: { count: 22, maxSize: 0.15, visibility: 1.0, centerChance: 0.85, carbonChance: 0.7 },\r\n  I3: { count: 30, maxSize: 0.22, visibility: 1.0, centerChance: 0.95, carbonChance: 0.85 },\r\n};\r\n\r\ntype InclusionType = 'pinpoint' | 'feather' | 'cloud' | 'crystal' | 'needle' | 'carbon';\r\n\r\ninterface Inclusion {\r\n  type: InclusionType;\r\n  position: THREE.Vector3;\r\n  size: number;\r\n  rotation: THREE.Euler;\r\n  opacity: number;\r\n  isCarbon: boolean;\r\n}\r\n\r\n// Generate realistic inclusions based on clarity grade\r\nconst generateInclusions = (clarityGrade: keyof typeof CLARITY_GRADES, seed: number): Inclusion[] => {\r\n  const params = CLARITY_GRADES[clarityGrade];\r\n  if (params.count === 0) return [];\r\n\r\n  const inclusions: Inclusion[] = [];\r\n  const random = (s: number) => {\r\n    const x = Math.sin(s) * 10000;\r\n    return x - Math.floor(x);\r\n  };\r\n\r\n  const inclusionTypes: InclusionType[] = ['pinpoint', 'feather', 'cloud', 'crystal', 'needle'];\r\n\r\n  for (let i = 0; i < params.count; i++) {\r\n    const s = seed + i * 137.5;\r\n    const isCarbon = random(s + 1) < params.carbonChance;\r\n    const isCenter = random(s + 2) < params.centerChance;\r\n    \r\n    const radius = isCenter ? random(s + 3) * 0.25 : 0.25 + random(s + 3) * 0.45;\r\n    const theta = random(s + 4) * Math.PI * 2;\r\n    const phi = random(s + 5) * Math.PI;\r\n    \r\n    const position = new THREE.Vector3(\r\n      radius * Math.sin(phi) * Math.cos(theta),\r\n      radius * Math.cos(phi) * 0.7,\r\n      radius * Math.sin(phi) * Math.sin(theta)\r\n    );\r\n\r\n    const type = isCarbon ? 'carbon' : inclusionTypes[Math.floor(random(s + 6) * inclusionTypes.length)];\r\n    const size = params.maxSize * (0.4 + random(s + 7) * 0.6);\r\n    \r\n    inclusions.push({\r\n      type,\r\n      position,\r\n      size,\r\n      rotation: new THREE.Euler(\r\n        random(s + 8) * Math.PI,\r\n        random(s + 9) * Math.PI,\r\n        random(s + 10) * Math.PI\r\n      ),\r\n      opacity: params.visibility * (0.6 + random(s + 11) * 0.4),\r\n      isCarbon,\r\n    });\r\n  }\r\n\r\n  return inclusions;\r\n};\r\n\r\n// Create realistic brilliant cut geometry with proper faceting\r\nconst createBrilliantCutGeometry = (): THREE.BufferGeometry => {\r\n  const geometry = new THREE.BufferGeometry();\r\n  \r\n  const tableRatio = 0.56;\r\n  const crownHeight = 0.16;\r\n  const girdleRadius = 1.0;\r\n  const pavilionDepth = 0.43;\r\n  const culetSize = 0.01;\r\n  \r\n  const vertices: number[] = [];\r\n  const normals: number[] = [];\r\n  const indices: number[] = [];\r\n  \r\n  const addVertex = (x: number, y: number, z: number) => {\r\n    vertices.push(x, y, z);\r\n    return vertices.length / 3 - 1;\r\n  };\r\n  \r\n  // Table center\r\n  const tableY = crownHeight;\r\n  const tableCenterIdx = addVertex(0, tableY, 0);\r\n  \r\n  // Table vertices (8 points)\r\n  const tableVertices: number[] = [];\r\n  for (let i = 0; i < 8; i++) {\r\n    const angle = (i * Math.PI * 2) / 8 + Math.PI / 8;\r\n    const idx = addVertex(\r\n      Math.cos(angle) * tableRatio,\r\n      tableY,\r\n      Math.sin(angle) * tableRatio\r\n    );\r\n    tableVertices.push(idx);\r\n  }\r\n  \r\n  // Crown star vertices (8 points between table and bezel)\r\n  const starVertices: number[] = [];\r\n  const starRadius = tableRatio + (girdleRadius - tableRatio) * 0.35;\r\n  const starY = crownHeight * 0.55;\r\n  for (let i = 0; i < 8; i++) {\r\n    const angle = (i * Math.PI * 2) / 8;\r\n    const idx = addVertex(\r\n      Math.cos(angle) * starRadius,\r\n      starY,\r\n      Math.sin(angle) * starRadius\r\n    );\r\n    starVertices.push(idx);\r\n  }\r\n  \r\n  // Upper girdle vertices (16 points)\r\n  const upperGirdleVertices: number[] = [];\r\n  const upperGirdleY = 0.02;\r\n  for (let i = 0; i < 16; i++) {\r\n    const angle = (i * Math.PI * 2) / 16;\r\n    const idx = addVertex(\r\n      Math.cos(angle) * girdleRadius,\r\n      upperGirdleY,\r\n      Math.sin(angle) * girdleRadius\r\n    );\r\n    upperGirdleVertices.push(idx);\r\n  }\r\n  \r\n  // Lower girdle vertices (16 points)\r\n  const lowerGirdleVertices: number[] = [];\r\n  const lowerGirdleY = -0.02;\r\n  for (let i = 0; i < 16; i++) {\r\n    const angle = (i * Math.PI * 2) / 16;\r\n    const idx = addVertex(\r\n      Math.cos(angle) * girdleRadius,\r\n      lowerGirdleY,\r\n      Math.sin(angle) * girdleRadius\r\n    );\r\n    lowerGirdleVertices.push(idx);\r\n  }\r\n  \r\n  // Pavilion main vertices (8 points)\r\n  const pavilionMainVertices: number[] = [];\r\n  const pavilionMainRadius = girdleRadius * 0.45;\r\n  const pavilionMainY = -pavilionDepth * 0.55;\r\n  for (let i = 0; i < 8; i++) {\r\n    const angle = (i * Math.PI * 2) / 8 + Math.PI / 8;\r\n    const idx = addVertex(\r\n      Math.cos(angle) * pavilionMainRadius,\r\n      pavilionMainY,\r\n      Math.sin(angle) * pavilionMainRadius\r\n    );\r\n    pavilionMainVertices.push(idx);\r\n  }\r\n  \r\n  // Culet\r\n  const culetIdx = addVertex(0, -pavilionDepth, 0);\r\n  \r\n  // === Build faces ===\r\n  \r\n  // Table facet (octagon)\r\n  for (let i = 0; i < 8; i++) {\r\n    indices.push(tableCenterIdx, tableVertices[i], tableVertices[(i + 1) % 8]);\r\n  }\r\n  \r\n  // Crown star facets\r\n  for (let i = 0; i < 8; i++) {\r\n    indices.push(tableVertices[i], starVertices[i], tableVertices[(i + 1) % 8]);\r\n  }\r\n  \r\n  // Crown bezel facets (kite-shaped, triangulated)\r\n  for (let i = 0; i < 8; i++) {\r\n    const nextI = (i + 1) % 8;\r\n    const girdleIdx1 = upperGirdleVertices[i * 2];\r\n    const girdleIdx2 = upperGirdleVertices[(i * 2 + 1) % 16];\r\n    const girdleIdx3 = upperGirdleVertices[(i * 2 + 2) % 16];\r\n    \r\n    // Upper bezel triangles\r\n    indices.push(starVertices[i], girdleIdx1, girdleIdx2);\r\n    indices.push(starVertices[i], girdleIdx2, starVertices[nextI]);\r\n    indices.push(starVertices[nextI], girdleIdx2, girdleIdx3);\r\n  }\r\n  \r\n  // Girdle band\r\n  for (let i = 0; i < 16; i++) {\r\n    const next = (i + 1) % 16;\r\n    indices.push(upperGirdleVertices[i], lowerGirdleVertices[i], upperGirdleVertices[next]);\r\n    indices.push(upperGirdleVertices[next], lowerGirdleVertices[i], lowerGirdleVertices[next]);\r\n  }\r\n  \r\n  // Pavilion main facets\r\n  for (let i = 0; i < 8; i++) {\r\n    const nextI = (i + 1) % 8;\r\n    const girdleIdx1 = lowerGirdleVertices[i * 2];\r\n    const girdleIdx2 = lowerGirdleVertices[(i * 2 + 1) % 16];\r\n    const girdleIdx3 = lowerGirdleVertices[(i * 2 + 2) % 16];\r\n    \r\n    // Main pavilion triangles\r\n    indices.push(girdleIdx1, pavilionMainVertices[i], girdleIdx2);\r\n    indices.push(girdleIdx2, pavilionMainVertices[i], pavilionMainVertices[nextI]);\r\n    indices.push(girdleIdx2, pavilionMainVertices[nextI], girdleIdx3);\r\n  }\r\n  \r\n  // Pavilion lower facets to culet\r\n  for (let i = 0; i < 8; i++) {\r\n    const nextI = (i + 1) % 8;\r\n    indices.push(pavilionMainVertices[i], culetIdx, pavilionMainVertices[nextI]);\r\n  }\r\n  \r\n  geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));\r\n  geometry.setIndex(indices);\r\n  geometry.computeVertexNormals();\r\n  \r\n  return geometry;\r\n};\r\n\r\n// Individual inclusion component with animation\r\nconst InclusionMesh = ({ inclusion, microscopeMode }: { inclusion: Inclusion; microscopeMode: boolean }) => {\r\n  const meshRef = useRef<THREE.Mesh>(null);\r\n  \r\n  useFrame((state) => {\r\n    if (meshRef.current && inclusion.type === 'cloud') {\r\n      meshRef.current.scale.setScalar(1 + Math.sin(state.clock.elapsedTime * 2) * 0.05);\r\n    }\r\n  });\r\n  \r\n  const geometry = useMemo(() => {\r\n    const scale = microscopeMode ? 2.2 : 1;\r\n    switch (inclusion.type) {\r\n      case 'pinpoint':\r\n        return new THREE.SphereGeometry(inclusion.size * 0.4 * scale, 12, 12);\r\n      case 'feather':\r\n        const shape = new THREE.Shape();\r\n        const w = inclusion.size * 1.5 * scale;\r\n        const h = inclusion.size * 0.8 * scale;\r\n        shape.moveTo(0, 0);\r\n        shape.bezierCurveTo(w * 0.3, h * 0.5, w * 0.7, h * 0.5, w, 0);\r\n        shape.bezierCurveTo(w * 0.7, -h * 0.3, w * 0.3, -h * 0.3, 0, 0);\r\n        return new THREE.ShapeGeometry(shape);\r\n      case 'cloud':\r\n        const cloudGeo = new THREE.BufferGeometry();\r\n        const cloudPositions: number[] = [];\r\n        for (let i = 0; i < 12; i++) {\r\n          const angle = (i / 12) * Math.PI * 2;\r\n          const r = inclusion.size * scale * (0.3 + Math.random() * 0.4);\r\n          cloudPositions.push(\r\n            Math.cos(angle) * r,\r\n            (Math.random() - 0.5) * inclusion.size * scale * 0.5,\r\n            Math.sin(angle) * r\r\n          );\r\n        }\r\n        cloudGeo.setAttribute('position', new THREE.Float32BufferAttribute(cloudPositions, 3));\r\n        return new THREE.SphereGeometry(inclusion.size * 0.8 * scale, 8, 8);\r\n      case 'crystal':\r\n        return new THREE.OctahedronGeometry(inclusion.size * 0.6 * scale);\r\n      case 'needle':\r\n        return new THREE.CylinderGeometry(0.003 * scale, 0.003 * scale, inclusion.size * 2.5 * scale, 8);\r\n      case 'carbon':\r\n        return new THREE.IcosahedronGeometry(inclusion.size * 0.55 * scale, 0);\r\n      default:\r\n        return new THREE.SphereGeometry(inclusion.size * scale, 8, 8);\r\n    }\r\n  }, [inclusion.type, inclusion.size, microscopeMode]);\r\n\r\n  const material = useMemo(() => {\r\n    const opacityMultiplier = microscopeMode ? 1.4 : 1;\r\n    \r\n    if (inclusion.isCarbon) {\r\n      return new THREE.MeshStandardMaterial({\r\n        color: new THREE.Color(0x0a0a0a),\r\n        metalness: 0.2,\r\n        roughness: 0.9,\r\n        transparent: true,\r\n        opacity: Math.min(inclusion.opacity * opacityMultiplier, 0.95),\r\n      });\r\n    }\r\n    \r\n    const baseColor = inclusion.type === 'feather' ? 0xffffff : \r\n                     inclusion.type === 'cloud' ? 0xeeeeee : 0xfafafa;\r\n    \r\n    return new THREE.MeshPhysicalMaterial({\r\n      color: new THREE.Color(baseColor),\r\n      metalness: 0,\r\n      roughness: inclusion.type === 'feather' ? 0.4 : 0.15,\r\n      transmission: inclusion.type === 'cloud' ? 0.2 : 0.5,\r\n      thickness: 0.05,\r\n      transparent: true,\r\n      opacity: inclusion.opacity * opacityMultiplier * 0.8,\r\n    });\r\n  }, [inclusion, microscopeMode]);\r\n\r\n  return (\r\n    <mesh\r\n      ref={meshRef}\r\n      geometry={geometry}\r\n      material={material}\r\n      position={inclusion.position}\r\n      rotation={inclusion.rotation}\r\n    />\r\n  );\r\n};\r\n\r\n// Sparkle effect component\r\nconst DiamondSparkles = ({ intensity = 1 }: { intensity?: number }) => {\r\n  const sparkleRef = useRef<THREE.Points>(null);\r\n  const [time, setTime] = useState(0);\r\n  \r\n  useFrame((state) => {\r\n    setTime(state.clock.elapsedTime);\r\n    if (sparkleRef.current) {\r\n      sparkleRef.current.rotation.y = state.clock.elapsedTime * 0.1;\r\n    }\r\n  });\r\n  \r\n  return (\r\n    <Sparkles\r\n      ref={sparkleRef}\r\n      count={30}\r\n      scale={2.5}\r\n      size={4 * intensity}\r\n      speed={0.4}\r\n      opacity={0.6}\r\n      color=\"#ffffff\"\r\n    />\r\n  );\r\n};\r\n\r\n// Main diamond mesh component\r\nconst DiamondMesh = ({\r\n  colorGrade,\r\n  clarityGrade,\r\n  autoRotate,\r\n  microscopeMode,\r\n  viewMode,\r\n  seed = 12345,\r\n}: {\r\n  colorGrade: keyof typeof COLOR_GRADES;\r\n  clarityGrade: keyof typeof CLARITY_GRADES;\r\n  autoRotate: boolean;\r\n  microscopeMode: boolean;\r\n  viewMode: 'faceUp' | 'side' | 'pavilion';\r\n  seed?: number;\r\n}) => {\r\n  const groupRef = useRef<THREE.Group>(null);\r\n  const diamondRef = useRef<THREE.Mesh>(null);\r\n  \r\n  const geometry = useMemo(() => createBrilliantCutGeometry(), []);\r\n  \r\n  const inclusions = useMemo(() => \r\n    generateInclusions(clarityGrade, seed), \r\n    [clarityGrade, seed]\r\n  );\r\n\r\n  // Calculate diamond color based on grade\r\n  const diamondColor = useMemo(() => {\r\n    const grade = COLOR_GRADES[colorGrade];\r\n    return new THREE.Color().setHSL(grade.hue / 360, grade.saturation, grade.lightness);\r\n  }, [colorGrade]);\r\n\r\n  // Diamond material with physically accurate properties\r\n  const material = useMemo(() => {\r\n    const grade = COLOR_GRADES[colorGrade];\r\n    \r\n    return new THREE.MeshPhysicalMaterial({\r\n      color: diamondColor,\r\n      metalness: 0,\r\n      roughness: 0.0,\r\n      transmission: 0.96 - grade.warmth * 0.08,\r\n      thickness: 2.0,\r\n      ior: 2.417,\r\n      clearcoat: 1,\r\n      clearcoatRoughness: 0,\r\n      envMapIntensity: microscopeMode ? 2 : 4,\r\n      transparent: true,\r\n      opacity: 1,\r\n      attenuationDistance: 0.5,\r\n      attenuationColor: diamondColor,\r\n      sheen: 0.3,\r\n      sheenRoughness: 0.2,\r\n      sheenColor: new THREE.Color(0xffffff),\r\n      specularIntensity: 1,\r\n      specularColor: new THREE.Color(0xffffff),\r\n    });\r\n  }, [diamondColor, colorGrade, microscopeMode]);\r\n\r\n  // Set initial rotation based on view mode\r\n  useEffect(() => {\r\n    if (groupRef.current) {\r\n      switch (viewMode) {\r\n        case 'faceUp':\r\n          groupRef.current.rotation.set(0, 0, 0);\r\n          break;\r\n        case 'side':\r\n          groupRef.current.rotation.set(Math.PI / 3.5, 0, 0);\r\n          break;\r\n        case 'pavilion':\r\n          groupRef.current.rotation.set(Math.PI, 0, 0);\r\n          break;\r\n      }\r\n    }\r\n  }, [viewMode]);\r\n\r\n  useFrame((state, delta) => {\r\n    if (groupRef.current && autoRotate) {\r\n      groupRef.current.rotation.y += delta * 0.4;\r\n    }\r\n    \r\n    // Subtle breathing animation for realism\r\n    if (diamondRef.current && !microscopeMode) {\r\n      const scale = 1 + Math.sin(state.clock.elapsedTime * 0.5) * 0.002;\r\n      diamondRef.current.scale.setScalar(scale);\r\n    }\r\n  });\r\n\r\n  const scale = microscopeMode ? 1.6 : 1.1;\r\n\r\n  return (\r\n    <group ref={groupRef} scale={scale}>\r\n      <mesh\r\n        ref={diamondRef}\r\n        geometry={geometry}\r\n        material={material}\r\n        castShadow\r\n        receiveShadow\r\n      />\r\n      \r\n      {/* Render inclusions inside the diamond */}\r\n      <group scale={0.85}>\r\n        {inclusions.map((inclusion, i) => (\r\n          <InclusionMesh \r\n            key={i} \r\n            inclusion={inclusion} \r\n            microscopeMode={microscopeMode}\r\n          />\r\n        ))}\r\n      </group>\r\n      \r\n      {/* Sparkle effects */}\r\n      {!microscopeMode && <DiamondSparkles intensity={1 - (COLOR_GRADES[colorGrade]?.warmth || 0) * 0.5} />}\r\n    </group>\r\n  );\r\n};\r\n\r\n// Enhanced lighting setup\r\nconst GemologicalLighting = ({ microscopeMode }: { microscopeMode: boolean }) => {\r\n  const lightsRef = useRef<THREE.Group>(null);\r\n  \r\n  useFrame((state) => {\r\n    if (lightsRef.current && !microscopeMode) {\r\n      lightsRef.current.rotation.y = state.clock.elapsedTime * 0.15;\r\n    }\r\n  });\r\n  \r\n  return (\r\n    <group ref={lightsRef}>\r\n      {/* Main key light */}\r\n      <directionalLight\r\n        position={[5, 10, 5]}\r\n        intensity={microscopeMode ? 2 : 1.5}\r\n        castShadow\r\n        shadow-mapSize-width={2048}\r\n        shadow-mapSize-height={2048}\r\n        color=\"#ffffff\"\r\n      />\r\n      \r\n      {/* Fill light */}\r\n      <directionalLight\r\n        position={[-5, 8, -5]}\r\n        intensity={microscopeMode ? 1.5 : 1}\r\n        color=\"#f0f8ff\"\r\n      />\r\n      \r\n      {/* Rim lights for fire effect */}\r\n      <pointLight position={[3, 2, 3]} intensity={0.8} color=\"#fff5e6\" distance={10} />\r\n      <pointLight position={[-3, 2, -3]} intensity={0.8} color=\"#e6f0ff\" distance={10} />\r\n      <pointLight position={[0, -2, 3]} intensity={0.5} color=\"#fff0f5\" distance={8} />\r\n      \r\n      {/* Microscope ring light */}\r\n      {microscopeMode && (\r\n        <>\r\n          <pointLight position={[2, 4, 2]} intensity={1.2} color=\"#ffffff\" />\r\n          <pointLight position={[-2, 4, 2]} intensity={1.2} color=\"#ffffff\" />\r\n          <pointLight position={[2, 4, -2]} intensity={1.2} color=\"#ffffff\" />\r\n          <pointLight position={[-2, 4, -2]} intensity={1.2} color=\"#ffffff\" />\r\n        </>\r\n      )}\r\n      \r\n      {/* Ambient fill */}\r\n      <ambientLight intensity={microscopeMode ? 0.5 : 0.35} />\r\n      \r\n      {/* Rainbow dispersion spotlights */}\r\n      {!microscopeMode && (\r\n        <>\r\n          <spotLight\r\n            position={[4, 6, 2]}\r\n            angle={0.25}\r\n            penumbra={0.8}\r\n            intensity={0.6}\r\n            color=\"#ff6b6b\"\r\n          />\r\n          <spotLight\r\n            position={[-2, 6, 4]}\r\n            angle={0.25}\r\n            penumbra={0.8}\r\n            intensity={0.5}\r\n            color=\"#4ecdc4\"\r\n          />\r\n          <spotLight\r\n            position={[0, 6, -4]}\r\n            angle={0.25}\r\n            penumbra={0.8}\r\n            intensity={0.5}\r\n            color=\"#a855f7\"\r\n          />\r\n        </>\r\n      )}\r\n    </group>\r\n  );\r\n};\r\n\r\n// Camera controller for view modes\r\nconst CameraController = ({ viewMode, microscopeMode }: { viewMode: string; microscopeMode: boolean }) => {\r\n  const { camera } = useThree();\r\n  \r\n  useEffect(() => {\r\n    const distance = microscopeMode ? 2.2 : 3.5;\r\n    switch (viewMode) {\r\n      case 'faceUp':\r\n        camera.position.set(0, distance, 0.5);\r\n        break;\r\n      case 'side':\r\n        camera.position.set(distance * 0.8, distance * 0.4, distance * 0.8);\r\n        break;\r\n      case 'pavilion':\r\n        camera.position.set(0, -distance, 0.5);\r\n        break;\r\n    }\r\n    camera.lookAt(0, 0, 0);\r\n  }, [viewMode, microscopeMode, camera]);\r\n  \r\n  return null;\r\n};\r\n\r\n// Main component props\r\ninterface RealisticDiamond3DProps {\r\n  colorGrade?: keyof typeof COLOR_GRADES;\r\n  clarityGrade?: keyof typeof CLARITY_GRADES;\r\n  autoRotate?: boolean;\r\n  microscopeMode?: boolean;\r\n  viewMode?: 'faceUp' | 'side' | 'pavilion';\r\n  showControls?: boolean;\r\n  seed?: number;\r\n  className?: string;\r\n}\r\n\r\nconst RealisticDiamond3D = ({\r\n  colorGrade = 'G',\r\n  clarityGrade = 'VS1',\r\n  autoRotate = true,\r\n  microscopeMode = false,\r\n  viewMode = 'faceUp',\r\n  showControls = true,\r\n  seed = 12345,\r\n  className = \"\",\r\n}: RealisticDiamond3DProps) => {\r\n  const bgGradient = microscopeMode \r\n    ? 'radial-gradient(circle at 50% 50%, #0d0d1a 0%, #000000 100%)'\r\n    : 'radial-gradient(ellipse at 50% 30%, #1e293b 0%, #0f172a 50%, #020617 100%)';\r\n  \r\n  return (\r\n    <div \r\n      className={`w-full h-full min-h-[400px] rounded-xl overflow-hidden ${className}`}\r\n      style={{ background: bgGradient }}\r\n    >\r\n      <Canvas\r\n        shadows\r\n        dpr={[1, 2]}\r\n        camera={{ position: [0, 3.5, 0.5], fov: microscopeMode ? 28 : 38 }}\r\n        gl={{ \r\n          antialias: true, \r\n          alpha: true,\r\n          powerPreference: \"high-performance\",\r\n          toneMapping: THREE.ACESFilmicToneMapping,\r\n          toneMappingExposure: 1.2,\r\n        }}\r\n      >\r\n        <CameraController viewMode={viewMode} microscopeMode={microscopeMode} />\r\n        <GemologicalLighting microscopeMode={microscopeMode} />\r\n        \r\n        <DiamondMesh\r\n          colorGrade={colorGrade}\r\n          clarityGrade={clarityGrade}\r\n          autoRotate={autoRotate}\r\n          microscopeMode={microscopeMode}\r\n          viewMode={viewMode}\r\n          seed={seed}\r\n        />\r\n        \r\n        {/* Reflective floor */}\r\n        <ContactShadows\r\n          position={[0, -1.2, 0]}\r\n          opacity={0.5}\r\n          scale={8}\r\n          blur={2.5}\r\n          far={4}\r\n        />\r\n        \r\n        {/* HDR Environment for realistic reflections */}\r\n        <Environment preset={microscopeMode ? \"warehouse\" : \"city\"} />\r\n        \r\n        {showControls && (\r\n          <OrbitControls\r\n            enableZoom={true}\r\n            enablePan={false}\r\n            autoRotate={false}\r\n            minDistance={1.5}\r\n            maxDistance={10}\r\n            minPolarAngle={0}\r\n            maxPolarAngle={Math.PI}\r\n            dampingFactor={0.05}\r\n            enableDamping\r\n          />\r\n        )}\r\n      </Canvas>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport { COLOR_GRADES, CLARITY_GRADES };\r\nexport default RealisticDiamond3D;\r\n","import { useState, useMemo, Suspense } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport * as THREE from \"three\";\r\nimport { Slider } from \"@/components/ui/slider\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\r\nimport { Eye, Layers, SplitSquareVertical, Info, Sparkles } from \"lucide-react\";\r\nimport RealisticDiamond3D, { COLOR_GRADES as DIAMOND_COLOR_GRADES } from \"./RealisticDiamond3D\";\r\n\r\n// Color grades with their properties\r\nconst COLOR_GRADES = [\r\n  { grade: \"D\", index: 0, name: \"Absolutely Colorless\", color: \"#E8F4FF\", warmth: 0, market: \"Exceptional, highest grade\", recommendation: \"Investment pieces, heirloom jewelry\" },\r\n  { grade: \"E\", index: 1, name: \"Colorless\", color: \"#E6F2FC\", warmth: 0.02, market: \"Exceptional quality\", recommendation: \"High-end engagement rings, fine jewelry\" },\r\n  { grade: \"F\", index: 2, name: \"Colorless\", color: \"#E4F0F9\", warmth: 0.04, market: \"Excellent, often preferred for platinum settings\", recommendation: \"White gold/platinum settings\" },\r\n  { grade: \"G\", index: 3, name: \"Near Colorless\", color: \"#F0F0E8\", warmth: 0.08, market: \"Best value in near-colorless range\", recommendation: \"Most popular for engagement rings\" },\r\n  { grade: \"H\", index: 4, name: \"Near Colorless\", color: \"#F2F0E4\", warmth: 0.12, market: \"Excellent value, slight warmth\", recommendation: \"Yellow gold settings enhance beauty\" },\r\n  { grade: \"I\", index: 5, name: \"Near Colorless\", color: \"#F5EFE0\", warmth: 0.18, market: \"Good value, faint color visible\", recommendation: \"Budget-friendly, yellow gold preferred\" },\r\n  { grade: \"J\", index: 6, name: \"Near Colorless\", color: \"#F8EEDC\", warmth: 0.24, market: \"Value range, noticeable warmth\", recommendation: \"Yellow/rose gold maximizes beauty\" },\r\n  { grade: \"K\", index: 7, name: \"Faint Yellow\", color: \"#F9EAD0\", warmth: 0.32, market: \"Faint yellow visible face-up\", recommendation: \"Vintage styles, yellow gold\" },\r\n  { grade: \"L\", index: 8, name: \"Faint Yellow\", color: \"#FAE6C4\", warmth: 0.40, market: \"Noticeable yellow tint\", recommendation: \"Antique/vintage settings\" },\r\n  { grade: \"M\", index: 9, name: \"Faint Yellow\", color: \"#FBE2B8\", warmth: 0.48, market: \"Yellow visible, lower price point\", recommendation: \"Statement pieces, warm settings\" },\r\n  { grade: \"N\", index: 10, name: \"Very Light Yellow\", color: \"#FCDEA8\", warmth: 0.56, market: \"Very light yellow\", recommendation: \"Specialty pieces\" },\r\n  { grade: \"Z\", index: 11, name: \"Light Yellow/Brown\", color: \"#FDD88C\", warmth: 0.75, market: \"Light colored diamonds\", recommendation: \"Fancy color settings, artistic jewelry\" },\r\n];\r\n\r\nconst gradeToKey = (grade: string): keyof typeof DIAMOND_COLOR_GRADES => {\r\n  return grade as keyof typeof DIAMOND_COLOR_GRADES;\r\n};\r\n\r\nconst LoadingFallback = () => (\r\n  <div className=\"flex items-center justify-center h-full\">\r\n    <div className=\"flex items-center gap-2 text-muted-foreground\">\r\n      <div className=\"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin\" />\r\n      <span className=\"text-sm\">Loading Diamond...</span>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport const DiamondColorModule = () => {\r\n  const [colorIndex, setColorIndex] = useState(0);\r\n  const [viewMode, setViewMode] = useState<\"face-up\" | \"side\">(\"face-up\");\r\n  const [comparisonMode, setComparisonMode] = useState(false);\r\n  const [isRotating, setIsRotating] = useState(true);\r\n\r\n  const currentGrade = useMemo(() => {\r\n    // Smooth interpolation between grades\r\n    const lowerIndex = Math.floor(colorIndex);\r\n    const upperIndex = Math.min(lowerIndex + 1, COLOR_GRADES.length - 1);\r\n    const fraction = colorIndex - lowerIndex;\r\n    \r\n    const lowerGrade = COLOR_GRADES[lowerIndex];\r\n    const upperGrade = COLOR_GRADES[upperIndex];\r\n    \r\n    // Interpolate color\r\n    const lowerColor = new THREE.Color(lowerGrade.color);\r\n    const upperColor = new THREE.Color(upperGrade.color);\r\n    const interpolatedColor = lowerColor.lerp(upperColor, fraction);\r\n    \r\n    return {\r\n      ...lowerGrade,\r\n      interpolatedColor: `#${interpolatedColor.getHexString()}`,\r\n      warmth: lowerGrade.warmth + (upperGrade.warmth - lowerGrade.warmth) * fraction,\r\n    };\r\n  }, [colorIndex]);\r\n\r\n  const gradeD = COLOR_GRADES[0];\r\n  const gradeG = COLOR_GRADES[3];\r\n\r\n  return (\r\n    <Card className=\"w-full\">\r\n      <CardHeader>\r\n        <CardTitle className=\"flex items-center gap-2\">\r\n          <div className=\"h-8 w-8 rounded-lg bg-gradient-to-br from-sky-400 to-blue-600 flex items-center justify-center\">\r\n            <span className=\"text-white text-sm font-bold\"></span>\r\n          </div>\r\n          Diamond Color Interactive Chart\r\n        </CardTitle>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-6\">\r\n        {/* View Mode Toggle */}\r\n        <div className=\"flex flex-wrap gap-2 justify-between items-center\">\r\n          <div className=\"flex gap-2\">\r\n            <Button\r\n              variant={viewMode === \"face-up\" ? \"default\" : \"outline\"}\r\n              size=\"sm\"\r\n              onClick={() => setViewMode(\"face-up\")}\r\n            >\r\n              <Eye className=\"h-4 w-4 mr-2\" />\r\n              Face-Up View\r\n            </Button>\r\n            <Button\r\n              variant={viewMode === \"side\" ? \"default\" : \"outline\"}\r\n              size=\"sm\"\r\n              onClick={() => setViewMode(\"side\")}\r\n            >\r\n              <Layers className=\"h-4 w-4 mr-2\" />\r\n              Side View\r\n            </Button>\r\n          </div>\r\n          <Button\r\n            variant={comparisonMode ? \"default\" : \"outline\"}\r\n            size=\"sm\"\r\n            onClick={() => setComparisonMode(!comparisonMode)}\r\n          >\r\n            <SplitSquareVertical className=\"h-4 w-4 mr-2\" />\r\n            Comparison Mode\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Diamond Visualization */}\r\n        <div className={`grid ${comparisonMode ? \"lg:grid-cols-3 grid-cols-1\" : \"grid-cols-1\"} gap-4`}>\r\n          {comparisonMode && (\r\n            <div className=\"relative\">\r\n              <Suspense fallback={<LoadingFallback />}>\r\n                <div className=\"h-72 rounded-xl overflow-hidden\">\r\n                  <RealisticDiamond3D \r\n                    colorGrade=\"D\"\r\n                    clarityGrade=\"VS1\"\r\n                    autoRotate={false}\r\n                    viewMode={viewMode === \"face-up\" ? \"faceUp\" : \"side\"}\r\n                  />\r\n                </div>\r\n              </Suspense>\r\n              <Badge className=\"absolute top-2 left-2 bg-sky-500 shadow-lg\">\r\n                <Sparkles className=\"h-3 w-3 mr-1\" />\r\n                D Grade (Reference)\r\n              </Badge>\r\n            </div>\r\n          )}\r\n          \r\n          <motion.div \r\n            className=\"relative\"\r\n            layout\r\n            transition={{ duration: 0.3 }}\r\n          >\r\n            <Suspense fallback={<LoadingFallback />}>\r\n              <div className=\"h-72 rounded-xl overflow-hidden\">\r\n                <RealisticDiamond3D \r\n                  colorGrade={gradeToKey(COLOR_GRADES[Math.round(colorIndex)].grade)}\r\n                  clarityGrade=\"VS1\"\r\n                  autoRotate={isRotating}\r\n                  viewMode={viewMode === \"face-up\" ? \"faceUp\" : \"side\"}\r\n                />\r\n              </div>\r\n            </Suspense>\r\n            <Badge className=\"absolute top-2 left-2 bg-primary shadow-lg\">\r\n              <Sparkles className=\"h-3 w-3 mr-1\" />\r\n              {COLOR_GRADES[Math.round(colorIndex)].grade} Grade (Selected)\r\n            </Badge>\r\n            <button\r\n              onClick={() => setIsRotating(!isRotating)}\r\n              className=\"absolute top-2 right-2 p-2.5 rounded-full bg-black/60 text-white hover:bg-black/80 transition-all shadow-lg backdrop-blur-sm\"\r\n            >\r\n              {isRotating ? \"\" : \"\"}\r\n            </button>\r\n          </motion.div>\r\n\r\n          {comparisonMode && (\r\n            <div className=\"relative\">\r\n              <Suspense fallback={<LoadingFallback />}>\r\n                <div className=\"h-72 rounded-xl overflow-hidden\">\r\n                  <RealisticDiamond3D \r\n                    colorGrade=\"G\"\r\n                    clarityGrade=\"VS1\"\r\n                    autoRotate={false}\r\n                    viewMode={viewMode === \"face-up\" ? \"faceUp\" : \"side\"}\r\n                  />\r\n                </div>\r\n              </Suspense>\r\n              <Badge className=\"absolute top-2 left-2 bg-amber-500 shadow-lg\">\r\n                <Sparkles className=\"h-3 w-3 mr-1\" />\r\n                G Grade (Reference)\r\n              </Badge>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Color Slider */}\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex justify-between items-center text-xs font-medium text-muted-foreground\">\r\n            {COLOR_GRADES.map((g, i) => (\r\n              <TooltipProvider key={g.grade}>\r\n                <Tooltip>\r\n                  <TooltipTrigger asChild>\r\n                    <button\r\n                      onClick={() => setColorIndex(i)}\r\n                      className={`px-2 py-1 rounded transition-all ${\r\n                        Math.round(colorIndex) === i \r\n                          ? \"bg-primary text-primary-foreground font-bold scale-110\" \r\n                          : \"hover:bg-muted\"\r\n                      }`}\r\n                    >\r\n                      {g.grade}\r\n                    </button>\r\n                  </TooltipTrigger>\r\n                  <TooltipContent side=\"bottom\" className=\"max-w-xs\">\r\n                    <div className=\"space-y-1\">\r\n                      <p className=\"font-semibold\">{g.grade} - {g.name}</p>\r\n                      <p className=\"text-xs text-muted-foreground\">{g.market}</p>\r\n                      <p className=\"text-xs\"><strong>Recommended:</strong> {g.recommendation}</p>\r\n                    </div>\r\n                  </TooltipContent>\r\n                </Tooltip>\r\n              </TooltipProvider>\r\n            ))}\r\n          </div>\r\n          \r\n          <div className=\"relative\">\r\n            <div \r\n              className=\"absolute inset-0 h-3 rounded-full mt-2\"\r\n              style={{\r\n                background: `linear-gradient(to right, ${COLOR_GRADES.map(g => g.color).join(\", \")})`\r\n              }}\r\n            />\r\n            <Slider\r\n              value={[colorIndex]}\r\n              onValueChange={(value) => setColorIndex(value[0])}\r\n              max={COLOR_GRADES.length - 1}\r\n              step={0.01}\r\n              className=\"relative z-10\"\r\n            />\r\n          </div>\r\n          \r\n          <p className=\"text-center text-sm text-muted-foreground\">\r\n            Drag the slider to see how diamond color changes from D (colorless) to Z (light yellow)\r\n          </p>\r\n        </div>\r\n\r\n        {/* Grade Information */}\r\n        <AnimatePresence mode=\"wait\">\r\n          <motion.div\r\n            key={Math.round(colorIndex)}\r\n            initial={{ opacity: 0, y: 10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, y: -10 }}\r\n            className=\"p-4 rounded-xl bg-muted/50 space-y-3\"\r\n          >\r\n            <div className=\"flex items-center gap-3\">\r\n              <div \r\n                className=\"w-12 h-12 rounded-full border-4 border-white shadow-lg\"\r\n                style={{ backgroundColor: currentGrade.interpolatedColor }}\r\n              />\r\n              <div>\r\n                <h3 className=\"text-lg font-bold\">\r\n                  Grade {COLOR_GRADES[Math.round(colorIndex)].grade}\r\n                </h3>\r\n                <p className=\"text-sm text-muted-foreground\">\r\n                  {COLOR_GRADES[Math.round(colorIndex)].name}\r\n                </p>\r\n              </div>\r\n              <Badge variant=\"outline\" className=\"ml-auto\">\r\n                Warmth: {Math.round(currentGrade.warmth * 100)}%\r\n              </Badge>\r\n            </div>\r\n            \r\n            <div className=\"grid md:grid-cols-2 gap-3 text-sm\">\r\n              <div className=\"flex items-start gap-2\">\r\n                <Info className=\"h-4 w-4 text-primary mt-0.5\" />\r\n                <div>\r\n                  <p className=\"font-medium\">Market Position</p>\r\n                  <p className=\"text-muted-foreground\">{COLOR_GRADES[Math.round(colorIndex)].market}</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-start gap-2\">\r\n                <Info className=\"h-4 w-4 text-primary mt-0.5\" />\r\n                <div>\r\n                  <p className=\"font-medium\">Recommendation</p>\r\n                  <p className=\"text-muted-foreground\">{COLOR_GRADES[Math.round(colorIndex)].recommendation}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </motion.div>\r\n        </AnimatePresence>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default DiamondColorModule;\r\n","import { useState, useMemo, Suspense, useCallback } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\r\nimport { RotateCcw, Search, Eye, Info, Sparkles } from \"lucide-react\";\r\nimport RealisticDiamond3D, { CLARITY_GRADES as DIAMOND_CLARITY_GRADES } from \"./RealisticDiamond3D\";\r\n\r\nconst CLARITY_GRADES = [\r\n  { grade: \"FL\", index: 0, name: \"Flawless\", inclusions: 0, size: 0, visibility: 0, description: \"No inclusions or blemishes visible under 10x magnification\", rarity: \"Extremely Rare (<1%)\" },\r\n  { grade: \"IF\", index: 1, name: \"Internally Flawless\", inclusions: 0, size: 0, visibility: 0.05, description: \"No inclusions visible under 10x magnification\", rarity: \"Very Rare (~3%)\" },\r\n  { grade: \"VVS1\", index: 2, name: \"Very Very Slightly Included 1\", inclusions: 1, size: 0.1, visibility: 0.15, description: \"Minute inclusions very difficult to see under 10x\", rarity: \"Rare\" },\r\n  { grade: \"VVS2\", index: 3, name: \"Very Very Slightly Included 2\", inclusions: 2, size: 0.15, visibility: 0.2, description: \"Minute inclusions difficult to see under 10x\", rarity: \"Uncommon\" },\r\n  { grade: \"VS1\", index: 4, name: \"Very Slightly Included 1\", inclusions: 3, size: 0.2, visibility: 0.35, description: \"Minor inclusions somewhat difficult to see under 10x\", rarity: \"Common\" },\r\n  { grade: \"VS2\", index: 5, name: \"Very Slightly Included 2\", inclusions: 4, size: 0.25, visibility: 0.45, description: \"Minor inclusions easily visible under 10x\", rarity: \"Common\" },\r\n  { grade: \"SI1\", index: 6, name: \"Slightly Included 1\", inclusions: 5, size: 0.35, visibility: 0.6, description: \"Noticeable inclusions under 10x, may be eye-visible\", rarity: \"Common\" },\r\n  { grade: \"SI2\", index: 7, name: \"Slightly Included 2\", inclusions: 7, size: 0.45, visibility: 0.75, description: \"Noticeable inclusions, often eye-visible\", rarity: \"Common\" },\r\n  { grade: \"I1\", index: 8, name: \"Included 1\", inclusions: 9, size: 0.55, visibility: 0.85, description: \"Obvious inclusions, visible to naked eye\", rarity: \"Abundant\" },\r\n  { grade: \"I2\", index: 9, name: \"Included 2\", inclusions: 12, size: 0.7, visibility: 0.95, description: \"Many obvious inclusions affecting transparency\", rarity: \"Abundant\" },\r\n  { grade: \"I3\", index: 10, name: \"Included 3\", inclusions: 15, size: 0.85, visibility: 1, description: \"Many large inclusions severely affecting beauty\", rarity: \"Abundant\" },\r\n];\r\n\r\nconst gradeToKey = (grade: string): keyof typeof DIAMOND_CLARITY_GRADES => {\r\n  return grade as keyof typeof DIAMOND_CLARITY_GRADES;\r\n};\r\n\r\nconst LoadingFallback = () => (\r\n  <div className=\"flex items-center justify-center h-full\">\r\n    <div className=\"flex items-center gap-2 text-muted-foreground\">\r\n      <div className=\"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin\" />\r\n      <span className=\"text-sm\">Loading Diamond...</span>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport const DiamondClarityModule = () => {\r\n  const [clarityIndex, setClarityIndex] = useState(4);\r\n  const [autoRotate, setAutoRotate] = useState(true);\r\n  const [microscopeMode, setMicroscopeMode] = useState(false);\r\n  const [seed, setSeed] = useState(1);\r\n\r\n  const currentGrade = useMemo(() => CLARITY_GRADES[Math.round(clarityIndex)], [clarityIndex]);\r\n  const regenerateInclusions = useCallback(() => setSeed(prev => prev + 1), []);\r\n  const isEyeClean = useMemo(() => clarityIndex <= 6, [clarityIndex]);\r\n\r\n  return (\r\n    <Card className=\"w-full\">\r\n      <CardHeader>\r\n        <CardTitle className=\"flex items-center gap-2\">\r\n          <div className=\"h-8 w-8 rounded-lg bg-gradient-to-br from-purple-400 to-indigo-600 flex items-center justify-center\">\r\n            <Search className=\"h-4 w-4 text-white\" />\r\n          </div>\r\n          Diamond Clarity Interactive Chart\r\n        </CardTitle>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-6\">\r\n        <div className=\"flex flex-wrap gap-4 justify-between items-center\">\r\n          <div className=\"flex items-center gap-4\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Switch id=\"rotate\" checked={autoRotate} onCheckedChange={setAutoRotate} />\r\n              <Label htmlFor=\"rotate\" className=\"flex items-center gap-1\"><RotateCcw className=\"h-4 w-4\" />360 Rotation</Label>\r\n            </div>\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Switch id=\"microscope\" checked={microscopeMode} onCheckedChange={setMicroscopeMode} />\r\n              <Label htmlFor=\"microscope\" className=\"flex items-center gap-1\"><Search className=\"h-4 w-4\" />10 Loupe View</Label>\r\n            </div>\r\n          </div>\r\n          <Button variant=\"outline\" size=\"sm\" onClick={regenerateInclusions}><Sparkles className=\"h-4 w-4 mr-2\" />Randomize</Button>\r\n        </div>\r\n\r\n        <div className=\"grid lg:grid-cols-3 gap-6\">\r\n          <div className=\"flex flex-col items-center gap-2\">\r\n            <span className=\"text-xs font-medium text-muted-foreground\">FL - Flawless</span>\r\n            <div className=\"relative h-64 w-12 flex items-center justify-center\">\r\n              <div className=\"absolute w-3 h-full rounded-full\" style={{ background: `linear-gradient(to bottom, hsl(210, 100%, 95%), hsl(210, 40%, 70%), hsl(0, 0%, 50%))` }} />\r\n              <input type=\"range\" min=\"0\" max={CLARITY_GRADES.length - 1} step=\"0.1\" value={clarityIndex} onChange={(e) => setClarityIndex(parseFloat(e.target.value))} className=\"absolute h-full w-8 cursor-pointer opacity-0\" style={{ writingMode: \"vertical-lr\", direction: \"rtl\" }} />\r\n              <div className=\"absolute w-6 h-6 rounded-full bg-primary border-2 border-white shadow-lg pointer-events-none\" style={{ top: `${(clarityIndex / (CLARITY_GRADES.length - 1)) * 100}%`, transform: \"translateY(-50%)\" }} />\r\n            </div>\r\n            <span className=\"text-xs font-medium text-muted-foreground\">I3 - Included</span>\r\n            <div className=\"mt-4 space-y-1 text-center\">\r\n              {CLARITY_GRADES.map((g, i) => (\r\n                <TooltipProvider key={g.grade}><Tooltip><TooltipTrigger asChild>\r\n                  <button onClick={() => setClarityIndex(i)} className={`block w-full text-xs px-2 py-0.5 rounded transition-all ${Math.round(clarityIndex) === i ? \"bg-primary text-primary-foreground font-bold\" : \"hover:bg-muted text-muted-foreground\"}`}>{g.grade}</button>\r\n                </TooltipTrigger><TooltipContent side=\"right\"><p className=\"font-medium\">{g.name}</p><p className=\"text-xs\">{g.description}</p></TooltipContent></Tooltip></TooltipProvider>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"lg:col-span-2 relative\">\r\n            <Suspense fallback={<LoadingFallback />}>\r\n              <motion.div className=\"h-80 rounded-xl overflow-hidden\" animate={{ scale: microscopeMode ? 1.02 : 1 }} transition={{ duration: 0.3 }}>\r\n                <RealisticDiamond3D colorGrade=\"G\" clarityGrade={gradeToKey(currentGrade.grade)} autoRotate={autoRotate} microscopeMode={microscopeMode} viewMode=\"faceUp\" seed={seed} />\r\n              </motion.div>\r\n            </Suspense>\r\n            <div className=\"absolute top-2 left-2 flex gap-2\">\r\n              <Badge className=\"bg-primary shadow-lg\"><Sparkles className=\"h-3 w-3 mr-1\" />{currentGrade.grade}</Badge>\r\n              {microscopeMode && <Badge variant=\"outline\" className=\"bg-black/60 text-white border-white/30 backdrop-blur-sm\"><Search className=\"h-3 w-3 mr-1\" />10 Magnification</Badge>}\r\n            </div>\r\n            <div className=\"absolute top-2 right-2\">\r\n              <Badge variant=\"outline\" className={`shadow-lg backdrop-blur-sm ${isEyeClean ? \"bg-green-500/20 text-green-400 border-green-400/30\" : \"bg-orange-500/20 text-orange-400 border-orange-400/30\"}`}><Eye className=\"h-3 w-3 mr-1\" />{isEyeClean ? \"Eye-Clean\" : \"Visible Inclusions\"}</Badge>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <AnimatePresence mode=\"wait\">\r\n          <motion.div key={currentGrade.grade} initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -10 }} className=\"p-4 rounded-xl bg-muted/50 space-y-4\">\r\n            <div className=\"flex items-center justify-between flex-wrap gap-4\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"w-12 h-12 rounded-full bg-gradient-to-br from-purple-400 to-indigo-600 flex items-center justify-center text-white font-bold shadow-lg\">{currentGrade.grade}</div>\r\n                <div><h3 className=\"text-lg font-bold\">{currentGrade.name}</h3><p className=\"text-sm text-muted-foreground\">{currentGrade.rarity}</p></div>\r\n              </div>\r\n              <div className=\"flex gap-2\"><Badge variant=\"outline\">Inclusions: {currentGrade.inclusions}</Badge><Badge variant=\"outline\">Visibility: {Math.round(currentGrade.visibility * 100)}%</Badge></div>\r\n            </div>\r\n            <p className=\"text-sm text-muted-foreground flex items-start gap-2\"><Info className=\"h-4 w-4 text-primary mt-0.5 flex-shrink-0\" />{currentGrade.description}</p>\r\n          </motion.div>\r\n        </AnimatePresence>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default DiamondClarityModule;\r\n","import { useState, useCallback, useMemo } from \"react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Slider } from \"@/components/ui/slider\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Tabs, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { Scale, Ruler, CircleDot, Hand, Coins } from \"lucide-react\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\n\r\n// Diamond dimensions for round brilliant cut (in mm)\r\n// Based on standard proportions\r\nconst getCaratDimensions = (carat: number, shape: string) => {\r\n  // Round brilliant cut diameter formula\r\n  const roundDiameter = 6.5 * Math.pow(carat, 1 / 3);\r\n  const roundDepth = roundDiameter * 0.615; // Ideal depth percentage\r\n\r\n  switch (shape) {\r\n    case 'round':\r\n      return { width: roundDiameter, height: roundDiameter, depth: roundDepth };\r\n    case 'princess':\r\n      const princessSide = roundDiameter * 0.9;\r\n      return { width: princessSide, height: princessSide, depth: princessSide * 0.7 };\r\n    case 'oval':\r\n      return { width: roundDiameter * 0.75, height: roundDiameter * 1.1, depth: roundDepth * 0.9 };\r\n    case 'cushion':\r\n      return { width: roundDiameter * 0.92, height: roundDiameter * 1.05, depth: roundDepth };\r\n    case 'emerald':\r\n      return { width: roundDiameter * 0.8, height: roundDiameter * 1.15, depth: roundDepth * 0.95 };\r\n    case 'pear':\r\n      return { width: roundDiameter * 0.72, height: roundDiameter * 1.2, depth: roundDepth * 0.9 };\r\n    case 'marquise':\r\n      return { width: roundDiameter * 0.55, height: roundDiameter * 1.35, depth: roundDepth * 0.85 };\r\n    case 'radiant':\r\n      return { width: roundDiameter * 0.85, height: roundDiameter * 1.1, depth: roundDepth };\r\n    default:\r\n      return { width: roundDiameter, height: roundDiameter, depth: roundDepth };\r\n  }\r\n};\r\n\r\n// Price multipliers (approximate market values)\r\nconst getPriceMultiplier = (carat: number): number => {\r\n  if (carat <= 0.3) return 1500;\r\n  if (carat <= 0.5) return 2500;\r\n  if (carat <= 0.75) return 3500;\r\n  if (carat <= 1.0) return 5500;\r\n  if (carat <= 1.5) return 8000;\r\n  if (carat <= 2.0) return 12000;\r\n  if (carat <= 3.0) return 18000;\r\n  return 25000;\r\n};\r\n\r\nconst SHAPES = [\r\n  { value: 'round', label: 'Round Brilliant' },\r\n  { value: 'princess', label: 'Princess' },\r\n  { value: 'oval', label: 'Oval' },\r\n  { value: 'cushion', label: 'Cushion' },\r\n  { value: 'emerald', label: 'Emerald' },\r\n  { value: 'pear', label: 'Pear' },\r\n  { value: 'marquise', label: 'Marquise' },\r\n  { value: 'radiant', label: 'Radiant' },\r\n];\r\n\r\nconst CARAT_PRESETS = [0.25, 0.5, 0.75, 1.0, 1.5, 2.0, 3.0, 5.0];\r\n\r\n// Finger ring visualization component\r\nconst FingerComparison = ({ carat, shape }: { carat: number; shape: string }) => {\r\n  const dims = getCaratDimensions(carat, shape);\r\n  const scale = 8; // mm to pixels\r\n  \r\n  return (\r\n    <div className=\"relative flex items-center justify-center h-48 bg-gradient-to-b from-muted/50 to-muted/20 rounded-xl overflow-hidden\">\r\n      {/* Finger representation */}\r\n      <div className=\"relative\">\r\n        <div className=\"w-16 h-32 bg-gradient-to-b from-amber-200 to-amber-300 rounded-t-full rounded-b-lg relative\">\r\n          {/* Finger nail */}\r\n          <div className=\"absolute top-2 left-1/2 -translate-x-1/2 w-10 h-6 bg-pink-100 rounded-t-lg\" />\r\n          {/* Ring band */}\r\n          <div className=\"absolute top-20 left-1/2 -translate-x-1/2 w-[70px] h-4 bg-gradient-to-r from-yellow-400 via-yellow-300 to-yellow-400 rounded-sm shadow-md\" />\r\n          {/* Diamond on ring */}\r\n          <motion.div\r\n            key={`${carat}-${shape}`}\r\n            initial={{ scale: 0, opacity: 0 }}\r\n            animate={{ scale: 1, opacity: 1 }}\r\n            transition={{ type: \"spring\", duration: 0.5 }}\r\n            className=\"absolute top-16 left-1/2 -translate-x-1/2\"\r\n            style={{\r\n              width: dims.width * scale,\r\n              height: dims.height * scale,\r\n            }}\r\n          >\r\n            <div \r\n              className=\"w-full h-full bg-gradient-to-br from-white via-sky-100 to-blue-200 shadow-lg\"\r\n              style={{\r\n                clipPath: shape === 'round' ? 'circle(50%)' :\r\n                          shape === 'princess' || shape === 'cushion' || shape === 'radiant' ? 'polygon(5% 0%, 95% 0%, 100% 5%, 100% 95%, 95% 100%, 5% 100%, 0% 95%, 0% 5%)' :\r\n                          shape === 'oval' ? 'ellipse(50% 50%)' :\r\n                          shape === 'emerald' ? 'polygon(10% 0%, 90% 0%, 100% 15%, 100% 85%, 90% 100%, 10% 100%, 0% 85%, 0% 15%)' :\r\n                          shape === 'pear' ? 'polygon(50% 0%, 100% 60%, 85% 100%, 15% 100%, 0% 60%)' :\r\n                          shape === 'marquise' ? 'polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)' :\r\n                          'circle(50%)',\r\n                boxShadow: '0 4px 20px rgba(135, 206, 250, 0.5)',\r\n              }}\r\n            />\r\n          </motion.div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Size indicator */}\r\n      <div className=\"absolute bottom-2 left-1/2 -translate-x-1/2 text-xs text-muted-foreground\">\r\n        {dims.width.toFixed(1)}mm  {dims.height.toFixed(1)}mm\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Size comparison grid\r\nconst SizeComparisonGrid = ({ currentCarat, shape }: { currentCarat: number; shape: string }) => {\r\n  const carats = [0.5, 1.0, 1.5, 2.0, 3.0];\r\n  const baseScale = 12;\r\n  \r\n  return (\r\n    <div className=\"grid grid-cols-5 gap-4 p-4 bg-muted/30 rounded-xl\">\r\n      {carats.map((carat) => {\r\n        const dims = getCaratDimensions(carat, shape);\r\n        const isSelected = Math.abs(carat - currentCarat) < 0.1;\r\n        \r\n        return (\r\n          <motion.div\r\n            key={carat}\r\n            initial={{ opacity: 0, y: 10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ delay: carat * 0.1 }}\r\n            className={`flex flex-col items-center gap-2 p-3 rounded-lg transition-all ${\r\n              isSelected ? 'bg-primary/20 ring-2 ring-primary' : 'bg-background/50'\r\n            }`}\r\n          >\r\n            <div \r\n              className=\"flex items-center justify-center\"\r\n              style={{ height: 50 }}\r\n            >\r\n              <motion.div\r\n                animate={{ scale: isSelected ? 1.1 : 1 }}\r\n                className=\"bg-gradient-to-br from-white via-sky-100 to-blue-200 shadow-md\"\r\n                style={{\r\n                  width: Math.min(dims.width * baseScale / 2, 45),\r\n                  height: Math.min(dims.height * baseScale / 2, 45),\r\n                  borderRadius: shape === 'round' ? '50%' : shape === 'princess' ? '2px' : '30%',\r\n                }}\r\n              />\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className={`text-sm font-bold ${isSelected ? 'text-primary' : ''}`}>\r\n                {carat}ct\r\n              </div>\r\n              <div className=\"text-xs text-muted-foreground\">\r\n                {dims.width.toFixed(1)}mm\r\n              </div>\r\n            </div>\r\n          </motion.div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Coin comparison\r\nconst CoinComparison = ({ carat, shape }: { carat: number; shape: string }) => {\r\n  const dims = getCaratDimensions(carat, shape);\r\n  const diamondSize = Math.max(dims.width, dims.height);\r\n  \r\n  const coins = [\r\n    { name: 'US Dime', diameter: 17.91, color: 'from-gray-300 to-gray-400' },\r\n    { name: 'US Penny', diameter: 19.05, color: 'from-orange-400 to-orange-600' },\r\n    { name: 'US Quarter', diameter: 24.26, color: 'from-gray-300 to-gray-400' },\r\n  ];\r\n  \r\n  const scale = 5;\r\n  \r\n  return (\r\n    <div className=\"flex items-end justify-center gap-6 h-32 p-4 bg-muted/30 rounded-xl\">\r\n      {coins.map((coin) => (\r\n        <div key={coin.name} className=\"flex flex-col items-center gap-1\">\r\n          <div\r\n            className={`rounded-full bg-gradient-to-br ${coin.color} shadow-md border-2 border-white/20`}\r\n            style={{\r\n              width: coin.diameter * scale / 3,\r\n              height: coin.diameter * scale / 3,\r\n            }}\r\n          />\r\n          <span className=\"text-xs text-muted-foreground\">{coin.name}</span>\r\n          <span className=\"text-xs text-muted-foreground\">{coin.diameter}mm</span>\r\n        </div>\r\n      ))}\r\n      \r\n      <div className=\"flex flex-col items-center gap-1\">\r\n        <motion.div\r\n          key={`${carat}-${shape}`}\r\n          initial={{ scale: 0 }}\r\n          animate={{ scale: 1 }}\r\n          className=\"bg-gradient-to-br from-white via-sky-100 to-blue-300 shadow-lg border border-sky-200\"\r\n          style={{\r\n            width: diamondSize * scale / 3,\r\n            height: diamondSize * scale / 3,\r\n            borderRadius: shape === 'round' ? '50%' : '20%',\r\n          }}\r\n        />\r\n        <span className=\"text-xs font-semibold text-primary\">{carat}ct Diamond</span>\r\n        <span className=\"text-xs text-muted-foreground\">{diamondSize.toFixed(1)}mm</span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const DiamondCaratModule = () => {\r\n  const [carat, setCarat] = useState(1.0);\r\n  const [shape, setShape] = useState('round');\r\n  const [viewMode, setViewMode] = useState<'finger' | 'comparison' | 'coins'>('finger');\r\n\r\n  const handleSliderChange = useCallback((value: number[]) => {\r\n    setCarat(Number(value[0].toFixed(2)));\r\n  }, []);\r\n\r\n  const dimensions = useMemo(() => getCaratDimensions(carat, shape), [carat, shape]);\r\n  const estimatedPrice = useMemo(() => {\r\n    const multiplier = getPriceMultiplier(carat);\r\n    return Math.round(carat * multiplier);\r\n  }, [carat]);\r\n\r\n  return (\r\n    <Card className=\"border-2 border-primary/20 bg-gradient-to-br from-background via-background to-amber-500/5\">\r\n      <CardHeader className=\"pb-4\">\r\n        <div className=\"flex items-center justify-between flex-wrap gap-4\">\r\n          <CardTitle className=\"flex items-center gap-3\">\r\n            <div className=\"h-10 w-10 rounded-lg bg-gradient-to-br from-amber-500 to-orange-600 flex items-center justify-center\">\r\n              <Scale className=\"h-5 w-5 text-white\" />\r\n            </div>\r\n            Diamond Carat Weight\r\n          </CardTitle>\r\n          <div className=\"flex items-center gap-3 flex-wrap\">\r\n            <Select value={shape} onValueChange={setShape}>\r\n              <SelectTrigger className=\"w-[150px]\">\r\n                <SelectValue placeholder=\"Shape\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                {SHAPES.map((s) => (\r\n                  <SelectItem key={s.value} value={s.value}>\r\n                    {s.label}\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n            \r\n            <Tabs value={viewMode} onValueChange={(v) => setViewMode(v as typeof viewMode)}>\r\n              <TabsList className=\"bg-muted/50\">\r\n                <TabsTrigger value=\"finger\" className=\"text-xs\">\r\n                  <Hand className=\"h-3 w-3 mr-1\" />\r\n                  On Finger\r\n                </TabsTrigger>\r\n                <TabsTrigger value=\"comparison\" className=\"text-xs\">\r\n                  <CircleDot className=\"h-3 w-3 mr-1\" />\r\n                  Sizes\r\n                </TabsTrigger>\r\n                <TabsTrigger value=\"coins\" className=\"text-xs\">\r\n                  <Coins className=\"h-3 w-3 mr-1\" />\r\n                  vs Coins\r\n                </TabsTrigger>\r\n              </TabsList>\r\n            </Tabs>\r\n          </div>\r\n        </div>\r\n      </CardHeader>\r\n\r\n      <CardContent className=\"space-y-6\">\r\n        {/* Main Visualization */}\r\n        <div className=\"relative\">\r\n          <div className=\"absolute top-2 left-2 z-10\">\r\n            <Badge variant=\"outline\" className=\"bg-amber-500/20 text-amber-400 border-amber-500/30\">\r\n              {carat.toFixed(2)} Carat {SHAPES.find(s => s.value === shape)?.label}\r\n            </Badge>\r\n          </div>\r\n          \r\n          {viewMode === 'finger' && <FingerComparison carat={carat} shape={shape} />}\r\n          {viewMode === 'comparison' && <SizeComparisonGrid currentCarat={carat} shape={shape} />}\r\n          {viewMode === 'coins' && <CoinComparison carat={carat} shape={shape} />}\r\n        </div>\r\n\r\n        {/* Carat Slider */}\r\n        <div className=\"space-y-4 bg-muted/30 p-4 rounded-xl\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <span className=\"text-sm font-medium\">Carat Weight</span>\r\n            <div className=\"text-2xl font-bold bg-gradient-to-r from-amber-400 to-orange-400 bg-clip-text text-transparent\">\r\n              {carat.toFixed(2)} ct\r\n            </div>\r\n          </div>\r\n          \r\n          <Slider\r\n            value={[carat]}\r\n            onValueChange={handleSliderChange}\r\n            min={0.1}\r\n            max={5.0}\r\n            step={0.05}\r\n            className=\"w-full\"\r\n          />\r\n          \r\n          {/* Quick presets */}\r\n          <div className=\"flex flex-wrap gap-2 justify-center\">\r\n            {CARAT_PRESETS.map((preset) => (\r\n              <Button\r\n                key={preset}\r\n                variant={Math.abs(carat - preset) < 0.05 ? \"default\" : \"outline\"}\r\n                size=\"sm\"\r\n                onClick={() => setCarat(preset)}\r\n                className=\"text-xs\"\r\n              >\r\n                {preset}ct\r\n              </Button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Dimensions Display */}\r\n        <motion.div\r\n          key={`${carat}-${shape}`}\r\n          initial={{ opacity: 0 }}\r\n          animate={{ opacity: 1 }}\r\n          className=\"grid grid-cols-2 md:grid-cols-4 gap-4\"\r\n        >\r\n          <div className=\"p-4 rounded-lg bg-muted/50 border border-border/50 text-center\">\r\n            <Ruler className=\"h-5 w-5 mx-auto mb-2 text-amber-500\" />\r\n            <div className=\"text-xs text-muted-foreground\">Width</div>\r\n            <div className=\"text-lg font-bold\">{dimensions.width.toFixed(2)}mm</div>\r\n          </div>\r\n          \r\n          <div className=\"p-4 rounded-lg bg-muted/50 border border-border/50 text-center\">\r\n            <Ruler className=\"h-5 w-5 mx-auto mb-2 text-amber-500 rotate-90\" />\r\n            <div className=\"text-xs text-muted-foreground\">Length</div>\r\n            <div className=\"text-lg font-bold\">{dimensions.height.toFixed(2)}mm</div>\r\n          </div>\r\n          \r\n          <div className=\"p-4 rounded-lg bg-muted/50 border border-border/50 text-center\">\r\n            <Scale className=\"h-5 w-5 mx-auto mb-2 text-amber-500\" />\r\n            <div className=\"text-xs text-muted-foreground\">Depth</div>\r\n            <div className=\"text-lg font-bold\">{dimensions.depth.toFixed(2)}mm</div>\r\n          </div>\r\n          \r\n          <div className=\"p-4 rounded-lg bg-muted/50 border border-border/50 text-center\">\r\n            <Coins className=\"h-5 w-5 mx-auto mb-2 text-emerald-500\" />\r\n            <div className=\"text-xs text-muted-foreground\">Est. Price (G/VS2)</div>\r\n            <div className=\"text-lg font-bold text-emerald-500\">${estimatedPrice.toLocaleString()}</div>\r\n          </div>\r\n        </motion.div>\r\n\r\n        {/* Educational Info */}\r\n        <div className=\"grid md:grid-cols-2 gap-4 text-sm\">\r\n          <div className=\"p-4 rounded-lg bg-amber-500/10 border border-amber-500/20\">\r\n            <h4 className=\"font-semibold mb-2 text-amber-400\">Understanding Carat Weight</h4>\r\n            <ul className=\"text-muted-foreground space-y-1\">\r\n              <li> 1 carat = 200 milligrams (0.2 grams)</li>\r\n              <li> \"Points\" = carat  100 (e.g., 0.50ct = 50 points)</li>\r\n              <li> Price increases exponentially with carat weight</li>\r\n              <li> Visual size depends on cut quality and shape</li>\r\n            </ul>\r\n          </div>\r\n          \r\n          <div className=\"p-4 rounded-lg bg-orange-500/10 border border-orange-500/20\">\r\n            <h4 className=\"font-semibold mb-2 text-orange-400\">Size vs. Weight</h4>\r\n            <ul className=\"text-muted-foreground space-y-1\">\r\n              <li> A 2ct diamond is NOT 2 larger than 1ct</li>\r\n              <li> Elongated shapes appear larger face-up</li>\r\n              <li> Deep cuts hide weight, look smaller</li>\r\n              <li> Shallow cuts spread weight, may lack brilliance</li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n","import { useState, useCallback, useMemo, Suspense, lazy } from \"react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Slider } from \"@/components/ui/slider\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Sparkles, Sun, Zap, RotateCcw, ArrowUp, ArrowDown } from \"lucide-react\";\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"@/components/ui/tooltip\";\r\n\r\nconst RealisticDiamond3D = lazy(() => import(\"./RealisticDiamond3D\"));\r\n\r\ninterface CutParameters {\r\n  tablePercentage: number;\r\n  crownAngle: number;\r\n  pavilionAngle: number;\r\n  depthPercentage: number;\r\n  girdleThickness: number;\r\n}\r\n\r\ninterface CutGradeResult {\r\n  grade: 'Excellent' | 'Very Good' | 'Good' | 'Fair' | 'Poor';\r\n  brilliance: number;\r\n  fire: number;\r\n  scintillation: number;\r\n  description: string;\r\n}\r\n\r\nconst IDEAL_CUT: CutParameters = {\r\n  tablePercentage: 57,\r\n  crownAngle: 34.5,\r\n  pavilionAngle: 40.8,\r\n  depthPercentage: 62,\r\n  girdleThickness: 3.5,\r\n};\r\n\r\nconst CUT_GRADE_PRESETS = {\r\n  'Excellent': {\r\n    tablePercentage: 57,\r\n    crownAngle: 34.5,\r\n    pavilionAngle: 40.8,\r\n    depthPercentage: 62,\r\n    girdleThickness: 3.5,\r\n  },\r\n  'Very Good': {\r\n    tablePercentage: 60,\r\n    crownAngle: 33,\r\n    pavilionAngle: 41.5,\r\n    depthPercentage: 63,\r\n    girdleThickness: 4,\r\n  },\r\n  'Good': {\r\n    tablePercentage: 64,\r\n    crownAngle: 31,\r\n    pavilionAngle: 42.5,\r\n    depthPercentage: 65,\r\n    girdleThickness: 5,\r\n  },\r\n  'Fair': {\r\n    tablePercentage: 68,\r\n    crownAngle: 28,\r\n    pavilionAngle: 44,\r\n    depthPercentage: 68,\r\n    girdleThickness: 6,\r\n  },\r\n  'Poor': {\r\n    tablePercentage: 72,\r\n    crownAngle: 25,\r\n    pavilionAngle: 46,\r\n    depthPercentage: 72,\r\n    girdleThickness: 8,\r\n  },\r\n};\r\n\r\nconst calculateCutGrade = (params: CutParameters): CutGradeResult => {\r\n  // Calculate deviations from ideal\r\n  const tableDeviation = Math.abs(params.tablePercentage - IDEAL_CUT.tablePercentage);\r\n  const crownDeviation = Math.abs(params.crownAngle - IDEAL_CUT.crownAngle);\r\n  const pavilionDeviation = Math.abs(params.pavilionAngle - IDEAL_CUT.pavilionAngle);\r\n  const depthDeviation = Math.abs(params.depthPercentage - IDEAL_CUT.depthPercentage);\r\n\r\n  // Calculate performance metrics (0-100)\r\n  const brilliance = Math.max(0, 100 - (tableDeviation * 2) - (depthDeviation * 1.5) - (pavilionDeviation * 3));\r\n  const fire = Math.max(0, 100 - (crownDeviation * 4) - (tableDeviation * 1.5) - (pavilionDeviation * 2));\r\n  const scintillation = Math.max(0, 100 - (tableDeviation * 1.5) - (crownDeviation * 2) - (pavilionDeviation * 2));\r\n\r\n  // Determine grade\r\n  const avgScore = (brilliance + fire + scintillation) / 3;\r\n  let grade: CutGradeResult['grade'];\r\n  let description: string;\r\n\r\n  if (avgScore >= 90) {\r\n    grade = 'Excellent';\r\n    description = 'Maximum light return with exceptional brilliance, fire, and scintillation. This represents the top tier of cut quality.';\r\n  } else if (avgScore >= 75) {\r\n    grade = 'Very Good';\r\n    description = 'Superior light performance with minor deviations from ideal. Excellent value choice.';\r\n  } else if (avgScore >= 60) {\r\n    grade = 'Good';\r\n    description = 'Good light performance. Some light leakage but still attractive.';\r\n  } else if (avgScore >= 45) {\r\n    grade = 'Fair';\r\n    description = 'Noticeable light leakage and reduced brilliance. Budget-conscious option.';\r\n  } else {\r\n    grade = 'Poor';\r\n    description = 'Significant light leakage. Diamond appears dull compared to better cuts.';\r\n  }\r\n\r\n  return { grade, brilliance, fire, scintillation, description };\r\n};\r\n\r\nconst getGradeColor = (grade: CutGradeResult['grade']): string => {\r\n  switch (grade) {\r\n    case 'Excellent': return 'bg-emerald-500/20 text-emerald-400 border-emerald-500/30';\r\n    case 'Very Good': return 'bg-sky-500/20 text-sky-400 border-sky-500/30';\r\n    case 'Good': return 'bg-amber-500/20 text-amber-400 border-amber-500/30';\r\n    case 'Fair': return 'bg-orange-500/20 text-orange-400 border-orange-500/30';\r\n    case 'Poor': return 'bg-red-500/20 text-red-400 border-red-500/30';\r\n  }\r\n};\r\n\r\n// Light path visualization\r\nconst LightPathVisualization = ({ params }: { params: CutParameters }) => {\r\n  const grade = calculateCutGrade(params);\r\n  const isIdeal = grade.grade === 'Excellent';\r\n  const isDeep = params.depthPercentage > 65;\r\n  const isShallow = params.depthPercentage < 58;\r\n\r\n  return (\r\n    <div className=\"relative h-64 bg-gradient-to-b from-muted/50 to-muted/20 rounded-xl overflow-hidden\">\r\n      {/* Diamond cross-section */}\r\n      <svg viewBox=\"0 0 200 150\" className=\"w-full h-full\">\r\n        {/* Incoming light rays */}\r\n        <g stroke=\"#fbbf24\" strokeWidth=\"1.5\" opacity=\"0.8\">\r\n          <motion.line\r\n            x1=\"70\" y1=\"0\" x2=\"100\" y2=\"40\"\r\n            initial={{ pathLength: 0 }}\r\n            animate={{ pathLength: 1 }}\r\n            transition={{ duration: 0.5, repeat: Infinity, repeatDelay: 1 }}\r\n          />\r\n          <motion.line\r\n            x1=\"100\" y1=\"0\" x2=\"100\" y2=\"40\"\r\n            initial={{ pathLength: 0 }}\r\n            animate={{ pathLength: 1 }}\r\n            transition={{ duration: 0.5, delay: 0.1, repeat: Infinity, repeatDelay: 1 }}\r\n          />\r\n          <motion.line\r\n            x1=\"130\" y1=\"0\" x2=\"100\" y2=\"40\"\r\n            initial={{ pathLength: 0 }}\r\n            animate={{ pathLength: 1 }}\r\n            transition={{ duration: 0.5, delay: 0.2, repeat: Infinity, repeatDelay: 1 }}\r\n          />\r\n        </g>\r\n\r\n        {/* Diamond outline */}\r\n        <polygon\r\n          points={`\r\n            ${100 - params.tablePercentage * 0.5},40\r\n            ${100 + params.tablePercentage * 0.5},40\r\n            170,55\r\n            100,${55 + params.depthPercentage}\r\n            30,55\r\n          `}\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          strokeWidth=\"2\"\r\n          className=\"text-primary/50\"\r\n        />\r\n\r\n        {/* Light behavior inside diamond */}\r\n        {isIdeal && (\r\n          <g stroke=\"#22c55e\" strokeWidth=\"1.5\">\r\n            <motion.path\r\n              d=\"M100,40 L130,70 L100,100 L100,40\"\r\n              fill=\"none\"\r\n              initial={{ pathLength: 0 }}\r\n              animate={{ pathLength: 1 }}\r\n              transition={{ duration: 1, delay: 0.5, repeat: Infinity, repeatDelay: 1 }}\r\n            />\r\n            <motion.line\r\n              x1=\"100\" y1=\"40\" x2=\"80\" y2=\"10\"\r\n              initial={{ pathLength: 0 }}\r\n              animate={{ pathLength: 1 }}\r\n              transition={{ duration: 0.3, delay: 1.5, repeat: Infinity, repeatDelay: 1.2 }}\r\n            />\r\n            <motion.line\r\n              x1=\"100\" y1=\"40\" x2=\"120\" y2=\"10\"\r\n              initial={{ pathLength: 0 }}\r\n              animate={{ pathLength: 1 }}\r\n              transition={{ duration: 0.3, delay: 1.6, repeat: Infinity, repeatDelay: 1.2 }}\r\n            />\r\n          </g>\r\n        )}\r\n\r\n        {isDeep && (\r\n          <g stroke=\"#ef4444\" strokeWidth=\"1.5\">\r\n            <motion.path\r\n              d=\"M100,40 L130,80 L100,130 L100,150\"\r\n              fill=\"none\"\r\n              initial={{ pathLength: 0 }}\r\n              animate={{ pathLength: 1 }}\r\n              transition={{ duration: 1.2, delay: 0.5, repeat: Infinity, repeatDelay: 1 }}\r\n            />\r\n            {/* Light leaking through sides */}\r\n            <motion.line\r\n              x1=\"130\" y1=\"80\" x2=\"170\" y2=\"100\"\r\n              initial={{ pathLength: 0 }}\r\n              animate={{ pathLength: 1 }}\r\n              transition={{ duration: 0.4, delay: 1, repeat: Infinity, repeatDelay: 1.3 }}\r\n            />\r\n          </g>\r\n        )}\r\n\r\n        {isShallow && (\r\n          <g stroke=\"#ef4444\" strokeWidth=\"1.5\">\r\n            <motion.path\r\n              d=\"M100,40 L110,50 L100,55 L90,50 L100,40\"\r\n              fill=\"none\"\r\n              initial={{ pathLength: 0 }}\r\n              animate={{ pathLength: 1 }}\r\n              transition={{ duration: 0.5, delay: 0.5, repeat: Infinity, repeatDelay: 1 }}\r\n            />\r\n            {/* Light leaking through bottom */}\r\n            <motion.line\r\n              x1=\"100\" y1=\"55\" x2=\"100\" y2=\"130\"\r\n              initial={{ pathLength: 0 }}\r\n              animate={{ pathLength: 1 }}\r\n              transition={{ duration: 0.4, delay: 0.8, repeat: Infinity, repeatDelay: 1.3 }}\r\n            />\r\n          </g>\r\n        )}\r\n\r\n        {/* Labels */}\r\n        <text x=\"100\" y=\"145\" textAnchor=\"middle\" className=\"fill-muted-foreground text-xs\">\r\n          {isIdeal ? ' Light returns through crown' : isDeep ? ' Light leaks through sides' : ' Light leaks through bottom'}\r\n        </text>\r\n      </svg>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Performance meter component\r\nconst PerformanceMeter = ({ label, value, icon: Icon, color }: { label: string; value: number; icon: React.ElementType; color: string }) => (\r\n  <div className=\"space-y-2\">\r\n    <div className=\"flex items-center justify-between\">\r\n      <div className=\"flex items-center gap-2\">\r\n        <Icon className={`h-4 w-4 ${color}`} />\r\n        <span className=\"text-sm font-medium\">{label}</span>\r\n      </div>\r\n      <span className={`text-sm font-bold ${color}`}>{value.toFixed(0)}%</span>\r\n    </div>\r\n    <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\r\n      <motion.div\r\n        className={`h-full bg-gradient-to-r ${\r\n          value >= 80 ? 'from-emerald-500 to-emerald-400' :\r\n          value >= 60 ? 'from-amber-500 to-amber-400' :\r\n          'from-red-500 to-red-400'\r\n        }`}\r\n        initial={{ width: 0 }}\r\n        animate={{ width: `${value}%` }}\r\n        transition={{ duration: 0.5, ease: \"easeOut\" }}\r\n      />\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport const DiamondCutModule = () => {\r\n  const [params, setParams] = useState<CutParameters>(IDEAL_CUT);\r\n  const [autoRotate, setAutoRotate] = useState(true);\r\n\r\n  const gradeResult = useMemo(() => calculateCutGrade(params), [params]);\r\n\r\n  const handleParamChange = useCallback((key: keyof CutParameters, value: number) => {\r\n    setParams(prev => ({ ...prev, [key]: value }));\r\n  }, []);\r\n\r\n  const applyPreset = useCallback((preset: keyof typeof CUT_GRADE_PRESETS) => {\r\n    setParams(CUT_GRADE_PRESETS[preset]);\r\n  }, []);\r\n\r\n  return (\r\n    <Card className=\"border-2 border-primary/20 bg-gradient-to-br from-background via-background to-emerald-500/5\">\r\n      <CardHeader className=\"pb-4\">\r\n        <div className=\"flex items-center justify-between flex-wrap gap-4\">\r\n          <CardTitle className=\"flex items-center gap-3\">\r\n            <div className=\"h-10 w-10 rounded-lg bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center\">\r\n              <Sparkles className=\"h-5 w-5 text-white\" />\r\n            </div>\r\n            Diamond Cut Quality\r\n          </CardTitle>\r\n          <div className=\"flex items-center gap-2 flex-wrap\">\r\n            {(Object.keys(CUT_GRADE_PRESETS) as Array<keyof typeof CUT_GRADE_PRESETS>).map((preset) => (\r\n              <Button\r\n                key={preset}\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => applyPreset(preset)}\r\n                className={`text-xs ${gradeResult.grade === preset ? 'ring-2 ring-primary' : ''}`}\r\n              >\r\n                {preset}\r\n              </Button>\r\n            ))}\r\n            <Button\r\n              variant={autoRotate ? \"default\" : \"outline\"}\r\n              size=\"sm\"\r\n              onClick={() => setAutoRotate(!autoRotate)}\r\n            >\r\n              <RotateCcw className={`h-3 w-3 ${autoRotate ? 'animate-spin' : ''}`} />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </CardHeader>\r\n\r\n      <CardContent className=\"space-y-6\">\r\n        {/* Grade Badge and 3D View */}\r\n        <div className=\"grid md:grid-cols-2 gap-6\">\r\n          <div className=\"relative\">\r\n            <div className=\"absolute top-2 left-2 z-10\">\r\n              <Badge variant=\"outline\" className={getGradeColor(gradeResult.grade)}>\r\n                {gradeResult.grade} Cut\r\n              </Badge>\r\n            </div>\r\n            <div className=\"h-[300px] rounded-xl overflow-hidden border-2 border-primary/30\">\r\n              <Suspense fallback={<div className=\"h-full flex items-center justify-center bg-muted/50\">Loading...</div>}>\r\n                <RealisticDiamond3D\r\n                  colorGrade=\"G\"\r\n                  clarityGrade=\"VVS1\"\r\n                  autoRotate={autoRotate}\r\n                  viewMode=\"faceUp\"\r\n                  showControls={true}\r\n                />\r\n              </Suspense>\r\n            </div>\r\n          </div>\r\n          \r\n          <LightPathVisualization params={params} />\r\n        </div>\r\n\r\n        {/* Performance Metrics */}\r\n        <div className=\"grid md:grid-cols-3 gap-6 p-4 bg-muted/30 rounded-xl\">\r\n          <PerformanceMeter\r\n            label=\"Brilliance\"\r\n            value={gradeResult.brilliance}\r\n            icon={Sun}\r\n            color=\"text-amber-400\"\r\n          />\r\n          <PerformanceMeter\r\n            label=\"Fire\"\r\n            value={gradeResult.fire}\r\n            icon={Sparkles}\r\n            color=\"text-red-400\"\r\n          />\r\n          <PerformanceMeter\r\n            label=\"Scintillation\"\r\n            value={gradeResult.scintillation}\r\n            icon={Zap}\r\n            color=\"text-sky-400\"\r\n          />\r\n        </div>\r\n\r\n        {/* Cut Parameters */}\r\n        <div className=\"space-y-4\">\r\n          <h4 className=\"font-semibold flex items-center gap-2\">\r\n            <ArrowUp className=\"h-4 w-4\" />\r\n            Adjust Cut Proportions\r\n          </h4>\r\n          \r\n          <div className=\"grid md:grid-cols-2 gap-6\">\r\n            <TooltipProvider>\r\n              {/* Table Percentage */}\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between\">\r\n                  <Tooltip>\r\n                    <TooltipTrigger className=\"text-sm font-medium cursor-help underline decoration-dotted\">\r\n                      Table %\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>\r\n                      <p className=\"max-w-xs\">The table is the flat top facet. Ideal range: 54-58%</p>\r\n                    </TooltipContent>\r\n                  </Tooltip>\r\n                  <span className=\"text-sm text-primary font-bold\">{params.tablePercentage}%</span>\r\n                </div>\r\n                <Slider\r\n                  value={[params.tablePercentage]}\r\n                  onValueChange={([v]) => handleParamChange('tablePercentage', v)}\r\n                  min={50}\r\n                  max={75}\r\n                  step={0.5}\r\n                />\r\n                <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n                  <span>Small (50%)</span>\r\n                  <span className=\"text-emerald-400\">Ideal</span>\r\n                  <span>Large (75%)</span>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Crown Angle */}\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between\">\r\n                  <Tooltip>\r\n                    <TooltipTrigger className=\"text-sm font-medium cursor-help underline decoration-dotted\">\r\n                      Crown Angle\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>\r\n                      <p className=\"max-w-xs\">Angle of crown facets. Affects fire. Ideal: 34-35</p>\r\n                    </TooltipContent>\r\n                  </Tooltip>\r\n                  <span className=\"text-sm text-primary font-bold\">{params.crownAngle}</span>\r\n                </div>\r\n                <Slider\r\n                  value={[params.crownAngle]}\r\n                  onValueChange={([v]) => handleParamChange('crownAngle', v)}\r\n                  min={22}\r\n                  max={40}\r\n                  step={0.5}\r\n                />\r\n                <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n                  <span>Flat (22)</span>\r\n                  <span className=\"text-emerald-400\">Ideal</span>\r\n                  <span>Steep (40)</span>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Pavilion Angle */}\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between\">\r\n                  <Tooltip>\r\n                    <TooltipTrigger className=\"text-sm font-medium cursor-help underline decoration-dotted\">\r\n                      Pavilion Angle\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>\r\n                      <p className=\"max-w-xs\">Angle of pavilion facets. Critical for brilliance. Ideal: 40.6-41</p>\r\n                    </TooltipContent>\r\n                  </Tooltip>\r\n                  <span className=\"text-sm text-primary font-bold\">{params.pavilionAngle}</span>\r\n                </div>\r\n                <Slider\r\n                  value={[params.pavilionAngle]}\r\n                  onValueChange={([v]) => handleParamChange('pavilionAngle', v)}\r\n                  min={38}\r\n                  max={48}\r\n                  step={0.2}\r\n                />\r\n                <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n                  <span>Shallow (38)</span>\r\n                  <span className=\"text-emerald-400\">Ideal</span>\r\n                  <span>Deep (48)</span>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Depth Percentage */}\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between\">\r\n                  <Tooltip>\r\n                    <TooltipTrigger className=\"text-sm font-medium cursor-help underline decoration-dotted\">\r\n                      Depth %\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>\r\n                      <p className=\"max-w-xs\">Total depth relative to diameter. Ideal: 59-63%</p>\r\n                    </TooltipContent>\r\n                  </Tooltip>\r\n                  <span className=\"text-sm text-primary font-bold\">{params.depthPercentage}%</span>\r\n                </div>\r\n                <Slider\r\n                  value={[params.depthPercentage]}\r\n                  onValueChange={([v]) => handleParamChange('depthPercentage', v)}\r\n                  min={55}\r\n                  max={75}\r\n                  step={0.5}\r\n                />\r\n                <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n                  <span>Shallow</span>\r\n                  <span className=\"text-emerald-400\">Ideal</span>\r\n                  <span>Deep</span>\r\n                </div>\r\n              </div>\r\n            </TooltipProvider>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Grade Description */}\r\n        <motion.div\r\n          key={gradeResult.grade}\r\n          initial={{ opacity: 0, y: 10 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          className=\"p-4 rounded-lg bg-muted/50 border border-border/50\"\r\n        >\r\n          <p className=\"text-sm text-muted-foreground\">{gradeResult.description}</p>\r\n        </motion.div>\r\n\r\n        {/* Educational Cards */}\r\n        <div className=\"grid md:grid-cols-3 gap-4 text-sm\">\r\n          <div className=\"p-4 rounded-lg bg-amber-500/10 border border-amber-500/20\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <Sun className=\"h-4 w-4 text-amber-400\" />\r\n              <h4 className=\"font-semibold text-amber-400\">Brilliance</h4>\r\n            </div>\r\n            <p className=\"text-muted-foreground text-xs\">\r\n              White light reflected from the diamond. Affected by table size and pavilion angle.\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"p-4 rounded-lg bg-red-500/10 border border-red-500/20\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <Sparkles className=\"h-4 w-4 text-red-400\" />\r\n              <h4 className=\"font-semibold text-red-400\">Fire</h4>\r\n            </div>\r\n            <p className=\"text-muted-foreground text-xs\">\r\n              Rainbow spectral colors from light dispersion. Enhanced by proper crown angle.\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"p-4 rounded-lg bg-sky-500/10 border border-sky-500/20\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <Zap className=\"h-4 w-4 text-sky-400\" />\r\n              <h4 className=\"font-semibold text-sky-400\">Scintillation</h4>\r\n            </div>\r\n            <p className=\"text-muted-foreground text-xs\">\r\n              Sparkle pattern when diamond moves. Balance of light and dark areas.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n","import { useState, useCallback, useMemo, Suspense, lazy } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Progress } from \"@/components/ui/progress\";\r\nimport { \r\n  GraduationCap, \r\n  CheckCircle2, \r\n  XCircle, \r\n  RotateCcw, \r\n  Trophy, \r\n  Star,\r\n  Palette,\r\n  Search,\r\n  ArrowRight,\r\n  Lightbulb\r\n} from \"lucide-react\";\r\n\r\nconst RealisticDiamond3D = lazy(() => import(\"./RealisticDiamond3D\"));\r\n\r\ntype QuizType = 'color' | 'clarity' | 'mixed';\r\n\r\ninterface Question {\r\n  id: number;\r\n  type: 'color' | 'clarity';\r\n  correctAnswer: string;\r\n  options: string[];\r\n  seed: number;\r\n}\r\n\r\nconst COLOR_GRADES = ['D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M'] as const;\r\nconst CLARITY_GRADES = ['FL', 'IF', 'VVS1', 'VVS2', 'VS1', 'VS2', 'SI1', 'SI2', 'I1', 'I2'] as const;\r\n\r\nconst generateQuestion = (type: 'color' | 'clarity', id: number): Question => {\r\n  const seed = Math.floor(Math.random() * 100000);\r\n  \r\n  if (type === 'color') {\r\n    const correctIdx = Math.floor(Math.random() * COLOR_GRADES.length);\r\n    const correct = COLOR_GRADES[correctIdx];\r\n    \r\n    // Generate nearby options\r\n    const options = new Set<string>([correct]);\r\n    while (options.size < 4) {\r\n      const offset = Math.floor(Math.random() * 5) - 2;\r\n      const idx = Math.max(0, Math.min(COLOR_GRADES.length - 1, correctIdx + offset));\r\n      options.add(COLOR_GRADES[idx]);\r\n    }\r\n    \r\n    return {\r\n      id,\r\n      type: 'color',\r\n      correctAnswer: correct,\r\n      options: Array.from(options).sort(() => Math.random() - 0.5),\r\n      seed,\r\n    };\r\n  } else {\r\n    const correctIdx = Math.floor(Math.random() * CLARITY_GRADES.length);\r\n    const correct = CLARITY_GRADES[correctIdx];\r\n    \r\n    const options = new Set<string>([correct]);\r\n    while (options.size < 4) {\r\n      const offset = Math.floor(Math.random() * 3) - 1;\r\n      const idx = Math.max(0, Math.min(CLARITY_GRADES.length - 1, correctIdx + offset));\r\n      options.add(CLARITY_GRADES[idx]);\r\n    }\r\n    \r\n    return {\r\n      id,\r\n      type: 'clarity',\r\n      correctAnswer: correct,\r\n      options: Array.from(options).sort(() => Math.random() - 0.5),\r\n      seed,\r\n    };\r\n  }\r\n};\r\n\r\nconst generateQuiz = (type: QuizType, count: number = 10): Question[] => {\r\n  const questions: Question[] = [];\r\n  for (let i = 0; i < count; i++) {\r\n    if (type === 'mixed') {\r\n      questions.push(generateQuestion(Math.random() > 0.5 ? 'color' : 'clarity', i));\r\n    } else {\r\n      questions.push(generateQuestion(type, i));\r\n    }\r\n  }\r\n  return questions;\r\n};\r\n\r\nconst getGradeHint = (type: 'color' | 'clarity', grade: string): string => {\r\n  if (type === 'color') {\r\n    const idx = COLOR_GRADES.indexOf(grade as typeof COLOR_GRADES[number]);\r\n    if (idx <= 2) return 'Look for absence of any warmth - ice white appearance';\r\n    if (idx <= 5) return 'Check for very subtle warmth compared to colorless';\r\n    if (idx <= 7) return 'Notice the faint yellow/warm tint becoming visible';\r\n    return 'Observe the noticeable yellow coloration';\r\n  } else {\r\n    const idx = CLARITY_GRADES.indexOf(grade as typeof CLARITY_GRADES[number]);\r\n    if (idx <= 1) return 'No inclusions visible - perfectly clean';\r\n    if (idx <= 3) return 'Extremely tiny inclusions, very hard to spot';\r\n    if (idx <= 5) return 'Minor inclusions visible with close inspection';\r\n    if (idx <= 7) return 'Noticeable inclusions, check center and edges';\r\n    return 'Obvious inclusions affecting the diamond appearance';\r\n  }\r\n};\r\n\r\ninterface QuizResultsProps {\r\n  score: number;\r\n  total: number;\r\n  onRestart: () => void;\r\n  onNewQuiz: () => void;\r\n}\r\n\r\nconst QuizResults = ({ score, total, onRestart, onNewQuiz }: QuizResultsProps) => {\r\n  const percentage = (score / total) * 100;\r\n  const grade = percentage >= 90 ? 'Expert' : percentage >= 70 ? 'Proficient' : percentage >= 50 ? 'Learning' : 'Beginner';\r\n  const gradeColor = percentage >= 90 ? 'text-emerald-400' : percentage >= 70 ? 'text-sky-400' : percentage >= 50 ? 'text-amber-400' : 'text-red-400';\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0, scale: 0.9 }}\r\n      animate={{ opacity: 1, scale: 1 }}\r\n      className=\"text-center space-y-6 py-8\"\r\n    >\r\n      <div className=\"flex justify-center\">\r\n        <div className=\"relative\">\r\n          <Trophy className={`h-24 w-24 ${gradeColor}`} />\r\n          {percentage >= 70 && (\r\n            <motion.div\r\n              initial={{ scale: 0 }}\r\n              animate={{ scale: 1 }}\r\n              transition={{ delay: 0.3, type: \"spring\" }}\r\n              className=\"absolute -top-2 -right-2\"\r\n            >\r\n              <Star className=\"h-8 w-8 text-amber-400 fill-amber-400\" />\r\n            </motion.div>\r\n          )}\r\n        </div>\r\n      </div>\r\n      \r\n      <div>\r\n        <h3 className=\"text-3xl font-bold\">{score} / {total}</h3>\r\n        <p className={`text-xl font-semibold ${gradeColor}`}>{grade} Level</p>\r\n        <p className=\"text-muted-foreground mt-2\">\r\n          {percentage >= 90 ? 'Outstanding! You have excellent diamond grading skills!' :\r\n           percentage >= 70 ? 'Great job! You have a solid understanding of diamond grading.' :\r\n           percentage >= 50 ? 'Good effort! Keep practicing to improve your skills.' :\r\n           'Keep learning! Practice makes perfect in diamond grading.'}\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"w-full max-w-md mx-auto\">\r\n        <Progress value={percentage} className=\"h-3\" />\r\n      </div>\r\n\r\n      <div className=\"flex gap-4 justify-center\">\r\n        <Button variant=\"outline\" onClick={onRestart}>\r\n          <RotateCcw className=\"h-4 w-4 mr-2\" />\r\n          Retry Same Quiz\r\n        </Button>\r\n        <Button onClick={onNewQuiz}>\r\n          <ArrowRight className=\"h-4 w-4 mr-2\" />\r\n          New Quiz\r\n        </Button>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nexport const DiamondGradingQuiz = () => {\r\n  const [quizType, setQuizType] = useState<QuizType | null>(null);\r\n  const [questions, setQuestions] = useState<Question[]>([]);\r\n  const [currentIndex, setCurrentIndex] = useState(0);\r\n  const [selectedAnswer, setSelectedAnswer] = useState<string | null>(null);\r\n  const [showResult, setShowResult] = useState(false);\r\n  const [score, setScore] = useState(0);\r\n  const [showHint, setShowHint] = useState(false);\r\n  const [quizComplete, setQuizComplete] = useState(false);\r\n\r\n  const currentQuestion = questions[currentIndex];\r\n  const progress = questions.length > 0 ? ((currentIndex + 1) / questions.length) * 100 : 0;\r\n\r\n  const startQuiz = useCallback((type: QuizType) => {\r\n    setQuizType(type);\r\n    setQuestions(generateQuiz(type, 10));\r\n    setCurrentIndex(0);\r\n    setScore(0);\r\n    setSelectedAnswer(null);\r\n    setShowResult(false);\r\n    setShowHint(false);\r\n    setQuizComplete(false);\r\n  }, []);\r\n\r\n  const handleAnswer = useCallback((answer: string) => {\r\n    if (showResult) return;\r\n    \r\n    setSelectedAnswer(answer);\r\n    setShowResult(true);\r\n    \r\n    if (answer === currentQuestion.correctAnswer) {\r\n      setScore(s => s + 1);\r\n    }\r\n  }, [showResult, currentQuestion]);\r\n\r\n  const nextQuestion = useCallback(() => {\r\n    if (currentIndex < questions.length - 1) {\r\n      setCurrentIndex(i => i + 1);\r\n      setSelectedAnswer(null);\r\n      setShowResult(false);\r\n      setShowHint(false);\r\n    } else {\r\n      setQuizComplete(true);\r\n    }\r\n  }, [currentIndex, questions.length]);\r\n\r\n  const resetQuiz = useCallback(() => {\r\n    setQuizType(null);\r\n    setQuestions([]);\r\n    setCurrentIndex(0);\r\n    setScore(0);\r\n    setSelectedAnswer(null);\r\n    setShowResult(false);\r\n    setShowHint(false);\r\n    setQuizComplete(false);\r\n  }, []);\r\n\r\n  const restartSameQuiz = useCallback(() => {\r\n    setCurrentIndex(0);\r\n    setScore(0);\r\n    setSelectedAnswer(null);\r\n    setShowResult(false);\r\n    setShowHint(false);\r\n    setQuizComplete(false);\r\n  }, []);\r\n\r\n  // Quiz type selection\r\n  if (!quizType) {\r\n    return (\r\n      <Card className=\"border-2 border-primary/20 bg-gradient-to-br from-background via-background to-violet-500/5\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-3 text-center justify-center\">\r\n            <div className=\"h-10 w-10 rounded-lg bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center\">\r\n              <GraduationCap className=\"h-5 w-5 text-white\" />\r\n            </div>\r\n            Diamond Grading Quiz\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <p className=\"text-center text-muted-foreground\">\r\n            Test your diamond grading skills! Identify the correct grade based on the 3D diamond visualization.\r\n          </p>\r\n          \r\n          <div className=\"grid md:grid-cols-3 gap-4\">\r\n            <motion.button\r\n              whileHover={{ scale: 1.02 }}\r\n              whileTap={{ scale: 0.98 }}\r\n              onClick={() => startQuiz('color')}\r\n              className=\"p-6 rounded-xl bg-gradient-to-br from-sky-500/20 to-blue-500/10 border-2 border-sky-500/30 hover:border-sky-400/50 transition-all\"\r\n            >\r\n              <Palette className=\"h-10 w-10 text-sky-400 mx-auto mb-3\" />\r\n              <h3 className=\"font-semibold text-lg mb-1\">Color Grading</h3>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Identify diamond color grades from D to M\r\n              </p>\r\n            </motion.button>\r\n\r\n            <motion.button\r\n              whileHover={{ scale: 1.02 }}\r\n              whileTap={{ scale: 0.98 }}\r\n              onClick={() => startQuiz('clarity')}\r\n              className=\"p-6 rounded-xl bg-gradient-to-br from-purple-500/20 to-indigo-500/10 border-2 border-purple-500/30 hover:border-purple-400/50 transition-all\"\r\n            >\r\n              <Search className=\"h-10 w-10 text-purple-400 mx-auto mb-3\" />\r\n              <h3 className=\"font-semibold text-lg mb-1\">Clarity Grading</h3>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Identify diamond clarity grades from FL to I2\r\n              </p>\r\n            </motion.button>\r\n\r\n            <motion.button\r\n              whileHover={{ scale: 1.02 }}\r\n              whileTap={{ scale: 0.98 }}\r\n              onClick={() => startQuiz('mixed')}\r\n              className=\"p-6 rounded-xl bg-gradient-to-br from-amber-500/20 to-orange-500/10 border-2 border-amber-500/30 hover:border-amber-400/50 transition-all\"\r\n            >\r\n              <Trophy className=\"h-10 w-10 text-amber-400 mx-auto mb-3\" />\r\n              <h3 className=\"font-semibold text-lg mb-1\">Mixed Challenge</h3>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Test both color and clarity grading skills\r\n              </p>\r\n            </motion.button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  // Quiz complete\r\n  if (quizComplete) {\r\n    return (\r\n      <Card className=\"border-2 border-primary/20 bg-gradient-to-br from-background via-background to-violet-500/5\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-3\">\r\n            <div className=\"h-10 w-10 rounded-lg bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center\">\r\n              <GraduationCap className=\"h-5 w-5 text-white\" />\r\n            </div>\r\n            Quiz Complete!\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <QuizResults\r\n            score={score}\r\n            total={questions.length}\r\n            onRestart={restartSameQuiz}\r\n            onNewQuiz={resetQuiz}\r\n          />\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Card className=\"border-2 border-primary/20 bg-gradient-to-br from-background via-background to-violet-500/5\">\r\n      <CardHeader className=\"pb-2\">\r\n        <div className=\"flex items-center justify-between flex-wrap gap-4\">\r\n          <CardTitle className=\"flex items-center gap-3\">\r\n            <div className=\"h-10 w-10 rounded-lg bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center\">\r\n              <GraduationCap className=\"h-5 w-5 text-white\" />\r\n            </div>\r\n            <div>\r\n              <span className=\"block\">\r\n                {currentQuestion.type === 'color' ? 'Color' : 'Clarity'} Grading Quiz\r\n              </span>\r\n              <span className=\"text-sm font-normal text-muted-foreground\">\r\n                Question {currentIndex + 1} of {questions.length}\r\n              </span>\r\n            </div>\r\n          </CardTitle>\r\n          <div className=\"flex items-center gap-3\">\r\n            <Badge variant=\"outline\" className=\"text-emerald-400 border-emerald-400/30\">\r\n              Score: {score}/{currentIndex + (showResult ? 1 : 0)}\r\n            </Badge>\r\n            <Button variant=\"ghost\" size=\"sm\" onClick={resetQuiz}>\r\n              <XCircle className=\"h-4 w-4 mr-1\" />\r\n              Exit\r\n            </Button>\r\n          </div>\r\n        </div>\r\n        <Progress value={progress} className=\"h-2 mt-4\" />\r\n      </CardHeader>\r\n\r\n      <CardContent className=\"space-y-6\">\r\n        {/* Question */}\r\n        <div className=\"text-center\">\r\n          <h3 className=\"text-xl font-semibold mb-2\">\r\n            What is the {currentQuestion.type === 'color' ? 'color' : 'clarity'} grade of this diamond?\r\n          </h3>\r\n          <p className=\"text-sm text-muted-foreground\">\r\n            Examine the diamond carefully and select your answer\r\n          </p>\r\n        </div>\r\n\r\n        {/* 3D Diamond */}\r\n        <div className=\"relative\">\r\n          <div className=\"h-[350px] rounded-xl overflow-hidden border-2 border-primary/30\">\r\n            <Suspense fallback={<div className=\"h-full flex items-center justify-center bg-muted/50\">Loading Diamond...</div>}>\r\n              <RealisticDiamond3D\r\n                colorGrade={currentQuestion.type === 'color' ? currentQuestion.correctAnswer as any : 'G'}\r\n                clarityGrade={currentQuestion.type === 'clarity' ? currentQuestion.correctAnswer as any : 'VVS1'}\r\n                autoRotate={true}\r\n                microscopeMode={currentQuestion.type === 'clarity'}\r\n                viewMode=\"faceUp\"\r\n                showControls={true}\r\n                seed={currentQuestion.seed}\r\n              />\r\n            </Suspense>\r\n          </div>\r\n          \r\n          {/* Hint button */}\r\n          {!showResult && (\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              className=\"absolute bottom-2 right-2\"\r\n              onClick={() => setShowHint(!showHint)}\r\n            >\r\n              <Lightbulb className={`h-4 w-4 mr-1 ${showHint ? 'text-amber-400' : ''}`} />\r\n              Hint\r\n            </Button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Hint */}\r\n        <AnimatePresence>\r\n          {showHint && !showResult && (\r\n            <motion.div\r\n              initial={{ opacity: 0, height: 0 }}\r\n              animate={{ opacity: 1, height: 'auto' }}\r\n              exit={{ opacity: 0, height: 0 }}\r\n              className=\"p-3 rounded-lg bg-amber-500/10 border border-amber-500/20\"\r\n            >\r\n              <p className=\"text-sm text-amber-400\">\r\n                 {getGradeHint(currentQuestion.type, currentQuestion.correctAnswer)}\r\n              </p>\r\n            </motion.div>\r\n          )}\r\n        </AnimatePresence>\r\n\r\n        {/* Answer Options */}\r\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n          {currentQuestion.options.map((option) => {\r\n            const isSelected = selectedAnswer === option;\r\n            const isCorrect = option === currentQuestion.correctAnswer;\r\n            const showCorrect = showResult && isCorrect;\r\n            const showIncorrect = showResult && isSelected && !isCorrect;\r\n\r\n            return (\r\n              <motion.button\r\n                key={option}\r\n                whileHover={!showResult ? { scale: 1.02 } : {}}\r\n                whileTap={!showResult ? { scale: 0.98 } : {}}\r\n                onClick={() => handleAnswer(option)}\r\n                disabled={showResult}\r\n                className={`\r\n                  p-4 rounded-xl border-2 font-semibold text-lg transition-all\r\n                  ${showCorrect ? 'bg-emerald-500/20 border-emerald-500 text-emerald-400' :\r\n                    showIncorrect ? 'bg-red-500/20 border-red-500 text-red-400' :\r\n                    isSelected ? 'bg-primary/20 border-primary' :\r\n                    'bg-muted/50 border-border/50 hover:border-primary/50'}\r\n                `}\r\n              >\r\n                <div className=\"flex items-center justify-center gap-2\">\r\n                  {showCorrect && <CheckCircle2 className=\"h-5 w-5\" />}\r\n                  {showIncorrect && <XCircle className=\"h-5 w-5\" />}\r\n                  {option}\r\n                </div>\r\n              </motion.button>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {/* Result feedback */}\r\n        <AnimatePresence>\r\n          {showResult && (\r\n            <motion.div\r\n              initial={{ opacity: 0, y: 10 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              className=\"flex items-center justify-between p-4 rounded-lg bg-muted/50\"\r\n            >\r\n              <div className=\"flex items-center gap-3\">\r\n                {selectedAnswer === currentQuestion.correctAnswer ? (\r\n                  <>\r\n                    <CheckCircle2 className=\"h-6 w-6 text-emerald-400\" />\r\n                    <span className=\"font-semibold text-emerald-400\">Correct!</span>\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <XCircle className=\"h-6 w-6 text-red-400\" />\r\n                    <span className=\"font-semibold text-red-400\">\r\n                      Incorrect. The answer was {currentQuestion.correctAnswer}\r\n                    </span>\r\n                  </>\r\n                )}\r\n              </div>\r\n              <Button onClick={nextQuestion}>\r\n                {currentIndex < questions.length - 1 ? 'Next Question' : 'See Results'}\r\n                <ArrowRight className=\"h-4 w-4 ml-2\" />\r\n              </Button>\r\n            </motion.div>\r\n          )}\r\n        </AnimatePresence>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n","import { useState, useMemo } from \"react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Slider } from \"@/components/ui/slider\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { \r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { DollarSign, TrendingUp, TrendingDown, Info, Gem, Scale, Sparkles, Palette, Search } from \"lucide-react\";\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"@/components/ui/tooltip\";\r\n\r\n// Market base prices per carat for round brilliant (USD) - based on Rapaport-style pricing\r\nconst BASE_PRICES_PER_CARAT: Record<string, Record<string, number>> = {\r\n  // Color -> Clarity -> Price per carat for 1ct stone\r\n  'D': { 'FL': 21000, 'IF': 18500, 'VVS1': 15000, 'VVS2': 13500, 'VS1': 11000, 'VS2': 9500, 'SI1': 7500, 'SI2': 5800, 'I1': 3500, 'I2': 2200 },\r\n  'E': { 'FL': 18000, 'IF': 16000, 'VVS1': 13500, 'VVS2': 12000, 'VS1': 10000, 'VS2': 8500, 'SI1': 6800, 'SI2': 5200, 'I1': 3200, 'I2': 2000 },\r\n  'F': { 'FL': 15500, 'IF': 14000, 'VVS1': 12000, 'VVS2': 10500, 'VS1': 9000, 'VS2': 7800, 'SI1': 6200, 'SI2': 4800, 'I1': 2900, 'I2': 1800 },\r\n  'G': { 'FL': 12500, 'IF': 11500, 'VVS1': 10000, 'VVS2': 8800, 'VS1': 7500, 'VS2': 6500, 'SI1': 5200, 'SI2': 4000, 'I1': 2500, 'I2': 1600 },\r\n  'H': { 'FL': 10500, 'IF': 9500, 'VVS1': 8500, 'VVS2': 7500, 'VS1': 6500, 'VS2': 5500, 'SI1': 4500, 'SI2': 3500, 'I1': 2200, 'I2': 1400 },\r\n  'I': { 'FL': 8500, 'IF': 7800, 'VVS1': 7000, 'VVS2': 6200, 'VS1': 5400, 'VS2': 4600, 'SI1': 3800, 'SI2': 3000, 'I1': 1900, 'I2': 1200 },\r\n  'J': { 'FL': 7000, 'IF': 6400, 'VVS1': 5800, 'VVS2': 5200, 'VS1': 4500, 'VS2': 3900, 'SI1': 3200, 'SI2': 2600, 'I1': 1700, 'I2': 1100 },\r\n  'K': { 'FL': 5500, 'IF': 5000, 'VVS1': 4500, 'VVS2': 4000, 'VS1': 3500, 'VS2': 3000, 'SI1': 2500, 'SI2': 2000, 'I1': 1400, 'I2': 900 },\r\n  'L': { 'FL': 4500, 'IF': 4100, 'VVS1': 3700, 'VVS2': 3300, 'VS1': 2900, 'VS2': 2500, 'SI1': 2100, 'SI2': 1700, 'I1': 1200, 'I2': 800 },\r\n  'M': { 'FL': 3800, 'IF': 3400, 'VVS1': 3100, 'VVS2': 2800, 'VS1': 2500, 'VS2': 2100, 'SI1': 1800, 'SI2': 1500, 'I1': 1000, 'I2': 700 },\r\n};\r\n\r\n// Carat weight multipliers (price increases exponentially)\r\nconst getCaratMultiplier = (carat: number): number => {\r\n  if (carat < 0.30) return 0.25;\r\n  if (carat < 0.50) return 0.45;\r\n  if (carat < 0.70) return 0.65;\r\n  if (carat < 0.90) return 0.85;\r\n  if (carat < 1.00) return 0.95;\r\n  if (carat < 1.50) return 1.35;\r\n  if (carat < 2.00) return 1.85;\r\n  if (carat < 3.00) return 2.50;\r\n  if (carat < 4.00) return 3.20;\r\n  if (carat < 5.00) return 4.00;\r\n  return 5.00;\r\n};\r\n\r\n// Cut quality adjustments\r\nconst CUT_ADJUSTMENTS: Record<string, number> = {\r\n  'Excellent': 1.0,\r\n  'Very Good': 0.92,\r\n  'Good': 0.82,\r\n  'Fair': 0.70,\r\n  'Poor': 0.55,\r\n};\r\n\r\n// Shape adjustments (relative to round)\r\nconst SHAPE_ADJUSTMENTS: Record<string, number> = {\r\n  'Round': 1.0,\r\n  'Princess': 0.75,\r\n  'Oval': 0.78,\r\n  'Cushion': 0.72,\r\n  'Emerald': 0.70,\r\n  'Pear': 0.73,\r\n  'Marquise': 0.68,\r\n  'Radiant': 0.71,\r\n  'Asscher': 0.69,\r\n  'Heart': 0.74,\r\n};\r\n\r\n// Fluorescence adjustments\r\nconst FLUOR_ADJUSTMENTS: Record<string, number> = {\r\n  'None': 1.0,\r\n  'Faint': 0.98,\r\n  'Medium': 0.94,\r\n  'Strong': 0.88,\r\n  'Very Strong': 0.80,\r\n};\r\n\r\nconst COLOR_GRADES = ['D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M'];\r\nconst CLARITY_GRADES = ['FL', 'IF', 'VVS1', 'VVS2', 'VS1', 'VS2', 'SI1', 'SI2', 'I1', 'I2'];\r\nconst CUT_GRADES = ['Excellent', 'Very Good', 'Good', 'Fair', 'Poor'];\r\nconst SHAPES = ['Round', 'Princess', 'Oval', 'Cushion', 'Emerald', 'Pear', 'Marquise', 'Radiant', 'Asscher', 'Heart'];\r\nconst FLUORESCENCE = ['None', 'Faint', 'Medium', 'Strong', 'Very Strong'];\r\n\r\ninterface PriceBreakdown {\r\n  basePrice: number;\r\n  caratAdjusted: number;\r\n  cutAdjusted: number;\r\n  shapeAdjusted: number;\r\n  fluorAdjusted: number;\r\n  finalPrice: number;\r\n  pricePerCarat: number;\r\n}\r\n\r\nconst calculatePrice = (\r\n  carat: number,\r\n  color: string,\r\n  clarity: string,\r\n  cut: string,\r\n  shape: string,\r\n  fluorescence: string\r\n): PriceBreakdown => {\r\n  const basePerCarat = BASE_PRICES_PER_CARAT[color]?.[clarity] || 5000;\r\n  const basePrice = basePerCarat * carat;\r\n  \r\n  const caratMultiplier = getCaratMultiplier(carat);\r\n  const caratAdjusted = basePrice * caratMultiplier;\r\n  \r\n  const cutMultiplier = CUT_ADJUSTMENTS[cut] || 1.0;\r\n  const cutAdjusted = caratAdjusted * cutMultiplier;\r\n  \r\n  const shapeMultiplier = SHAPE_ADJUSTMENTS[shape] || 1.0;\r\n  const shapeAdjusted = cutAdjusted * shapeMultiplier;\r\n  \r\n  const fluorMultiplier = FLUOR_ADJUSTMENTS[fluorescence] || 1.0;\r\n  const fluorAdjusted = shapeAdjusted * fluorMultiplier;\r\n  \r\n  return {\r\n    basePrice,\r\n    caratAdjusted,\r\n    cutAdjusted,\r\n    shapeAdjusted,\r\n    fluorAdjusted,\r\n    finalPrice: Math.round(fluorAdjusted),\r\n    pricePerCarat: Math.round(fluorAdjusted / carat),\r\n  };\r\n};\r\n\r\nconst PriceFactorBar = ({ label, value, maxValue, impact, icon: Icon }: { \r\n  label: string; \r\n  value: string; \r\n  maxValue: number;\r\n  impact: 'positive' | 'negative' | 'neutral';\r\n  icon: React.ElementType;\r\n}) => {\r\n  const percentage = (parseFloat(value.replace(/[^0-9.-]/g, '')) / maxValue) * 100;\r\n  \r\n  return (\r\n    <div className=\"space-y-1\">\r\n      <div className=\"flex items-center justify-between text-sm\">\r\n        <span className=\"flex items-center gap-2 text-muted-foreground\">\r\n          <Icon className=\"h-4 w-4\" />\r\n          {label}\r\n        </span>\r\n        <span className={`font-medium flex items-center gap-1 ${\r\n          impact === 'positive' ? 'text-emerald-400' : \r\n          impact === 'negative' ? 'text-red-400' : 'text-foreground'\r\n        }`}>\r\n          {value}\r\n          {impact === 'positive' && <TrendingUp className=\"h-3 w-3\" />}\r\n          {impact === 'negative' && <TrendingDown className=\"h-3 w-3\" />}\r\n        </span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const DiamondValueCalculator = () => {\r\n  const [carat, setCarat] = useState(1.0);\r\n  const [color, setColor] = useState('G');\r\n  const [clarity, setClarity] = useState('VS1');\r\n  const [cut, setCut] = useState('Excellent');\r\n  const [shape, setShape] = useState('Round');\r\n  const [fluorescence, setFluorescence] = useState('None');\r\n\r\n  const priceBreakdown = useMemo(() => \r\n    calculatePrice(carat, color, clarity, cut, shape, fluorescence),\r\n    [carat, color, clarity, cut, shape, fluorescence]\r\n  );\r\n\r\n  // Calculate comparison prices\r\n  const idealPrice = useMemo(() => \r\n    calculatePrice(carat, 'D', 'FL', 'Excellent', 'Round', 'None').finalPrice,\r\n    [carat]\r\n  );\r\n\r\n  const budgetPrice = useMemo(() => \r\n    calculatePrice(carat, 'J', 'SI1', 'Very Good', 'Round', 'None').finalPrice,\r\n    [carat]\r\n  );\r\n\r\n  const savingsVsIdeal = idealPrice - priceBreakdown.finalPrice;\r\n  const savingsPercent = ((savingsVsIdeal / idealPrice) * 100).toFixed(0);\r\n\r\n  return (\r\n    <Card className=\"border-2 border-primary/20 bg-gradient-to-br from-background via-background to-emerald-500/5\">\r\n      <CardHeader className=\"pb-4\">\r\n        <CardTitle className=\"flex items-center gap-3\">\r\n          <div className=\"h-10 w-10 rounded-lg bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center\">\r\n            <DollarSign className=\"h-5 w-5 text-white\" />\r\n          </div>\r\n          Diamond Value Calculator\r\n        </CardTitle>\r\n        <p className=\"text-sm text-muted-foreground\">\r\n          Estimate diamond prices based on the 4Cs using current market data\r\n        </p>\r\n      </CardHeader>\r\n\r\n      <CardContent className=\"space-y-6\">\r\n        {/* Main Price Display */}\r\n        <motion.div\r\n          key={priceBreakdown.finalPrice}\r\n          initial={{ scale: 0.95, opacity: 0 }}\r\n          animate={{ scale: 1, opacity: 1 }}\r\n          className=\"text-center p-6 rounded-xl bg-gradient-to-br from-emerald-500/20 to-teal-500/10 border border-emerald-500/30\"\r\n        >\r\n          <div className=\"text-sm text-muted-foreground mb-1\">Estimated Value</div>\r\n          <div className=\"text-4xl md:text-5xl font-bold text-emerald-400\">\r\n            ${priceBreakdown.finalPrice.toLocaleString()}\r\n          </div>\r\n          <div className=\"text-sm text-muted-foreground mt-2\">\r\n            ${priceBreakdown.pricePerCarat.toLocaleString()} per carat\r\n          </div>\r\n          {savingsVsIdeal > 0 && (\r\n            <Badge variant=\"outline\" className=\"mt-3 bg-amber-500/20 text-amber-400 border-amber-500/30\">\r\n              {savingsPercent}% below D/FL equivalent\r\n            </Badge>\r\n          )}\r\n        </motion.div>\r\n\r\n        {/* 4Cs Selection Grid */}\r\n        <div className=\"grid md:grid-cols-2 gap-6\">\r\n          {/* Carat Weight */}\r\n          <div className=\"space-y-3 p-4 rounded-lg bg-muted/30 border border-border/50\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <span className=\"text-sm font-medium flex items-center gap-2\">\r\n                <Scale className=\"h-4 w-4 text-amber-400\" />\r\n                Carat Weight\r\n              </span>\r\n              <span className=\"text-lg font-bold text-amber-400\">{carat.toFixed(2)} ct</span>\r\n            </div>\r\n            <Slider\r\n              value={[carat]}\r\n              onValueChange={([v]) => setCarat(Number(v.toFixed(2)))}\r\n              min={0.2}\r\n              max={5.0}\r\n              step={0.05}\r\n            />\r\n            <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n              <span>0.2ct</span>\r\n              <span>5.0ct</span>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Color Grade */}\r\n          <div className=\"space-y-3 p-4 rounded-lg bg-muted/30 border border-border/50\">\r\n            <span className=\"text-sm font-medium flex items-center gap-2\">\r\n              <Palette className=\"h-4 w-4 text-sky-400\" />\r\n              Color Grade\r\n            </span>\r\n            <Select value={color} onValueChange={setColor}>\r\n              <SelectTrigger>\r\n                <SelectValue />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                {COLOR_GRADES.map((g) => (\r\n                  <SelectItem key={g} value={g}>\r\n                    {g} - {g <= 'F' ? 'Colorless' : g <= 'J' ? 'Near Colorless' : 'Faint'}\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          {/* Clarity Grade */}\r\n          <div className=\"space-y-3 p-4 rounded-lg bg-muted/30 border border-border/50\">\r\n            <span className=\"text-sm font-medium flex items-center gap-2\">\r\n              <Search className=\"h-4 w-4 text-purple-400\" />\r\n              Clarity Grade\r\n            </span>\r\n            <Select value={clarity} onValueChange={setClarity}>\r\n              <SelectTrigger>\r\n                <SelectValue />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                {CLARITY_GRADES.map((g) => (\r\n                  <SelectItem key={g} value={g}>{g}</SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          {/* Cut Grade */}\r\n          <div className=\"space-y-3 p-4 rounded-lg bg-muted/30 border border-border/50\">\r\n            <span className=\"text-sm font-medium flex items-center gap-2\">\r\n              <Sparkles className=\"h-4 w-4 text-emerald-400\" />\r\n              Cut Grade\r\n            </span>\r\n            <Select value={cut} onValueChange={setCut}>\r\n              <SelectTrigger>\r\n                <SelectValue />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                {CUT_GRADES.map((g) => (\r\n                  <SelectItem key={g} value={g}>{g}</SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          {/* Shape */}\r\n          <div className=\"space-y-3 p-4 rounded-lg bg-muted/30 border border-border/50\">\r\n            <span className=\"text-sm font-medium flex items-center gap-2\">\r\n              <Gem className=\"h-4 w-4 text-pink-400\" />\r\n              Shape\r\n            </span>\r\n            <Select value={shape} onValueChange={setShape}>\r\n              <SelectTrigger>\r\n                <SelectValue />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                {SHAPES.map((s) => (\r\n                  <SelectItem key={s} value={s}>{s}</SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          {/* Fluorescence */}\r\n          <div className=\"space-y-3 p-4 rounded-lg bg-muted/30 border border-border/50\">\r\n            <span className=\"text-sm font-medium flex items-center gap-2\">\r\n              <Info className=\"h-4 w-4 text-violet-400\" />\r\n              Fluorescence\r\n            </span>\r\n            <Select value={fluorescence} onValueChange={setFluorescence}>\r\n              <SelectTrigger>\r\n                <SelectValue />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                {FLUORESCENCE.map((f) => (\r\n                  <SelectItem key={f} value={f}>{f}</SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Price Factors */}\r\n        <div className=\"p-4 rounded-lg bg-muted/30 border border-border/50 space-y-4\">\r\n          <h4 className=\"font-semibold text-sm\">Price Impact Factors</h4>\r\n          <TooltipProvider>\r\n            <div className=\"space-y-3\">\r\n              <Tooltip>\r\n                <TooltipTrigger className=\"w-full\">\r\n                  <PriceFactorBar\r\n                    label=\"Carat Weight\"\r\n                    value={`${getCaratMultiplier(carat).toFixed(2)}`}\r\n                    maxValue={5}\r\n                    impact={carat >= 1 ? 'positive' : 'neutral'}\r\n                    icon={Scale}\r\n                  />\r\n                </TooltipTrigger>\r\n                <TooltipContent>\r\n                  <p>Larger diamonds are exponentially rarer and more valuable</p>\r\n                </TooltipContent>\r\n              </Tooltip>\r\n\r\n              <Tooltip>\r\n                <TooltipTrigger className=\"w-full\">\r\n                  <PriceFactorBar\r\n                    label=\"Cut Quality\"\r\n                    value={`${(CUT_ADJUSTMENTS[cut] * 100).toFixed(0)}%`}\r\n                    maxValue={100}\r\n                    impact={cut === 'Excellent' ? 'positive' : cut === 'Poor' || cut === 'Fair' ? 'negative' : 'neutral'}\r\n                    icon={Sparkles}\r\n                  />\r\n                </TooltipTrigger>\r\n                <TooltipContent>\r\n                  <p>Cut quality directly affects brilliance and value</p>\r\n                </TooltipContent>\r\n              </Tooltip>\r\n\r\n              <Tooltip>\r\n                <TooltipTrigger className=\"w-full\">\r\n                  <PriceFactorBar\r\n                    label=\"Shape\"\r\n                    value={`${(SHAPE_ADJUSTMENTS[shape] * 100).toFixed(0)}%`}\r\n                    maxValue={100}\r\n                    impact={shape === 'Round' ? 'positive' : 'neutral'}\r\n                    icon={Gem}\r\n                  />\r\n                </TooltipTrigger>\r\n                <TooltipContent>\r\n                  <p>Round brilliant commands premium; fancy shapes offer value</p>\r\n                </TooltipContent>\r\n              </Tooltip>\r\n\r\n              <Tooltip>\r\n                <TooltipTrigger className=\"w-full\">\r\n                  <PriceFactorBar\r\n                    label=\"Fluorescence\"\r\n                    value={`${(FLUOR_ADJUSTMENTS[fluorescence] * 100).toFixed(0)}%`}\r\n                    maxValue={100}\r\n                    impact={fluorescence === 'None' ? 'neutral' : 'negative'}\r\n                    icon={Info}\r\n                  />\r\n                </TooltipTrigger>\r\n                <TooltipContent>\r\n                  <p>Strong fluorescence can reduce value, especially in D-F colors</p>\r\n                </TooltipContent>\r\n              </Tooltip>\r\n            </div>\r\n          </TooltipProvider>\r\n        </div>\r\n\r\n        {/* Price Comparison */}\r\n        <div className=\"grid grid-cols-3 gap-4\">\r\n          <div className=\"p-4 rounded-lg bg-amber-500/10 border border-amber-500/20 text-center\">\r\n            <div className=\"text-xs text-muted-foreground mb-1\">Budget (J/SI1)</div>\r\n            <div className=\"text-lg font-bold text-amber-400\">\r\n              ${budgetPrice.toLocaleString()}\r\n            </div>\r\n          </div>\r\n          <div className=\"p-4 rounded-lg bg-emerald-500/20 border border-emerald-500/30 text-center ring-2 ring-emerald-500/50\">\r\n            <div className=\"text-xs text-muted-foreground mb-1\">Your Selection</div>\r\n            <div className=\"text-lg font-bold text-emerald-400\">\r\n              ${priceBreakdown.finalPrice.toLocaleString()}\r\n            </div>\r\n          </div>\r\n          <div className=\"p-4 rounded-lg bg-violet-500/10 border border-violet-500/20 text-center\">\r\n            <div className=\"text-xs text-muted-foreground mb-1\">Premium (D/FL)</div>\r\n            <div className=\"text-lg font-bold text-violet-400\">\r\n              ${idealPrice.toLocaleString()}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Disclaimer */}\r\n        <p className=\"text-xs text-muted-foreground text-center\">\r\n          * Prices are estimates based on market averages. Actual prices vary by retailer, certification (GIA, AGS), and market conditions.\r\n        </p>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n","import { useState, useMemo, useRef, Suspense } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { Canvas, useFrame } from \"@react-three/fiber\";\r\nimport { OrbitControls, Environment, ContactShadows, Sparkles } from \"@react-three/drei\";\r\nimport * as THREE from \"three\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Slider } from \"@/components/ui/slider\";\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\r\nimport { Lightbulb, Sun, Moon, Info, TrendingDown, TrendingUp, Minus } from \"lucide-react\";\r\n\r\n// Fluorescence levels with properties\r\nconst FLUORESCENCE_LEVELS = [\r\n  { \r\n    level: \"None\", \r\n    index: 0, \r\n    intensity: 0, \r\n    glowColor: \"#0066ff\", \r\n    priceImpact: 0,\r\n    description: \"No fluorescence visible under UV light\",\r\n    marketNote: \"Standard pricing, no fluorescence discount or premium\",\r\n    visibility: \"No visible effect under any lighting\"\r\n  },\r\n  { \r\n    level: \"Faint\", \r\n    index: 1, \r\n    intensity: 0.15, \r\n    glowColor: \"#3388ff\", \r\n    priceImpact: -2,\r\n    description: \"Slight blue glow under UV light, not visible in normal lighting\",\r\n    marketNote: \"Minimal price impact, generally 1-3% discount\",\r\n    visibility: \"Only visible under strong UV light\"\r\n  },\r\n  { \r\n    level: \"Medium\", \r\n    index: 2, \r\n    intensity: 0.35, \r\n    glowColor: \"#4499ff\", \r\n    priceImpact: -5,\r\n    description: \"Moderate blue glow visible under UV light\",\r\n    marketNote: \"Typically 3-7% discount, can enhance appearance of lower color grades\",\r\n    visibility: \"Visible under UV, rarely affects appearance in daylight\"\r\n  },\r\n  { \r\n    level: \"Strong\", \r\n    index: 3, \r\n    intensity: 0.6, \r\n    glowColor: \"#55aaff\", \r\n    priceImpact: -10,\r\n    description: \"Pronounced blue glow under UV light, may affect daylight appearance\",\r\n    marketNote: \"Usually 10-15% discount, but can make I-M colors appear whiter\",\r\n    visibility: \"Visible under UV, may create slight haze in direct sunlight\"\r\n  },\r\n  { \r\n    level: \"Very Strong\", \r\n    index: 4, \r\n    intensity: 0.9, \r\n    glowColor: \"#66bbff\", \r\n    priceImpact: -15,\r\n    description: \"Intense blue glow, may cause oily or milky appearance in daylight\",\r\n    marketNote: \"Significant discount 15-25%, but some prefer the effect\",\r\n    visibility: \"Strongly visible under UV, may appear hazy or oily in sunlight\"\r\n  },\r\n];\r\n\r\n// Fluorescent Diamond Component\r\nconst FluorescentDiamond = ({ \r\n  fluorescenceLevel, \r\n  uvLightOn, \r\n  autoRotate,\r\n  colorGrade = \"H\"\r\n}: { \r\n  fluorescenceLevel: number;\r\n  uvLightOn: boolean;\r\n  autoRotate: boolean;\r\n  colorGrade?: string;\r\n}) => {\r\n  const groupRef = useRef<THREE.Group>(null);\r\n  const glowRef = useRef<THREE.Mesh>(null);\r\n  const diamondRef = useRef<THREE.Mesh>(null);\r\n  \r\n  const level = FLUORESCENCE_LEVELS[Math.round(fluorescenceLevel)];\r\n  \r\n  useFrame((state, delta) => {\r\n    if (groupRef.current && autoRotate) {\r\n      groupRef.current.rotation.y += delta * 0.3;\r\n    }\r\n    \r\n    // Pulsing glow effect when UV is on\r\n    if (glowRef.current && uvLightOn && level.intensity > 0) {\r\n      const pulse = Math.sin(state.clock.elapsedTime * 3) * 0.1 + 1;\r\n      glowRef.current.scale.setScalar(pulse * 1.15);\r\n    }\r\n  });\r\n\r\n  // Diamond base color based on color grade\r\n  const diamondBaseColor = useMemo(() => {\r\n    const colors: Record<string, string> = {\r\n      D: \"#f8fcff\",\r\n      E: \"#f6fafd\",\r\n      F: \"#f4f8fb\",\r\n      G: \"#f5f5ed\",\r\n      H: \"#f7f3e8\",\r\n      I: \"#f9f0e0\",\r\n      J: \"#fbedd8\",\r\n    };\r\n    return colors[colorGrade] || \"#f7f3e8\";\r\n  }, [colorGrade]);\r\n\r\n  // Calculate diamond color when UV is on\r\n  const diamondColor = useMemo(() => {\r\n    if (!uvLightOn || level.intensity === 0) return diamondBaseColor;\r\n    // Mix base color with blue fluorescence\r\n    const base = new THREE.Color(diamondBaseColor);\r\n    const glow = new THREE.Color(level.glowColor);\r\n    return base.lerp(glow, level.intensity * 0.3).getStyle();\r\n  }, [uvLightOn, level, diamondBaseColor]);\r\n\r\n  return (\r\n    <group ref={groupRef}>\r\n      {/* Fluorescent glow sphere (visible when UV is on) */}\r\n      {uvLightOn && level.intensity > 0 && (\r\n        <mesh ref={glowRef} scale={1.15}>\r\n          <sphereGeometry args={[1.2, 32, 32]} />\r\n          <meshBasicMaterial\r\n            color={level.glowColor}\r\n            transparent\r\n            opacity={level.intensity * 0.4}\r\n            side={THREE.BackSide}\r\n          />\r\n        </mesh>\r\n      )}\r\n      \r\n      {/* Crown */}\r\n      <mesh position={[0, 0.25, 0]} rotation={[Math.PI, 0, 0]} ref={diamondRef}>\r\n        <coneGeometry args={[0.9, 1.3, 8, 1]} />\r\n        <meshPhysicalMaterial\r\n          color={diamondColor}\r\n          metalness={0}\r\n          roughness={0}\r\n          transmission={uvLightOn ? 0.7 - level.intensity * 0.3 : 0.95}\r\n          thickness={1.5}\r\n          ior={2.417}\r\n          clearcoat={1}\r\n          envMapIntensity={uvLightOn ? 1.5 : 3}\r\n          emissive={uvLightOn && level.intensity > 0 ? level.glowColor : \"#000000\"}\r\n          emissiveIntensity={uvLightOn ? level.intensity * 0.5 : 0}\r\n        />\r\n      </mesh>\r\n      \r\n      {/* Pavilion */}\r\n      <mesh position={[0, -0.35, 0]}>\r\n        <coneGeometry args={[0.9, 0.7, 8, 1]} />\r\n        <meshPhysicalMaterial\r\n          color={diamondColor}\r\n          metalness={0}\r\n          roughness={0}\r\n          transmission={uvLightOn ? 0.7 - level.intensity * 0.3 : 0.95}\r\n          thickness={1.2}\r\n          ior={2.417}\r\n          clearcoat={1}\r\n          envMapIntensity={uvLightOn ? 1.5 : 3}\r\n          emissive={uvLightOn && level.intensity > 0 ? level.glowColor : \"#000000\"}\r\n          emissiveIntensity={uvLightOn ? level.intensity * 0.4 : 0}\r\n        />\r\n      </mesh>\r\n\r\n      {/* Table */}\r\n      <mesh position={[0, 0.26, 0]} rotation={[-Math.PI / 2, 0, 0]}>\r\n        <circleGeometry args={[0.5, 8]} />\r\n        <meshPhysicalMaterial\r\n          color={diamondColor}\r\n          metalness={0.1}\r\n          roughness={0}\r\n          transmission={0.9}\r\n          thickness={0.2}\r\n          envMapIntensity={2}\r\n          clearcoat={1}\r\n          ior={2.417}\r\n          emissive={uvLightOn && level.intensity > 0 ? level.glowColor : \"#000000\"}\r\n          emissiveIntensity={uvLightOn ? level.intensity * 0.6 : 0}\r\n        />\r\n      </mesh>\r\n\r\n      {/* Sparkles when UV is off */}\r\n      {!uvLightOn && (\r\n        <Sparkles count={20} scale={2} size={3} speed={0.3} opacity={0.5} color=\"#ffffff\" />\r\n      )}\r\n      \r\n      {/* UV glow particles when UV is on */}\r\n      {uvLightOn && level.intensity > 0 && (\r\n        <Sparkles \r\n          count={Math.round(30 * level.intensity)} \r\n          scale={2.5} \r\n          size={4} \r\n          speed={0.8} \r\n          opacity={level.intensity * 0.8} \r\n          color={level.glowColor} \r\n        />\r\n      )}\r\n    </group>\r\n  );\r\n};\r\n\r\n// UV Light source visualization\r\nconst UVLight = ({ isOn }: { isOn: boolean }) => {\r\n  const lightRef = useRef<THREE.PointLight>(null);\r\n  \r\n  useFrame((state) => {\r\n    if (lightRef.current && isOn) {\r\n      lightRef.current.intensity = 2 + Math.sin(state.clock.elapsedTime * 5) * 0.5;\r\n    }\r\n  });\r\n  \r\n  return (\r\n    <>\r\n      {isOn && (\r\n        <>\r\n          <pointLight ref={lightRef} position={[0, 4, 0]} intensity={2} color=\"#4400ff\" distance={10} />\r\n          <pointLight position={[2, 3, 2]} intensity={1} color=\"#6600ff\" distance={8} />\r\n          <pointLight position={[-2, 3, -2]} intensity={1} color=\"#6600ff\" distance={8} />\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nconst LoadingFallback = () => (\r\n  <div className=\"flex items-center justify-center h-full\">\r\n    <div className=\"flex items-center gap-2 text-muted-foreground\">\r\n      <div className=\"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin\" />\r\n      <span className=\"text-sm\">Loading...</span>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nconst FluorescenceScene = ({ \r\n  fluorescenceLevel, \r\n  uvLightOn, \r\n  autoRotate,\r\n  colorGrade\r\n}: { \r\n  fluorescenceLevel: number;\r\n  uvLightOn: boolean;\r\n  autoRotate: boolean;\r\n  colorGrade: string;\r\n}) => {\r\n  return (\r\n    <Canvas camera={{ position: [0, 0, 4], fov: 40 }} dpr={[1, 2]}>\r\n      <Suspense fallback={null}>\r\n        <ambientLight intensity={uvLightOn ? 0.15 : 0.4} />\r\n        \r\n        {!uvLightOn && (\r\n          <>\r\n            <spotLight position={[5, 5, 5]} angle={0.3} penumbra={1} intensity={1.5} castShadow />\r\n            <spotLight position={[-5, 5, -5]} angle={0.3} penumbra={1} intensity={1} />\r\n            <pointLight position={[0, 3, 0]} intensity={1} />\r\n          </>\r\n        )}\r\n        \r\n        <UVLight isOn={uvLightOn} />\r\n        \r\n        <FluorescentDiamond \r\n          fluorescenceLevel={fluorescenceLevel}\r\n          uvLightOn={uvLightOn}\r\n          autoRotate={autoRotate}\r\n          colorGrade={colorGrade}\r\n        />\r\n        \r\n        <Environment preset={uvLightOn ? \"night\" : \"studio\"} />\r\n        <ContactShadows \r\n          position={[0, -1.2, 0]} \r\n          opacity={uvLightOn ? 0.2 : 0.4} \r\n          scale={8} \r\n          blur={2} \r\n        />\r\n        <OrbitControls \r\n          enableZoom={true} \r\n          enablePan={false}\r\n          minDistance={2}\r\n          maxDistance={8}\r\n        />\r\n      </Suspense>\r\n    </Canvas>\r\n  );\r\n};\r\n\r\nexport const DiamondFluorescenceModule = () => {\r\n  const [fluorescenceIndex, setFluorescenceIndex] = useState(2);\r\n  const [uvLightOn, setUvLightOn] = useState(false);\r\n  const [autoRotate, setAutoRotate] = useState(true);\r\n  const [colorGrade, setColorGrade] = useState(\"H\");\r\n\r\n  const currentLevel = useMemo(() => \r\n    FLUORESCENCE_LEVELS[Math.round(fluorescenceIndex)], \r\n    [fluorescenceIndex]\r\n  );\r\n\r\n  const priceImpactIcon = useMemo(() => {\r\n    if (currentLevel.priceImpact < -10) return <TrendingDown className=\"h-4 w-4 text-red-400\" />;\r\n    if (currentLevel.priceImpact < 0) return <TrendingDown className=\"h-4 w-4 text-orange-400\" />;\r\n    return <Minus className=\"h-4 w-4 text-muted-foreground\" />;\r\n  }, [currentLevel]);\r\n\r\n  const colorGrades = [\"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\"];\r\n\r\n  return (\r\n    <Card className=\"w-full\">\r\n      <CardHeader>\r\n        <CardTitle className=\"flex items-center gap-2\">\r\n          <div className=\"h-8 w-8 rounded-lg bg-gradient-to-br from-violet-400 to-purple-600 flex items-center justify-center\">\r\n            <Lightbulb className=\"h-4 w-4 text-white\" />\r\n          </div>\r\n          Diamond Fluorescence Visualization\r\n        </CardTitle>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-6\">\r\n        {/* UV Light Control */}\r\n        <div className=\"flex flex-wrap gap-4 justify-between items-center\">\r\n          <div className=\"flex items-center gap-6\">\r\n            <motion.div \r\n              className=\"flex items-center space-x-3\"\r\n              animate={{ scale: uvLightOn ? 1.02 : 1 }}\r\n            >\r\n              <Switch\r\n                id=\"uv-light\"\r\n                checked={uvLightOn}\r\n                onCheckedChange={setUvLightOn}\r\n              />\r\n              <Label \r\n                htmlFor=\"uv-light\" \r\n                className={`flex items-center gap-2 font-medium transition-colors ${uvLightOn ? \"text-violet-400\" : \"\"}`}\r\n              >\r\n                {uvLightOn ? <Moon className=\"h-4 w-4\" /> : <Sun className=\"h-4 w-4\" />}\r\n                {uvLightOn ? \"UV Light ON\" : \"Normal Light\"}\r\n              </Label>\r\n            </motion.div>\r\n            \r\n            <div className=\"flex items-center space-x-2\">\r\n              <Switch\r\n                id=\"rotate-fluor\"\r\n                checked={autoRotate}\r\n                onCheckedChange={setAutoRotate}\r\n              />\r\n              <Label htmlFor=\"rotate-fluor\">360 Rotation</Label>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Color Grade Selector */}\r\n          <div className=\"flex items-center gap-2\">\r\n            <span className=\"text-sm text-muted-foreground\">Diamond Color:</span>\r\n            <div className=\"flex gap-1\">\r\n              {colorGrades.map((grade) => (\r\n                <Button\r\n                  key={grade}\r\n                  variant={colorGrade === grade ? \"default\" : \"outline\"}\r\n                  size=\"sm\"\r\n                  className=\"w-8 h-8 p-0\"\r\n                  onClick={() => setColorGrade(grade)}\r\n                >\r\n                  {grade}\r\n                </Button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Visualization Grid */}\r\n        <div className=\"grid lg:grid-cols-2 gap-6\">\r\n          {/* 3D Diamond View */}\r\n          <div className=\"relative\">\r\n            <motion.div \r\n              className=\"h-80 rounded-xl overflow-hidden\"\r\n              animate={{ \r\n                backgroundColor: uvLightOn ? \"#0a001a\" : \"#0f172a\"\r\n              }}\r\n              transition={{ duration: 0.5 }}\r\n              style={{\r\n                background: uvLightOn \r\n                  ? \"radial-gradient(circle at 50% 30%, #1a0033 0%, #0a001a 50%, #000005 100%)\"\r\n                  : \"radial-gradient(ellipse at 50% 30%, #1e293b 0%, #0f172a 50%, #020617 100%)\"\r\n              }}\r\n            >\r\n              <FluorescenceScene \r\n                fluorescenceLevel={fluorescenceIndex}\r\n                uvLightOn={uvLightOn}\r\n                autoRotate={autoRotate}\r\n                colorGrade={colorGrade}\r\n              />\r\n            </motion.div>\r\n            \r\n            <div className=\"absolute top-2 left-2 flex gap-2\">\r\n              <Badge className={`shadow-lg ${uvLightOn ? \"bg-violet-600\" : \"bg-primary\"}`}>\r\n                <Lightbulb className=\"h-3 w-3 mr-1\" />\r\n                {currentLevel.level} Fluorescence\r\n              </Badge>\r\n              <Badge variant=\"outline\" className=\"bg-black/50 text-white border-white/30\">\r\n                {colorGrade} Color\r\n              </Badge>\r\n            </div>\r\n\r\n            {uvLightOn && currentLevel.intensity > 0 && (\r\n              <motion.div\r\n                initial={{ opacity: 0, scale: 0.9 }}\r\n                animate={{ opacity: 1, scale: 1 }}\r\n                className=\"absolute bottom-2 left-2 right-2\"\r\n              >\r\n                <div className=\"bg-violet-500/20 backdrop-blur-sm border border-violet-400/30 rounded-lg p-2 text-center\">\r\n                  <span className=\"text-violet-300 text-sm font-medium\">\r\n                     Blue fluorescent glow visible under UV light\r\n                  </span>\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Controls & Info */}\r\n          <div className=\"space-y-6\">\r\n            {/* Fluorescence Level Slider */}\r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex justify-between items-center\">\r\n                <span className=\"font-medium\">Fluorescence Level</span>\r\n                <Badge variant=\"outline\" className=\"font-mono\">\r\n                  {currentLevel.level}\r\n                </Badge>\r\n              </div>\r\n              \r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n                  {FLUORESCENCE_LEVELS.map((l) => (\r\n                    <TooltipProvider key={l.level}>\r\n                      <Tooltip>\r\n                        <TooltipTrigger asChild>\r\n                          <button\r\n                            onClick={() => setFluorescenceIndex(l.index)}\r\n                            className={`px-1.5 py-0.5 rounded transition-all ${\r\n                              Math.round(fluorescenceIndex) === l.index \r\n                                ? \"bg-violet-500 text-white font-bold\" \r\n                                : \"hover:bg-muted\"\r\n                            }`}\r\n                          >\r\n                            {l.level.split(\" \")[0]}\r\n                          </button>\r\n                        </TooltipTrigger>\r\n                        <TooltipContent>\r\n                          <p>{l.description}</p>\r\n                        </TooltipContent>\r\n                      </Tooltip>\r\n                    </TooltipProvider>\r\n                  ))}\r\n                </div>\r\n                \r\n                <div className=\"relative\">\r\n                  <div \r\n                    className=\"absolute inset-0 h-3 rounded-full mt-2\"\r\n                    style={{\r\n                      background: \"linear-gradient(to right, #374151, #3b82f6, #8b5cf6, #a855f7, #c084fc)\"\r\n                    }}\r\n                  />\r\n                  <Slider\r\n                    value={[fluorescenceIndex]}\r\n                    onValueChange={(value) => setFluorescenceIndex(value[0])}\r\n                    max={FLUORESCENCE_LEVELS.length - 1}\r\n                    step={0.01}\r\n                    className=\"relative z-10\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Intensity Visualization */}\r\n            <div className=\"space-y-2\">\r\n              <span className=\"text-sm text-muted-foreground\">Glow Intensity</span>\r\n              <div className=\"h-4 rounded-full bg-muted overflow-hidden\">\r\n                <motion.div\r\n                  className=\"h-full rounded-full\"\r\n                  style={{\r\n                    background: `linear-gradient(to right, ${currentLevel.glowColor}, #c084fc)`\r\n                  }}\r\n                  animate={{ width: `${currentLevel.intensity * 100}%` }}\r\n                  transition={{ duration: 0.3 }}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Price Impact */}\r\n            <div className=\"p-4 rounded-xl bg-muted/50 space-y-3\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <span className=\"font-medium flex items-center gap-2\">\r\n                  {priceImpactIcon}\r\n                  Price Impact\r\n                </span>\r\n                <Badge \r\n                  variant=\"outline\" \r\n                  className={`${\r\n                    currentLevel.priceImpact < -10 \r\n                      ? \"border-red-400/50 text-red-400\" \r\n                      : currentLevel.priceImpact < 0 \r\n                        ? \"border-orange-400/50 text-orange-400\"\r\n                        : \"border-muted-foreground\"\r\n                  }`}\r\n                >\r\n                  {currentLevel.priceImpact === 0 ? \"No Impact\" : `${currentLevel.priceImpact}%`}\r\n                </Badge>\r\n              </div>\r\n              <p className=\"text-sm text-muted-foreground\">{currentLevel.marketNote}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Level Information */}\r\n        <AnimatePresence mode=\"wait\">\r\n          <motion.div\r\n            key={currentLevel.level}\r\n            initial={{ opacity: 0, y: 10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, y: -10 }}\r\n            className=\"p-4 rounded-xl bg-gradient-to-br from-violet-500/10 to-purple-500/10 border border-violet-500/20 space-y-4\"\r\n          >\r\n            <div className=\"flex items-center gap-3\">\r\n              <motion.div \r\n                className=\"w-12 h-12 rounded-full flex items-center justify-center shadow-lg\"\r\n                style={{ \r\n                  background: `linear-gradient(135deg, ${currentLevel.glowColor}, #8b5cf6)`,\r\n                  boxShadow: uvLightOn ? `0 0 20px ${currentLevel.glowColor}` : \"none\"\r\n                }}\r\n                animate={{ \r\n                  boxShadow: uvLightOn && currentLevel.intensity > 0\r\n                    ? [`0 0 10px ${currentLevel.glowColor}`, `0 0 30px ${currentLevel.glowColor}`, `0 0 10px ${currentLevel.glowColor}`]\r\n                    : \"0 0 0px transparent\"\r\n                }}\r\n                transition={{ duration: 1, repeat: Infinity }}\r\n              >\r\n                <Lightbulb className=\"h-5 w-5 text-white\" />\r\n              </motion.div>\r\n              <div>\r\n                <h3 className=\"text-lg font-bold\">{currentLevel.level} Fluorescence</h3>\r\n                <p className=\"text-sm text-muted-foreground\">Intensity: {Math.round(currentLevel.intensity * 100)}%</p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"grid md:grid-cols-2 gap-4 text-sm\">\r\n              <div className=\"flex items-start gap-2\">\r\n                <Info className=\"h-4 w-4 text-violet-400 mt-0.5 flex-shrink-0\" />\r\n                <div>\r\n                  <p className=\"font-medium\">Description</p>\r\n                  <p className=\"text-muted-foreground\">{currentLevel.description}</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-start gap-2\">\r\n                <Sun className=\"h-4 w-4 text-amber-400 mt-0.5 flex-shrink-0\" />\r\n                <div>\r\n                  <p className=\"font-medium\">Visibility</p>\r\n                  <p className=\"text-muted-foreground\">{currentLevel.visibility}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Pro Tip */}\r\n            {currentLevel.intensity > 0 && (\r\n              <div className=\"p-3 rounded-lg bg-violet-500/10 border border-violet-500/20\">\r\n                <p className=\"text-sm\">\r\n                  <span className=\"font-medium text-violet-400\"> Pro Tip:</span>{\" \"}\r\n                  {currentLevel.index >= 3 \r\n                    ? \"Strong fluorescence can make lower color grades (I-M) appear whiter, potentially offering good value.\"\r\n                    : \"Medium fluorescence rarely affects appearance and can offer slight savings.\"}\r\n                </p>\r\n              </div>\r\n            )}\r\n          </motion.div>\r\n        </AnimatePresence>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default DiamondFluorescenceModule;\r\n","import { useEffect } from \"react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { BackToHomeButton } from \"@/components/BackToHomeButton\";\r\nimport { DiamondColorModule } from \"@/components/diamond-education/DiamondColorModule\";\r\nimport { DiamondClarityModule } from \"@/components/diamond-education/DiamondClarityModule\";\r\nimport { DiamondCaratModule } from \"@/components/diamond-education/DiamondCaratModule\";\r\nimport { DiamondCutModule } from \"@/components/diamond-education/DiamondCutModule\";\r\nimport { DiamondGradingQuiz } from \"@/components/diamond-education/DiamondGradingQuiz\";\r\nimport { DiamondValueCalculator } from \"@/components/diamond-education/DiamondValueCalculator\";\r\nimport { DiamondFluorescenceModule } from \"@/components/diamond-education/DiamondFluorescenceModule\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { SEOHead } from \"@/components/SEOHead\";\r\nimport { StructuredData } from \"@/components/StructuredData\";\r\nimport { Palette, Search, GraduationCap, Scale, Sparkles, Trophy, DollarSign, Lightbulb } from \"lucide-react\";\r\nimport { BreadcrumbNav } from \"@/components/BreadcrumbNav\";\r\n\r\nconst DiamondEducation = () => {\r\n  // Educational content schema\r\n  const educationSchema = {\r\n    type: \"Article\" as const,\r\n    headline: \"Interactive Diamond Education - Learn the 4Cs\",\r\n    description: \"Master diamond grading with interactive 3D visualization. Learn about Color (D-M grades), Clarity (IF-I3), Cut quality, and Carat weight. Take quizzes to test your knowledge.\",\r\n    image: \"https://cataleon.com/og-image.png\",\r\n    author: \"Cataleon Education Team\",\r\n    publisher: \"Cataleon\",\r\n    datePublished: \"2024-01-01\",\r\n    dateModified: \"2025-01-15\"\r\n  };\r\n\r\n  // FAQ schema for diamond education\r\n  const faqSchema = {\r\n    type: \"FAQPage\" as const,\r\n    questions: [\r\n      {\r\n        question: \"What are the 4Cs of diamonds?\",\r\n        answer: \"The 4Cs are Color (D-Z scale, with D being colorless), Clarity (presence of inclusions, from IF to I3), Cut (how well the diamond is cut, affecting brilliance), and Carat (the weight of the diamond).\"\r\n      },\r\n      {\r\n        question: \"What is diamond fluorescence?\",\r\n        answer: \"Diamond fluorescence is the visible light some diamonds emit when exposed to UV light. It's graded from None to Very Strong and can affect a diamond's appearance and value.\"\r\n      },\r\n      {\r\n        question: \"How does diamond cut affect value?\",\r\n        answer: \"Cut is considered the most important C. An excellent cut maximizes brilliance and fire, making the diamond appear more brilliant. Poor cuts can make even high-color, high-clarity diamonds look dull.\"\r\n      }\r\n    ]\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background\">\r\n      {/* SEO Meta Tags */}\r\n      <SEOHead\r\n        title=\"Interactive Diamond Education - Learn the 4Cs with 3D Visualization | Cataleon\"\r\n        description=\"Master diamond grading with our interactive education center. Learn about Color, Clarity, Cut, and Carat with 3D visualization tools. Take quizzes to test your diamond expertise. Free educational resource for jewelers and consumers.\"\r\n        keywords=\"diamond education, 4Cs of diamonds, diamond grading, diamond color grades, diamond clarity, diamond cut quality, diamond carat weight, fluorescence, GIA grading, diamond quiz\"\r\n        canonicalUrl=\"/diamond-education\"\r\n      />\r\n      \r\n      {/* Structured Data */}\r\n      <StructuredData data={[educationSchema, faqSchema]} />\r\n      \r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <div className=\"mb-4\">\r\n          <BreadcrumbNav />\r\n        </div>\r\n        <BackToHomeButton />\r\n        \r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          className=\"space-y-8\"\r\n        >\r\n          <div className=\"text-center space-y-4 max-w-3xl mx-auto\">\r\n            <div className=\"flex items-center justify-center gap-3\">\r\n              <div className=\"h-12 w-12 rounded-xl bg-gradient-to-br from-primary via-amber-500 to-orange-500 flex items-center justify-center shadow-lg\">\r\n                <GraduationCap className=\"h-6 w-6 text-white\" />\r\n              </div>\r\n              <h1 className=\"text-3xl md:text-4xl font-bold\">\r\n                Interactive Diamond Education\r\n              </h1>\r\n            </div>\r\n            <p className=\"text-muted-foreground text-lg\">\r\n              Master the 4Cs of diamond grading with hyper-realistic 3D visualization tools.\r\n            </p>\r\n          </div>\r\n\r\n          <Tabs defaultValue=\"color\" className=\"space-y-6\">\r\n            <TabsList className=\"grid w-full max-w-4xl mx-auto grid-cols-7\">\r\n              <TabsTrigger value=\"color\" className=\"flex items-center gap-1 text-xs md:text-sm\">\r\n                <Palette className=\"h-3 w-3 md:h-4 md:w-4\" />\r\n                <span className=\"hidden md:inline\">Color</span>\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"clarity\" className=\"flex items-center gap-1 text-xs md:text-sm\">\r\n                <Search className=\"h-3 w-3 md:h-4 md:w-4\" />\r\n                <span className=\"hidden md:inline\">Clarity</span>\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"cut\" className=\"flex items-center gap-1 text-xs md:text-sm\">\r\n                <Sparkles className=\"h-3 w-3 md:h-4 md:w-4\" />\r\n                <span className=\"hidden md:inline\">Cut</span>\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"carat\" className=\"flex items-center gap-1 text-xs md:text-sm\">\r\n                <Scale className=\"h-3 w-3 md:h-4 md:w-4\" />\r\n                <span className=\"hidden md:inline\">Carat</span>\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"fluorescence\" className=\"flex items-center gap-1 text-xs md:text-sm\">\r\n                <Lightbulb className=\"h-3 w-3 md:h-4 md:w-4\" />\r\n                <span className=\"hidden md:inline\">Fluor.</span>\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"value\" className=\"flex items-center gap-1 text-xs md:text-sm\">\r\n                <DollarSign className=\"h-3 w-3 md:h-4 md:w-4\" />\r\n                <span className=\"hidden md:inline\">Value</span>\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"quiz\" className=\"flex items-center gap-1 text-xs md:text-sm\">\r\n                <Trophy className=\"h-3 w-3 md:h-4 md:w-4\" />\r\n                <span className=\"hidden md:inline\">Quiz</span>\r\n              </TabsTrigger>\r\n            </TabsList>\r\n\r\n            <TabsContent value=\"color\"><DiamondColorModule /></TabsContent>\r\n            <TabsContent value=\"clarity\"><DiamondClarityModule /></TabsContent>\r\n            <TabsContent value=\"cut\"><DiamondCutModule /></TabsContent>\r\n            <TabsContent value=\"carat\"><DiamondCaratModule /></TabsContent>\r\n            <TabsContent value=\"fluorescence\"><DiamondFluorescenceModule /></TabsContent>\r\n            <TabsContent value=\"value\"><DiamondValueCalculator /></TabsContent>\r\n            <TabsContent value=\"quiz\"><DiamondGradingQuiz /></TabsContent>\r\n          </Tabs>\r\n        </motion.div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DiamondEducation;\r\n"],"file":"assets/DiamondEducation-hS3kLXsu.js"}