import{E as G,a as W}from"./jspdf.plugin.autotable-DkGJWiqm.js";const A=t=>{switch(t){case"export":return"EXPORT INVOICE";case"proforma":return"PROFORMA INVOICE";default:return"TAX INVOICE"}},d=t=>`Rs. ${t.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,H=async t=>new Promise(e=>{const o=new Image;o.crossOrigin="anonymous",o.onload=()=>{try{const F=document.createElement("canvas");F.width=o.width,F.height=o.height;const l=F.getContext("2d");if(!l){e(null);return}l.drawImage(o,0,0);const x=F.toDataURL("image/jpeg",.95);e(x)}catch(F){console.error("Error converting image to base64:",F),e(null)}},o.onerror=()=>{console.error("Failed to load image:",t),e(null)};const C=t.includes("?")?"&":"?";o.src=`${t}${C}_t=${Date.now()}`,setTimeout(()=>e(null),3e3)}),Ce=async t=>{const e=t.template||"detailed";if(t.estimateCategory==="loose_diamond"||e==="loose_diamond")return await he(t);if(t.estimateCategory==="gemstone"||e==="gemstone")return await xe(t);switch(e){case"summary":return await le(t);case"minimal":return await ce(t);case"traditional":return await ge(t);case"modern":return await ae(t);case"luxury":return await me(t);default:return await re(t)}},re=async t=>{var v,f,B,L,E,V,j,J,X,q,Z,K,Q,ee,te,oe,ne;const e=new G,o=e.internal.pageSize.getWidth();e.internal.pageSize.getHeight();const C=((v=t.vendorBranding)==null?void 0:v.primaryColor)||"#1e40af",F=((f=t.vendorBranding)==null?void 0:f.secondaryColor)||"#6366f1",l="#f59e0b",x=a=>{const y=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return y?{r:parseInt(y[1],16),g:parseInt(y[2],16),b:parseInt(y[3],16)}:{r:30,g:64,b:175}},i=x(C),h=x(F),r=x(l);if(e.setFillColor(i.r,i.g,i.b),e.rect(0,0,o,50,"F"),e.setFillColor(r.r,r.g,r.b),e.rect(0,48,o,2,"F"),(B=t.vendorBranding)!=null&&B.logo){e.setFillColor(255,255,255),e.roundedRect(16,10,30,30,3,3,"F"),e.setDrawColor(230,230,235),e.setLineWidth(.5),e.roundedRect(16,10,30,30,3,3,"S");try{const a=await H(t.vendorBranding.logo);a?e.addImage(a,"JPEG",18,12,26,26,void 0,"FAST"):(e.setFontSize(7),e.setTextColor(150,150,150),e.text("LOGO",31,26.5,{align:"center"}))}catch(a){console.error("Error processing logo:",a),e.setFontSize(7),e.setTextColor(150,150,150),e.text("LOGO",31,26.5,{align:"center"})}}const c=(L=t.vendorBranding)!=null&&L.logo?52:o/2,S=(E=t.vendorBranding)!=null&&E.logo?"left":"center";if(e.setFontSize(22),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),(V=t.vendorBranding)!=null&&V.name){e.text(t.vendorBranding.name.toUpperCase(),c,22,{align:S}),(j=t.vendorBranding)!=null&&j.tagline&&(e.setFontSize(9),e.setFont("helvetica","italic"),e.setTextColor(240,240,245),e.text(t.vendorBranding.tagline,c,28,{align:S}));const a=A(t.invoiceType);e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text(a,c,36,{align:S})}else{const a=A(t.invoiceType);e.setFontSize(26),e.text(a,o/2,28,{align:"center"})}e.setTextColor(50,50,50);let T=58;if((J=t.vendorBranding)!=null&&J.email||(X=t.vendorBranding)!=null&&X.phone||(q=t.vendorBranding)!=null&&q.address||t.vendorGSTIN){e.setFillColor(248,250,252),e.roundedRect(o-80,T,66,32,2,2,"F"),e.setDrawColor(220,225,230),e.setLineWidth(.5),e.roundedRect(o-80,T,66,32,2,2,"S"),e.setFontSize(8),e.setFont("helvetica","normal"),e.setTextColor(80,80,90);let a=T+6;if(t.vendorGSTIN&&(e.setFont("helvetica","bold"),e.text("GSTIN:",o-76,a),e.setFont("helvetica","normal"),e.text(t.vendorGSTIN,o-76,a+3.5),a+=8),t.vendorBranding.phone&&(e.text(`Tel: ${t.vendorBranding.phone}`,o-76,a),a+=4.5),t.vendorBranding.email){const y=t.vendorBranding.email.length>25?t.vendorBranding.email.substring(0,22)+"...":t.vendorBranding.email;e.text(`Email: ${y}`,o-76,a),a+=4.5}if(t.vendorBranding.address&&a<T+28){const y=e.splitTextToSize(t.vendorBranding.address,60);e.text(y.slice(0,2),o-76,a)}}e.setTextColor(40,40,50);let N=58;e.setFillColor(255,253,245),e.roundedRect(14,N,90,32,2,2,"F"),e.setFillColor(r.r,r.g,r.b),e.rect(14,N,2,32,"F"),e.setDrawColor(r.r,r.g,r.b),e.setLineWidth(.5),e.roundedRect(14,N,90,32,2,2,"S");let n=N+7;if(e.setFontSize(10),e.setFont("helvetica","bold"),e.setTextColor(i.r,i.g,i.b),e.text("INVOICE NUMBER",20,n),e.setFontSize(12),e.setFont("helvetica","bold"),e.setTextColor(40,40,50),e.text(t.invoiceNumber,20,n+5),n+=12,e.setFontSize(8),e.setFont("helvetica","bold"),e.setTextColor(100,100,110),e.text("Date:",20,n),e.setFont("helvetica","normal"),e.text(new Date(t.invoiceDate).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),35,n),t.paymentDueDate&&(n+=4.5,e.setFont("helvetica","bold"),e.text("Due:",20,n),e.setFont("helvetica","normal"),e.setTextColor(220,38,38),e.text(new Date(t.paymentDueDate).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),35,n),e.setTextColor(100,100,110)),t.paymentTerms&&(n+=4.5,e.setFont("helvetica","bold"),e.text("Terms:",20,n),e.setFont("helvetica","normal"),e.text(t.paymentTerms,35,n)),t.status){const a={paid:{bg:[220,252,231],text:[22,163,74]},partial:{bg:[254,249,195],text:[202,138,4]},pending:{bg:[254,226,226],text:[220,38,38]}},y={paid:"PAID",partial:"PARTIAL",pending:"UNPAID"},U=a[t.status]||a.pending,R=y[t.status]||"UNPAID";e.setFillColor(...U.bg),e.roundedRect(o-50,55,36,10,2,2,"F"),e.setFontSize(8),e.setFont("helvetica","bold"),e.setTextColor(...U.text),e.text(R,o-32,61.5,{align:"center"}),e.setTextColor(40,40,50)}let u=98;if(t.customerName){e.setFillColor(250,252,255),e.roundedRect(14,u,o-28,42,2,2,"F"),e.setFillColor(h.r,h.g,h.b),e.roundedRect(14,u,o-28,3,2,2,"F"),e.setDrawColor(220,225,235),e.setLineWidth(.5),e.roundedRect(14,u,o-28,42,2,2,"S"),e.setFontSize(10),e.setFont("helvetica","bold"),e.setTextColor(h.r,h.g,h.b),e.text("BILL TO",20,u+10),e.setTextColor(40,40,50),e.setFontSize(11),e.setFont("helvetica","bold");let a=u+17;e.text(t.customerName,20,a),e.setFontSize(9),e.setFont("helvetica","normal"),e.setTextColor(80,80,90);let y=a+6;const U=o/2;if(t.customerGSTIN&&(e.setFont("helvetica","bold"),e.text("GSTIN:",20,y),e.setFont("helvetica","normal"),e.text(t.customerGSTIN,38,y),y+=5),t.customerPhone&&(e.text(`Tel: ${t.customerPhone}`,20,y),y+=5),t.customerEmail){const R=e.splitTextToSize(`Email: ${t.customerEmail}`,U-25);e.text(R,20,y),y+=R.length*4}if(t.customerAddress){const R=e.splitTextToSize(t.customerAddress,o-50);e.text(R,20,y)}u+=47}let m=u+5;if(t.lineItems&&t.lineItems.length>0)m>e.internal.pageSize.getHeight()-100&&(e.addPage(),m=20),e.setFontSize(12),e.setFont("helvetica","bold"),e.setTextColor(i.r,i.g,i.b),e.text("INVOICE LINE ITEMS",14,m),e.setTextColor(0,0,0),m+=5,t.lineItems.forEach((a,y)=>{m>e.internal.pageSize.getHeight()-50&&(e.addPage(),m=20);const U=m;if(a.image_url)try{e.setFillColor(245,245,250),e.rect(14,m,30,30,"F"),e.setFontSize(7),e.setTextColor(150,150,150),e.text("[Image]",29,m+17,{align:"center"})}catch(k){console.error("Error adding item image:",k)}const R=a.image_url?48:18;if(e.setFontSize(11),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),e.text(`${y+1}. ${a.item_name}`,R,m+5),a.description){e.setFontSize(9),e.setFont("helvetica","normal"),e.setTextColor(100,100,100);const k=e.splitTextToSize(a.description,o-R-20);e.text(k,R,m+11)}m=Math.max(m+35,U+(a.image_url?35:25));const P=[["Gross Weight",`${a.gross_weight} g`],["Net Weight",`${a.net_weight} g`]];a.diamond_weight>0&&(P.push(["Diamond Weight",`${a.diamond_weight} ct`]),a.diamond_color&&P.push(["Diamond Color",a.diamond_color]),a.diamond_clarity&&P.push(["Diamond Clarity",a.diamond_clarity]),a.diamond_cut&&P.push(["Diamond Cut",a.diamond_cut]),a.diamond_certification&&P.push(["Diamond Certification",a.diamond_certification])),a.gemstone_weight>0&&(P.push(["Gemstone Weight",`${a.gemstone_weight} ct`]),a.gemstone_type&&P.push(["Gemstone Type",a.gemstone_type]),a.gemstone_color&&P.push(["Gemstone Color",a.gemstone_color]),a.gemstone_clarity&&P.push(["Gemstone Clarity",a.gemstone_clarity])),W(e,{startY:m,body:P,theme:"plain",styles:{fontSize:9,cellPadding:2},columnStyles:{0:{fontStyle:"bold",cellWidth:40},1:{cellWidth:"auto"}},margin:{left:18,right:14}}),m=e.lastAutoTable.finalY+2;const se=[["Gold Cost",d(a.gold_cost)],["Making Charges",d(a.making_charges)],["CAD Design",d(a.cad_design_charges)],["Camming",d(a.camming_charges)],["Certification",d(a.certification_cost)],["Diamond Cost",d(a.diamond_cost)],["Gemstone Cost",d(a.gemstone_cost)]];W(e,{startY:m,body:se,theme:"plain",styles:{fontSize:9,cellPadding:2.5,textColor:[70,70,80]},columnStyles:{0:{cellWidth:45,fontStyle:"bold",textColor:[100,100,110]},1:{cellWidth:"auto",halign:"right",fontStyle:"bold"}},margin:{left:18,right:14}}),m=e.lastAutoTable.finalY+3,e.setFillColor(h.r,h.g,h.b),e.rect(14,m,o-28,10,"F"),e.setFontSize(11),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text("Item Subtotal:",18,m+6.5),e.text(d(a.subtotal),o-18,m+6.5,{align:"right"}),e.setTextColor(40,40,50),m+=18});else{m>e.internal.pageSize.getHeight()-100&&(e.addPage(),m=20),e.setFontSize(12),e.setFont("helvetica","bold"),e.setTextColor(i.r,i.g,i.b),e.text("PRODUCT SPECIFICATIONS",14,m),e.setTextColor(0,0,0);const a=[];t.grossWeight&&a.push(["Gross Weight",`${t.grossWeight} grams`]),t.netWeight&&a.push(["Net Weight",`${t.netWeight} grams`]),t.purityFraction&&a.push(["Gold Purity",`${(t.purityFraction*100).toFixed(0)}%`]),(Z=t.details)!=null&&Z.diamond_type&&a.push(["Diamond Type",t.details.diamond_type]),(K=t.details)!=null&&K.diamond_shape&&a.push(["Diamond Shape",t.details.diamond_shape]),(Q=t.details)!=null&&Q.diamond_weight&&a.push(["Diamond Weight",`${t.details.diamond_weight} carats`]),(ee=t.details)!=null&&ee.diamond_color&&a.push(["Diamond Color",t.details.diamond_color]),(te=t.details)!=null&&te.diamond_clarity&&a.push(["Diamond Clarity",t.details.diamond_clarity]),(oe=t.details)!=null&&oe.diamond_certification&&t.details.diamond_certification!=="none"&&a.push(["Certification",t.details.diamond_certification.toUpperCase()]),(ne=t.details)!=null&&ne.gemstone_weight&&a.push(["Gemstone Weight",`${t.details.gemstone_weight} carats`]),a.length>0?(W(e,{startY:m+5,body:a,theme:"plain",styles:{fontSize:10},columnStyles:{0:{fontStyle:"bold",cellWidth:50},1:{cellWidth:"auto"}},margin:{left:14,right:14}}),m=e.lastAutoTable.finalY+15):m+=10}if(!t.lineItems||t.lineItems.length===0){m>e.internal.pageSize.getHeight()-100&&(e.addPage(),m=20),e.setFontSize(12),e.setFont("helvetica","bold"),e.setTextColor(i.r,i.g,i.b),e.text("COST BREAKDOWN",14,m),e.setTextColor(40,40,50);const y=[["Gold Cost",d(t.goldCost)],["Making Charges",d(t.makingCharges)],["CAD Design Charges",d(t.cadDesignCharges)],["Camming Charges",d(t.cammingCharges)],["Certification Cost",d(t.certificationCost)],["Diamond Cost",d(t.diamondCost)],["Gemstone Cost",d(t.gemstoneCost)]];W(e,{startY:m+5,head:[["Description","Amount"]],body:y,theme:"striped",headStyles:{fillColor:[i.r,i.g,i.b],fontSize:11,fontStyle:"bold",textColor:[255,255,255],cellPadding:4},bodyStyles:{fontSize:10,textColor:[50,50,60],cellPadding:3.5},alternateRowStyles:{fillColor:[250,252,255]},columnStyles:{0:{cellWidth:110,fontStyle:"normal"},1:{cellWidth:"auto",halign:"right",fontStyle:"bold"}},margin:{left:14,right:14}}),m=e.lastAutoTable.finalY+10}const p=m,I=t.gstMode==="sgst_cgst"&&(t.sgstAmount&&t.sgstAmount>0||t.cgstAmount&&t.cgstAmount>0)||t.gstMode==="igst"&&t.igstAmount&&t.igstAmount>0,b=t.shippingCharges&&t.shippingCharges>0,z=t.grandTotal!==void 0&&t.grandTotal>0,$=t.exchangeRate&&t.exchangeRate>0&&z,_=40,w=I?t.gstMode==="sgst_cgst"?12:7:0,O=b?7:0,Y=z?12:0,M=$?8:0,s=_+w+O+Y+M;if(p+s>e.internal.pageSize.getHeight()-80){e.addPage(),m=20;const a=m;e.setFillColor(245,245,250),e.rect(14,a,o-28,s,"F"),ie(e,a,t,i,o,I,b,z,$),m=a+s+5}else e.setFillColor(245,245,250),e.rect(14,p,o-28,s,"F"),ie(e,p,t,i,o,I,b,z,$),m=p+s+5;if(t.invoiceNotes){m>e.internal.pageSize.getHeight()-60&&(e.addPage(),m=20),e.setFontSize(12),e.setFont("helvetica","bold"),e.setTextColor(i.r,i.g,i.b),e.text("INVOICE NOTES",14,m),e.setTextColor(0,0,0),e.setFontSize(10),e.setFont("helvetica","normal");const a=e.splitTextToSize(t.invoiceNotes,o-28);e.text(a,14,m+6),m+=6+a.length*5+5}m>e.internal.pageSize.getHeight()-70&&(e.addPage(),m=20),e.setFillColor(255,253,245),e.roundedRect(14,m-2,o-28,22,2,2,"F"),e.setDrawColor(245,158,11),e.setLineWidth(2),e.line(14,m-2,14,m+20),e.setDrawColor(220,225,230),e.setLineWidth(.5),e.roundedRect(14,m-2,o-28,22,2,2,"S"),e.setFontSize(10),e.setFont("helvetica","bold"),e.setTextColor(i.r,i.g,i.b),e.text("PAYMENT INFORMATION",20,m+4),e.setTextColor(40,40,50),e.setFont("helvetica","normal"),e.setFontSize(8.5),e.setTextColor(70,70,80),e.text("Please make payment within the specified terms to avoid late fees.",20,m+10),e.text("For payment inquiries or bank details, contact us at the details above.",20,m+15),m+=28,m>e.internal.pageSize.getHeight()-50&&(e.addPage(),m=20),e.setFillColor(248,250,252),e.rect(14,m-2,o-28,32,"F"),e.setDrawColor(220,225,230),e.setLineWidth(.5),e.rect(14,m-2,o-28,32,"S"),e.setFontSize(9),e.setFont("helvetica","bold"),e.setTextColor(i.r,i.g,i.b),e.text("TERMS & CONDITIONS",18,m+3),e.setFont("helvetica","normal"),e.setFontSize(7.5),e.setTextColor(70,70,80),e.text("- Payment must be received by the due date to avoid late fees.",18,m+9),e.text("- All prices are final and include applicable taxes unless otherwise stated.",18,m+13),e.text("- This invoice is valid for the amounts and items listed above.",18,m+17),e.text("- Goods once sold cannot be returned or exchanged.",18,m+21),e.text("- Subject to jurisdiction mentioned in the invoice.",18,m+25);const g=e.internal.pageSize.getHeight()-7;e.setDrawColor(220,225,230),e.setLineWidth(.5),e.line(14,g-2,o-14,g-2),e.setFontSize(7.5),e.setTextColor(120,120,130),e.text(`Generated on ${new Date().toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})} at ${new Date().toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})}`,o/2,g,{align:"center"});const D=`Invoice_${t.invoiceNumber.replace(/[^a-z0-9]/gi,"_")}_${Date.now()}.pdf`;e.save(D)},ie=(t,e,o,C,F,l,x,i,h)=>{let r=e+10;if(t.setFontSize(10),t.setFont("helvetica","normal"),t.setTextColor(80,80,90),t.text("Subtotal:",20,r),t.setFont("helvetica","bold"),t.setTextColor(50,50,60),t.text(d(o.totalCost),F-20,r,{align:"right"}),r+=6,t.setDrawColor(220,225,235),t.setLineWidth(.3),t.line(20,r,F-20,r),r+=5,t.setFont("helvetica","bold"),t.setTextColor(60,60,70),t.text("Amount (Before Tax):",20,r),t.setTextColor(50,50,60),t.text(d(o.finalSellingPrice),F-20,r,{align:"right"}),r+=7,l&&(t.setFontSize(9),o.gstMode==="sgst_cgst"?(t.setFont("helvetica","normal"),t.setTextColor(80,80,90),t.text(`SGST (${o.sgstPercentage||0}%):`,24,r),t.setFont("helvetica","bold"),t.setTextColor(50,50,60),t.text(d(o.sgstAmount||0),F-20,r,{align:"right"}),r+=4.5,t.setFont("helvetica","normal"),t.setTextColor(80,80,90),t.text(`CGST (${o.cgstPercentage||0}%):`,24,r),t.setFont("helvetica","bold"),t.setTextColor(50,50,60),t.text(d(o.cgstAmount||0),F-20,r,{align:"right"}),r+=5):(t.setFont("helvetica","normal"),t.setTextColor(80,80,90),t.text(`IGST (${o.igstPercentage||0}%):`,24,r),t.setFont("helvetica","bold"),t.setTextColor(50,50,60),t.text(d(o.igstAmount||0),F-20,r,{align:"right"}),r+=5),t.setFontSize(10)),x&&(t.setFont("helvetica","normal"),t.setTextColor(80,80,90),t.text(`Shipping${o.shippingZone?` (${o.shippingZone})`:""}:`,20,r),t.setFont("helvetica","bold"),t.setTextColor(50,50,60),t.text(d(o.shippingCharges),F-20,r,{align:"right"}),r+=6),i?(t.setDrawColor(C.r,C.g,C.b),t.setLineWidth(1),t.line(20,r,F-20,r),r+=7,t.setFillColor(C.r,C.g,C.b),t.roundedRect(18,r-4,F-36,12,1,1,"F"),t.setFontSize(13),t.setFont("helvetica","bold"),t.setTextColor(255,255,255),t.text("GRAND TOTAL (INR):",22,r+3),t.setFontSize(14),t.text(d(o.grandTotal),F-22,r+3,{align:"right"}),r+=10,t.setTextColor(40,40,50)):(t.setDrawColor(C.r,C.g,C.b),t.setLineWidth(1),t.line(20,r,F-20,r),r+=7,t.setFontSize(13),t.setFont("helvetica","bold"),t.setTextColor(C.r,C.g,C.b),t.text("TOTAL AMOUNT DUE:",20,r),t.text(d(o.finalSellingPrice),F-20,r,{align:"right"}),r+=7,t.setTextColor(40,40,50)),h&&o.grandTotal){t.setFontSize(9),t.setFont("helvetica","italic"),t.setTextColor(100,100,110);const c=(o.grandTotal/(o.exchangeRate||1)).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});t.text(`Equivalent: USD $${c} @ Exchange Rate Rs.${(o.exchangeRate||0).toFixed(2)}/USD`,20,r),t.setTextColor(40,40,50)}},le=async t=>{var c;const e=new G,o=e.internal.pageSize.getWidth(),C=((c=t.vendorBranding)==null?void 0:c.primaryColor)||"#4F46E5",l=(S=>{const T=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(S);return T?{r:parseInt(T[1],16),g:parseInt(T[2],16),b:parseInt(T[3],16)}:{r:79,g:70,b:229}})(C);e.setFillColor(l.r,l.g,l.b),e.rect(0,0,o,35,"F"),e.setFontSize(24),e.setFont("helvetica","bold"),e.setTextColor(255,255,255);const x=A(t.invoiceType);e.text(x,o/2,22,{align:"center"}),e.setTextColor(0,0,0),e.setFontSize(10),e.setFont("helvetica","bold"),e.text(`Invoice: ${t.invoiceNumber}`,14,50),e.setFont("helvetica","normal"),e.text(`Date: ${new Date(t.invoiceDate).toLocaleDateString()}`,14,56),t.paymentDueDate&&e.text(`Due: ${new Date(t.paymentDueDate).toLocaleDateString()}`,14,62),t.customerName&&(e.setFont("helvetica","bold"),e.text("Bill To:",14,75),e.setFont("helvetica","normal"),e.text(t.customerName,14,81),t.customerPhone&&e.text(t.customerPhone,14,87));const i=[["Gold Cost",`Rs. ${t.goldCost.toFixed(2)}`],["Making & Design",`Rs. ${(t.makingCharges+t.cadDesignCharges+t.cammingCharges).toFixed(2)}`],["Stones & Gems",`Rs. ${(t.diamondCost+t.gemstoneCost).toFixed(2)}`],["Certification",`Rs. ${t.certificationCost.toFixed(2)}`]];W(e,{startY:100,head:[["Item","Amount"]],body:i,theme:"plain",headStyles:{fillColor:[l.r,l.g,l.b],textColor:255},margin:{left:14,right:14}});const h=e.lastAutoTable.finalY+10;e.setFillColor(245,245,250),e.rect(14,h,o-28,20,"F"),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(l.r,l.g,l.b),e.text(`TOTAL: Rs. ${t.finalSellingPrice.toFixed(2)}`,o-18,h+13,{align:"right"}),e.setTextColor(0,0,0);const r=`Invoice_${t.invoiceNumber.replace(/[^a-z0-9]/gi,"_")}_${Date.now()}.pdf`;e.save(r)},ce=async t=>{var r;const e=new G,o=e.internal.pageSize.getWidth(),C=((r=t.vendorBranding)==null?void 0:r.primaryColor)||"#4F46E5",l=(c=>{const S=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(c);return S?{r:parseInt(S[1],16),g:parseInt(S[2],16),b:parseInt(S[3],16)}:{r:79,g:70,b:229}})(C);e.setFontSize(28),e.setFont("helvetica","bold"),e.setTextColor(l.r,l.g,l.b);const x=A(t.invoiceType);e.text(x,o/2,30,{align:"center"}),e.setTextColor(0,0,0),e.setFontSize(12),e.setFont("helvetica","normal");let i=50;e.text(`Invoice Number: ${t.invoiceNumber}`,o/2,i,{align:"center"}),i+=8,e.text(`Date: ${new Date(t.invoiceDate).toLocaleDateString()}`,o/2,i,{align:"center"}),t.customerName&&(i+=20,e.setFont("helvetica","bold"),e.text(`Customer: ${t.customerName}`,o/2,i,{align:"center"})),i+=40,e.setFontSize(36),e.setFont("helvetica","bold"),e.setTextColor(l.r,l.g,l.b),e.text(`Rs. ${t.finalSellingPrice.toFixed(2)}`,o/2,i,{align:"center"}),e.setTextColor(0,0,0),e.setFontSize(10),e.setFont("helvetica","normal"),i+=10,e.text("Total Amount Due",o/2,i,{align:"center"}),t.paymentDueDate&&(i+=15,e.setFontSize(11),e.text(`Payment Due: ${new Date(t.paymentDueDate).toLocaleDateString()}`,o/2,i,{align:"center"}));const h=`Invoice_${t.invoiceNumber.replace(/[^a-z0-9]/gi,"_")}_${Date.now()}.pdf`;e.save(h)},ge=async t=>{var p,I,b,z,$;const e=new G,o=e.internal.pageSize.getWidth(),C=e.internal.pageSize.getHeight(),F=((p=t.vendorBranding)==null?void 0:p.primaryColor)||"#2C1810",l="#8B7355",x=_=>{const w=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(_);return w?{r:parseInt(w[1],16),g:parseInt(w[2],16),b:parseInt(w[3],16)}:{r:44,g:24,b:16}},i=x(F),h=x(l);e.setDrawColor(h.r,h.g,h.b),e.setLineWidth(2),e.rect(10,10,o-20,C-20),e.setLineWidth(.5),e.rect(12,12,o-24,C-24),e.setFillColor(h.r,h.g,h.b),[[15,15],[o-15,15],[15,C-15],[o-15,C-15]].forEach(([_,w])=>{e.circle(_,w,2,"F")});let r=30;e.setFontSize(32),e.setFont("times","bold"),e.setTextColor(i.r,i.g,i.b),e.text(((I=t.vendorBranding)==null?void 0:I.name)||"FINE JEWELERS",o/2,r,{align:"center"}),(b=t.vendorBranding)!=null&&b.tagline&&(r+=8,e.setFontSize(11),e.setFont("times","italic"),e.setTextColor(h.r,h.g,h.b),e.text(t.vendorBranding.tagline,o/2,r,{align:"center"})),r+=10,e.setDrawColor(h.r,h.g,h.b),e.setLineWidth(.5);const c=40;e.line(c,r,o-c,r),e.circle(o/2,r,1,"F"),r+=12,e.setFontSize(24),e.setFont("times","bold"),e.setTextColor(i.r,i.g,i.b);const S=A(t.invoiceType);e.text(S,o/2,r,{align:"center"}),r+=15,e.setFillColor(250,248,245),e.rect(20,r,(o-40)/2-5,30,"F"),e.setFontSize(10),e.setFont("times","bold"),e.setTextColor(i.r,i.g,i.b),e.text("Invoice Number:",25,r+8),e.setFont("times","normal"),e.text(t.invoiceNumber,25,r+14),e.setFont("times","bold"),e.text("Date:",25,r+20),e.setFont("times","normal"),e.text(new Date(t.invoiceDate).toLocaleDateString(),25,r+26),e.setFillColor(250,248,245),e.rect(o/2+5,r,(o-40)/2-5,30,"F"),e.setFont("times","bold");let T=r+8;if((z=t.vendorBranding)!=null&&z.phone&&(e.text("Tel:",o/2+10,T),e.setFont("times","normal"),e.text(t.vendorBranding.phone,o/2+25,T),T+=6),($=t.vendorBranding)!=null&&$.email){e.setFont("times","bold"),e.text("Email:",o/2+10,T),e.setFont("times","normal");const _=e.splitTextToSize(t.vendorBranding.email,60);e.text(_,o/2+25,T)}if(r+=40,e.setFont("times","bold"),e.setFontSize(12),e.setTextColor(h.r,h.g,h.b),e.text("BILL TO",20,r),r+=6,e.setDrawColor(h.r,h.g,h.b),e.line(20,r,80,r),r+=8,e.setFont("times","normal"),e.setFontSize(10),e.setTextColor(i.r,i.g,i.b),t.customerName&&e.text(t.customerName,20,r),t.customerPhone&&(r+=5,e.text(t.customerPhone,20,r)),t.customerEmail&&(r+=5,e.text(t.customerEmail,20,r)),t.customerAddress){r+=5;const _=e.splitTextToSize(t.customerAddress,70);e.text(_,20,r)}r+=25;const N=[["Gold Cost","",`Rs. ${t.goldCost.toFixed(2)}`],["Diamond Cost","",`Rs. ${t.diamondCost.toFixed(2)}`],["Gemstone Cost","",`Rs. ${t.gemstoneCost.toFixed(2)}`],["Making Charges","",`Rs. ${t.makingCharges.toFixed(2)}`],["Design & CAD","",`Rs. ${t.cadDesignCharges.toFixed(2)}`],["Certification","",`Rs. ${t.certificationCost.toFixed(2)}`]];W(e,{startY:r,head:[["Description","","Amount"]],body:N,theme:"plain",styles:{font:"times",fontSize:10,textColor:[i.r,i.g,i.b]},headStyles:{fillColor:[h.r,h.g,h.b],textColor:[255,255,255],fontStyle:"bold",halign:"left"},columnStyles:{0:{cellWidth:80},1:{cellWidth:"auto"},2:{cellWidth:40,halign:"right"}},margin:{left:20,right:20}});const n=e.lastAutoTable.finalY+10;e.setDrawColor(h.r,h.g,h.b),e.setLineWidth(1.5),e.rect(o-90,n,70,20),e.setFontSize(14),e.setFont("times","bold"),e.setTextColor(i.r,i.g,i.b),e.text("TOTAL:",o-85,n+13),e.text(`Rs. ${t.finalSellingPrice.toFixed(2)}`,o-25,n+13,{align:"right"});const u=C-35;if(e.setFontSize(9),e.setFont("times","italic"),e.setTextColor(h.r,h.g,h.b),e.text("Payment Terms:",20,u),e.setFont("times","normal"),e.text(t.paymentTerms||"Net 30",20,u+5),t.invoiceNotes){e.text("Notes:",20,u+12);const _=e.splitTextToSize(t.invoiceNotes,o-45);e.text(_,20,u+17)}const m=`Invoice_${t.invoiceNumber.replace(/[^a-z0-9]/gi,"_")}_Traditional.pdf`;e.save(m)},ae=async t=>{var n,u,m,p,I,b;const e=new G,o=e.internal.pageSize.getWidth(),C=((n=t.vendorBranding)==null?void 0:n.primaryColor)||"#000000",F=((u=t.vendorBranding)==null?void 0:u.secondaryColor)||"#6366F1",l=z=>{const $=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(z);return $?{r:parseInt($[1],16),g:parseInt($[2],16),b:parseInt($[3],16)}:{r:0,g:0,b:0}},x=l(C),i=l(F);e.setDrawColor(i.r,i.g,i.b),e.setLineWidth(3),e.line(0,25,o,25),e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(100,100,100),e.text(((p=(m=t.vendorBranding)==null?void 0:m.name)==null?void 0:p.toUpperCase())||"JEWELERS",20,15),e.setFontSize(48),e.setFont("helvetica","bold"),e.setTextColor(x.r,x.g,x.b);const h=A(t.invoiceType);e.text(h,20,50);let r=65;e.setFontSize(9),e.setFont("helvetica","normal"),e.setTextColor(100,100,100),e.text("NUMBER",20,r),e.setTextColor(x.r,x.g,x.b),e.text(t.invoiceNumber,55,r),r+=6,e.setTextColor(100,100,100),e.text("DATE",20,r),e.setTextColor(x.r,x.g,x.b),e.text(new Date(t.invoiceDate).toLocaleDateString(),55,r),t.paymentDueDate&&(r+=6,e.setTextColor(100,100,100),e.text("DUE",20,r),e.setTextColor(x.r,x.g,x.b),e.text(new Date(t.paymentDueDate).toLocaleDateString(),55,r)),r=65,t.customerName&&(e.setFontSize(9),e.setTextColor(100,100,100),e.text("BILL TO",o-20,r,{align:"right"}),r+=6,e.setTextColor(x.r,x.g,x.b),e.text(t.customerName,o-20,r,{align:"right"}),t.customerEmail&&(r+=5,e.setFontSize(8),e.text(t.customerEmail,o-20,r,{align:"right"}))),r+=25;const c=[["Gold & Metal Work",`Rs. ${t.goldCost.toFixed(2)}`],["Precious Stones",`Rs. ${(t.diamondCost+t.gemstoneCost).toFixed(2)}`],["Craftsmanship",`Rs. ${t.makingCharges.toFixed(2)}`],["Design & Finishing",`Rs. ${(t.cadDesignCharges+t.cammingCharges).toFixed(2)}`],["Certification",`Rs. ${t.certificationCost.toFixed(2)}`]];W(e,{startY:r,body:c,theme:"plain",styles:{fontSize:10,textColor:[x.r,x.g,x.b],cellPadding:{top:4,bottom:4,left:0,right:0}},columnStyles:{0:{cellWidth:130,fontStyle:"normal"},1:{cellWidth:50,halign:"right",fontStyle:"bold"}},margin:{left:20,right:20},didDrawCell:z=>{z.row.index<c.length-1&&(e.setDrawColor(230,230,230),e.setLineWidth(.1),e.line(z.cell.x,z.cell.y+z.cell.height,z.cell.x+z.cell.width,z.cell.y+z.cell.height))}});const S=e.lastAutoTable.finalY+15;e.setDrawColor(i.r,i.g,i.b),e.setLineWidth(2),e.line(20,S,o-20,S),e.setFontSize(11),e.setFont("helvetica","normal"),e.setTextColor(100,100,100),e.text("TOTAL",20,S+10),e.setFontSize(24),e.setFont("helvetica","bold"),e.setTextColor(x.r,x.g,x.b),e.text(`Rs. ${t.finalSellingPrice.toFixed(2)}`,o-20,S+10,{align:"right"});const T=e.internal.pageSize.getHeight()-20;e.setFontSize(8),e.setTextColor(150,150,150),e.setFont("helvetica","normal"),(I=t.vendorBranding)!=null&&I.email&&e.text(t.vendorBranding.email,20,T),(b=t.vendorBranding)!=null&&b.phone&&e.text(t.vendorBranding.phone,o-20,T,{align:"right"});const N=`Invoice_${t.invoiceNumber.replace(/[^a-z0-9]/gi,"_")}_Modern.pdf`;e.save(N)},me=async t=>{var n,u,m,p,I;const e=new G,o=e.internal.pageSize.getWidth(),C=e.internal.pageSize.getHeight(),F={r:25,g:20,b:40},l={r:212,g:175,b:55},x={r:250,g:248,b:240};e.setFillColor(x.r,x.g,x.b),e.rect(0,0,o,C,"F"),e.setFillColor(l.r,l.g,l.b),e.rect(0,0,o,8,"F"),e.setDrawColor(l.r,l.g,l.b),e.setLineWidth(1);const i=15;e.line(15,15,15+i,15),e.line(15,15,15,15+i),e.line(o-15,15,o-15-i,15),e.line(o-15,15,o-15,15+i),e.line(15,C-15,15+i,C-15),e.line(15,C-15,15,C-15-i),e.line(o-15,C-15,o-15-i,C-15),e.line(o-15,C-15,o-15,C-15-i);let h=35;e.setFontSize(28),e.setFont("times","bold"),e.setTextColor(F.r,F.g,F.b),e.text(((u=(n=t.vendorBranding)==null?void 0:n.name)==null?void 0:u.toUpperCase())||"PRESTIGE JEWELERS",o/2,h,{align:"center"}),(m=t.vendorBranding)!=null&&m.tagline&&(h+=8,e.setFontSize(10),e.setFont("times","italic"),e.setTextColor(l.r,l.g,l.b),e.text(t.vendorBranding.tagline,o/2,h,{align:"center"})),h+=10,e.setDrawColor(l.r,l.g,l.b),e.setLineWidth(.5),e.line(60,h,o-60,h),e.setFillColor(l.r,l.g,l.b),[70,o/2,o-70].forEach(b=>{e.circle(b,h,.8,"F")}),h+=12,e.setFontSize(20),e.setFont("times","bold"),e.setTextColor(F.r,F.g,F.b);const r=A(t.invoiceType);if(e.text(r,o/2,h,{align:"center"}),h+=15,e.setFillColor(255,255,255),e.setDrawColor(l.r,l.g,l.b),e.setLineWidth(.5),e.rect(25,h,75,28,"FD"),e.setFontSize(9),e.setFont("times","bold"),e.setTextColor(l.r,l.g,l.b),e.text("INVOICE NO.",30,h+7),e.setFont("times","normal"),e.setTextColor(F.r,F.g,F.b),e.text(t.invoiceNumber,30,h+12),e.setFont("times","bold"),e.setTextColor(l.r,l.g,l.b),e.text("DATE",30,h+19),e.setFont("times","normal"),e.setTextColor(F.r,F.g,F.b),e.text(new Date(t.invoiceDate).toLocaleDateString(),30,h+24),e.setFillColor(255,255,255),e.rect(o-100,h,75,28,"FD"),e.setFont("times","bold"),e.setTextColor(l.r,l.g,l.b),e.text("ESTEEMED CLIENT",o-95,h+7),e.setFont("times","normal"),e.setTextColor(F.r,F.g,F.b),t.customerName&&e.text(t.customerName,o-95,h+13),t.customerPhone&&(e.setFontSize(8),e.text(t.customerPhone,o-95,h+18)),t.customerEmail){e.setFontSize(7);const b=e.splitTextToSize(t.customerEmail,70);e.text(b,o-95,h+23)}h+=40;const c=[["Fine Gold Workmanship",`Rs. ${t.goldCost.toFixed(2)}`],["Precious Diamond Selection",`Rs. ${t.diamondCost.toFixed(2)}`],["Gemstone Accents",`Rs. ${t.gemstoneCost.toFixed(2)}`],["Master Craftsmanship",`Rs. ${t.makingCharges.toFixed(2)}`],["Bespoke Design Services",`Rs. ${t.cadDesignCharges.toFixed(2)}`],["Finishing & Polish",`Rs. ${t.cammingCharges.toFixed(2)}`],["Authentication Certificate",`Rs. ${t.certificationCost.toFixed(2)}`]];W(e,{startY:h,body:c,theme:"plain",styles:{font:"times",fontSize:10,textColor:[F.r,F.g,F.b],cellPadding:{top:3,bottom:3}},columnStyles:{0:{cellWidth:130,fontStyle:"italic"},1:{cellWidth:45,halign:"right",fontStyle:"bold"}},margin:{left:25,right:25},didDrawCell:b=>{e.setDrawColor(l.r,l.g,l.b),e.setLineWidth(.1),e.line(b.cell.x,b.cell.y+b.cell.height,b.cell.x+b.cell.width,b.cell.y+b.cell.height)}});const S=e.lastAutoTable.finalY+15;e.setFillColor(F.r,F.g,F.b),e.rect(o-110,S,85,22,"F"),e.setFontSize(11),e.setFont("times","bold"),e.setTextColor(l.r,l.g,l.b),e.text("TOTAL INVESTMENT",o-105,S+8),e.setFontSize(18),e.setTextColor(255,255,255),e.text(`Rs. ${t.finalSellingPrice.toFixed(2)}`,o-105,S+17);const T=C-30;if(e.setDrawColor(l.r,l.g,l.b),e.setLineWidth(.3),e.line(25,T,o-25,T),e.setFontSize(8),e.setFont("times","italic"),e.setTextColor(l.r,l.g,l.b),e.text("Thank you for choosing exceptional luxury",o/2,T+6,{align:"center"}),(p=t.vendorBranding)!=null&&p.phone||(I=t.vendorBranding)!=null&&I.email){e.setFontSize(7),e.setTextColor(F.r,F.g,F.b);let b="";t.vendorBranding.phone&&(b+=t.vendorBranding.phone),t.vendorBranding.phone&&t.vendorBranding.email&&(b+=" | "),t.vendorBranding.email&&(b+=t.vendorBranding.email),e.text(b,o/2,T+12,{align:"center"})}const N=`Invoice_${t.invoiceNumber.replace(/[^a-z0-9]/gi,"_")}_Luxury.pdf`;e.save(N)},he=async t=>{var z,$,_,w,O,Y,M;const e=new G,o=e.internal.pageSize.getWidth(),C=e.internal.pageSize.getHeight(),F={r:37,g:99,b:235},l={r:248,g:250,b:252},x={r:30,g:41,b:59},i={r:148,g:163,b:184},h=((z=t.vendorBranding)==null?void 0:z.primaryColor)||"#2563eb",c=(s=>{const g=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(s);return g?{r:parseInt(g[1],16),g:parseInt(g[2],16),b:parseInt(g[3],16)}:F})(h);e.setFillColor(c.r,c.g,c.b),e.rect(0,0,o,45,"F"),e.setFillColor(255,255,255),e.setGState(new e.GState({opacity:.1}));for(let s=0;s<5;s++){const g=20+s*40;e.moveTo(g,22),e.lineTo(g+8,10),e.lineTo(g+16,22),e.lineTo(g+8,34),e.close(),e.fill()}e.setGState(new e.GState({opacity:1})),e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(255,255,255);const S=A(t.invoiceType);e.text(S,o-20,12,{align:"right"}),e.setFontSize(24),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text("LOOSE DIAMOND INVOICE",20,28),e.setFontSize(11),e.setFont("helvetica","normal"),e.text(`Invoice: ${t.invoiceNumber}`,20,38);let T=0;if(($=t.vendorBranding)!=null&&$.logo)try{const s=await H(t.vendorBranding.logo);s&&(e.setFillColor(255,255,255),e.roundedRect(o-45,8,30,30,2,2,"F"),e.addImage(s,"PNG",o-43,10,26,26),T=35)}catch(s){console.error("Error loading logo:",s)}const N=T>0?o-50:o-20;(_=t.vendorBranding)!=null&&_.name&&(e.setFontSize(12),e.setFont("helvetica","bold"),e.text(t.vendorBranding.name,N,28,{align:"right"})),(w=t.vendorBranding)!=null&&w.phone&&(e.setFontSize(9),e.setFont("helvetica","normal"),e.text(`Tel: ${t.vendorBranding.phone}`,N,38,{align:"right"}));let n=55;if(e.setFillColor(l.r,l.g,l.b),e.rect(0,n,o,18,"F"),e.setFontSize(9),e.setFont("helvetica","normal"),e.setTextColor(x.r,x.g,x.b),e.text(`Date: ${t.invoiceDate}`,20,n+11),t.paymentDueDate&&e.text(`Due: ${t.paymentDueDate}`,80,n+11),t.status){const s={paid:{bg:[220,252,231],text:[22,163,74]},partial:{bg:[254,249,195],text:[202,138,4]},pending:{bg:[254,226,226],text:[220,38,38]}},g=s[t.status]||s.pending,D=t.status.toUpperCase(),v=e.getTextWidth(D)+12;e.setFillColor(...g.bg),e.roundedRect(o-20-v,n+4,v,10,2,2,"F"),e.setFontSize(8),e.setFont("helvetica","bold"),e.setTextColor(...g.text),e.text(D,o-20-v+6,n+11)}if(n+=25,e.setFontSize(11),e.setFont("helvetica","bold"),e.setTextColor(c.r,c.g,c.b),e.text("BILL TO",20,n),n+=6,e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(x.r,x.g,x.b),t.customerName&&(e.setFont("helvetica","bold"),e.text(t.customerName,20,n),n+=5,e.setFont("helvetica","normal")),t.customerPhone&&(e.text(`Phone: ${t.customerPhone}`,20,n),n+=5),t.customerEmail&&(e.text(`Email: ${t.customerEmail}`,20,n),n+=5),t.customerAddress){const s=e.splitTextToSize(t.customerAddress,80);e.text(s,20,n),n+=s.length*5}n+=10,e.setFillColor(c.r,c.g,c.b),e.rect(15,n,o-30,10,"F"),e.setFontSize(9),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text("DIAMOND SPECIFICATIONS",20,n+7),e.text("AMOUNT",o-20,n+7,{align:"right"}),n+=15;const u=[];if(t.lineItems&&t.lineItems.length>0)for(let s=0;s<t.lineItems.length;s++){const g=t.lineItems[s];s%2===0&&(e.setFillColor(248,250,252),e.rect(15,n-4,o-30,40,"F")),e.setFontSize(10),e.setFont("helvetica","bold"),e.setTextColor(x.r,x.g,x.b);const D=g.item_name||`Diamond ${s+1}`;e.text(D,20,n),g.certificate_image_url&&(u.push({itemName:D,imageUrl:g.certificate_image_url}),e.setFontSize(7),e.setFont("helvetica","italic"),e.setTextColor(c.r,c.g,c.b),e.text("(Certificate - Page 2)",20+e.getTextWidth(D)+5,n)),e.setFontSize(8),e.setFont("helvetica","normal"),e.setTextColor(i.r,i.g,i.b);let v=n+5;const f=[];g.diamond_weight&&f.push(`Weight: ${g.diamond_weight} ct`),g.diamond_color&&f.push(`Color: ${g.diamond_color}`),g.diamond_clarity&&f.push(`Clarity: ${g.diamond_clarity}`),g.diamond_cut&&f.push(`Cut: ${g.diamond_cut}`),g.diamond_shape&&f.push(`Shape: ${g.diamond_shape}`),g.diamond_certification&&f.push(`Cert: ${g.diamond_certification}`);const B=f.slice(0,3).join(" | "),L=f.slice(3).join(" | ");e.text(B,20,v),L&&e.text(L,20,v+4);const E=[];g.diamond_fluorescence&&E.push(`Fluorescence: ${g.diamond_fluorescence}`),g.diamond_measurements&&E.push(`Measurements: ${g.diamond_measurements}`),E.length>0&&e.text(E.join(" | "),20,v+8),g.diamond_per_carat_price&&(e.setTextColor(100,116,139),e.text(`Rs. ${g.diamond_per_carat_price.toLocaleString("en-IN")} /ct`,20,v+14)),e.setFontSize(11),e.setFont("helvetica","bold"),e.setTextColor(c.r,c.g,c.b),e.text(d(g.diamond_cost||g.subtotal||0),o-20,n,{align:"right"}),n+=44}else e.setFillColor(248,250,252),e.rect(15,n-4,o-30,25,"F"),e.setFontSize(10),e.setFont("helvetica","bold"),e.setTextColor(x.r,x.g,x.b),e.text("Loose Diamond",20,n),e.setFontSize(8),e.setFont("helvetica","normal"),e.setTextColor(i.r,i.g,i.b),e.text(`Weight: ${t.netWeight||0} ct`,20,n+5),e.setFontSize(11),e.setFont("helvetica","bold"),e.setTextColor(c.r,c.g,c.b),e.text(d(t.diamondCost||0),o-20,n,{align:"right"}),n+=30;n+=5,e.setDrawColor(i.r,i.g,i.b),e.setLineWidth(.3),e.line(15,n,o-15,n),n+=8;const m=[{label:"Certification Cost",value:t.certificationCost},{label:"Shipping Charges",value:t.shippingCharges}].filter(s=>s.value&&s.value>0);if(m.length>0&&(e.setFontSize(9),m.forEach(s=>{e.setFont("helvetica","normal"),e.setTextColor(x.r,x.g,x.b),e.text(s.label,20,n),e.text(d(s.value||0),o-20,n,{align:"right"}),n+=6})),t.gstMode==="sgst_cgst"&&(t.sgstAmount||t.cgstAmount)?(e.setFontSize(9),e.setFont("helvetica","normal"),e.setTextColor(x.r,x.g,x.b),t.sgstAmount&&(e.text(`SGST (${t.sgstPercentage}%)`,20,n),e.text(d(t.sgstAmount),o-20,n,{align:"right"}),n+=6),t.cgstAmount&&(e.text(`CGST (${t.cgstPercentage}%)`,20,n),e.text(d(t.cgstAmount),o-20,n,{align:"right"}),n+=6)):t.gstMode==="igst"&&t.igstAmount&&(e.setFontSize(9),e.setFont("helvetica","normal"),e.setTextColor(x.r,x.g,x.b),e.text(`IGST (${t.igstPercentage}%)`,20,n),e.text(d(t.igstAmount),o-20,n,{align:"right"}),n+=6),n+=5,e.setFillColor(c.r,c.g,c.b),e.roundedRect(o-95,n,80,22,3,3,"F"),e.setFontSize(10),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text("GRAND TOTAL",o-90,n+8),e.setFontSize(14),e.text(d(t.grandTotal||t.finalSellingPrice||0),o-90,n+17),t.exchangeRate&&t.grandTotal){n+=28,e.setFontSize(9),e.setFont("helvetica","normal"),e.setTextColor(i.r,i.g,i.b);const s=(t.grandTotal/t.exchangeRate).toFixed(2);e.text(`USD Equivalent: $ ${Number(s).toLocaleString("en-US")} (Rate: ${t.exchangeRate})`,o-20,n,{align:"right"})}if(t.invoiceNotes){n+=15,e.setFillColor(248,250,252),e.roundedRect(15,n,o-30,25,2,2,"F"),e.setFontSize(8),e.setFont("helvetica","bold"),e.setTextColor(c.r,c.g,c.b),e.text("NOTES",20,n+6),e.setFont("helvetica","normal"),e.setTextColor(x.r,x.g,x.b);const s=e.splitTextToSize(t.invoiceNotes,o-50);e.text(s.slice(0,2),20,n+12)}const p=C-25;if(e.setDrawColor(c.r,c.g,c.b),e.setLineWidth(.5),e.line(15,p,o-15,p),e.setFontSize(8),e.setFont("helvetica","normal"),e.setTextColor(i.r,i.g,i.b),e.text("Thank you for your business",o/2,p+6,{align:"center"}),(O=t.vendorBranding)!=null&&O.email||(Y=t.vendorBranding)!=null&&Y.phone){let s="";t.vendorBranding.phone&&(s+=`Tel: ${t.vendorBranding.phone}`),t.vendorBranding.phone&&t.vendorBranding.email&&(s+=" | "),t.vendorBranding.email&&(s+=`Email: ${t.vendorBranding.email}`),e.text(s,o/2,p+12,{align:"center"})}const I=u.length>0?2:1;if(e.setFontSize(7),e.text(`Page 1 of ${I}`,o-20,p+18,{align:"right"}),u.length>0){e.addPage();let s=20;e.setFillColor(c.r,c.g,c.b),e.rect(0,0,o,30,"F"),e.setFontSize(18),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text("DIAMOND CERTIFICATES",20,20),e.setFontSize(10),e.setFont("helvetica","normal"),e.text(`Invoice: ${t.invoiceNumber}`,o-20,20,{align:"right"}),s=45;for(let D=0;D<u.length;D++){const v=u[D];s>C-100&&(e.addPage(),s=20),e.setFontSize(11),e.setFont("helvetica","bold"),e.setTextColor(x.r,x.g,x.b),e.text(`Certificate for: ${v.itemName}`,20,s),s+=8;try{const f=await H(v.imageUrl);if(f){const B=o-40,L=120;e.setDrawColor(c.r,c.g,c.b),e.setLineWidth(.5),e.rect(19,s-1,B+2,L+2,"S"),e.addImage(f,"JPEG",20,s,B,L),s+=L+15}else e.setFontSize(9),e.setFont("helvetica","italic"),e.setTextColor(i.r,i.g,i.b),e.text("Certificate image could not be loaded",20,s),s+=15}catch(f){console.error("Error loading certificate image:",f),e.setFontSize(9),e.setFont("helvetica","italic"),e.setTextColor(i.r,i.g,i.b),e.text("Certificate image could not be loaded",20,s),s+=15}}const g=C-15;e.setFontSize(7),e.setFont("helvetica","normal"),e.setTextColor(i.r,i.g,i.b),e.text(`Page 2 of ${I}`,o-20,g,{align:"right"}),(M=t.vendorBranding)!=null&&M.name&&e.text(t.vendorBranding.name,20,g)}const b=`Invoice_${t.invoiceNumber.replace(/[^a-z0-9]/gi,"_")}_LooseDiamond.pdf`;e.save(b)},xe=async t=>{var z,$,_,w,O,Y,M;const e=new G,o=e.internal.pageSize.getWidth(),C=e.internal.pageSize.getHeight(),F={r:16,g:185,b:129},l={r:30,g:41,b:59},x={r:248,g:250,b:252},i={r:100,g:116,b:139},h=((z=t.vendorBranding)==null?void 0:z.primaryColor)||"#10b981",c=(s=>{const g=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(s);return g?{r:parseInt(g[1],16),g:parseInt(g[2],16),b:parseInt(g[3],16)}:F})(h);e.setFillColor(c.r,c.g,c.b),e.rect(0,0,o,45,"F"),e.setFillColor(255,255,255),e.setGState(new e.GState({opacity:.1}));for(let s=0;s<6;s++){const g=15+s*35;e.moveTo(g,22),e.lineTo(g+6,12),e.lineTo(g+14,12),e.lineTo(g+20,22),e.lineTo(g+14,32),e.lineTo(g+6,32),e.close(),e.fill()}e.setGState(new e.GState({opacity:1})),e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(255,255,255);const S=A(t.invoiceType);e.text(S,o-20,12,{align:"right"}),e.setFontSize(24),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text("GEMSTONE INVOICE",20,28),e.setFontSize(11),e.setFont("helvetica","normal"),e.text(`Invoice: ${t.invoiceNumber}`,20,38);let T=0;if(($=t.vendorBranding)!=null&&$.logo)try{const s=await H(t.vendorBranding.logo);s&&(e.setFillColor(255,255,255),e.roundedRect(o-45,8,30,30,2,2,"F"),e.addImage(s,"PNG",o-43,10,26,26),T=35)}catch(s){console.error("Error loading logo:",s)}const N=T>0?o-50:o-20;(_=t.vendorBranding)!=null&&_.name&&(e.setFontSize(12),e.setFont("helvetica","bold"),e.text(t.vendorBranding.name,N,28,{align:"right"})),(w=t.vendorBranding)!=null&&w.phone&&(e.setFontSize(9),e.setFont("helvetica","normal"),e.text(`Tel: ${t.vendorBranding.phone}`,N,38,{align:"right"}));let n=55;if(e.setFillColor(x.r,x.g,x.b),e.rect(0,n,o,18,"F"),e.setFontSize(9),e.setFont("helvetica","normal"),e.setTextColor(l.r,l.g,l.b),e.text(`Date: ${t.invoiceDate}`,20,n+11),t.paymentDueDate&&e.text(`Due: ${t.paymentDueDate}`,80,n+11),t.status){const s={paid:{bg:[220,252,231],text:[22,163,74]},partial:{bg:[254,249,195],text:[202,138,4]},pending:{bg:[254,226,226],text:[220,38,38]}},g=s[t.status]||s.pending,D=t.status.toUpperCase(),v=e.getTextWidth(D)+12;e.setFillColor(...g.bg),e.roundedRect(o-20-v,n+4,v,10,2,2,"F"),e.setFontSize(8),e.setFont("helvetica","bold"),e.setTextColor(...g.text),e.text(D,o-20-v+6,n+11)}if(n+=25,e.setFontSize(11),e.setFont("helvetica","bold"),e.setTextColor(c.r,c.g,c.b),e.text("BILL TO",20,n),n+=6,e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(l.r,l.g,l.b),t.customerName&&(e.setFont("helvetica","bold"),e.text(t.customerName,20,n),n+=5,e.setFont("helvetica","normal")),t.customerPhone&&(e.text(`Phone: ${t.customerPhone}`,20,n),n+=5),t.customerEmail&&(e.text(`Email: ${t.customerEmail}`,20,n),n+=5),t.customerAddress){const s=e.splitTextToSize(t.customerAddress,80);e.text(s,20,n),n+=s.length*5}n+=10,e.setFillColor(c.r,c.g,c.b),e.rect(15,n,o-30,10,"F"),e.setFontSize(9),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text("GEMSTONE SPECIFICATIONS",20,n+7),e.text("AMOUNT",o-20,n+7,{align:"right"}),n+=15;const u=[];if(t.lineItems&&t.lineItems.length>0)for(let s=0;s<t.lineItems.length;s++){const g=t.lineItems[s];s%2===0&&(e.setFillColor(248,250,252),e.rect(15,n-4,o-30,44,"F")),e.setFontSize(10),e.setFont("helvetica","bold"),e.setTextColor(l.r,l.g,l.b);const D=g.item_name||g.gemstone_type||`Gemstone ${s+1}`;e.text(D,20,n),g.certificate_image_url&&(u.push({itemName:D,imageUrl:g.certificate_image_url}),e.setFontSize(7),e.setFont("helvetica","italic"),e.setTextColor(c.r,c.g,c.b),e.text("(Certificate - Page 2)",20+e.getTextWidth(D)+5,n)),e.setFontSize(8),e.setFont("helvetica","normal"),e.setTextColor(i.r,i.g,i.b);let v=n+5;const f=[];g.gemstone_type&&f.push(`Type: ${g.gemstone_type}`),g.gemstone_weight&&f.push(`Weight: ${g.gemstone_weight} ct`),g.gemstone_color&&f.push(`Color: ${g.gemstone_color}`),g.gemstone_clarity&&f.push(`Clarity: ${g.gemstone_clarity}`),g.gemstone_origin&&f.push(`Origin: ${g.gemstone_origin}`),g.gemstone_treatment&&f.push(`Treatment: ${g.gemstone_treatment}`),g.gemstone_shape&&f.push(`Shape: ${g.gemstone_shape}`);const B=f.slice(0,3).join(" | "),L=f.slice(3,6).join(" | "),E=f.slice(6).join(" | ");e.text(B,20,v),L&&e.text(L,20,v+4),E&&e.text(E,20,v+8),g.gemstone_per_carat_price&&(e.setTextColor(100,116,139),e.text(`Rs. ${g.gemstone_per_carat_price.toLocaleString("en-IN")} /ct`,20,v+14)),g.diamond_certification&&(e.setTextColor(c.r,c.g,c.b),e.text(`Cert: ${g.diamond_certification}`,20,v+18)),e.setFontSize(11),e.setFont("helvetica","bold"),e.setTextColor(c.r,c.g,c.b),e.text(d(g.gemstone_cost||g.subtotal||0),o-20,n,{align:"right"}),n+=48}else e.setFillColor(248,250,252),e.rect(15,n-4,o-30,25,"F"),e.setFontSize(10),e.setFont("helvetica","bold"),e.setTextColor(l.r,l.g,l.b),e.text("Loose Gemstone",20,n),e.setFontSize(8),e.setFont("helvetica","normal"),e.setTextColor(i.r,i.g,i.b),e.text(`Weight: ${t.netWeight||0} ct`,20,n+5),e.setFontSize(11),e.setFont("helvetica","bold"),e.setTextColor(c.r,c.g,c.b),e.text(d(t.gemstoneCost||0),o-20,n,{align:"right"}),n+=30;n+=5,e.setDrawColor(i.r,i.g,i.b),e.setLineWidth(.3),e.line(15,n,o-15,n),n+=8;const m=[{label:"Certification Cost",value:t.certificationCost},{label:"Shipping Charges",value:t.shippingCharges}].filter(s=>s.value&&s.value>0);if(m.length>0&&(e.setFontSize(9),m.forEach(s=>{e.setFont("helvetica","normal"),e.setTextColor(l.r,l.g,l.b),e.text(s.label,20,n),e.text(d(s.value||0),o-20,n,{align:"right"}),n+=6})),t.gstMode==="sgst_cgst"&&(t.sgstAmount||t.cgstAmount)?(e.setFontSize(9),e.setFont("helvetica","normal"),e.setTextColor(l.r,l.g,l.b),t.sgstAmount&&(e.text(`SGST (${t.sgstPercentage}%)`,20,n),e.text(d(t.sgstAmount),o-20,n,{align:"right"}),n+=6),t.cgstAmount&&(e.text(`CGST (${t.cgstPercentage}%)`,20,n),e.text(d(t.cgstAmount),o-20,n,{align:"right"}),n+=6)):t.gstMode==="igst"&&t.igstAmount&&(e.setFontSize(9),e.setFont("helvetica","normal"),e.setTextColor(l.r,l.g,l.b),e.text(`IGST (${t.igstPercentage}%)`,20,n),e.text(d(t.igstAmount),o-20,n,{align:"right"}),n+=6),n+=5,e.setFillColor(c.r,c.g,c.b),e.roundedRect(o-95,n,80,22,3,3,"F"),e.setFontSize(10),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text("GRAND TOTAL",o-90,n+8),e.setFontSize(14),e.text(d(t.grandTotal||t.finalSellingPrice||0),o-90,n+17),t.exchangeRate&&t.grandTotal){n+=28,e.setFontSize(9),e.setFont("helvetica","normal"),e.setTextColor(i.r,i.g,i.b);const s=(t.grandTotal/t.exchangeRate).toFixed(2);e.text(`USD Equivalent: $ ${Number(s).toLocaleString("en-US")} (Rate: ${t.exchangeRate})`,o-20,n,{align:"right"})}if(t.invoiceNotes){n+=15,e.setFillColor(248,250,252),e.roundedRect(15,n,o-30,25,2,2,"F"),e.setFontSize(8),e.setFont("helvetica","bold"),e.setTextColor(c.r,c.g,c.b),e.text("NOTES",20,n+6),e.setFont("helvetica","normal"),e.setTextColor(l.r,l.g,l.b);const s=e.splitTextToSize(t.invoiceNotes,o-50);e.text(s.slice(0,2),20,n+12)}const p=C-25;if(e.setDrawColor(c.r,c.g,c.b),e.setLineWidth(.5),e.line(15,p,o-15,p),e.setFontSize(8),e.setFont("helvetica","normal"),e.setTextColor(i.r,i.g,i.b),e.text("Thank you for your business",o/2,p+6,{align:"center"}),(O=t.vendorBranding)!=null&&O.email||(Y=t.vendorBranding)!=null&&Y.phone){let s="";t.vendorBranding.phone&&(s+=`Tel: ${t.vendorBranding.phone}`),t.vendorBranding.phone&&t.vendorBranding.email&&(s+=" | "),t.vendorBranding.email&&(s+=`Email: ${t.vendorBranding.email}`),e.text(s,o/2,p+12,{align:"center"})}const I=u.length>0?2:1;if(e.setFontSize(7),e.text(`Page 1 of ${I}`,o-20,p+18,{align:"right"}),u.length>0){e.addPage();let s=20;e.setFillColor(c.r,c.g,c.b),e.rect(0,0,o,30,"F"),e.setFontSize(18),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text("GEMSTONE CERTIFICATES",20,20),e.setFontSize(10),e.setFont("helvetica","normal"),e.text(`Invoice: ${t.invoiceNumber}`,o-20,20,{align:"right"}),s=45;for(let D=0;D<u.length;D++){const v=u[D];s>C-100&&(e.addPage(),s=20),e.setFontSize(11),e.setFont("helvetica","bold"),e.setTextColor(l.r,l.g,l.b),e.text(`Certificate for: ${v.itemName}`,20,s),s+=8;try{const f=await H(v.imageUrl);if(f){const B=o-40,L=120;e.setDrawColor(c.r,c.g,c.b),e.setLineWidth(.5),e.rect(19,s-1,B+2,L+2,"S"),e.addImage(f,"JPEG",20,s,B,L),s+=L+15}else e.setFontSize(9),e.setFont("helvetica","italic"),e.setTextColor(i.r,i.g,i.b),e.text("Certificate image could not be loaded",20,s),s+=15}catch(f){console.error("Error loading certificate image:",f),e.setFontSize(9),e.setFont("helvetica","italic"),e.setTextColor(i.r,i.g,i.b),e.text("Certificate image could not be loaded",20,s),s+=15}}const g=C-15;e.setFontSize(7),e.setFont("helvetica","normal"),e.setTextColor(i.r,i.g,i.b),e.text(`Page 2 of ${I}`,o-20,g,{align:"right"}),(M=t.vendorBranding)!=null&&M.name&&e.text(t.vendorBranding.name,20,g)}const b=`Invoice_${t.invoiceNumber.replace(/[^a-z0-9]/gi,"_")}_Gemstone.pdf`;e.save(b)};export{Ce as g};
//# sourceMappingURL=invoiceGenerator-BHCm5yW4.js.map
