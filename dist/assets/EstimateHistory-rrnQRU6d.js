import{j as e}from"./query-vendor-BLxHmmGk.js";import{u as F,r as l}from"./react-vendor-BeR0k5Z3.js";import{s as p,B as d,C as f,i as I,k as T,g}from"./index-CX6yiz0b.js";import{I as A}from"./input-CiHC6UAI.js";import{B as j}from"./badge-45Abp579.js";import{u as v,E as B,l as m,K as D,av as V,an as q}from"./ui-vendor-DjQqXt9S.js";import{S as z,a as H,b as P,c as U,d as i}from"./select-CYWHo3cU.js";import"./supabase-vendor-VSDMYZ1k.js";import"./index-BdQq_4o_.js";import"./index-BC78nHQ6.js";import"./index-D6fUEw85.js";import"./index-DjQc2W_p.js";const ee=()=>{const o=F(),[u,N]=l.useState([]),[c,b]=l.useState([]),[r,y]=l.useState(""),[n,w]=l.useState("all"),[C,S]=l.useState(!0);l.useEffect(()=>{_()},[]),l.useEffect(()=>{E()},[r,n,u]);const _=async()=>{try{const{data:{user:s}}=await p.auth.getUser();if(!s){v.error("Please sign in to view estimates"),o("/auth");return}const{data:a,error:t}=await p.from("manufacturing_cost_estimates").select("*").eq("user_id",s.id).or("is_invoice_generated.is.null,is_invoice_generated.eq.false").order("created_at",{ascending:!1});if(t)throw t;N(a||[])}catch(s){v.error("Failed to load estimates"),console.error("Error fetching estimates:",s)}finally{S(!1)}},E=()=>{let s=u;r&&(s=s.filter(a=>{var t,x,h;return((t=a.estimate_name)==null?void 0:t.toLowerCase().includes(r.toLowerCase()))||((x=a.customer_name)==null?void 0:x.toLowerCase().includes(r.toLowerCase()))||((h=a.customer_email)==null?void 0:h.toLowerCase().includes(r.toLowerCase()))})),n!=="all"&&(s=s.filter(a=>a.status===n)),b(s)},k=s=>{o(`/manufacturing-cost?estimate=${s}`)},L=s=>{o(`/invoice-generator?estimate=${s}`)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-muted/20 p-4 md:p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs(d,{variant:"ghost",onClick:()=>o("/calculators"),className:"group",children:[e.jsx(B,{className:"mr-2 h-4 w-4 transition-transform group-hover:-translate-x-1"}),"Back to Calculators"]}),e.jsxs(f,{className:"border-primary/10 shadow-2xl backdrop-blur-sm bg-card/95",children:[e.jsx(I,{className:"bg-gradient-to-r from-primary/5 via-secondary/5 to-accent/5 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(T,{className:"text-3xl font-bold flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(m,{className:"h-7 w-7 text-primary"})}),"Estimate History"]}),e.jsxs(j,{variant:"secondary",className:"text-sm",children:[c.length," ",c.length===1?"Estimate":"Estimates"]})]})}),e.jsxs(g,{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(D,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(A,{placeholder:"Search by estimate name, customer name or email...",value:r,onChange:s=>y(s.target.value),className:"pl-10"})]}),e.jsxs(z,{value:n,onValueChange:w,children:[e.jsx(H,{className:"w-full md:w-48",children:e.jsx(P,{placeholder:"Filter by status"})}),e.jsxs(U,{children:[e.jsx(i,{value:"all",children:"All Status"}),e.jsx(i,{value:"draft",children:"Draft"}),e.jsx(i,{value:"quoted",children:"Quoted"}),e.jsx(i,{value:"approved",children:"Approved"}),e.jsx(i,{value:"in_production",children:"In Production"}),e.jsx(i,{value:"completed",children:"Completed"})]})]})]}),C?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Loading estimates..."})]}):c.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"p-4 rounded-full bg-muted/50 inline-block mb-4",children:e.jsx(m,{className:"h-16 w-16 text-muted-foreground"})}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No estimates found"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:r||n!=="all"?"Try adjusting your filters":"Start creating estimates to see them here"})]}):e.jsx("div",{className:"space-y-4",children:c.map(s=>{var a,t;return e.jsx(f,{className:"group hover:shadow-lg hover:border-primary/20 transition-all duration-200 bg-gradient-to-br from-card to-card/50",children:e.jsx(g,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[e.jsxs("div",{className:"space-y-3 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-primary/5 px-3 py-1.5 rounded-lg",children:[e.jsx(m,{className:"h-4 w-4 text-primary"}),e.jsx("h3",{className:"font-bold text-lg",children:s.estimate_name})]}),e.jsx(j,{variant:s.status==="completed"?"default":"secondary",className:"capitalize",children:(a=s.status)==null?void 0:a.replace("_"," ")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Customer:"}),e.jsx("span",{className:"text-foreground",children:s.customer_name||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Created:"}),e.jsx("span",{className:"text-foreground",children:new Date(s.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"flex items-baseline gap-2 pt-1",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Amount:"}),e.jsxs("span",{className:"text-2xl font-bold text-primary",children:["â‚¹",(t=s.final_selling_price)==null?void 0:t.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(d,{variant:"outline",size:"default",onClick:()=>k(s.id),className:"group/btn",children:[e.jsx(V,{className:"h-4 w-4 mr-2 transition-transform group-hover/btn:scale-110"}),"View"]}),e.jsxs(d,{size:"default",onClick:()=>L(s.id),className:"group/btn bg-primary hover:bg-primary/90",children:[e.jsx(q,{className:"h-4 w-4 mr-2 transition-transform group-hover/btn:scale-110"}),"Create Invoice"]})]})]})})},s.id)})})]})]})]})})};export{ee as default};
//# sourceMappingURL=EstimateHistory-rrnQRU6d.js.map
