import{j as e}from"./query-vendor-CIvqgC9B.js";import{u as A,r as d}from"./react-vendor-BCzWReGx.js";import{l,B as i,C as p,t as N,x as v,o as h}from"./index-DBHw7ps1.js";import{u as r,P as f,d as S,bB as k,f as E,b0 as P,b4 as B,aG as F}from"./ui-vendor-B3Ur81tx.js";import{B as I}from"./BackToHomeButton-Vfa6cTYe.js";import{P as w}from"./generateTemplate-CGI6eLLE.js";import{A as U,a as q,b as z,c as H,d as L,e as O,f as R,g as $}from"./alert-dialog-C5S5s-18.js";import{B as G}from"./badge-HmGNQ04n.js";import"./supabase-vendor-DJknrin8.js";import"./xlsx-CKN5doRT.js";import"./invoiceTemplate-N6fQ82wS.js";import"./index-BswhvY0M.js";import"./index-vsC2Ycwh.js";const re=()=>{const c=A(),[m,y]=d.useState([]),[b,g]=d.useState(!0),[u,x]=d.useState(null);d.useEffect(()=>{C(),o()},[]);const C=async()=>{const{data:{user:s}}=await l.auth.getUser();if(!s){r.error("Please sign in to manage templates"),c("/auth");return}},o=async()=>{g(!0);const{data:{user:s}}=await l.auth.getUser();if(!s)return;const{data:a,error:t}=await l.from("invoice_templates").select("*").eq("user_id",s.id).order("created_at",{ascending:!1});t?(console.error("Error fetching templates:",t),r.error("Failed to load templates")):y((a||[]).map(n=>({...n,template_data:n.template_data}))),g(!1)},_=async()=>{if(!u)return;const{error:s}=await l.from("invoice_templates").delete().eq("id",u);s?(r.error("Failed to delete template"),console.error(s)):(r.success("Template deleted successfully"),o()),x(null)},T=async s=>{const{data:{user:a}}=await l.auth.getUser();if(!a)return;const{error:t}=await l.from("invoice_templates").insert({user_id:a.id,name:`${s.name} (Copy)`,description:s.description,template_data:s.template_data,is_default:!1});t?(r.error("Failed to duplicate template"),console.error(t)):(r.success("Template duplicated successfully"),o())},D=async s=>{const{error:a}=await l.from("invoice_templates").update({is_default:!s.is_default}).eq("id",s.id);a?(r.error("Failed to update template"),console.error(a)):(r.success(s.is_default?"Removed from default":"Set as default"),o())},j=async s=>{const{data:{user:a}}=await l.auth.getUser();if(!a)return;const t=w[s],{error:n}=await l.from("invoice_templates").insert({user_id:a.id,name:t.name,description:t.description,template_data:t.template_data,is_default:m.length===0});n?(r.error("Failed to create template"),console.error(n)):(r.success(`${t.name} template created`),o())};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-muted/20 p-4 md:p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{}),e.jsxs(i,{onClick:()=>c("/invoice-template-builder"),children:[e.jsx(f,{className:"mr-2 h-4 w-4"}),"Create New Template"]})]}),e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-primary via-accent to-primary bg-clip-text text-transparent",children:"Invoice Templates"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Manage your custom invoice layouts"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold text-foreground",children:"Start with a Pre-Designed Template"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:Object.entries(w).map(([s,a])=>e.jsxs(p,{className:"hover:shadow-lg transition-all cursor-pointer border-2 hover:border-primary/50",onClick:()=>j(s),children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5 text-primary"}),e.jsx(v,{className:"text-lg",children:a.name})]})}),e.jsxs(h,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:a.description}),e.jsxs(i,{variant:"outline",className:"w-full",onClick:t=>{t.stopPropagation(),j(s)},children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Use This Template"]})]})]},s))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold text-foreground",children:"Your Custom Templates"}),b?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading templates..."})}):m.length===0?e.jsx(p,{children:e.jsxs(h,{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No custom templates yet. Start with a pre-designed template above or create from scratch!"}),e.jsxs(i,{onClick:()=>c("/invoice-template-builder"),children:[e.jsx(f,{className:"mr-2 h-4 w-4"}),"Create from Scratch"]})]})}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:m.map(s=>{var a;return e.jsxs(p,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(v,{className:"text-lg",children:s.name}),s.is_default&&e.jsx(G,{className:"mt-2",variant:"secondary",children:"Default"})]}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>D(s),children:s.is_default?e.jsx(k,{className:"h-4 w-4 text-yellow-500"}):e.jsx(E,{className:"h-4 w-4"})})]})}),e.jsxs(h,{className:"space-y-4",children:[s.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.description}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[((a=s.template_data.sections)==null?void 0:a.length)||0," sections"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>c(`/invoice-template-builder/${s.id}`),children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>T(s),children:e.jsx(B,{className:"h-4 w-4"})}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>x(s.id),children:e.jsx(F,{className:"h-4 w-4"})})]})]})]},s.id)})})]}),e.jsx(U,{open:!!u,onOpenChange:()=>x(null),children:e.jsxs(q,{children:[e.jsxs(z,{children:[e.jsx(H,{children:"Delete Template"}),e.jsx(L,{children:"Are you sure you want to delete this template? This action cannot be undone."})]}),e.jsxs(O,{children:[e.jsx(R,{children:"Cancel"}),e.jsx($,{onClick:_,children:"Delete"})]})]})})]})})};export{re as default};
//# sourceMappingURL=InvoiceTemplates-D9W1u866.js.map
