import{j as e}from"./query-vendor-BLxHmmGk.js";import{r as p,u as ne}from"./react-vendor-BeR0k5Z3.js";import{u as ce,a as U,P as R,d as W,e as V,x as de,y as me,f as $,s as F,A as pe,B as q,C as ue,i as ge,k as he,g as _e}from"./index-CX6yiz0b.js";import{I as o}from"./input-CiHC6UAI.js";import{L as a}from"./label-DbIM3Eg1.js";import{T as xe}from"./textarea-CBQfWmvq.js";import{c as O,R as ye,I as je}from"./index-DVcnno33.js";import{u as ve}from"./index-BC78nHQ6.js";import{u as fe}from"./index-DjQc2W_p.js";import{aD as be,u as k,E as Ne,a7 as we,X as I,a9 as E,q as A}from"./ui-vendor-DjQqXt9S.js";import{u as Fe}from"./useVendorPermissions-CoV6zMFq.js";import{P as Ce}from"./PlanLimitWarning-BlkgAHMZ.js";import{u as ke}from"./useRewardsSystem-d5GTIiEP.js";import{j as Re}from"./validations-BCm7QRmg.js";import{A as Pe,a as Se}from"./alert-DIsJjuyH.js";import"./supabase-vendor-VSDMYZ1k.js";import"./index-ibl8YJur.js";var T="Radio",[Ge,B]=U(T),[Ie,Ee]=Ge(T),J=p.forwardRef((r,t)=>{const{__scopeRadio:c,name:y,checked:_=!1,required:n,disabled:i,value:l="on",onCheck:u,form:j,...x}=r,[f,s]=p.useState(null),h=W(t,v=>s(v)),b=p.useRef(!1),C=f?j||!!f.closest("form"):!0;return e.jsxs(Ie,{scope:c,checked:_,disabled:i,children:[e.jsx(R.button,{type:"button",role:"radio","aria-checked":_,"data-state":X(_),"data-disabled":i?"":void 0,disabled:i,value:l,...x,ref:h,onClick:V(r.onClick,v=>{_||u==null||u(),C&&(b.current=v.isPropagationStopped(),b.current||v.stopPropagation())})}),C&&e.jsx(z,{control:f,bubbles:!b.current,name:y,value:l,checked:_,required:n,disabled:i,form:j,style:{transform:"translateX(-100%)"}})]})});J.displayName=T;var K="RadioIndicator",H=p.forwardRef((r,t)=>{const{__scopeRadio:c,forceMount:y,..._}=r,n=Ee(K,c);return e.jsx(de,{present:y||n.checked,children:e.jsx(R.span,{"data-state":X(n.checked),"data-disabled":n.disabled?"":void 0,..._,ref:t})})});H.displayName=K;var Ae="RadioBubbleInput",z=p.forwardRef(({__scopeRadio:r,control:t,checked:c,bubbles:y=!0,..._},n)=>{const i=p.useRef(null),l=W(i,n),u=fe(c),j=me(t);return p.useEffect(()=>{const x=i.current;if(!x)return;const f=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(f,"checked").set;if(u!==c&&h){const b=new Event("click",{bubbles:y});h.call(x,c),x.dispatchEvent(b)}},[u,c,y]),e.jsx(R.input,{type:"radio","aria-hidden":!0,defaultChecked:c,..._,tabIndex:-1,ref:l,style:{..._.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});z.displayName=Ae;function X(r){return r?"checked":"unchecked"}var Ve=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],P="RadioGroup",[Le]=U(P,[O,B]),Y=O(),Q=B(),[We,Te]=Le(P),Z=p.forwardRef((r,t)=>{const{__scopeRadioGroup:c,name:y,defaultValue:_,value:n,required:i=!1,disabled:l=!1,orientation:u,dir:j,loop:x=!0,onValueChange:f,...s}=r,h=Y(c),b=ve(j),[C,v]=ce({prop:n,defaultProp:_??null,onChange:f,caller:P});return e.jsx(We,{scope:c,name:y,required:i,disabled:l,value:C,onValueChange:v,children:e.jsx(ye,{asChild:!0,...h,orientation:u,dir:b,loop:x,children:e.jsx(R.div,{role:"radiogroup","aria-required":i,"aria-orientation":u,"data-disabled":l?"":void 0,dir:b,...s,ref:t})})})});Z.displayName=P;var D="RadioGroupItem",ee=p.forwardRef((r,t)=>{const{__scopeRadioGroup:c,disabled:y,..._}=r,n=Te(D,c),i=n.disabled||y,l=Y(c),u=Q(c),j=p.useRef(null),x=W(t,j),f=n.value===_.value,s=p.useRef(!1);return p.useEffect(()=>{const h=C=>{Ve.includes(C.key)&&(s.current=!0)},b=()=>s.current=!1;return document.addEventListener("keydown",h),document.addEventListener("keyup",b),()=>{document.removeEventListener("keydown",h),document.removeEventListener("keyup",b)}},[]),e.jsx(je,{asChild:!0,...l,focusable:!i,active:f,children:e.jsx(J,{disabled:i,required:n.required,checked:f,...u,..._,name:n.name,ref:x,onCheck:()=>n.onValueChange(_.value),onKeyDown:V(h=>{h.key==="Enter"&&h.preventDefault()}),onFocus:V(_.onFocus,()=>{var h;s.current&&((h=j.current)==null||h.click())})})})});ee.displayName=D;var Me="RadioGroupIndicator",se=p.forwardRef((r,t)=>{const{__scopeRadioGroup:c,...y}=r,_=Q(c);return e.jsx(H,{..._,...y,ref:t})});se.displayName=Me;var re=Z,te=ee,qe=se;const ae=p.forwardRef(({className:r,...t},c)=>e.jsx(re,{className:$("grid gap-2",r),...t,ref:c}));ae.displayName=re.displayName;const L=p.forwardRef(({className:r,...t},c)=>e.jsx(te,{ref:c,className:$("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),...t,children:e.jsx(qe,{className:"flex items-center justify-center",children:e.jsx(be,{className:"h-2.5 w-2.5 fill-current text-current"})})}));L.displayName=te.displayName;const Ue=({formData:r,handleChange:t,setFormData:c})=>{const[y,_]=p.useState(0);return p.useEffect(()=>{(async()=>{const{data:{user:i}}=await F.auth.getUser();if(!i)return;const{data:l}=await F.from("vendor_profiles").select("making_charges_per_gram").eq("user_id",i.id).maybeSingle();if(l!=null&&l.making_charges_per_gram){const u=Number(l.making_charges_per_gram);isNaN(u)||_(u)}})()},[]),p.useEffect(()=>{const n=parseFloat(r.d_wt_1)||0,i=parseFloat(r.d_wt_2)||0,l=n+i;l>0&&l.toFixed(2)!==r.diamond_weight&&c(u=>({...u,diamond_weight:l.toFixed(2)}))},[r.d_wt_1,r.d_wt_2]),p.useEffect(()=>{const n=parseFloat(r.d_wt_1)||0,i=parseFloat(r.d_wt_2)||0,l=parseFloat(r.d_rate_1)||0,u=parseFloat(r.pointer_diamond)||0,j=parseFloat(r.diamond_weight)||0;let x=0;r.d_wt_1||r.d_wt_2?x=n*l+i*u:j>0&&l>0&&(x=j*l),x>0&&x.toFixed(2)!==r.d_value&&c(f=>({...f,d_value:x.toFixed(2)}))},[r.d_wt_1,r.d_wt_2,r.d_rate_1,r.pointer_diamond,r.diamond_weight]),p.useEffect(()=>{const n=parseFloat(r.weight_grams)||0,i=parseFloat(r.diamond_weight)||0,l=parseFloat(r.carat_weight)||0;if(n>0&&(i>0||l>0)){const u=n-(i+l)/5;u>0&&u.toFixed(3)!==r.net_weight&&c(j=>({...j,net_weight:u.toFixed(3)}))}},[r.weight_grams,r.diamond_weight,r.carat_weight]),p.useEffect(()=>{const n=parseFloat(r.carat_weight)||0,i=parseFloat(r.gemstone_rate)||0;if(n>0&&i>0){const l=n*i;l.toFixed(2)!==r.gemstone_cost&&c(u=>({...u,gemstone_cost:l.toFixed(2)}))}},[r.carat_weight,r.gemstone_rate]),p.useEffect(()=>{const n=parseFloat(r.weight_grams)||0;if(n>0&&y>0){const i=n*y;i.toFixed(2)!==r.mkg&&c(l=>({...l,mkg:i.toFixed(2)}))}},[r.weight_grams,y]),p.useEffect(()=>{const n=parseFloat(r.net_weight)||0,i=parseFloat(r.gold_per_gram_price)||0,l=(parseFloat(r.purity_fraction_used)||100)/100,u=parseFloat(r.d_value)||0,j=parseFloat(r.mkg)||0,x=parseFloat(r.certification_cost)||0,f=parseFloat(r.gemstone_cost)||0,s=n*i*l,h=u+j+s+x+f;h.toFixed(2)!==r.retail_price&&c(b=>({...b,retail_price:h.toFixed(2),cost_price:(h*.85).toFixed(2)}))},[r.net_weight,r.gold_per_gram_price,r.purity_fraction_used,r.d_value,r.mkg,r.certification_cost,r.gemstone_cost]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"}),"Jewellery Details",e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"metal_type",children:"Metal Type"}),e.jsx(o,{id:"metal_type",name:"metal_type",value:r.metal_type,onChange:t,placeholder:"18k Gold"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"gemstone",children:"Gemstone"}),e.jsx(o,{id:"gemstone",name:"gemstone",value:r.gemstone,onChange:t,placeholder:"GH VS (Color Clarity)"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"weight_grams",children:"Gross Weight (g)"}),e.jsx(o,{id:"weight_grams",name:"weight_grams",type:"number",step:"0.001",value:r.weight_grams,onChange:t,placeholder:"4.37"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"carat_weight",children:"Gemstone Weight (ct)"}),e.jsx(o,{id:"carat_weight",name:"carat_weight",type:"number",step:"0.01",value:r.carat_weight,onChange:t,placeholder:"0.50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"net_weight",children:"Net Weight (g)"}),e.jsx(o,{id:"net_weight",name:"net_weight",type:"number",step:"0.001",value:r.net_weight,onChange:t,placeholder:"4.252",className:"bg-muted/30",readOnly:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"d_wt_1",children:"D.WT 1 (ct)"}),e.jsx(o,{id:"d_wt_1",name:"d_wt_1",type:"number",step:"0.01",value:r.d_wt_1,onChange:t,placeholder:"0.23"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"d_wt_2",children:"D.WT 2 (ct)"}),e.jsx(o,{id:"d_wt_2",name:"d_wt_2",type:"number",step:"0.01",value:r.d_wt_2,onChange:t,placeholder:"0.36"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"diamond_weight",children:"Total D.WT (ct)"}),e.jsx(o,{id:"diamond_weight",name:"diamond_weight",type:"number",step:"0.01",value:r.diamond_weight,onChange:t,placeholder:"0.59",className:"bg-muted/30",readOnly:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Auto-calculated: D.WT 1 + D.WT 2"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"d_rate_1",children:"D Rate 1 (â‚¹)"}),e.jsx(o,{id:"d_rate_1",name:"d_rate_1",type:"number",step:"0.01",value:r.d_rate_1,onChange:t,placeholder:"15000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"pointer_diamond",children:"Pointer Diamond (â‚¹)"}),e.jsx(o,{id:"pointer_diamond",name:"pointer_diamond",type:"number",step:"0.01",value:r.pointer_diamond,onChange:t,placeholder:"12000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"d_value",children:"D Value (â‚¹)"}),e.jsx(o,{id:"d_value",name:"d_value",type:"number",step:"0.01",value:r.d_value,onChange:t,placeholder:"8850",className:"bg-muted/30",readOnly:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"purity_fraction_used",children:"Purity (%)"}),e.jsx(o,{id:"purity_fraction_used",name:"purity_fraction_used",type:"number",step:"0.01",value:r.purity_fraction_used,onChange:t,placeholder:"76"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"gold_per_gram_price",children:"Gold/Gram (â‚¹)"}),e.jsx(o,{id:"gold_per_gram_price",name:"gold_per_gram_price",type:"number",step:"0.01",value:r.gold_per_gram_price,onChange:t,placeholder:"7500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"mkg",children:"Making Charges (â‚¹)"}),e.jsx(o,{id:"mkg",name:"mkg",type:"number",step:"0.01",value:r.mkg,onChange:t,placeholder:"4039.40",className:"bg-muted/30",readOnly:!0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Auto-calculated: Gross Weight Ã— ",y,"/g"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"retail_price",children:"Total Price (â‚¹)"}),e.jsx(o,{id:"retail_price",name:"retail_price",type:"number",step:"0.01",value:r.retail_price,onChange:t,placeholder:"0",className:"bg-muted/30",readOnly:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"gemstone_rate",children:"Gemstone Rate (â‚¹/ct)"}),e.jsx(o,{id:"gemstone_rate",name:"gemstone_rate",type:"number",step:"0.01",value:r.gemstone_rate,onChange:t,placeholder:"5000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"gemstone_cost",children:"Gemstone Cost (â‚¹)"}),e.jsx(o,{id:"gemstone_cost",name:"gemstone_cost",type:"number",step:"0.01",value:r.gemstone_cost,onChange:t,placeholder:"0",className:"bg-muted/30",readOnly:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Auto-calculated: G.WT Ã— Rate"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"certification_cost",children:"Cert Cost (â‚¹)"}),e.jsx(o,{id:"certification_cost",name:"certification_cost",type:"number",step:"0.01",value:r.certification_cost,onChange:t,placeholder:"0"})]})]}),e.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg border border-border",children:[e.jsx("p",{className:"text-sm font-medium mb-3",children:"Formula Breakdown:"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"D Value:"}),e.jsxs("span",{className:"font-medium",children:["â‚¹",parseFloat(r.d_value||0).toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Making Charges:"}),e.jsxs("span",{className:"font-medium",children:["â‚¹",parseFloat(r.mkg||0).toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Gold Value:"}),e.jsxs("span",{className:"font-medium",children:["â‚¹",(parseFloat(r.net_weight||0)*parseFloat(r.gold_per_gram_price||0)*(parseFloat(r.purity_fraction_used||100)/100)).toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Certification:"}),e.jsxs("span",{className:"font-medium",children:["â‚¹",parseFloat(r.certification_cost||0).toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Gemstone Cost:"}),e.jsxs("span",{className:"font-medium",children:["â‚¹",parseFloat(r.gemstone_cost||0).toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"border-t pt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"Total Price:"}),e.jsxs("span",{className:"font-bold text-primary",children:["â‚¹",parseFloat(r.retail_price||0).toLocaleString("en-IN")]})]})]})]})]})},$e=({formData:r,handleChange:t})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"}),"Gemstone Details",e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"gemstone_name",children:"Gemstone Name"}),e.jsx(o,{id:"gemstone_name",name:"gemstone_name",value:r.gemstone_name,onChange:t,placeholder:"Ruby, Sapphire, Emerald..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"gemstone_type",children:"Gemstone Type"}),e.jsx(o,{id:"gemstone_type",name:"gemstone_type",value:r.gemstone_type,onChange:t,placeholder:"Natural, Synthetic..."})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"color",children:"Color"}),e.jsx(o,{id:"color",name:"color",value:r.color,onChange:t,placeholder:"Red, Blue, Green..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"clarity",children:"Clarity"}),e.jsx(o,{id:"clarity",name:"clarity",value:r.clarity,onChange:t,placeholder:"VVS, VS, SI..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"cut",children:"Cut"}),e.jsx(o,{id:"cut",name:"cut",value:r.cut,onChange:t,placeholder:"Excellent, Good..."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"carat_weight",children:"Carat Weight"}),e.jsx(o,{id:"carat_weight",name:"carat_weight",type:"number",step:"0.01",value:r.carat_weight,onChange:t,placeholder:"5.50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"per_carat_price",children:"Per Carat Price (â‚¹)"}),e.jsx(o,{id:"per_carat_price",name:"per_carat_price",type:"number",step:"0.01",value:r.per_carat_price,onChange:t,placeholder:"10000"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"color_shade_amount",children:"Color Shade Amount"}),e.jsx(o,{id:"color_shade_amount",name:"color_shade_amount",value:r.color_shade_amount,onChange:t,placeholder:"Vivid, Medium..."})]})]}),Oe=({formData:r,handleChange:t})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"}),"Diamond Details",e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"shape",children:"Shape"}),e.jsx(o,{id:"shape",name:"shape",value:r.shape,onChange:t,placeholder:"Round, Princess, Oval..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"carat",children:"Carat"}),e.jsx(o,{id:"carat",name:"carat",type:"number",step:"0.01",value:r.carat,onChange:t,placeholder:"1.50"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"color",children:"Color"}),e.jsx(o,{id:"color",name:"color",value:r.color,onChange:t,placeholder:"D, E, F, G, H..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"clarity",children:"Clarity"}),e.jsx(o,{id:"clarity",name:"clarity",value:r.clarity,onChange:t,placeholder:"IF, VVS1, VVS2, VS1..."})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"cut",children:"Cut"}),e.jsx(o,{id:"cut",name:"cut",value:r.cut,onChange:t,placeholder:"Excellent, Very Good..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"polish",children:"Polish"}),e.jsx(o,{id:"polish",name:"polish",value:r.polish,onChange:t,placeholder:"Excellent, Very Good..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"symmetry",children:"Symmetry"}),e.jsx(o,{id:"symmetry",name:"symmetry",value:r.symmetry,onChange:t,placeholder:"Excellent, Very Good..."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"fluorescence",children:"Fluorescence"}),e.jsx(o,{id:"fluorescence",name:"fluorescence",value:r.fluorescence,onChange:t,placeholder:"None, Faint, Medium..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"measurement",children:"Measurement"}),e.jsx(o,{id:"measurement",name:"measurement",value:r.measurement,onChange:t,placeholder:"6.50 x 6.55 x 4.05 mm"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"lab",children:"Lab"}),e.jsx(o,{id:"lab",name:"lab",value:r.lab,onChange:t,placeholder:"GIA, IGI, AGS..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"certification",children:"Certification #"}),e.jsx(o,{id:"certification",name:"certification",value:r.certification,onChange:t,placeholder:"Certificate number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"ratio",children:"Ratio"}),e.jsx(o,{id:"ratio",name:"ratio",value:r.ratio,onChange:t,placeholder:"1.00 - 1.05"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"per_carat_price",children:"Per Carat Price (â‚¹)"}),e.jsx(o,{id:"per_carat_price",name:"per_carat_price",type:"number",step:"0.01",value:r.per_carat_price,onChange:t,placeholder:"500000"})]})]}),ls=()=>{const r=ne(),{permissions:t,loading:c}=Fe(),{awardPoints:y}=ke(),[_,n]=p.useState(!1),[i,l]=p.useState({}),[u,j]=p.useState(["Jewellery"]),[x,f]=p.useState([]),[s,h]=p.useState({name:"",description:"",sku:"",category:"",product_type:"Jewellery",metal_type:"",gemstone:"",gemstone_name:"",gemstone_type:"",gemstone_rate:"",color:"",diamond_color:"",clarity:"",cut:"",polish:"",symmetry:"",fluorescence:"",shape:"",measurement:"",certification:"",ratio:"",lab:"",weight_grams:"",net_weight:"",diamond_weight:"",d_wt_1:"",d_wt_2:"",purity_fraction_used:"",d_rate_1:"",pointer_diamond:"",d_value:"",mkg:"",carat:"",carat_weight:"",per_carat_price:"",gold_per_gram_price:"",certification_cost:"",gemstone_cost:"",cost_price:"",retail_price:"",total_usd:"",stock_quantity:"0",color_shade_amount:"",image_url:"",image_url_2:"",image_url_3:"",delivery_type:"immediate delivery",dispatches_in_days:""});p.useEffect(()=>{b()},[]);const b=async()=>{try{const{data:{user:d}}=await F.auth.getUser();if(!d)return;const{data:m,error:g}=await F.from("user_approval_status").select("approved_categories").eq("user_id",d.id).single();if(g)throw g;const N=(m==null?void 0:m.approved_categories)||["Jewellery"];j(N),h(w=>({...w,product_type:N[0]}))}catch(d){console.error("Failed to fetch approved categories:",d)}};p.useEffect(()=>{!c&&!t.can_add_products&&(k.error("You don't have permission to add products"),r("/"))},[t,c,r]);const C=async d=>{if(d.preventDefault(),f([]),s.product_type==="Jewellery")try{Re.parse({name:s.name,description:s.description||void 0,sku:s.sku||void 0,category:s.category||void 0,metal_type:s.metal_type,gemstone:s.gemstone||void 0,weight_grams:s.weight_grams?parseFloat(s.weight_grams):void 0,net_weight:s.net_weight?parseFloat(s.net_weight):void 0,gold_per_gram_price:s.gold_per_gram_price?parseFloat(s.gold_per_gram_price):void 0,purity_fraction_used:s.purity_fraction_used?parseFloat(s.purity_fraction_used):void 0,d_wt_1:s.d_wt_1?parseFloat(s.d_wt_1):null,d_wt_2:s.d_wt_2?parseFloat(s.d_wt_2):null,diamond_weight:s.diamond_weight?parseFloat(s.diamond_weight):null,d_rate_1:s.d_rate_1?parseFloat(s.d_rate_1):null,pointer_diamond:s.pointer_diamond?parseFloat(s.pointer_diamond):null,d_value:s.d_value?parseFloat(s.d_value):null,mkg:s.mkg?parseFloat(s.mkg):void 0,carat_weight:s.carat_weight?parseFloat(s.carat_weight):null,gemstone_rate:s.gemstone_rate?parseFloat(s.gemstone_rate):null,certification_cost:s.certification_cost?parseFloat(s.certification_cost):null,gemstone_cost:s.gemstone_cost?parseFloat(s.gemstone_cost):null,cost_price:s.cost_price?parseFloat(s.cost_price):void 0,retail_price:s.retail_price?parseFloat(s.retail_price):void 0,stock_quantity:parseInt(s.stock_quantity),delivery_type:s.delivery_type==="immediate delivery"?"immediate":s.delivery_type,image_url:s.image_url||null,image_url_2:s.image_url_2||null,image_url_3:s.image_url_3||null})}catch(m){if(m.errors){const g=m.errors.map(N=>`${N.path.join(" â†’ ")}: ${N.message}`);f(g),k.error("Please fix the validation errors below"),window.scrollTo({top:0,behavior:"smooth"});return}}n(!0);try{const{data:{user:m}}=await F.auth.getUser();if(!m)throw new Error("Not authenticated");const{error:g}=await F.from("products").insert([{user_id:m.id,name:s.name,description:s.description||null,sku:s.sku||null,category:s.category||null,product_type:s.product_type,metal_type:s.metal_type||null,gemstone:s.gemstone||null,gemstone_name:s.gemstone_name||null,gemstone_type:s.gemstone_type||null,color:s.color||null,diamond_color:s.diamond_color||null,clarity:s.clarity||null,cut:s.cut||null,polish:s.polish||null,symmetry:s.symmetry||null,fluorescence:s.fluorescence||null,shape:s.shape||null,measurement:s.measurement||null,certification:s.certification||null,ratio:s.ratio||null,lab:s.lab||null,weight_grams:s.weight_grams?parseFloat(s.weight_grams):null,net_weight:s.net_weight?parseFloat(s.net_weight):null,diamond_weight:s.diamond_weight?parseFloat(s.diamond_weight):null,d_wt_1:s.d_wt_1?parseFloat(s.d_wt_1):null,d_wt_2:s.d_wt_2?parseFloat(s.d_wt_2):null,purity_fraction_used:s.purity_fraction_used?parseFloat(s.purity_fraction_used):null,d_rate_1:s.d_rate_1?parseFloat(s.d_rate_1):null,pointer_diamond:s.pointer_diamond?parseFloat(s.pointer_diamond):null,d_value:s.d_value?parseFloat(s.d_value):null,mkg:s.mkg?parseFloat(s.mkg):null,carat:s.carat?parseFloat(s.carat):null,carat_weight:s.carat_weight?parseFloat(s.carat_weight):null,per_carat_price:s.per_carat_price?parseFloat(s.per_carat_price):null,gold_per_gram_price:s.gold_per_gram_price?parseFloat(s.gold_per_gram_price):null,certification_cost:s.certification_cost?parseFloat(s.certification_cost):null,gemstone_cost:s.gemstone_cost?parseFloat(s.gemstone_cost):null,cost_price:parseFloat(s.cost_price),retail_price:parseFloat(s.retail_price),total_usd:s.total_usd?parseFloat(s.total_usd):null,stock_quantity:parseInt(s.stock_quantity),color_shade_amount:s.color_shade_amount||null,image_url:s.image_url||null,image_url_2:s.image_url_2||null,image_url_3:s.image_url_3||null,delivery_type:s.delivery_type,dispatches_in_days:s.dispatches_in_days?parseInt(s.dispatches_in_days):null}]);if(g)throw g;try{await y("product_added",{product_name:s.name})}catch(N){console.error("Failed to award points:",N)}k.success("Product added successfully!"),r("/")}catch(m){k.error(m.message||"Failed to add product")}finally{n(!1)}},v=d=>{h({...s,[d.target.name]:d.target.value})},S=async(d,m)=>{if(d){if(!d.type.startsWith("image/")){k.error("Please upload an image file");return}if(d.size>5*1024*1024){k.error("Image size should be less than 5MB");return}l(g=>({...g,[m]:!0}));try{const{data:{user:g}}=await F.auth.getUser();if(!g)throw new Error("Not authenticated");const N=d.name.split(".").pop(),w=`${g.id}/${Date.now()}-${Math.random().toString(36).substring(7)}.${N}`,{data:oe,error:M}=await F.storage.from("product-images").upload(w,d,{cacheControl:"3600",upsert:!1});if(M)throw M;const{data:{publicUrl:ie}}=F.storage.from("product-images").getPublicUrl(oe.path);h(le=>({...le,[m]:ie})),k.success("Image uploaded successfully!")}catch(g){console.error("Upload error:",g),k.error(g.message||"Failed to upload image")}finally{l(g=>({...g,[m]:!1}))}}},G=d=>{h(m=>({...m,[d]:""}))};return c?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."}):e.jsx(pe,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-muted/20 py-8",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[e.jsxs(q,{variant:"ghost",onClick:()=>r("/"),className:"mb-6",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Back to Catalog"]}),e.jsxs(ue,{className:"shadow-xl",children:[e.jsxs(ge,{className:"border-b border-border/50",children:[e.jsx(he,{className:"text-3xl font-serif bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"Add New Product"}),e.jsx("p",{className:"text-muted-foreground text-sm mt-2",children:"Select a category and fill in the product details"})]}),e.jsxs(_e,{className:"pt-6",children:[x.length>0&&e.jsxs(Pe,{variant:"destructive",className:"mb-6",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsxs(Se,{children:[e.jsx("div",{className:"font-semibold mb-2",children:"Please fix the following errors:"}),e.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm",children:x.map((d,m)=>e.jsx("li",{children:d},m))})]})]}),e.jsx("div",{className:"mb-6",children:e.jsx(Ce,{})}),u.length>1&&e.jsxs("div",{className:"mb-8 pb-6 border-b border-border/30",children:[e.jsx(a,{className:"text-base font-semibold mb-4 block",children:"Select Product Category *"}),e.jsx("div",{className:"flex gap-3 flex-wrap",children:u.map(d=>{const m=s.product_type===d,g=d.toLowerCase().replace(/\s+/g,"-"),N={jewellery:{gradient:"from-category-jewellery/20 to-category-jewellery/5",border:"border-category-jewellery/40",text:"text-category-jewellery",glow:"shadow-[0_0_20px_hsl(var(--category-jewellery)/0.3)]",icon:"ðŸ’"},gemstones:{gradient:"from-category-gemstone/20 to-category-gemstone/5",border:"border-category-gemstone/40",text:"text-category-gemstone",glow:"shadow-[0_0_20px_hsl(var(--category-gemstone)/0.3)]",icon:"ðŸ’Ž"},"loose-gemstones":{gradient:"from-category-gemstone/20 to-category-gemstone/5",border:"border-category-gemstone/40",text:"text-category-gemstone",glow:"shadow-[0_0_20px_hsl(var(--category-gemstone)/0.3)]",icon:"ðŸ’Ž"},"loose-diamonds":{gradient:"from-category-diamond/20 to-category-diamond/5",border:"border-category-diamond/40",text:"text-category-diamond",glow:"shadow-[0_0_20px_hsl(var(--category-diamond)/0.3)]",icon:"âœ¨"}},w=N[g]||N.jewellery;return e.jsxs("button",{type:"button",onClick:()=>h({...s,product_type:d}),className:`
                            group relative overflow-hidden px-6 py-3 rounded-xl
                            font-serif text-base font-semibold transition-all duration-300 ease-out
                            ${m?`bg-gradient-to-br ${w.gradient} border-2 ${w.border} ${w.glow} scale-105`:"bg-card/50 border-2 border-border/30 hover:border-border/60 hover:scale-102"}
                          `,children:[e.jsx("div",{className:`
                            absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent
                            -translate-x-full group-hover:translate-x-full transition-transform duration-1000 ease-out
                          `}),e.jsxs("span",{className:`
                            relative flex items-center gap-2
                            ${m?w.text:"text-muted-foreground group-hover:text-foreground"}
                            transition-colors duration-300
                          `,children:[e.jsx("span",{className:"text-xl",children:w.icon}),e.jsx("span",{className:"tracking-wide",children:d})]}),m&&e.jsx("div",{className:`
                              absolute bottom-0 left-1/2 -translate-x-1/2 h-1 w-3/4 rounded-full
                              bg-gradient-to-r ${w.gradient} animate-pulse
                            `})]},d)})})]}),e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"}),"Basic Information",e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"name",children:"Product Name *"}),e.jsx(o,{id:"name",name:"name",value:s.name,onChange:v,required:!0,placeholder:"Gold Diamond Ring"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"description",children:"Description"}),e.jsx(xe,{id:"description",name:"description",value:s.description,onChange:v,placeholder:"Beautiful 18k gold ring with diamond...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"sku",children:"SKU"}),e.jsx(o,{id:"sku",name:"sku",value:s.sku,onChange:v,placeholder:"DPS19"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"category",children:"Sub-Category"}),e.jsx(o,{id:"category",name:"category",value:s.category,onChange:v,placeholder:"DIAMOND PANDENT SET"})]})]})]}),s.product_type==="Jewellery"&&e.jsx(Ue,{formData:s,handleChange:v,setFormData:h}),(s.product_type==="Gemstones"||s.product_type==="Loose Gemstones")&&e.jsx($e,{formData:s,handleChange:v}),s.product_type==="Loose Diamonds"&&e.jsx(Oe,{formData:s,handleChange:v}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"}),"Pricing & Stock",e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"cost_price",children:"Cost Price (â‚¹) *"}),e.jsx(o,{id:"cost_price",name:"cost_price",type:"number",step:"0.01",value:s.cost_price,onChange:v,required:!0,placeholder:"75000.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"retail_price",children:"Retail Price (â‚¹) *"}),e.jsx(o,{id:"retail_price",name:"retail_price",type:"number",step:"0.01",value:s.retail_price,onChange:v,required:!0,placeholder:"95000.00"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"stock_quantity",children:"Stock Quantity"}),e.jsx(o,{id:"stock_quantity",name:"stock_quantity",type:"number",value:s.stock_quantity,onChange:v,placeholder:"1"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"}),"Product Images",e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Primary Image *"}),s.image_url?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s.image_url,alt:"Primary product",className:"w-full h-64 object-cover rounded-lg border-2 border-border"}),e.jsx("button",{type:"button",onClick:()=>G("image_url"),className:"absolute top-2 right-2 bg-destructive text-destructive-foreground p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(I,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",id:"image_upload",accept:"image/*",className:"hidden",onChange:d=>{var g;const m=(g=d.target.files)==null?void 0:g[0];m&&S(m,"image_url")},disabled:i.image_url}),e.jsx("label",{htmlFor:"image_upload",className:`
                            flex flex-col items-center justify-center w-full h-64 
                            border-2 border-dashed rounded-lg cursor-pointer
                            bg-muted/50 hover:bg-muted transition-colors
                            ${i.image_url?"opacity-50 cursor-wait":"border-border hover:border-primary"}
                          `,children:i.image_url?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(E,{className:"h-10 w-10 text-primary animate-spin"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Uploading..."})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(A,{className:"h-10 w-10 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Click to upload primary image"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"PNG, JPG up to 5MB"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Image 2"}),s.image_url_2?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s.image_url_2,alt:"Product image 2",className:"w-full h-48 object-cover rounded-lg border-2 border-border"}),e.jsx("button",{type:"button",onClick:()=>G("image_url_2"),className:"absolute top-2 right-2 bg-destructive text-destructive-foreground p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(I,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",id:"image_upload_2",accept:"image/*",className:"hidden",onChange:d=>{var g;const m=(g=d.target.files)==null?void 0:g[0];m&&S(m,"image_url_2")},disabled:i.image_url_2}),e.jsx("label",{htmlFor:"image_upload_2",className:`
                              flex flex-col items-center justify-center w-full h-48 
                              border-2 border-dashed rounded-lg cursor-pointer
                              bg-muted/50 hover:bg-muted transition-colors
                              ${i.image_url_2?"opacity-50 cursor-wait":"border-border hover:border-primary"}
                            `,children:i.image_url_2?e.jsx(E,{className:"h-8 w-8 text-primary animate-spin"}):e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx(A,{className:"h-8 w-8 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Upload image"})]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Image 3"}),s.image_url_3?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s.image_url_3,alt:"Product image 3",className:"w-full h-48 object-cover rounded-lg border-2 border-border"}),e.jsx("button",{type:"button",onClick:()=>G("image_url_3"),className:"absolute top-2 right-2 bg-destructive text-destructive-foreground p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(I,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",id:"image_upload_3",accept:"image/*",className:"hidden",onChange:d=>{var g;const m=(g=d.target.files)==null?void 0:g[0];m&&S(m,"image_url_3")},disabled:i.image_url_3}),e.jsx("label",{htmlFor:"image_upload_3",className:`
                              flex flex-col items-center justify-center w-full h-48 
                              border-2 border-dashed rounded-lg cursor-pointer
                              bg-muted/50 hover:bg-muted transition-colors
                              ${i.image_url_3?"opacity-50 cursor-wait":"border-border hover:border-primary"}
                            `,children:i.image_url_3?e.jsx(E,{className:"h-8 w-8 text-primary animate-spin"}):e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx(A,{className:"h-8 w-8 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Upload image"})]})})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"}),"Delivery",e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-border to-transparent"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(a,{children:"Delivery Type"}),e.jsxs(ae,{value:s.delivery_type,onValueChange:d=>h({...s,delivery_type:d}),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{value:"immediate delivery",id:"immediate"}),e.jsx(a,{htmlFor:"immediate",children:"Immediate Delivery"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{value:"dispatches in",id:"scheduled"}),e.jsx(a,{htmlFor:"scheduled",children:"Scheduled Delivery"})]})]})]}),s.delivery_type==="dispatches in"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"dispatches_in_days",children:"Dispatch in (days)"}),e.jsx(o,{id:"dispatches_in_days",name:"dispatches_in_days",type:"number",value:s.dispatches_in_days,onChange:v,placeholder:"3"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(q,{type:"submit",className:"w-full h-12 text-lg shadow-lg hover:shadow-xl transition-all duration-300",disabled:_,children:_?"Adding Product...":"Add Product"})})]})]})]})]})})})};export{ls as default};
//# sourceMappingURL=AddProduct-DorMg2TU.js.map
